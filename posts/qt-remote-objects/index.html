<!doctype html><html lang=zh dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Qt Remote Objects ç®€å•ä½¿ç”¨ | âœ¨kiraã®åšå®¢</title><meta name=keywords content="Qt"><meta name=description content="å­¦ä¹ ä½¿ç”¨ Qt Remote Objects"><meta name=author content><link rel=canonical href=https://kira-96.github.io/posts/qt-remote-objects/><link crossorigin=anonymous href=/assets/css/stylesheet.98f7858d07353d656e458d003f39cc16b592a5fbc04fe02e7136bfef3d45dd16.css integrity="sha256-mPeFjQc1PWVuRY0APznMFrWSpfvAT+AucTa/7z1F3RY=" rel="preload stylesheet" as=style><link rel=icon href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/favicon-32x32.png><link rel=apple-touch-icon href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/icons/apple-icon-180x180.png><link rel=mask-icon href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/icons/apple-icon-76x76.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://kira-96.github.io/posts/qt-remote-objects/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><link rel=manifest href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/manifest.json><link rel=stylesheet href=https://cdn.bootcdn.net/ajax/libs/lxgw-wenkai-screen-webfont/1.7.0/style.min.css><script src=https://fastly.jsdelivr.net/npm/live2d-widgets@0/autoload.js></script><script type=text/javascript src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><meta property="og:url" content="https://kira-96.github.io/posts/qt-remote-objects/"><meta property="og:site_name" content="âœ¨kiraã®åšå®¢"><meta property="og:title" content="Qt Remote Objects ç®€å•ä½¿ç”¨"><meta property="og:description" content="å­¦ä¹ ä½¿ç”¨ Qt Remote Objects"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-17T16:15:28+08:00"><meta property="article:modified_time" content="2025-04-18T11:12:36+08:00"><meta property="article:tag" content="Qt"><meta name=twitter:card content="summary"><meta name=twitter:title content="Qt Remote Objects ç®€å•ä½¿ç”¨"><meta name=twitter:description content="å­¦ä¹ ä½¿ç”¨ Qt Remote Objects"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://kira-96.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Qt Remote Objects ç®€å•ä½¿ç”¨","item":"https://kira-96.github.io/posts/qt-remote-objects/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Qt Remote Objects ç®€å•ä½¿ç”¨","name":"Qt Remote Objects ç®€å•ä½¿ç”¨","description":"å­¦ä¹ ä½¿ç”¨ Qt Remote Objects","keywords":["Qt"],"articleBody":"ä»‹ç» Qt Remote Objects æ˜¯Qtæ¨å‡ºçš„è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰æ¨¡å—ï¼Œç”¨äºå®ç°è¿›ç¨‹é—´æˆ–è¿œç¨‹ç½‘ç»œé—´é€šä¿¡ï¼Œç®€åŒ–åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼€å‘ã€‚é€šè¿‡æŠ½è±¡åº•å±‚é€šä¿¡ç»†èŠ‚ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿåƒæ“ä½œæœ¬åœ°å¯¹è±¡ä¸€æ ·è°ƒç”¨è¿œç¨‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚\nå…³é”®ç»„æˆ\næºå¯¹è±¡ï¼ˆSourceï¼‰\nåœ¨æœåŠ¡ç«¯å®šä¹‰å®é™…å¯¹è±¡ï¼Œå¯¹å¤–æš´éœ²æ•°æ®å’Œæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ§åˆ¶è®¾å¤‡çš„ç±»å¯èƒ½åŒ…å«çŠ¶æ€å±æ€§å’Œæ§åˆ¶æŒ‡ä»¤æ–¹æ³•ã€‚ å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰\nå®¢æˆ·ç«¯é€šè¿‡å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰ä¸æºå¯¹è±¡ï¼ˆSourceï¼‰äº¤äº’ã€‚Replica ä¼šå°†å®¢æˆ·ç«¯çš„æ“ä½œè½¬å‘ç»™æœåŠ¡ç«¯ï¼Œå¹¶åŒæ­¥æ›´æ–°å±æ€§å˜åŒ–ã€‚ é€šä¿¡èŠ‚ç‚¹ï¼ˆNodeï¼‰\næœåŠ¡ç«¯é€šè¿‡ QRemoteObjectHost å‘å¸ƒå¯¹è±¡ï¼Œå®¢æˆ·ç«¯é€šè¿‡ QRemoteObjectNode è¿æ¥æœåŠ¡ç«¯å¹¶è·å–å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰ã€‚ å…³é”®ç‰¹æ€§\né€æ˜é€šä¿¡ï¼šå®¢æˆ·ç«¯è°ƒç”¨è¿œç¨‹æ–¹æ³•å¦‚åŒæœ¬åœ°è°ƒç”¨ã€‚ è‡ªåŠ¨åŒæ­¥ï¼šæºå¯¹è±¡çš„å±æ€§å˜åŒ–ä¼šè‡ªåŠ¨åŒæ­¥åˆ°æ‰€æœ‰å®¢æˆ·ç«¯å‰¯æœ¬ã€‚ å¤šåè®®æ”¯æŒï¼šæ”¯æŒæœ¬åœ°è¿›ç¨‹é€šä¿¡ï¼ˆlocal://ï¼‰ã€TCP ç½‘ç»œé€šä¿¡ï¼ˆtcp://ï¼‰ç­‰ã€‚ åŠ¨æ€å‘ç°ï¼šå¯é€‰æ³¨å†Œä¸­å¿ƒï¼ˆRegistryï¼‰å®ç°æœåŠ¡è‡ªåŠ¨å‘ç°ã€‚ å…¸å‹åœºæ™¯\nå¤šè¿›ç¨‹åä½œï¼šä¾‹å¦‚ GUI åº”ç”¨ä¸åå°æœåŠ¡åˆ†ç¦»ã€‚ åˆ†å¸ƒå¼åº”ç”¨ï¼šä¸»æ§ç¨‹åºä¸å¤šä¸ªå­è¿›ç¨‹å…±äº«é…ç½®æ•°æ®ã€‚ è·¨è®¾å¤‡æ§åˆ¶ï¼šå¦‚é€šè¿‡ PC æ§åˆ¶åµŒå…¥å¼è®¾å¤‡ã€‚ å¾®æœåŠ¡æ¶æ„ï¼šå°†åŠŸèƒ½æ¨¡å—æ‹†åˆ†ä¸ºç‹¬ç«‹è¿›ç¨‹ï¼Œé€šè¿‡ QtRO é€šä¿¡ã€‚ QtROä¸RPCæ¡†æ¶çš„åŠŸèƒ½æ¯”è¾ƒ\né€šä¿¡æ¨¡å¼ Qt Remote Objects RPC(Remote Procedure Call) å¤šå®¢æˆ·ç«¯ âœ… âœ… å•å‘è°ƒç”¨ âœ…ï¼ˆSlotsï¼‰ âœ… å‘å¸ƒ-è®¢é˜… âœ…ï¼ˆSignalsï¼‰ âŒ åŒå‘æµå¼ âŒ âœ… çŠ¶æ€åŒæ­¥ âœ… âŒ è¡¥å……è¯´æ˜\nReplica ç¼–è¯‘å™¨ï¼ˆrepcï¼‰åŸºäº API å®šä¹‰æ–‡ä»¶ï¼ˆâ€œrepâ€æ–‡ä»¶ï¼‰ç”Ÿæˆ QObject å¤´æ–‡ä»¶ã€‚å½“ repc å¤„ç†è¿™äº›æ–‡ä»¶æ—¶ï¼Œrepc ä¼šç”Ÿæˆ Source å¤´æ–‡ä»¶å’Œ Replica å¤´æ–‡ä»¶ã€‚\nQt Remote Objects æ”¯æŒé™æ€å’ŒåŠ¨æ€å‰¯æœ¬ä¸¤ç§æ–¹å¼ï¼Œä¸¤ç§æ–¹å¼çš„å®¢æˆ·ç«¯ä»£ç ç¼–å†™æ–¹å¼æœ‰æ‰€ä¸åŒã€‚\nè™½ç„¶ Qt Remote Objects æ”¯æŒé€šè¿‡ç½‘ç»œå…±äº«ä»»ä½• QObject å¯¹è±¡ï¼Œä½†ä½¿ç”¨ repc å®šä¹‰å¯¹è±¡æœ‰å‡ ä¸ªä¼˜ç‚¹ï¼š\nè™½ç„¶åŠ¨æ€å‰¯æœ¬ï¼ˆDynamicReplicasï¼‰å¾ˆæœ‰ç”¨ï¼Œä½†ä½¿ç”¨èµ·æ¥æ›´éº»çƒ¦ã€‚åœ¨å¯¹è±¡åˆå§‹åŒ–ä¹‹å‰ï¼Œæ˜¯ä¸çŸ¥é“APIçš„ï¼Œå¹¶ä¸”ä½¿ç”¨ API æ—¶éœ€è¦é€šè¿‡å…ƒå¯¹è±¡ï¼ˆQMetaObjectï¼‰çš„æ–¹æ³•è¿›è¡Œå­—ç¬¦ä¸²æŸ¥æ‰¾ã€‚ åœ¨ç¼–è¯‘æ—¶çŸ¥é“æ¥å£å¯ä»¥æ›´å®¹æ˜“å‘ç°ç¼–è¯‘æ—¶ä¸è¿è¡Œæ—¶çš„é—®é¢˜ã€‚ rep æ ¼å¼æ”¯æŒé»˜è®¤å€¼ï¼Œå¦‚æœæ‚¨æ— æ³•ç¡®ä¿åœ¨å®ä¾‹åŒ–å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰æ—¶æºå¯¹è±¡ï¼ˆSourceï¼‰å¯ç”¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ã€‚ ç®€å•ç¤ºä¾‹ é™æ€æ–¹å¼ å®šä¹‰æ¥å£ QtRO é™æ€æ–¹å¼éœ€è¦å…ˆå®šä¹‰å‰¯æœ¬å¯¹è±¡æ¥å£æ–‡ä»¶ï¼ˆ.repï¼‰ï¼Œæ–‡ä»¶è¯­æ³•å¯ä»¥å‚è€ƒQt Remote Objects Compilerã€‚\nè¿™é‡Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„è®¾å¤‡æ§åˆ¶æ¥å£æ–‡ä»¶ï¼š\ndevicecontroller.rep â–¼ 1 2 3 4 5 6 7 8 class DeviceController { ENUM Status { Ok, Error }; // çŠ¶æ€æšä¸¾ PROP(Status status = Ok READONLY); // çŠ¶æ€å±æ€§ï¼Œåªè¯» SLOT(void controlDevice(QString command)); // æ§½å‡½æ•° SLOT(void uploadFile(QString fileName, QByteArray fileData)); // æ§½å‡½æ•° SIGNAL(fileReceived(QString fileName)); // ä¿¡å· }; æ¥ä¸‹æ¥éœ€è¦æŠŠæ¥å£æ–‡ä»¶æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼Œé¡¹ç›®åˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚\nmyproject.pro â–¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 # qmakeä¸­çš„å†™æ³• # æ·»åŠ  Qt Remote Objects æ”¯æŒ QT += remoteobjects # æœåŠ¡ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆæºå¯¹è±¡ï¼‰ REPC_SOURCE += devicecontroller.rep # å®¢æˆ·ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆå‰¯æœ¬å¯¹è±¡ï¼‰ REPC_REPLICA += devicecontroller.rep # åŒæ—¶ç”Ÿæˆæºå¯¹è±¡å’Œå‰¯æœ¬å¯¹è±¡çš„å¤´æ–‡ä»¶ REPC_MERGED = devicecontroller.rep CMakeLists.txt â–¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # cmakeä¸­çš„å†™æ³• set(CMAKE_INCLUDE_CURRENT_DIR ON) # æ·»åŠ  Qt Remote Objects æ”¯æŒ find_package(Qt6 REQUIRED COMPONENTS Core RemoteObjects) # æœåŠ¡ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆæºå¯¹è±¡ï¼‰ qt_add_repc_sources(${PROJECT_NAME} devicecontroller.rep ) # å®¢æˆ·ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆå‰¯æœ¬å¯¹è±¡ï¼‰ qt_add_repc_replicas(${PROJECT_NAME} devicecontroller.rep ) # åŒæ—¶ç”Ÿæˆæºå¯¹è±¡å’Œå‰¯æœ¬å¯¹è±¡çš„å¤´æ–‡ä»¶ qt_add_repc_merged(${PROJECT_NAME} devicecontroller.rep ) æ·»åŠ å®Œæˆåï¼Œæ„å»ºä¸€ä¸‹é¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†æºå¯¹è±¡å¤´æ–‡ä»¶rep_devicecontroller_source.hå’Œå‰¯æœ¬å¯¹è±¡å¤´æ–‡ä»¶rep_devicecontroller_replica.hã€‚\nrep_devicecontroller_source.h â–¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 #ifndef REP_DEVICECONTROLLER_SOURCE_H #define REP_DEVICECONTROLLER_SOURCE_H // This is an autogenerated file. // Do not edit this file, any changes made will be lost the next time it is generated. #include #include #include #include #include #include #include using namespace Qt::Literals::StringLiterals; class DeviceControllerSource : public QObject { Q_OBJECT Q_CLASSINFO(QCLASSINFO_REMOTEOBJECT_TYPE, \"DeviceController\") Q_CLASSINFO(QCLASSINFO_REMOTEOBJECT_SIGNATURE, \"3947cd1a592cb801ecdf88688ceb676821764dc3\") Q_PROPERTY(Status status READ status NOTIFY statusChanged) public: enum Status { Ok = 0, Error = 1, }; Q_ENUM(Status) public: explicit DeviceControllerSource(QObject *parent = nullptr) : QObject(parent) { qRegisterMetaType\u003cStatus\u003e(); } public: ~DeviceControllerSource() override = default; virtual Status status() const = 0; Q_SIGNALS: void statusChanged(DeviceControllerSource::Status status); void fileReceived(QString fileName); public Q_SLOTS: virtual void controlDevice(QString command) = 0; virtual void uploadFile(QString fileName, QByteArray fileData) = 0; private: friend class QT_PREPEND_NAMESPACE(QRemoteObjectNode); }; class DeviceControllerSimpleSource : public DeviceControllerSource { Q_OBJECT public: explicit DeviceControllerSimpleSource(QObject *parent = nullptr) : DeviceControllerSource(parent) , m_status(Ok) {} public: ~DeviceControllerSimpleSource() override = default; Status status() const override { return m_status; } protected: virtual void setStatus(Status status) { if (status != m_status) { m_status = status; Q_EMIT statusChanged(m_status); } } private: Status m_status; }; ... #endif // REP_DEVICECONTROLLER_SOURCE_H æœåŠ¡ç«¯ æ¥ä¸‹æ¥ç¼–å†™æœåŠ¡ç«¯ä»£ç ï¼š\nmydeviceservice.h â–¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #ifndef MYDEVICESERVICE_H #define MYDEVICESERVICE_H #include \"rep_devicecontroller_source.h\" class MyDeviceService : public DeviceControllerSimpleSource { Q_OBJECT public: explicit MyDeviceService(QObject *parent = Q_NULLPTR); ~MyDeviceService(); public Q_SLOTS: virtual void controlDevice(QString command) Q_DECL_OVERRIDE; virtual void uploadFile(QString fileName, QByteArray fileData) Q_DECL_OVERRIDE; }; #endif // MYDEVICESERVICE_H mydeviceservice.cpp â–¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 #include \"mydeviceservice.h\" #include MyDeviceService::MyDeviceService(QObject *parent) : DeviceControllerSimpleSource{parent} { qDebug() \u003c\u003c __PRETTY_FUNCTION__; } MyDeviceService::~MyDeviceService() { qDebug() \u003c\u003c __PRETTY_FUNCTION__; } void MyDeviceService::controlDevice(QString command) { qDebug() \u003c\u003c __PRETTY_FUNCTION__ \u003c\u003c command; setStatus(Error); } void MyDeviceService::uploadFile(QString fileName, QByteArray fileData) { qDebug() \u003c\u003c __PRETTY_FUNCTION__; qDebug() \u003c\u003c \"Receiving file:\" \u003c\u003c fileName \u003c\u003c \"\\nContent: \\n\" \u003c\u003c QString::fromUtf8(fileData); setStatus(Ok); Q_EMIT fileReceived(fileName); } å¯åŠ¨æœåŠ¡ç«¯ï¼š\nmain.cpp â–¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 #include #include \"mydeviceservice.h\" int main(int argc, char *argv[]) { QCoreApplication a(argc, argv); QRemoteObjectHost host; // è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰ // host.setHostUrl(QUrl(\"local:devicecontroller\")); // è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰ host.setHostUrl(QUrl(\"tcp://0.0.0.0:2333\")); MyDeviceService service; /** * ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æºå¯¹è±¡æŒ‡é’ˆ * ç¬¬äºŒä¸ªå‚æ•°æ˜¯æºå¯¹è±¡åå­—ï¼Œå®¢æˆ·ç«¯å¯æ ¹æ®åå­—è·å–æºå¯¹è±¡ï¼Œ * ä½¿ç”¨åŠ¨æ€å‰¯æœ¬çš„æ–¹å¼æ—¶ï¼Œå¿…é¡»å¡«å†™æºå¯¹è±¡åå­—ã€‚ */ host.enableRemoting(\u0026service, \"mydeviceservice\"); return a.exec(); } å®¢æˆ·ç«¯ å®¢æˆ·ç«¯ä»£ç ï¼š\nmydevicecontroller.h â–¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 #ifndef MYDEVICECONTROLLER_H #define MYDEVICECONTROLLER_H #include #include QT_BEGIN_NAMESPACE class QRemoteObjectNode; QT_END_NAMESPACE class MyDeviceController : public QObject { Q_OBJECT public: explicit MyDeviceController(QObject *parent = Q_NULLPTR); Q_INVOKABLE void test(const QUrl \u0026url); private: QPointer\u003cQRemoteObjectNode\u003e node; // QPointer replica; }; #endif // MYDEVICECONTROLLER_H mydevicecontroller.h â–¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 #include \"mydevicecontroller.h\" #include \"rep_devicecontroller_replica.h\" MyDeviceController::MyDeviceController(QObject *parent) : QObject{parent} , node{new QRemoteObjectNode(this)} {} void MyDeviceController::test(const QUrl \u0026url) { node-\u003econnectToNode(url); qDebug() \u003c\u003c \"connected to:\" \u003c\u003c url; auto *replica = node-\u003eacquire\u003cDeviceControllerReplica\u003e(\"mydeviceservice\"); connect(replica, \u0026DeviceControllerReplica::statusChanged, this, [\u0026](DeviceControllerReplica::Status s) { qDebug() \u003c\u003c \"Device status changed to:\" \u003c\u003c s; }); connect(replica, \u0026DeviceControllerReplica::fileReceived, this, [\u0026](QString fileName) { qDebug() \u003c\u003c \"File sent. file -\" \u003c\u003c fileName; }); connect(replica, \u0026DeviceControllerReplica::stateChanged, this, [this](QRemoteObjectReplica::State state, QRemoteObjectReplica::State oldState) { qDebug() \u003c\u003c \"replica state changed:\" \u003c\u003c oldState \u003c\u003c \"â†’\" \u003c\u003c state; // å‰¯æœ¬å¯¹è±¡çŠ¶æ€å¯ç”¨æ—¶æ‰èƒ½è°ƒç”¨æ¥å£ if (state == QRemoteObjectReplica::Valid) { DeviceControllerReplica *replica = qobject_cast\u003cDeviceControllerReplica*\u003e(sender()); Q_ASSERT(replica); replica-\u003econtrolDevice(\"echo\"); replica-\u003euploadFile(\"test.txt\", QString(\"ä½ å¥½ï¼ä¸–ç•Œã€‚\").toUtf8()); } }); } å®¢æˆ·ç«¯è°ƒç”¨ï¼š\nmain.cpp â–¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #include #include #include \"mydevicecontroller.h\" int main(int argc, char *argv[]) { QCoreApplication a(argc, argv); MyDeviceController client; // è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰ // client.test(QUrl(\"local:devicecontroller\")); // è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰ client.test(QUrl(\"tcp://192.168.1.3:2333\")); return a.exec(); } åŠ¨æ€å‰¯æœ¬ åŠ¨æ€å‰¯æœ¬çš„å®¢æˆ·ç«¯ä»£ç æœ‰æ‰€ä¸åŒã€‚\nmydevicecontroller.h â–¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 #ifndef MYDEVICECONTROLLER_H #define MYDEVICECONTROLLER_H #include #include QT_BEGIN_NAMESPACE class QRemoteObjectNode; QT_END_NAMESPACE class MyDeviceController : public QObject { Q_OBJECT public: explicit MyDeviceController(QObject *parent = Q_NULLPTR); Q_INVOKABLE void test(const QUrl \u0026url); Q_SLOT void onStatusChanged(int); Q_SLOT void onFileReceived(const QString\u0026); private: QPointer\u003cQRemoteObjectNode\u003e node; }; #endif // MYDEVICECONTROLLER_H mydevicecontroller.cpp â–¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 #include \"mydevicecontroller.h\" #include \"rep_devicecontroller_replica.h\" MyDeviceController::MyDeviceController(QObject *parent) : QObject{parent} , node{new QRemoteObjectNode(this)} {} void MyDeviceController::test(const QUrl \u0026url) { node-\u003econnectToNode(url); qDebug() \u003c\u003c \"connected to:\" \u003c\u003c url; auto *replica = node-\u003eacquireDynamic(\"mydeviceservice\"); connect(replica, \u0026QRemoteObjectDynamicReplica::stateChanged, this, [this](QRemoteObjectReplica::State state, QRemoteObjectReplica::State oldState) { qDebug() \u003c\u003c \"replica state changed:\" \u003c\u003c oldState \u003c\u003c \"â†’\" \u003c\u003c state; if (state == QRemoteObjectReplica::Valid) { QRemoteObjectDynamicReplica *replica = qobject_cast\u003cQRemoteObjectDynamicReplica*\u003e(sender()); Q_ASSERT(replica); /** ç”±äºä½¿ç”¨åŠ¨æ€å‰¯æœ¬æ–¹å¼ï¼Œåœ¨å‰¯æœ¬åˆå§‹åŒ–å®Œæˆå‰ï¼Œæ— æ³•é¢„å…ˆçŸ¥é“APIï¼Œ * åªæœ‰åœ¨å‰¯æœ¬å¯¹è±¡çŠ¶æ€å¯ç”¨æ—¶ï¼Œæ‰èƒ½è¿›è¡Œä¿¡å·-æ§½è¿æ¥ã€‚ * å¹¶ä¸”æ— æ³•ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹å‚æ•°ï¼Œå¦‚ä¹‹å‰å®šä¹‰çš„æšä¸¾ã€‚ */ // connect(replica, SIGNAL(statusChanged(int)), this, SLOT(onStatusChanged(int))); connect(replica, SIGNAL(fileReceived(QString)), this, SLOT(onFileReceived(QString))); /** è°ƒç”¨æ¥å£éœ€è¦ä½¿ç”¨å…ƒå¯¹è±¡çš„`invokeMethod`æ–¹æ³• */ QMetaObject::invokeMethod(replica, \"controlDevice\", Q_ARG(QString, \"echo\")); QMetaObject::invokeMethod(replica, \"uploadFile\", Q_ARG(QString, \"test.txt\"), Q_ARG(QByteArray, QString(\"ä½ å¥½ï¼ä¸–ç•Œã€‚\").toUtf8())); } }); } void MyDeviceController::onStatusChanged(int s) { qDebug() \u003c\u003c \"Device status changed to:\" \u003c\u003c s; } void MyDeviceController::onFileReceived(const QString \u0026fileName) { qDebug() \u003c\u003c \"File sent. file -\" \u003c\u003c fileName; } æ³¨æ„äº‹é¡¹ Qt Remote Objects ä½¿ç”¨å†…éƒ¨åè®®åœ¨è¿›ç¨‹å’Œ/æˆ–è®¾å¤‡ä¹‹é—´ä¼ é€’æ•°æ®ã€‚æ‰€æœ‰éƒ¨åˆ†éƒ½éœ€è¦ä½¿ç”¨ç›¸åŒçš„åè®®ç‰ˆæœ¬ï¼šå¦‚æœç‰ˆæœ¬ä¸åŒ¹é…ï¼Œè¿æ¥èŠ‚ç‚¹å°†è¾“å‡ºè­¦å‘Šï¼Œä¸»æœºèŠ‚ç‚¹å°†ä¸å‘é€ä»»ä½•æ•°æ®ã€‚\nç›®å‰å‘å¸ƒçš„ç‰ˆæœ¬ï¼š\nåè®®ç‰ˆæœ¬ Qtç‰ˆæœ¬ \u003c1.2 åœ¨ QtRO çš„æŠ€æœ¯é¢„è§ˆé˜¶æ®µä½¿ç”¨ã€‚ 1.2 5.12.0 1.3 5.12.4 2.0 6.2.0 See Qt Remote Objects Protocol Versioning.\nå‚è€ƒ\nQt Remote Objectsè¿œç¨‹è°ƒç”¨æ¨¡å—çš„åŸºæœ¬ä½¿ç”¨ Qt Remote Objects å­¦ä¹ ç¬”è®°ï¼ˆQt è¿œç«¯å¯è°ƒç”¨å¯¹è±¡æ¡†æ¶) Qt Remote Objectï¼ˆQtROï¼‰åŠ¨æ€Replicaå®ç°è¿›ç¨‹é—´é€šä¿¡ ","wordCount":"1233","inLanguage":"zh","datePublished":"2025-04-17T16:15:28+08:00","dateModified":"2025-04-18T11:12:36+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://kira-96.github.io/posts/qt-remote-objects/"},"publisher":{"@type":"Organization","name":"âœ¨kiraã®åšå®¢","logo":{"@type":"ImageObject","url":"https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://kira-96.github.io/ accesskey=h title="âœ¨kiraã®åšå®¢ (Alt + H)">âœ¨kiraã®åšå®¢</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kira-96.github.io/ title=ğŸ ä¸»é¡µ><span>ğŸ ä¸»é¡µ</span></a></li><li><a href=https://kira-96.github.io/notes/ title=ğŸ““ç¬”è®°><span>ğŸ““ç¬”è®°</span></a></li><li><a href=https://kira-96.github.io/search/ title=ğŸ”ï¸æœç´¢><span>ğŸ”ï¸æœç´¢</span></a></li><li><a href=https://kira-96.github.io/archives/ title=ğŸ—ƒï¸å­˜æ¡£><span>ğŸ—ƒï¸å­˜æ¡£</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://kira-96.github.io/>ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://kira-96.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Qt Remote Objects ç®€å•ä½¿ç”¨</h1><div class=post-description>å­¦ä¹ ä½¿ç”¨ Qt Remote Objects</div><div class=post-meta><span title='2025-04-17 16:15:28 +0800 +0800'>2025å¹´4æœˆ17æ—¥</span>&nbsp;Â·&nbsp;<span>6 åˆ†é’Ÿ</span>&nbsp;Â·&nbsp;<span>1233 å­—</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/kira-96/kira-96.github.io/tree/main/content/posts/ rel="noopener noreferrer edit" target=_blank>âœï¸ç¼–è¾‘</a></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#%e4%bb%8b%e7%bb%8d aria-label=ä»‹ç»>ä»‹ç»</a></li><li><a href=#%e7%ae%80%e5%8d%95%e7%a4%ba%e4%be%8b aria-label=ç®€å•ç¤ºä¾‹>ç®€å•ç¤ºä¾‹</a><ul><li><a href=#%e9%9d%99%e6%80%81%e6%96%b9%e5%bc%8f aria-label=é™æ€æ–¹å¼>é™æ€æ–¹å¼</a><ul><li><a href=#%e5%ae%9a%e4%b9%89%e6%8e%a5%e5%8f%a3 aria-label=å®šä¹‰æ¥å£>å®šä¹‰æ¥å£</a></li><li><a href=#%e6%9c%8d%e5%8a%a1%e7%ab%af aria-label=æœåŠ¡ç«¯>æœåŠ¡ç«¯</a></li><li><a href=#%e5%ae%a2%e6%88%b7%e7%ab%af aria-label=å®¢æˆ·ç«¯>å®¢æˆ·ç«¯</a></li></ul></li><li><a href=#%e5%8a%a8%e6%80%81%e5%89%af%e6%9c%ac aria-label=åŠ¨æ€å‰¯æœ¬>åŠ¨æ€å‰¯æœ¬</a></li></ul></li><li><a href=#%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9 aria-label=æ³¨æ„äº‹é¡¹>æ³¨æ„äº‹é¡¹</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=ä»‹ç»>ä»‹ç»<a hidden class=anchor aria-hidden=true href=#ä»‹ç»>#</a></h2><p><code>Qt Remote Objects</code> æ˜¯Qtæ¨å‡ºçš„è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰æ¨¡å—ï¼Œç”¨äºå®ç°è¿›ç¨‹é—´æˆ–è¿œç¨‹ç½‘ç»œé—´é€šä¿¡ï¼Œç®€åŒ–åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼€å‘ã€‚é€šè¿‡æŠ½è±¡åº•å±‚é€šä¿¡ç»†èŠ‚ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿåƒæ“ä½œæœ¬åœ°å¯¹è±¡ä¸€æ ·è°ƒç”¨è¿œç¨‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚</p><p><strong>å…³é”®ç»„æˆ</strong></p><ol><li>æºå¯¹è±¡ï¼ˆSourceï¼‰<br>åœ¨æœåŠ¡ç«¯å®šä¹‰å®é™…å¯¹è±¡ï¼Œå¯¹å¤–æš´éœ²æ•°æ®å’Œæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ§åˆ¶è®¾å¤‡çš„ç±»å¯èƒ½åŒ…å«çŠ¶æ€å±æ€§å’Œæ§åˆ¶æŒ‡ä»¤æ–¹æ³•ã€‚</li><li>å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰<br>å®¢æˆ·ç«¯é€šè¿‡å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰ä¸æºå¯¹è±¡ï¼ˆSourceï¼‰äº¤äº’ã€‚<code>Replica</code> ä¼šå°†å®¢æˆ·ç«¯çš„æ“ä½œè½¬å‘ç»™æœåŠ¡ç«¯ï¼Œå¹¶åŒæ­¥æ›´æ–°å±æ€§å˜åŒ–ã€‚</li><li>é€šä¿¡èŠ‚ç‚¹ï¼ˆNodeï¼‰<br>æœåŠ¡ç«¯é€šè¿‡ <code>QRemoteObjectHost</code> å‘å¸ƒå¯¹è±¡ï¼Œå®¢æˆ·ç«¯é€šè¿‡ <code>QRemoteObjectNode</code> è¿æ¥æœåŠ¡ç«¯å¹¶è·å–å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰ã€‚</li></ol><p><strong>å…³é”®ç‰¹æ€§</strong></p><ul><li>é€æ˜é€šä¿¡ï¼šå®¢æˆ·ç«¯è°ƒç”¨è¿œç¨‹æ–¹æ³•å¦‚åŒæœ¬åœ°è°ƒç”¨ã€‚</li><li>è‡ªåŠ¨åŒæ­¥ï¼šæºå¯¹è±¡çš„å±æ€§å˜åŒ–ä¼šè‡ªåŠ¨åŒæ­¥åˆ°æ‰€æœ‰å®¢æˆ·ç«¯å‰¯æœ¬ã€‚</li><li>å¤šåè®®æ”¯æŒï¼šæ”¯æŒæœ¬åœ°è¿›ç¨‹é€šä¿¡ï¼ˆ<code>local://</code>ï¼‰ã€TCP ç½‘ç»œé€šä¿¡ï¼ˆ<code>tcp://</code>ï¼‰ç­‰ã€‚</li><li>åŠ¨æ€å‘ç°ï¼šå¯é€‰æ³¨å†Œä¸­å¿ƒï¼ˆRegistryï¼‰å®ç°æœåŠ¡è‡ªåŠ¨å‘ç°ã€‚</li></ul><p><strong>å…¸å‹åœºæ™¯</strong></p><ul><li>å¤šè¿›ç¨‹åä½œï¼šä¾‹å¦‚ GUI åº”ç”¨ä¸åå°æœåŠ¡åˆ†ç¦»ã€‚</li><li>åˆ†å¸ƒå¼åº”ç”¨ï¼šä¸»æ§ç¨‹åºä¸å¤šä¸ªå­è¿›ç¨‹å…±äº«é…ç½®æ•°æ®ã€‚</li><li>è·¨è®¾å¤‡æ§åˆ¶ï¼šå¦‚é€šè¿‡ PC æ§åˆ¶åµŒå…¥å¼è®¾å¤‡ã€‚</li><li>å¾®æœåŠ¡æ¶æ„ï¼šå°†åŠŸèƒ½æ¨¡å—æ‹†åˆ†ä¸ºç‹¬ç«‹è¿›ç¨‹ï¼Œé€šè¿‡ QtRO é€šä¿¡ã€‚</li></ul><p><strong>QtROä¸RPCæ¡†æ¶çš„åŠŸèƒ½æ¯”è¾ƒ</strong></p><table><thead><tr><th>é€šä¿¡æ¨¡å¼</th><th>Qt Remote Objects</th><th>RPC(Remote Procedure Call)</th></tr></thead><tbody><tr><td>å¤šå®¢æˆ·ç«¯</td><td>âœ…</td><td>âœ…</td></tr><tr><td>å•å‘è°ƒç”¨</td><td>âœ…ï¼ˆSlotsï¼‰</td><td>âœ…</td></tr><tr><td>å‘å¸ƒ-è®¢é˜…</td><td>âœ…ï¼ˆSignalsï¼‰</td><td>âŒ</td></tr><tr><td>åŒå‘æµå¼</td><td>âŒ</td><td>âœ…</td></tr><tr><td>çŠ¶æ€åŒæ­¥</td><td>âœ…</td><td>âŒ</td></tr></tbody></table><p><strong>è¡¥å……è¯´æ˜</strong></p><p>Replica ç¼–è¯‘å™¨ï¼ˆrepcï¼‰åŸºäº API å®šä¹‰æ–‡ä»¶ï¼ˆâ€œrepâ€æ–‡ä»¶ï¼‰ç”Ÿæˆ QObject å¤´æ–‡ä»¶ã€‚å½“ repc å¤„ç†è¿™äº›æ–‡ä»¶æ—¶ï¼Œrepc ä¼šç”Ÿæˆ <code>Source</code> å¤´æ–‡ä»¶å’Œ <code>Replica</code> å¤´æ–‡ä»¶ã€‚<br>Qt Remote Objects æ”¯æŒ<strong>é™æ€</strong>å’Œ<strong>åŠ¨æ€å‰¯æœ¬</strong>ä¸¤ç§æ–¹å¼ï¼Œä¸¤ç§æ–¹å¼çš„å®¢æˆ·ç«¯ä»£ç ç¼–å†™æ–¹å¼æœ‰æ‰€ä¸åŒã€‚</p><p>è™½ç„¶ Qt Remote Objects æ”¯æŒé€šè¿‡ç½‘ç»œå…±äº«ä»»ä½• QObject å¯¹è±¡ï¼Œä½†ä½¿ç”¨ repc å®šä¹‰å¯¹è±¡æœ‰å‡ ä¸ªä¼˜ç‚¹ï¼š</p><ul><li>è™½ç„¶åŠ¨æ€å‰¯æœ¬ï¼ˆDynamicReplicasï¼‰å¾ˆæœ‰ç”¨ï¼Œä½†ä½¿ç”¨èµ·æ¥æ›´éº»çƒ¦ã€‚åœ¨å¯¹è±¡åˆå§‹åŒ–ä¹‹å‰ï¼Œæ˜¯ä¸çŸ¥é“APIçš„ï¼Œå¹¶ä¸”ä½¿ç”¨ API æ—¶éœ€è¦é€šè¿‡å…ƒå¯¹è±¡ï¼ˆQMetaObjectï¼‰çš„æ–¹æ³•è¿›è¡Œå­—ç¬¦ä¸²æŸ¥æ‰¾ã€‚</li><li>åœ¨ç¼–è¯‘æ—¶çŸ¥é“æ¥å£å¯ä»¥æ›´å®¹æ˜“å‘ç°ç¼–è¯‘æ—¶ä¸è¿è¡Œæ—¶çš„é—®é¢˜ã€‚</li><li>rep æ ¼å¼æ”¯æŒé»˜è®¤å€¼ï¼Œå¦‚æœæ‚¨æ— æ³•ç¡®ä¿åœ¨å®ä¾‹åŒ–å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰æ—¶æºå¯¹è±¡ï¼ˆSourceï¼‰å¯ç”¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ã€‚</li></ul><h2 id=ç®€å•ç¤ºä¾‹>ç®€å•ç¤ºä¾‹<a hidden class=anchor aria-hidden=true href=#ç®€å•ç¤ºä¾‹>#</a></h2><h3 id=é™æ€æ–¹å¼>é™æ€æ–¹å¼<a hidden class=anchor aria-hidden=true href=#é™æ€æ–¹å¼>#</a></h3><h4 id=å®šä¹‰æ¥å£>å®šä¹‰æ¥å£<a hidden class=anchor aria-hidden=true href=#å®šä¹‰æ¥å£>#</a></h4><p>QtRO é™æ€æ–¹å¼éœ€è¦å…ˆå®šä¹‰å‰¯æœ¬å¯¹è±¡æ¥å£æ–‡ä»¶ï¼ˆ.repï¼‰ï¼Œæ–‡ä»¶è¯­æ³•å¯ä»¥å‚è€ƒ<a href=https://doc.qt.io/qt-6/qtremoteobjects-repc.html>Qt Remote Objects Compiler</a>ã€‚</p><p>è¿™é‡Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„è®¾å¤‡æ§åˆ¶æ¥å£æ–‡ä»¶ï¼š</p><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=devicecontroller.rep>devicecontroller.rep</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>DeviceController</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ENUM</span> <span class=n>Status</span> <span class=p>{</span> <span class=n>Ok</span><span class=p>,</span> <span class=n>Error</span> <span class=p>};</span>  <span class=c1>// çŠ¶æ€æšä¸¾
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>PROP</span><span class=p>(</span><span class=n>Status</span> <span class=n>status</span> <span class=o>=</span> <span class=n>Ok</span> <span class=n>READONLY</span><span class=p>);</span>  <span class=c1>// çŠ¶æ€å±æ€§ï¼Œåªè¯»
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>SLOT</span><span class=p>(</span><span class=kt>void</span> <span class=n>controlDevice</span><span class=p>(</span><span class=n>QString</span> <span class=n>command</span><span class=p>));</span>  <span class=c1>// æ§½å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>SLOT</span><span class=p>(</span><span class=kt>void</span> <span class=n>uploadFile</span><span class=p>(</span><span class=n>QString</span> <span class=n>fileName</span><span class=p>,</span> <span class=n>QByteArray</span> <span class=n>fileData</span><span class=p>));</span>  <span class=c1>// æ§½å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>SIGNAL</span><span class=p>(</span><span class=n>fileReceived</span><span class=p>(</span><span class=n>QString</span> <span class=n>fileName</span><span class=p>));</span>  <span class=c1>// ä¿¡å·
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span></span></span></code></pre></td></tr></table></div></div></div></div><p>æ¥ä¸‹æ¥éœ€è¦æŠŠæ¥å£æ–‡ä»¶æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼Œé¡¹ç›®åˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚</p><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=myproject.pro>myproject.pro</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-make data-lang=make><span class=line><span class=cl><span class=c># qmakeä¸­çš„å†™æ³•
</span></span></span><span class=line><span class=cl><span class=c></span>
</span></span><span class=line><span class=cl><span class=c># æ·»åŠ  Qt Remote Objects æ”¯æŒ
</span></span></span><span class=line><span class=cl><span class=c></span><span class=nv>QT</span> <span class=o>+=</span> remoteobjects
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># æœåŠ¡ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆæºå¯¹è±¡ï¼‰
</span></span></span><span class=line><span class=cl><span class=c></span><span class=nv>REPC_SOURCE</span> <span class=o>+=</span> devicecontroller.rep
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># å®¢æˆ·ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆå‰¯æœ¬å¯¹è±¡ï¼‰
</span></span></span><span class=line><span class=cl><span class=c></span><span class=nv>REPC_REPLICA</span> <span class=o>+=</span> devicecontroller.rep
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># åŒæ—¶ç”Ÿæˆæºå¯¹è±¡å’Œå‰¯æœ¬å¯¹è±¡çš„å¤´æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=c></span><span class=nv>REPC_MERGED</span> <span class=o>=</span> devicecontroller.rep
</span></span></code></pre></td></tr></table></div></div></div></div><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=CMakeLists.txt>CMakeLists.txt</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cmake data-lang=cmake><span class=line><span class=cl><span class=c># cmakeä¸­çš„å†™æ³•
</span></span></span><span class=line><span class=cl><span class=c></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nb>set</span><span class=p>(</span><span class=s>CMAKE_INCLUDE_CURRENT_DIR</span> <span class=s>ON</span><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># æ·»åŠ  Qt Remote Objects æ”¯æŒ
</span></span></span><span class=line><span class=cl><span class=c></span><span class=nb>find_package</span><span class=p>(</span><span class=s>Qt6</span> <span class=s>REQUIRED</span> <span class=s>COMPONENTS</span> <span class=s>Core</span> <span class=s>RemoteObjects</span><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># æœåŠ¡ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆæºå¯¹è±¡ï¼‰
</span></span></span><span class=line><span class=cl><span class=c></span><span class=nb>qt_add_repc_sources</span><span class=p>(</span><span class=o>${</span><span class=nv>PROJECT_NAME</span><span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=s>devicecontroller.rep</span>
</span></span><span class=line><span class=cl><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># å®¢æˆ·ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆå‰¯æœ¬å¯¹è±¡ï¼‰
</span></span></span><span class=line><span class=cl><span class=c></span><span class=nb>qt_add_repc_replicas</span><span class=p>(</span><span class=o>${</span><span class=nv>PROJECT_NAME</span><span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=s>devicecontroller.rep</span>
</span></span><span class=line><span class=cl><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># åŒæ—¶ç”Ÿæˆæºå¯¹è±¡å’Œå‰¯æœ¬å¯¹è±¡çš„å¤´æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=c></span><span class=nb>qt_add_repc_merged</span><span class=p>(</span><span class=o>${</span><span class=nv>PROJECT_NAME</span><span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=s>devicecontroller.rep</span>
</span></span><span class=line><span class=cl><span class=p>)</span></span></span></code></pre></td></tr></table></div></div></div></div><p>æ·»åŠ å®Œæˆåï¼Œæ„å»ºä¸€ä¸‹é¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†æºå¯¹è±¡å¤´æ–‡ä»¶<em>rep_devicecontroller_source.h</em>å’Œå‰¯æœ¬å¯¹è±¡å¤´æ–‡ä»¶<em>rep_devicecontroller_replica.h</em>ã€‚</p><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=rep_devicecontroller_source.h>rep_devicecontroller_source.h</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#ifndef REP_DEVICECONTROLLER_SOURCE_H
</span></span></span><span class=line><span class=cl><span class=cp>#define REP_DEVICECONTROLLER_SOURCE_H
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=c1>// This is an autogenerated file.
</span></span></span><span class=line><span class=cl><span class=c1>// Do not edit this file, any changes made will be lost the next time it is generated.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QtCore/qobject.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QtCore/qdatastream.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QtCore/qvariant.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QtCore/qmap.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QtCore/qmetatype.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QtRemoteObjects/qremoteobjectnode.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QtRemoteObjects/qremoteobjectsource.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=k>namespace</span> <span class=n>Qt</span><span class=o>::</span><span class=n>Literals</span><span class=o>::</span><span class=n>StringLiterals</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DeviceControllerSource</span> <span class=o>:</span> <span class=k>public</span> <span class=n>QObject</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Q_OBJECT</span>
</span></span><span class=line><span class=cl>    <span class=nf>Q_CLASSINFO</span><span class=p>(</span><span class=n>QCLASSINFO_REMOTEOBJECT_TYPE</span><span class=p>,</span> <span class=s>&#34;DeviceController&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>Q_CLASSINFO</span><span class=p>(</span><span class=n>QCLASSINFO_REMOTEOBJECT_SIGNATURE</span><span class=p>,</span> <span class=s>&#34;3947cd1a592cb801ecdf88688ceb676821764dc3&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>Q_PROPERTY</span><span class=p>(</span><span class=n>Status</span> <span class=n>status</span> <span class=n>READ</span> <span class=n>status</span> <span class=n>NOTIFY</span> <span class=n>statusChanged</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>enum</span> <span class=nc>Status</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Ok</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>Error</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=n>Q_ENUM</span><span class=p>(</span><span class=n>Status</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>explicit</span> <span class=n>DeviceControllerSource</span><span class=p>(</span><span class=n>QObject</span> <span class=o>*</span><span class=n>parent</span> <span class=o>=</span> <span class=k>nullptr</span><span class=p>)</span> <span class=o>:</span> <span class=n>QObject</span><span class=p>(</span><span class=n>parent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>qRegisterMetaType</span><span class=o>&lt;</span><span class=n>Status</span><span class=o>&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=o>~</span><span class=n>DeviceControllerSource</span><span class=p>()</span> <span class=k>override</span> <span class=o>=</span> <span class=k>default</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=n>Status</span> <span class=nf>status</span><span class=p>()</span> <span class=k>const</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>Q_SIGNALS</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=n>statusChanged</span><span class=p>(</span><span class=n>DeviceControllerSource</span><span class=o>::</span><span class=n>Status</span> <span class=n>status</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>fileReceived</span><span class=p>(</span><span class=n>QString</span> <span class=n>fileName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=nl>Q_SLOTS</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=kt>void</span> <span class=n>controlDevice</span><span class=p>(</span><span class=n>QString</span> <span class=n>command</span><span class=p>)</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=kt>void</span> <span class=nf>uploadFile</span><span class=p>(</span><span class=n>QString</span> <span class=n>fileName</span><span class=p>,</span> <span class=n>QByteArray</span> <span class=n>fileData</span><span class=p>)</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>friend</span> <span class=k>class</span> <span class=nc>QT_PREPEND_NAMESPACE</span><span class=p>(</span><span class=n>QRemoteObjectNode</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DeviceControllerSimpleSource</span> <span class=o>:</span> <span class=k>public</span> <span class=n>DeviceControllerSource</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Q_OBJECT</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>explicit</span> <span class=n>DeviceControllerSimpleSource</span><span class=p>(</span><span class=n>QObject</span> <span class=o>*</span><span class=n>parent</span> <span class=o>=</span> <span class=k>nullptr</span><span class=p>)</span> <span class=o>:</span> <span class=n>DeviceControllerSource</span><span class=p>(</span><span class=n>parent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>,</span> <span class=n>m_status</span><span class=p>(</span><span class=n>Ok</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=o>~</span><span class=n>DeviceControllerSimpleSource</span><span class=p>()</span> <span class=k>override</span> <span class=o>=</span> <span class=k>default</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Status</span> <span class=nf>status</span><span class=p>()</span> <span class=k>const</span> <span class=k>override</span> <span class=p>{</span> <span class=k>return</span> <span class=n>m_status</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>protected</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=kt>void</span> <span class=n>setStatus</span><span class=p>(</span><span class=n>Status</span> <span class=n>status</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>status</span> <span class=o>!=</span> <span class=n>m_status</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>m_status</span> <span class=o>=</span> <span class=n>status</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>Q_EMIT</span> <span class=nf>statusChanged</span><span class=p>(</span><span class=n>m_status</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>Status</span> <span class=n>m_status</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#endif </span><span class=c1>// REP_DEVICECONTROLLER_SOURCE_H
</span></span></span></code></pre></td></tr></table></div></div></div></div><h4 id=æœåŠ¡ç«¯>æœåŠ¡ç«¯<a hidden class=anchor aria-hidden=true href=#æœåŠ¡ç«¯>#</a></h4><p>æ¥ä¸‹æ¥ç¼–å†™æœåŠ¡ç«¯ä»£ç ï¼š</p><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=mydeviceservice.h>mydeviceservice.h</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#ifndef MYDEVICESERVICE_H
</span></span></span><span class=line><span class=cl><span class=cp>#define MYDEVICESERVICE_H
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;rep_devicecontroller_source.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyDeviceService</span> <span class=o>:</span> <span class=k>public</span> <span class=n>DeviceControllerSimpleSource</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Q_OBJECT</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>explicit</span> <span class=n>MyDeviceService</span><span class=p>(</span><span class=n>QObject</span> <span class=o>*</span><span class=n>parent</span> <span class=o>=</span> <span class=n>Q_NULLPTR</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=o>~</span><span class=n>MyDeviceService</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=nl>Q_SLOTS</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=kt>void</span> <span class=n>controlDevice</span><span class=p>(</span><span class=n>QString</span> <span class=n>command</span><span class=p>)</span> <span class=n>Q_DECL_OVERRIDE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=kt>void</span> <span class=nf>uploadFile</span><span class=p>(</span><span class=n>QString</span> <span class=n>fileName</span><span class=p>,</span> <span class=n>QByteArray</span> <span class=n>fileData</span><span class=p>)</span> <span class=n>Q_DECL_OVERRIDE</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#endif </span><span class=c1>// MYDEVICESERVICE_H
</span></span></span></code></pre></td></tr></table></div></div></div></div><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=mydeviceservice.cpp>mydeviceservice.cpp</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mydeviceservice.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QDebug&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=n>MyDeviceService</span><span class=o>::</span><span class=n>MyDeviceService</span><span class=p>(</span><span class=n>QObject</span> <span class=o>*</span><span class=n>parent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>:</span> <span class=n>DeviceControllerSimpleSource</span><span class=p>{</span><span class=n>parent</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=n>__PRETTY_FUNCTION__</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>MyDeviceService</span><span class=o>::~</span><span class=n>MyDeviceService</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=n>__PRETTY_FUNCTION__</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>MyDeviceService</span><span class=o>::</span><span class=n>controlDevice</span><span class=p>(</span><span class=n>QString</span> <span class=n>command</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=n>__PRETTY_FUNCTION__</span> <span class=o>&lt;&lt;</span> <span class=n>command</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>setStatus</span><span class=p>(</span><span class=n>Error</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>MyDeviceService</span><span class=o>::</span><span class=n>uploadFile</span><span class=p>(</span><span class=n>QString</span> <span class=n>fileName</span><span class=p>,</span> <span class=n>QByteArray</span> <span class=n>fileData</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=n>__PRETTY_FUNCTION__</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Receiving file:&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>fileName</span>
</span></span><span class=line><span class=cl>             <span class=o>&lt;&lt;</span> <span class=s>&#34;</span><span class=se>\n</span><span class=s>Content: </span><span class=se>\n</span><span class=s>&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>QString</span><span class=o>::</span><span class=n>fromUtf8</span><span class=p>(</span><span class=n>fileData</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>setStatus</span><span class=p>(</span><span class=n>Ok</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Q_EMIT</span> <span class=nf>fileReceived</span><span class=p>(</span><span class=n>fileName</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><p>å¯åŠ¨æœåŠ¡ç«¯ï¼š</p><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=main.cpp>main.cpp</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QCoreApplication&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mydeviceservice.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>argv</span><span class=p>[])</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>QCoreApplication</span> <span class=n>a</span><span class=p>(</span><span class=n>argc</span><span class=p>,</span> <span class=n>argv</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>QRemoteObjectHost</span> <span class=n>host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// host.setHostUrl(QUrl(&#34;local:devicecontroller&#34;));
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>host</span><span class=p>.</span><span class=n>setHostUrl</span><span class=p>(</span><span class=n>QUrl</span><span class=p>(</span><span class=s>&#34;tcp://0.0.0.0:2333&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>MyDeviceService</span> <span class=n>service</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æºå¯¹è±¡æŒ‡é’ˆ
</span></span></span><span class=line><span class=cl><span class=cm>     * ç¬¬äºŒä¸ªå‚æ•°æ˜¯æºå¯¹è±¡åå­—ï¼Œå®¢æˆ·ç«¯å¯æ ¹æ®åå­—è·å–æºå¯¹è±¡ï¼Œ
</span></span></span><span class=line><span class=cl><span class=cm>     * ä½¿ç”¨åŠ¨æ€å‰¯æœ¬çš„æ–¹å¼æ—¶ï¼Œå¿…é¡»å¡«å†™æºå¯¹è±¡åå­—ã€‚
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=n>host</span><span class=p>.</span><span class=n>enableRemoting</span><span class=p>(</span><span class=o>&amp;</span><span class=n>service</span><span class=p>,</span> <span class=s>&#34;mydeviceservice&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span><span class=p>.</span><span class=n>exec</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h4 id=å®¢æˆ·ç«¯>å®¢æˆ·ç«¯<a hidden class=anchor aria-hidden=true href=#å®¢æˆ·ç«¯>#</a></h4><p>å®¢æˆ·ç«¯ä»£ç ï¼š</p><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=mydevicecontroller.h>mydevicecontroller.h</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#ifndef MYDEVICECONTROLLER_H
</span></span></span><span class=line><span class=cl><span class=cp>#define MYDEVICECONTROLLER_H
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QObject&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QPointer&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=n>QT_BEGIN_NAMESPACE</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>QRemoteObjectNode</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>QT_END_NAMESPACE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyDeviceController</span> <span class=o>:</span> <span class=k>public</span> <span class=n>QObject</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Q_OBJECT</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>explicit</span> <span class=n>MyDeviceController</span><span class=p>(</span><span class=n>QObject</span> <span class=o>*</span><span class=n>parent</span> <span class=o>=</span> <span class=n>Q_NULLPTR</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Q_INVOKABLE</span> <span class=kt>void</span> <span class=nf>test</span><span class=p>(</span><span class=k>const</span> <span class=n>QUrl</span> <span class=o>&amp;</span><span class=n>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>QPointer</span><span class=o>&lt;</span><span class=n>QRemoteObjectNode</span><span class=o>&gt;</span> <span class=n>node</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// QPointer&lt;DeviceControllerReplica&gt; replica;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#endif </span><span class=c1>// MYDEVICECONTROLLER_H
</span></span></span></code></pre></td></tr></table></div></div></div></div><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=mydevicecontroller.h>mydevicecontroller.h</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=hl><span class=lnt>24
</span></span><span class=hl><span class=lnt>25
</span></span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mydevicecontroller.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;rep_devicecontroller_replica.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=n>MyDeviceController</span><span class=o>::</span><span class=n>MyDeviceController</span><span class=p>(</span><span class=n>QObject</span> <span class=o>*</span><span class=n>parent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>:</span> <span class=n>QObject</span><span class=p>{</span><span class=n>parent</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>,</span> <span class=n>node</span><span class=p>{</span><span class=k>new</span> <span class=nf>QRemoteObjectNode</span><span class=p>(</span><span class=k>this</span><span class=p>)}</span>
</span></span><span class=line><span class=cl><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>MyDeviceController</span><span class=o>::</span><span class=n>test</span><span class=p>(</span><span class=k>const</span> <span class=n>QUrl</span> <span class=o>&amp;</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>node</span><span class=o>-&gt;</span><span class=n>connectToNode</span><span class=p>(</span><span class=n>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;connected to:&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>url</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>auto</span> <span class=o>*</span><span class=n>replica</span> <span class=o>=</span> <span class=n>node</span><span class=o>-&gt;</span><span class=n>acquire</span><span class=o>&lt;</span><span class=n>DeviceControllerReplica</span><span class=o>&gt;</span><span class=p>(</span><span class=s>&#34;mydeviceservice&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>connect</span><span class=p>(</span><span class=n>replica</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>DeviceControllerReplica</span><span class=o>::</span><span class=n>statusChanged</span><span class=p>,</span> <span class=k>this</span><span class=p>,</span> <span class=p>[</span><span class=o>&amp;</span><span class=p>](</span><span class=n>DeviceControllerReplica</span><span class=o>::</span><span class=n>Status</span> <span class=n>s</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Device status changed to:&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=n>connect</span><span class=p>(</span><span class=n>replica</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>DeviceControllerReplica</span><span class=o>::</span><span class=n>fileReceived</span><span class=p>,</span> <span class=k>this</span><span class=p>,</span> <span class=p>[</span><span class=o>&amp;</span><span class=p>](</span><span class=n>QString</span> <span class=n>fileName</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;File sent. file -&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>fileName</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=n>connect</span><span class=p>(</span><span class=n>replica</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>DeviceControllerReplica</span><span class=o>::</span><span class=n>stateChanged</span><span class=p>,</span> <span class=k>this</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=k>this</span><span class=p>](</span><span class=n>QRemoteObjectReplica</span><span class=o>::</span><span class=n>State</span> <span class=n>state</span><span class=p>,</span> <span class=n>QRemoteObjectReplica</span><span class=o>::</span><span class=n>State</span> <span class=n>oldState</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;replica state changed:&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>oldState</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;â†’&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>state</span><span class=p>;</span>
</span></span><span class="line hl"><span class=cl>        <span class=c1>// å‰¯æœ¬å¯¹è±¡çŠ¶æ€å¯ç”¨æ—¶æ‰èƒ½è°ƒç”¨æ¥å£
</span></span></span><span class="line hl"><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>state</span> <span class=o>==</span> <span class=n>QRemoteObjectReplica</span><span class=o>::</span><span class=n>Valid</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>DeviceControllerReplica</span> <span class=o>*</span><span class=n>replica</span> <span class=o>=</span> <span class=n>qobject_cast</span><span class=o>&lt;</span><span class=n>DeviceControllerReplica</span><span class=o>*&gt;</span><span class=p>(</span><span class=n>sender</span><span class=p>());</span>
</span></span><span class=line><span class=cl>            <span class=n>Q_ASSERT</span><span class=p>(</span><span class=n>replica</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>replica</span><span class=o>-&gt;</span><span class=n>controlDevice</span><span class=p>(</span><span class=s>&#34;echo&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>replica</span><span class=o>-&gt;</span><span class=n>uploadFile</span><span class=p>(</span><span class=s>&#34;test.txt&#34;</span><span class=p>,</span> <span class=n>QString</span><span class=p>(</span><span class=s>&#34;ä½ å¥½ï¼ä¸–ç•Œã€‚&#34;</span><span class=p>).</span><span class=n>toUtf8</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><p>å®¢æˆ·ç«¯è°ƒç”¨ï¼š</p><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=main.cpp>main.cpp</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QCoreApplication&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QUrl&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mydevicecontroller.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>argv</span><span class=p>[])</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>QCoreApplication</span> <span class=n>a</span><span class=p>(</span><span class=n>argc</span><span class=p>,</span> <span class=n>argv</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>MyDeviceController</span> <span class=n>client</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// client.test(QUrl(&#34;local:devicecontroller&#34;));
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>client</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>QUrl</span><span class=p>(</span><span class=s>&#34;tcp://192.168.1.3:2333&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span><span class=p>.</span><span class=n>exec</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h3 id=åŠ¨æ€å‰¯æœ¬>åŠ¨æ€å‰¯æœ¬<a hidden class=anchor aria-hidden=true href=#åŠ¨æ€å‰¯æœ¬>#</a></h3><p>åŠ¨æ€å‰¯æœ¬çš„å®¢æˆ·ç«¯ä»£ç æœ‰æ‰€ä¸åŒã€‚</p><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=mydevicecontroller.h>mydevicecontroller.h</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=hl><span class=lnt>19
</span></span><span class=hl><span class=lnt>20
</span></span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#ifndef MYDEVICECONTROLLER_H
</span></span></span><span class=line><span class=cl><span class=cp>#define MYDEVICECONTROLLER_H
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QObject&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;QPointer&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=n>QT_BEGIN_NAMESPACE</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>QRemoteObjectNode</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>QT_END_NAMESPACE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MyDeviceController</span> <span class=o>:</span> <span class=k>public</span> <span class=n>QObject</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Q_OBJECT</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=k>explicit</span> <span class=n>MyDeviceController</span><span class=p>(</span><span class=n>QObject</span> <span class=o>*</span><span class=n>parent</span> <span class=o>=</span> <span class=n>Q_NULLPTR</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Q_INVOKABLE</span> <span class=kt>void</span> <span class=nf>test</span><span class=p>(</span><span class=k>const</span> <span class=n>QUrl</span> <span class=o>&amp;</span><span class=n>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class="line hl"><span class=cl>    <span class=n>Q_SLOT</span> <span class=kt>void</span> <span class=nf>onStatusChanged</span><span class=p>(</span><span class=kt>int</span><span class=p>);</span>
</span></span><span class="line hl"><span class=cl>    <span class=n>Q_SLOT</span> <span class=kt>void</span> <span class=nf>onFileReceived</span><span class=p>(</span><span class=k>const</span> <span class=n>QString</span><span class=o>&amp;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>QPointer</span><span class=o>&lt;</span><span class=n>QRemoteObjectNode</span><span class=o>&gt;</span> <span class=n>node</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>#endif </span><span class=c1>// MYDEVICECONTROLLER_H
</span></span></span></code></pre></td></tr></table></div></div></div></div><div class=mac-codeblock><div class=mac-titlebar><div class=mac-left-group><span class=mac-close></span>
<span class=mac-minimize></span>
<span class=mac-expand></span></div><div class=mac-title title=mydevicecontroller.cpp>mydevicecontroller.cpp</div><div class=mac-right-group><button class=fold-button>&#9660;</button></div></div><div class=mac-content><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=hl><span class=lnt>14
</span></span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=hl><span class=lnt>26
</span></span><span class=hl><span class=lnt>27
</span></span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=hl><span class=lnt>31
</span></span><span class=hl><span class=lnt>32
</span></span><span class=hl><span class=lnt>33
</span></span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mydevicecontroller.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;rep_devicecontroller_replica.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=n>MyDeviceController</span><span class=o>::</span><span class=n>MyDeviceController</span><span class=p>(</span><span class=n>QObject</span> <span class=o>*</span><span class=n>parent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>:</span> <span class=n>QObject</span><span class=p>{</span><span class=n>parent</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>,</span> <span class=n>node</span><span class=p>{</span><span class=k>new</span> <span class=nf>QRemoteObjectNode</span><span class=p>(</span><span class=k>this</span><span class=p>)}</span>
</span></span><span class=line><span class=cl><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>MyDeviceController</span><span class=o>::</span><span class=n>test</span><span class=p>(</span><span class=k>const</span> <span class=n>QUrl</span> <span class=o>&amp;</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>node</span><span class=o>-&gt;</span><span class=n>connectToNode</span><span class=p>(</span><span class=n>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;connected to:&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>url</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class="line hl"><span class=cl>    <span class=k>auto</span> <span class=o>*</span><span class=n>replica</span> <span class=o>=</span> <span class=n>node</span><span class=o>-&gt;</span><span class=n>acquireDynamic</span><span class=p>(</span><span class=s>&#34;mydeviceservice&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>connect</span><span class=p>(</span><span class=n>replica</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>QRemoteObjectDynamicReplica</span><span class=o>::</span><span class=n>stateChanged</span><span class=p>,</span> <span class=k>this</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=k>this</span><span class=p>](</span><span class=n>QRemoteObjectReplica</span><span class=o>::</span><span class=n>State</span> <span class=n>state</span><span class=p>,</span> <span class=n>QRemoteObjectReplica</span><span class=o>::</span><span class=n>State</span> <span class=n>oldState</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;replica state changed:&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>oldState</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;â†’&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>state</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>state</span> <span class=o>==</span> <span class=n>QRemoteObjectReplica</span><span class=o>::</span><span class=n>Valid</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>QRemoteObjectDynamicReplica</span> <span class=o>*</span><span class=n>replica</span> <span class=o>=</span> <span class=n>qobject_cast</span><span class=o>&lt;</span><span class=n>QRemoteObjectDynamicReplica</span><span class=o>*&gt;</span><span class=p>(</span><span class=n>sender</span><span class=p>());</span>
</span></span><span class=line><span class=cl>                    <span class=n>Q_ASSERT</span><span class=p>(</span><span class=n>replica</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                    <span class=cm>/** ç”±äºä½¿ç”¨åŠ¨æ€å‰¯æœ¬æ–¹å¼ï¼Œåœ¨å‰¯æœ¬åˆå§‹åŒ–å®Œæˆå‰ï¼Œæ— æ³•é¢„å…ˆçŸ¥é“APIï¼Œ
</span></span></span><span class=line><span class=cl><span class=cm>                     *  åªæœ‰åœ¨å‰¯æœ¬å¯¹è±¡çŠ¶æ€å¯ç”¨æ—¶ï¼Œæ‰èƒ½è¿›è¡Œä¿¡å·-æ§½è¿æ¥ã€‚
</span></span></span><span class=line><span class=cl><span class=cm>                     *  å¹¶ä¸”æ— æ³•ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹å‚æ•°ï¼Œå¦‚ä¹‹å‰å®šä¹‰çš„æšä¸¾ã€‚
</span></span></span><span class=line><span class=cl><span class=cm>                     */</span>
</span></span><span class="line hl"><span class=cl>                    <span class=c1>// connect(replica, SIGNAL(statusChanged(int)), this, SLOT(onStatusChanged(int)));
</span></span></span><span class="line hl"><span class=cl><span class=c1></span>                    <span class=n>connect</span><span class=p>(</span><span class=n>replica</span><span class=p>,</span> <span class=n>SIGNAL</span><span class=p>(</span><span class=n>fileReceived</span><span class=p>(</span><span class=n>QString</span><span class=p>)),</span> <span class=k>this</span><span class=p>,</span> <span class=n>SLOT</span><span class=p>(</span><span class=n>onFileReceived</span><span class=p>(</span><span class=n>QString</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                    <span class=cm>/** è°ƒç”¨æ¥å£éœ€è¦ä½¿ç”¨å…ƒå¯¹è±¡çš„`invokeMethod`æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=cm>                      */</span>
</span></span><span class="line hl"><span class=cl>                    <span class=n>QMetaObject</span><span class=o>::</span><span class=n>invokeMethod</span><span class=p>(</span><span class=n>replica</span><span class=p>,</span> <span class=s>&#34;controlDevice&#34;</span><span class=p>,</span> <span class=n>Q_ARG</span><span class=p>(</span><span class=n>QString</span><span class=p>,</span> <span class=s>&#34;echo&#34;</span><span class=p>));</span>
</span></span><span class="line hl"><span class=cl>                    <span class=n>QMetaObject</span><span class=o>::</span><span class=n>invokeMethod</span><span class=p>(</span><span class=n>replica</span><span class=p>,</span> <span class=s>&#34;uploadFile&#34;</span><span class=p>,</span> <span class=n>Q_ARG</span><span class=p>(</span><span class=n>QString</span><span class=p>,</span> <span class=s>&#34;test.txt&#34;</span><span class=p>),</span>
</span></span><span class="line hl"><span class=cl>                                              <span class=n>Q_ARG</span><span class=p>(</span><span class=n>QByteArray</span><span class=p>,</span> <span class=n>QString</span><span class=p>(</span><span class=s>&#34;ä½ å¥½ï¼ä¸–ç•Œã€‚&#34;</span><span class=p>).</span><span class=n>toUtf8</span><span class=p>()));</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>MyDeviceController</span><span class=o>::</span><span class=n>onStatusChanged</span><span class=p>(</span><span class=kt>int</span> <span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;Device status changed to:&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>MyDeviceController</span><span class=o>::</span><span class=n>onFileReceived</span><span class=p>(</span><span class=k>const</span> <span class=n>QString</span> <span class=o>&amp;</span><span class=n>fileName</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>qDebug</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&#34;File sent. file -&#34;</span> <span class=o>&lt;&lt;</span> <span class=n>fileName</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div></div><h2 id=æ³¨æ„äº‹é¡¹>æ³¨æ„äº‹é¡¹<a hidden class=anchor aria-hidden=true href=#æ³¨æ„äº‹é¡¹>#</a></h2><p>Qt Remote Objects ä½¿ç”¨å†…éƒ¨åè®®åœ¨è¿›ç¨‹å’Œ/æˆ–è®¾å¤‡ä¹‹é—´ä¼ é€’æ•°æ®ã€‚æ‰€æœ‰éƒ¨åˆ†éƒ½éœ€è¦ä½¿ç”¨ç›¸åŒçš„åè®®ç‰ˆæœ¬ï¼šå¦‚æœç‰ˆæœ¬ä¸åŒ¹é…ï¼Œè¿æ¥èŠ‚ç‚¹å°†è¾“å‡ºè­¦å‘Šï¼Œä¸»æœºèŠ‚ç‚¹å°†ä¸å‘é€ä»»ä½•æ•°æ®ã€‚</p><p>ç›®å‰å‘å¸ƒçš„ç‰ˆæœ¬ï¼š</p><table><thead><tr><th style=text-align:center>åè®®ç‰ˆæœ¬</th><th style=text-align:center>Qtç‰ˆæœ¬</th></tr></thead><tbody><tr><td style=text-align:center>&lt;1.2</td><td style=text-align:center>åœ¨ QtRO çš„æŠ€æœ¯é¢„è§ˆé˜¶æ®µä½¿ç”¨ã€‚</td></tr><tr><td style=text-align:center>1.2</td><td style=text-align:center>5.12.0</td></tr><tr><td style=text-align:center>1.3</td><td style=text-align:center>5.12.4</td></tr><tr><td style=text-align:center>2.0</td><td style=text-align:center>6.2.0</td></tr></tbody></table><p>See <a href=https://doc.qt.io/qt-6/qtremoteobjects-compatibility.html>Qt Remote Objects Protocol Versioning</a>.</p><p><strong>å‚è€ƒ</strong></p><ul><li><a href=https://www.xnip.cn/ruanjian/anli/39413.html>Qt Remote Objectsè¿œç¨‹è°ƒç”¨æ¨¡å—çš„åŸºæœ¬ä½¿ç”¨</a></li><li><a href=https://blog.csdn.net/zzc116433008/article/details/99194118>Qt Remote Objects å­¦ä¹ ç¬”è®°ï¼ˆQt è¿œç«¯å¯è°ƒç”¨å¯¹è±¡æ¡†æ¶)</a></li><li><a href=https://zhuanlan.zhihu.com/p/613641170>Qt Remote Objectï¼ˆQtROï¼‰åŠ¨æ€Replicaå®ç°è¿›ç¨‹é—´é€šä¿¡</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://kira-96.github.io/tags/qt/>Qt</a></li></ul><nav class=paginav><a class=prev href=https://kira-96.github.io/posts/%E4%B8%AA%E4%BA%BA%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%88%86%E4%BA%AB/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>ä¸ªäººå¸¸ç”¨è½¯ä»¶åˆ†äº«</span>
</a><a class=next href=https://kira-96.github.io/posts/qt5-quick2-extension-plugin/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>Qt5ç¼–å†™Qt Quick2æ’ä»¶</span></a></nav></footer><script src=https://utteranc.es/client.js repo=kira-96/kira-96.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>Â© 2019-2025 <a href=/>kira&rsquo;s blog</a> Â· LICENSED under <a href=https://github.com/kira-96/kira-96.github.io/tree/main/LICENSE>CC-BY-4.0</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>document.querySelectorAll(".fold-button").forEach(e=>{e.addEventListener("click",t=>{const n=t.target.closest(".mac-codeblock"),s=n.querySelector(".mac-content");s.classList.toggle("folded"),e.classList.toggle("folded")})})</script><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>