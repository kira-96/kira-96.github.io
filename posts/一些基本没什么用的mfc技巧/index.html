<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ä¸€äº›åŸºæœ¬æ²¡ä»€ä¹ˆç”¨çš„MFCæŠ€å·§ | âœ¨kiraã®åšå®¢</title>
<meta name=keywords content="MFC"><meta name=description content="MFCå°æŠ€å·§"><meta name=author content><link rel=canonical href=https://kira-96.github.io/posts/%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%9C%AC%E6%B2%A1%E4%BB%80%E4%B9%88%E7%94%A8%E7%9A%84mfc%E6%8A%80%E5%B7%A7/><link crossorigin=anonymous href=/assets/css/stylesheet.3885277a87a498ed2522e7ff68054e29ab8db4095b653379837d1193311cfcc9.css integrity="sha256-OIUneoekmO0lIuf/aAVOKauNtAlbZTN5g30RkzEc/Mk=" rel="preload stylesheet" as=style><link rel=icon href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/favicon-32x32.png><link rel=apple-touch-icon href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/icons/apple-icon-180x180.png><link rel=mask-icon href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/icons/apple-icon-76x76.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://kira-96.github.io/posts/%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%9C%AC%E6%B2%A1%E4%BB%80%E4%B9%88%E7%94%A8%E7%9A%84mfc%E6%8A%80%E5%B7%A7/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=manifest href=https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/manifest.json><script src=https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js></script><script type=text/javascript src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><meta property="og:title" content="ä¸€äº›åŸºæœ¬æ²¡ä»€ä¹ˆç”¨çš„MFCæŠ€å·§"><meta property="og:description" content="MFCå°æŠ€å·§"><meta property="og:type" content="article"><meta property="og:url" content="https://kira-96.github.io/posts/%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%9C%AC%E6%B2%A1%E4%BB%80%E4%B9%88%E7%94%A8%E7%9A%84mfc%E6%8A%80%E5%B7%A7/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-04-24T14:35:30+08:00"><meta property="article:modified_time" content="2020-04-24T14:35:30+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="ä¸€äº›åŸºæœ¬æ²¡ä»€ä¹ˆç”¨çš„MFCæŠ€å·§"><meta name=twitter:description content="MFCå°æŠ€å·§"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://kira-96.github.io/posts/"},{"@type":"ListItem","position":2,"name":"ä¸€äº›åŸºæœ¬æ²¡ä»€ä¹ˆç”¨çš„MFCæŠ€å·§","item":"https://kira-96.github.io/posts/%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%9C%AC%E6%B2%A1%E4%BB%80%E4%B9%88%E7%94%A8%E7%9A%84mfc%E6%8A%80%E5%B7%A7/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ä¸€äº›åŸºæœ¬æ²¡ä»€ä¹ˆç”¨çš„MFCæŠ€å·§","name":"ä¸€äº›åŸºæœ¬æ²¡ä»€ä¹ˆç”¨çš„MFCæŠ€å·§","description":"MFCå°æŠ€å·§","keywords":["MFC"],"articleBody":"å‰è¨€ ç”±äºæˆ‘å¾ˆå°‘ç”¨MFCï¼Œåªæœ‰å·¥ä½œä¸Šéœ€è¦çš„æ—¶å€™æ‰ä¼šç”¨åˆ°ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæ˜¯ä¸ªæ–°æ‰‹ï¼Œé‡åˆ°é—®é¢˜éœ€è¦åˆ°ç½‘ä¸Šæ‰¾å¾ˆä¹…èµ„æ–™ã€‚è¿™é‡Œåªæ˜¯è®°å½•ä¸€äº›ç‰¹æ®Šæƒ…æ™¯ä¸‹ä¼šç”¨åˆ°çš„æŠ€å·§ï¼Œæ–¹ä¾¿ä»¥åæŸ¥æ‰¾ã€‚\néšè—çª—å£ä»»åŠ¡æ å›¾æ ‡ è¿™ä¸ªé—®é¢˜æˆ‘åœ¨ç½‘ä¸Šæ‰¾äº†å¾ˆä¹…ï¼Œå¤§è‡´æœ‰ä¸¤ç§æ–¹æ¡ˆï¼š\nä¿®æ”¹çª—å£çš„æ‰©å±•æ ·å¼\n1 ModifyStyleEx(WS_EX_APPWINDOW,WS_EX_TOOLWINDOW); ä½†æ˜¯è¿™æ ·åšä¼šå¯¼è‡´æ•´ä¸ªçª—å£çš„æ ·å¼ä¼šå˜å¾—å¾ˆéš¾çœ‹ã€‚\nå°†ä¸€ä¸ªéšè—çª—å£è®¾ç½®æˆä¸»çª—å£çš„çˆ¶çª—å£\nè¿™æ ·åšæ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”ä»»åŠ¡è§†å›¾ä¸‹ä¹Ÿä¸èƒ½å†çœ‹åˆ°çª—å£ï¼Œæ˜¾ç„¶ä¸æ˜¯æˆ‘æƒ³è¦çš„æ•ˆæœã€‚\næœ€åç»ˆäºæ‰¾åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒå®Œç¾çš„è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡COMçš„æ–¹å¼ç§»é™¤ä»»åŠ¡æ åˆ—è¡¨ä¸­çš„å›¾æ ‡ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 // æ˜¾ç¤º/éšè—ä»»åŠ¡æ å›¾æ ‡(COMæ–¹å¼) bool ShowInTaskbar(HWND hWnd, bool isShow) { CoInitialize(nullptr); ITaskbarList* pTaskbarList; HRESULT hr = CoCreateInstance(CLSID_TaskbarList, nullptr, CLSCTX_INPROC_SERVER, IID_ITaskbarList, (void**)\u0026pTaskbarList); if (SUCCEEDED(hr)) { pTaskbarList-\u003eHrInit(); if (isShow) { pTaskbarList-\u003eAddTab(hWnd); } else { pTaskbarList-\u003eDeleteTab(hWnd); } CoUninitialize(); return true; } CoUninitialize(); return false; } ç¨‹åºå¯åŠ¨æ—¶é»˜è®¤éšè—çª—å£ ä¸€ç§æ¯”è¾ƒç®€å•çš„æ–¹æ³•æ˜¯åœ¨ç¨‹åºå¯åŠ¨æ—¶å°†çª—å£ç§»åŠ¨åˆ°å±å¹•å¤–çš„ä¸å¯è§åŒºåŸŸã€‚ å¦‚æœç›´æ¥åœ¨OnInitDialogä¸­è®¾ç½®ShowWindow(SW_HIDE)æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºæ­¤æ—¶çª—å£è¿˜æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œè‡ªç„¶ä¹Ÿæ— æ³•éšè—ã€‚\nè¿™é‡Œçš„æ€è·¯æ˜¯åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™å…ˆå°†çª—å£ç§»åŠ¨åˆ°å±å¹•å¤–ï¼Œç„¶åé€šè¿‡å¦ä¸€ä¸ªçº¿ç¨‹å°†çª—å£éšè—èµ·æ¥ï¼Œè¿™æ ·åšè™½ç„¶ç¨‹åºå¯åŠ¨åçª—å£è¿˜æ˜¯ä¼šä¸€é—ªå³é€ï¼Œä½†ç”±äºæ˜¯åœ¨å±å¹•ä¹‹å¤–ï¼Œå®é™…ä¸Šå¹¶ä¸èƒ½çœ‹åˆ°ï¼Œç„¶ååœ¨çª—å£éœ€è¦æ˜¾ç¤ºçš„æ—¶å€™è°ƒç”¨ShowWindow(SW_SHOW)å³å¯ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 // CxxxDlg.h å¤´æ–‡ä»¶ #include class CxxxDlg : public CDialogEx { ... ... ... private: std::future\u003cint\u003e hideTask; // åå°éšè—çª—å£çº¿ç¨‹ } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 BOOL CxxxDlg::OnInitDialog() { ... CRect rcClient; GetWindowRect(\u0026rcClient); // å°†çª—å£ç§»åŠ¨åˆ°å±å¹•å¤– MoveWindow(-rcClient.Width(), rcClient.top, rcClient.Width(), rcClient.Height()); // æ–°å»ºçº¿ç¨‹ï¼Œå»¶æ—¶1såéšè—çª—å£ hideTask = std::async( std::launch::async, [\u0026] { std::this_thread::sleep_for(std::chrono::seconds(1)); // ShowWindow(SW_HIDE); ShowWindowAsync(m_hWnd, SW_HIDE); std::this_thread::sleep_for(std::chrono::seconds(1)); // å»¶æ—¶1sï¼Œå¾…çª—å£å®Œå…¨éšè—åå†å°†çª—å£å±…ä¸­ CenterWindow(); return 0; }); ... return TRUE; // é™¤éå°†ç„¦ç‚¹è®¾ç½®åˆ°æ§ä»¶ï¼Œå¦åˆ™è¿”å› TRUE } ç‚¹å‡»å…³é—­æ—¶éšè—çª—å£ æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›åœ¨ç‚¹å‡»ä¸»çª—å£çš„å…³é—­æŒ‰é’®ä¹‹åå°†çª—å£éšè—æˆ–è€…æœ€å°åŒ–ï¼Œè€Œä¸æ˜¯é€€å‡ºç¨‹åºã€‚è¿™æ—¶åªéœ€è¦æ‹¦æˆªæ‰çª—å£çš„å…³é—­æ¶ˆæ¯å³å¯ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 // CxxxDlg.h å¤´æ–‡ä»¶ class CxxxDlg : public CDialogEx { ... protected: afx_msg void OnSysCommand(UINT nID, LPARAM lParam); ... } void CxxxDlg::OnSysCommand(UINT nID, LPARAM lParam) { ///////////////////////////////////// // è¿™é‡Œæ•è·çª—å£çš„å…³é—­æ¶ˆæ¯ // ä¸ç›´æ¥å…³é—­çª—å£ï¼Œè€Œæ˜¯éšè—èµ·æ¥ if (nID == SC_CLOSE) { ShowWindowAsync(m_hWnd, SW_HIDE); } ///////////////////////////////////// else { CDialogEx::OnSysCommand(nID, lParam); } } è¿™æ ·å°±å¯ä»¥æ‹¦æˆªæ‰çª—å£çš„å…³é—­æ¶ˆæ¯äº†ï¼Œè¿™æ ·ä¸ä»…ä»…æ˜¯ç‚¹å‡»å…³é—­æŒ‰é’®æ—¶ä¼šéšè—çª—å£ï¼Œé€šè¿‡çª—å£èœå•å…³é—­çª—å£æˆ–æ˜¯ä½¿ç”¨Alt+F4éƒ½ä¸èƒ½çœŸæ­£å…³é—­çª—å£ã€‚é‚£ä¹ˆæˆ‘æ€æ ·æ‰èƒ½é€€å‡ºç¨‹åºå‘¢ï¼Œæ€»ä¸èƒ½ç”¨ä»»åŠ¡ç®¡ç†å™¨å§ã€‚\nå…¶å®å¾ˆç®€å•ï¼Œåœ¨éœ€è¦é€€å‡ºç¨‹åºçš„æ—¶å€™å‘çª—å£å‘é€WM_CLOSEæ¶ˆæ¯å³å¯ã€‚\n1 SendMessage(WM_CLOSE); CFileDialogå¯¼è‡´CDialogExâ€œå¤±å»ç„¦ç‚¹â€çš„è§£å†³æ–¹æ³• ç»§æ‰¿è‡ªCDialogExçš„çª—å£åœ¨ä½¿ç”¨CFileDialogä¹‹åä¼šå¯¼è‡´çª—å£æ ‡é¢˜æ å˜æˆç°è‰²ï¼Œå¾ˆåƒæ˜¯çª—å£å¤±å»äº†ç„¦ç‚¹ï¼Œæ­¤æ—¶çª—å£ä»ç„¶èƒ½å¤Ÿæ­£å¸¸æ“ä½œï¼Œä½†å³ä½¿é¼ æ ‡ç‚¹å‡»åœ¨çª—å£ä¸Šçª—å£çš„æ ‡é¢˜æ ä¾æ—§æ˜¯ç°è‰²ï¼Œæ— æ³•æ¢å¤åˆ°çª—å£æ¿€æ´»çŠ¶æ€çš„é¢œè‰²ï¼Œå³ä½¿å°†çª—å£å±æ€§è®¾ç½®ä¸ºWS_EX_TOPMOSTï¼ˆç½®é¡¶ï¼‰ä¾æ—§æ˜¯è¿™æ ·ï¼Œå¿…é¡»ç‚¹å‡»çª—å£å¤–çš„å…¶å®ƒåŒºåŸŸæˆ–è€…ä½¿ç”¨Tabåˆ‡æ¢ä¸€ä¸‹æ‰èƒ½æ¢å¤æ­£å¸¸ã€‚\nè€Œç»§æ‰¿è‡ªCDialogçš„çª—å£åˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†çª—å£çš„åŸºç±»æ”¹æˆCDialogæ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚å¯¹äºæˆ‘è¿™æ ·çš„å¼ºè¿«ç—‡æ¥è¯´æ˜¯æ— æ³•å¿å—çš„ï¼Œæ‰€ä»¥ç”¨å°½åƒæ–¹ç™¾è®¡ç»ˆäºæ‰¾åˆ°äº†ä¸€ä¸ªå¯è¡Œçš„è§£å†³æ–¹æ¡ˆã€‚\nç»è¿‡å°è¯•ï¼Œå•çº¯è®©çª—å£è·å–ç„¦ç‚¹æˆ–è€…å°†çª—å£æ”¾åˆ°å‰å°çš„æ–¹æ³•éƒ½æ˜¯æ— æ•ˆçš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 CFileDialog dlg( TRUE, _T(\"ini\"), nullptr, OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT, _T(\"ini(*.ini)|*.ini|TEXT(*.txt)|*.txt|\"), this); auto dlgResult = dlg.DoModal(); // æ— æ•ˆçš„æ–¹æ³• this-\u003eSetFocus(); this-\u003eSetForegroundWindow(); ... æ‰€ä»¥åªèƒ½æ›²çº¿æ•‘å›½ï¼Œæ—¢ç„¶é€šè¿‡æ‰‹åŠ¨åˆ‡æ¢çš„æ–¹å¼å¯ä»¥æ¢å¤åˆ°æ­£å¸¸çŠ¶æ€ï¼Œä¸å¦¨å…ˆåˆ‡æ¢åˆ°å…¶å®ƒçª—å£å†åˆ‡æ¢å›æ¥ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 CFileDialog dlg( TRUE, _T(\"ini\"), nullptr, OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT, _T(\"ini(*.ini)|*.ini|TEXT(*.txt)|*.txt|\"), this); auto dlgResult = dlg.DoModal(); // å…ˆå°†ç„¦ç‚¹æ”¾åˆ°æ¡Œé¢ï¼Œå†åˆ‡æ¢å›æœ¬çª—å£ ::SetForegroundWindow(::GetDesktopWindow()); this-\u003eSetForegroundWindow(); ... å®Œç¾è§£å†³äº†é—®é¢˜ã€‚\nçª—å£å¯ç”¨è§†è§‰æ ·å¼ å¯ç”¨è§†è§‰æ ·å¼ä¹‹åï¼Œå¯ä»¥è®©ç¨‹åºçœ‹èµ·æ¥æ›´åŠ ç°ä»£åŒ–ä¸€äº›ï¼Œåªæ”¯æŒWindow XPä»¥åçš„ç³»ç»Ÿã€‚ å¯ä»¥é€šè¿‡ä¸ºç¨‹åºæ·»åŠ æ¸…å•æ–‡ä»¶æ¥å®ç°ï¼Œä¸è¿‡æ¯”è¾ƒéº»çƒ¦ã€‚åœ¨VC++ 2005ä¹‹åï¼Œç›´æ¥æ·»åŠ ç¼–è¯‘å™¨æŒ‡ä»¤åˆ°ä»£ç ä¸­å°±å¯ä»¥äº†ã€‚\nåœ¨é¢„ç¼–è¯‘å¤´æ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢ä»£ç å³å¯ã€‚\n1 2 3 4 5 6 7 8 9 #if defined _M_IX86 #pragma comment(linker,\"/manifestdependency:\\\"type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' processorArchitecture='x86' publicKeyToken='6595b64144ccf1df' language='*'\\\"\") #elif defined _M_IA64 #pragma comment(linker,\"/manifestdependency:\\\"type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' processorArchitecture='ia64' publicKeyToken='6595b64144ccf1df' language='*'\\\"\") #elif defined _M_X64 #pragma comment(linker,\"/manifestdependency:\\\"type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' processorArchitecture='amd64' publicKeyToken='6595b64144ccf1df' language='*'\\\"\") #else #pragma comment(linker,\"/manifestdependency:\\\"type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' processorArchitecture='*' publicKeyToken='6595b64144ccf1df' language='*'\\\"\") #endif ä»»åŠ¡æ æ˜¾ç¤ºè¿›åº¦ ä¸ºçª—å£çš„ä»»åŠ¡æ å›¾æ ‡æ·»åŠ è¿›åº¦æ˜¾ç¤ºï¼Œä¹Ÿå¯ä»¥ä¸ºä»»åŠ¡æ æ·»åŠ æŒ‰é’®ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 ITaskbarList3* pTaskbar; // åˆå§‹åŒ–COMç»„ä»¶ CoInitialize(NULL); CoCreateInstance(CLSID_TaskbarList, NULL, CLSCTX_INPROC_SERVER, IID_PPV_ARGS(\u0026pTaskbar)); // TBPF_NOPROGRESS\t= 0, // æ­£å¸¸çŠ¶æ€ï¼Œä¸æ˜¾ç¤ºè¿›åº¦ // TBPF_INDETERMINATE\t= 0x1, // å¿™ç¢ŒçŠ¶æ€ï¼Œä¸æ˜¾ç¤ºè¿›åº¦ // TBPF_NORMAL\t= 0x2, // æ­£å¸¸çŠ¶æ€ï¼Œæ˜¾ç¤ºè¿›åº¦ï¼ˆç»¿è‰²ï¼‰ // TBPF_ERROR\t= 0x4, // é”™è¯¯çŠ¶æ€ï¼Œæ˜¾ç¤ºè¿›åº¦ï¼ˆçº¢è‰²ï¼‰ // TBPF_PAUSED\t= 0x8 // åœæ­¢çŠ¶æ€ï¼Œæ˜¾ç¤ºè¿›åº¦ï¼ˆé»„è‰²ï¼‰ pTaskbar-\u003eSetProgressState(GetSafeHwnd(), TBPF_NORMAL); pTaskbar-\u003eSetProgressValue(GetSafeHwnd(), 60, 100); // è®¾ç½®æç¤ºä¿¡æ¯ pTaskbar-\u003eSetThumbnailTooltip(GetSafeHwnd(), TEXT(\"Tooltip\")); // è®¾ç½®è¦†ç›–å›¾æ ‡ HICON hIcon = AfxGetApp()-\u003eLoadIcon(IDI_ICON_ERR); pTaskbar-\u003eSetOverlayIcon(GetSafeHwnd(), hIcon, _T(\"Error\")); // æ·»åŠ ä»»åŠ¡æ æŒ‰é’® THUMBBUTTONMASK dwMask = THB_ICON | THB_TOOLTIP; THUMBBUTTON buttons[3]; buttons[0].iId = 0; buttons[0].dwMask = dwMask; buttons[0].hIcon = hIcon; memcpy(buttons[0].szTip, TEXT(\"Tooltip\"), sizeof(buttons[0].szTip)); // ... pTaskbar-\u003eThumbBarAddButtons(GetSafeHwnd(), 3, buttons); // æœ€åé‡Šæ”¾COMç»„ä»¶ CoUninitialize(); æœªå®Œå¾…ç»­ï¼ŒæŒç»­æ›´æ–°ä¸­â€¦ å‚è€ƒ\nMFCç®€å•çš„å¯åŠ¨æ—¶éšè—ç•Œé¢æ–¹å¼(ä»…å¯åŠ¨æ—¶éšè—)\nEnabling Visual Styles\n","wordCount":"1900","inLanguage":"zh","datePublished":"2020-04-24T14:35:30+08:00","dateModified":"2020-04-24T14:35:30+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://kira-96.github.io/posts/%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%9C%AC%E6%B2%A1%E4%BB%80%E4%B9%88%E7%94%A8%E7%9A%84mfc%E6%8A%80%E5%B7%A7/"},"publisher":{"@type":"Organization","name":"âœ¨kiraã®åšå®¢","logo":{"@type":"ImageObject","url":"https://cdn.jsdelivr.net/gh/kira-96/kira-96.github.io@gh-pages/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kira-96.github.io/ accesskey=h title="âœ¨kiraã®åšå®¢ (Alt + H)">âœ¨kiraã®åšå®¢</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://kira-96.github.io/ title=ğŸ ä¸»é¡µ><span>ğŸ ä¸»é¡µ</span></a></li><li><a href=https://kira-96.github.io/notes/ title=ğŸ““ç¬”è®°><span>ğŸ““ç¬”è®°</span></a></li><li><a href=https://kira-96.github.io/search/ title=ğŸ”ï¸æœç´¢><span>ğŸ”ï¸æœç´¢</span></a></li><li><a href=https://kira-96.github.io/archives/ title=ğŸ—ƒï¸å­˜æ¡£><span>ğŸ—ƒï¸å­˜æ¡£</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://kira-96.github.io/>ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://kira-96.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">ä¸€äº›åŸºæœ¬æ²¡ä»€ä¹ˆç”¨çš„MFCæŠ€å·§</h1><div class=post-description>MFCå°æŠ€å·§</div><div class=post-meta><span title='2020-04-24 14:35:30 +0800 +0800'>å››æœˆ 24, 2020</span>&nbsp;Â·&nbsp;4 åˆ†é’Ÿ&nbsp;Â·&nbsp;1900 å­—&nbsp;|&nbsp;<a href=https://github.com/kira-96/kira-96.github.io/tree/main/content/posts/ rel="noopener noreferrer" target=_blank>âœï¸ç¼–è¾‘</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#%e5%89%8d%e8%a8%80 aria-label=å‰è¨€>å‰è¨€</a></li><li><a href=#%e9%9a%90%e8%97%8f%e7%aa%97%e5%8f%a3%e4%bb%bb%e5%8a%a1%e6%a0%8f%e5%9b%be%e6%a0%87 aria-label=éšè—çª—å£ä»»åŠ¡æ å›¾æ ‡>éšè—çª—å£ä»»åŠ¡æ å›¾æ ‡</a></li><li><a href=#%e7%a8%8b%e5%ba%8f%e5%90%af%e5%8a%a8%e6%97%b6%e9%bb%98%e8%ae%a4%e9%9a%90%e8%97%8f%e7%aa%97%e5%8f%a3 aria-label=ç¨‹åºå¯åŠ¨æ—¶é»˜è®¤éšè—çª—å£>ç¨‹åºå¯åŠ¨æ—¶é»˜è®¤éšè—çª—å£</a></li><li><a href=#%e7%82%b9%e5%87%bb%e5%85%b3%e9%97%ad%e6%97%b6%e9%9a%90%e8%97%8f%e7%aa%97%e5%8f%a3 aria-label=ç‚¹å‡»å…³é—­æ—¶éšè—çª—å£>ç‚¹å‡»å…³é—­æ—¶éšè—çª—å£</a></li><li><a href=#cfiledialog%e5%af%bc%e8%87%b4cdialogex%e5%a4%b1%e5%8e%bb%e7%84%a6%e7%82%b9%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95 aria-label=CFileDialogå¯¼è‡´CDialogExâ€œå¤±å»ç„¦ç‚¹â€çš„è§£å†³æ–¹æ³•>CFileDialogå¯¼è‡´CDialogExâ€œå¤±å»ç„¦ç‚¹â€çš„è§£å†³æ–¹æ³•</a></li><li><a href=#%e7%aa%97%e5%8f%a3%e5%90%af%e7%94%a8%e8%a7%86%e8%a7%89%e6%a0%b7%e5%bc%8f aria-label=çª—å£å¯ç”¨è§†è§‰æ ·å¼>çª—å£å¯ç”¨è§†è§‰æ ·å¼</a></li><li><a href=#%e4%bb%bb%e5%8a%a1%e6%a0%8f%e6%98%be%e7%a4%ba%e8%bf%9b%e5%ba%a6 aria-label=ä»»åŠ¡æ æ˜¾ç¤ºè¿›åº¦>ä»»åŠ¡æ æ˜¾ç¤ºè¿›åº¦</a></li><li><a href=#%e6%9c%aa%e5%ae%8c%e5%be%85%e7%bb%ad%e6%8c%81%e7%bb%ad%e6%9b%b4%e6%96%b0%e4%b8%ad aria-label=æœªå®Œå¾…ç»­ï¼ŒæŒç»­æ›´æ–°ä¸­&mldr;>æœªå®Œå¾…ç»­ï¼ŒæŒç»­æ›´æ–°ä¸­&mldr;</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=å‰è¨€>å‰è¨€<a hidden class=anchor aria-hidden=true href=#å‰è¨€>#</a></h2><p>ç”±äºæˆ‘å¾ˆå°‘ç”¨MFCï¼Œåªæœ‰å·¥ä½œä¸Šéœ€è¦çš„æ—¶å€™æ‰ä¼šç”¨åˆ°ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæ˜¯ä¸ªæ–°æ‰‹ï¼Œé‡åˆ°é—®é¢˜éœ€è¦åˆ°ç½‘ä¸Šæ‰¾å¾ˆä¹…èµ„æ–™ã€‚è¿™é‡Œåªæ˜¯è®°å½•ä¸€äº›ç‰¹æ®Šæƒ…æ™¯ä¸‹ä¼šç”¨åˆ°çš„æŠ€å·§ï¼Œæ–¹ä¾¿ä»¥åæŸ¥æ‰¾ã€‚</p><h2 id=éšè—çª—å£ä»»åŠ¡æ å›¾æ ‡>éšè—çª—å£ä»»åŠ¡æ å›¾æ ‡<a hidden class=anchor aria-hidden=true href=#éšè—çª—å£ä»»åŠ¡æ å›¾æ ‡>#</a></h2><p>è¿™ä¸ªé—®é¢˜æˆ‘åœ¨ç½‘ä¸Šæ‰¾äº†å¾ˆä¹…ï¼Œå¤§è‡´æœ‰ä¸¤ç§æ–¹æ¡ˆï¼š</p><p><strong>ä¿®æ”¹çª—å£çš„æ‰©å±•æ ·å¼</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>ModifyStyleEx</span><span class=p>(</span><span class=n>WS_EX_APPWINDOW</span><span class=p>,</span><span class=n>WS_EX_TOOLWINDOW</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½†æ˜¯è¿™æ ·åšä¼šå¯¼è‡´æ•´ä¸ªçª—å£çš„æ ·å¼ä¼šå˜å¾—å¾ˆéš¾çœ‹ã€‚</p><p><strong>å°†ä¸€ä¸ªéšè—çª—å£è®¾ç½®æˆä¸»çª—å£çš„çˆ¶çª—å£</strong></p><p>è¿™æ ·åšæ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”ä»»åŠ¡è§†å›¾ä¸‹ä¹Ÿä¸èƒ½å†çœ‹åˆ°çª—å£ï¼Œæ˜¾ç„¶ä¸æ˜¯æˆ‘æƒ³è¦çš„æ•ˆæœã€‚</p><p>æœ€åç»ˆäºæ‰¾åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒå®Œç¾çš„è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡COMçš„æ–¹å¼ç§»é™¤ä»»åŠ¡æ åˆ—è¡¨ä¸­çš„å›¾æ ‡ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>// æ˜¾ç¤º/éšè—ä»»åŠ¡æ å›¾æ ‡(COMæ–¹å¼)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>bool</span> <span class=nf>ShowInTaskbar</span><span class=p>(</span><span class=n>HWND</span> <span class=n>hWnd</span><span class=p>,</span> <span class=kt>bool</span> <span class=n>isShow</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=n>CoInitialize</span><span class=p>(</span><span class=k>nullptr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>ITaskbarList</span><span class=o>*</span> <span class=n>pTaskbarList</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=n>HRESULT</span> <span class=n>hr</span> <span class=o>=</span> <span class=n>CoCreateInstance</span><span class=p>(</span><span class=n>CLSID_TaskbarList</span><span class=p>,</span> <span class=k>nullptr</span><span class=p>,</span> <span class=n>CLSCTX_INPROC_SERVER</span><span class=p>,</span> <span class=n>IID_ITaskbarList</span><span class=p>,</span> <span class=p>(</span><span class=kt>void</span><span class=o>**</span><span class=p>)</span><span class=o>&amp;</span><span class=n>pTaskbarList</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=n>SUCCEEDED</span><span class=p>(</span><span class=n>hr</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>pTaskbarList</span><span class=o>-&gt;</span><span class=n>HrInit</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=n>isShow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=n>pTaskbarList</span><span class=o>-&gt;</span><span class=n>AddTab</span><span class=p>(</span><span class=n>hWnd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=k>else</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=n>pTaskbarList</span><span class=o>-&gt;</span><span class=n>DeleteTab</span><span class=p>(</span><span class=n>hWnd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=n>CoUninitialize</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>CoUninitialize</span><span class=p>();</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=ç¨‹åºå¯åŠ¨æ—¶é»˜è®¤éšè—çª—å£>ç¨‹åºå¯åŠ¨æ—¶é»˜è®¤éšè—çª—å£<a hidden class=anchor aria-hidden=true href=#ç¨‹åºå¯åŠ¨æ—¶é»˜è®¤éšè—çª—å£>#</a></h2><p>ä¸€ç§æ¯”è¾ƒç®€å•çš„æ–¹æ³•æ˜¯åœ¨ç¨‹åºå¯åŠ¨æ—¶å°†çª—å£ç§»åŠ¨åˆ°å±å¹•å¤–çš„ä¸å¯è§åŒºåŸŸã€‚
å¦‚æœç›´æ¥åœ¨<code>OnInitDialog</code>ä¸­è®¾ç½®<code>ShowWindow(SW_HIDE)</code>æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºæ­¤æ—¶çª—å£è¿˜æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œè‡ªç„¶ä¹Ÿæ— æ³•éšè—ã€‚</p><p>è¿™é‡Œçš„æ€è·¯æ˜¯åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™å…ˆå°†çª—å£ç§»åŠ¨åˆ°å±å¹•å¤–ï¼Œç„¶åé€šè¿‡å¦ä¸€ä¸ªçº¿ç¨‹å°†çª—å£éšè—èµ·æ¥ï¼Œè¿™æ ·åšè™½ç„¶ç¨‹åºå¯åŠ¨åçª—å£è¿˜æ˜¯ä¼šä¸€é—ªå³é€ï¼Œä½†ç”±äºæ˜¯åœ¨å±å¹•ä¹‹å¤–ï¼Œå®é™…ä¸Šå¹¶ä¸èƒ½çœ‹åˆ°ï¼Œç„¶ååœ¨çª—å£éœ€è¦æ˜¾ç¤ºçš„æ—¶å€™è°ƒç”¨<code>ShowWindow(SW_SHOW)</code>å³å¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>// CxxxDlg.h å¤´æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#include</span> <span class=cpf>&lt;future&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CxxxDlg</span> <span class=o>:</span> <span class=k>public</span> <span class=n>CDialogEx</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>std</span><span class=o>::</span><span class=n>future</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>hideTask</span><span class=p>;</span>  <span class=c1>// åå°éšè—çª—å£çº¿ç¨‹
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>BOOL</span> <span class=n>CxxxDlg</span><span class=o>::</span><span class=n>OnInitDialog</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>CRect</span> <span class=n>rcClient</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=n>GetWindowRect</span><span class=p>(</span><span class=o>&amp;</span><span class=n>rcClient</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// å°†çª—å£ç§»åŠ¨åˆ°å±å¹•å¤–
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>MoveWindow</span><span class=p>(</span><span class=o>-</span><span class=n>rcClient</span><span class=p>.</span><span class=n>Width</span><span class=p>(),</span> <span class=n>rcClient</span><span class=p>.</span><span class=n>top</span><span class=p>,</span> <span class=n>rcClient</span><span class=p>.</span><span class=n>Width</span><span class=p>(),</span> <span class=n>rcClient</span><span class=p>.</span><span class=n>Height</span><span class=p>());</span>
</span></span><span class=line><span class=cl>	<span class=c1>// æ–°å»ºçº¿ç¨‹ï¼Œå»¶æ—¶1såéšè—çª—å£
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=n>hideTask</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>async</span><span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=n>std</span><span class=o>::</span><span class=n>launch</span><span class=o>::</span><span class=n>async</span><span class=p>,</span> <span class=p>[</span><span class=o>&amp;</span><span class=p>]</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>std</span><span class=o>::</span><span class=n>this_thread</span><span class=o>::</span><span class=n>sleep_for</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>chrono</span><span class=o>::</span><span class=n>seconds</span><span class=p>(</span><span class=mi>1</span><span class=p>));</span>
</span></span><span class=line><span class=cl>		<span class=c1>// ShowWindow(SW_HIDE);
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=n>ShowWindowAsync</span><span class=p>(</span><span class=n>m_hWnd</span><span class=p>,</span> <span class=n>SW_HIDE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=n>std</span><span class=o>::</span><span class=n>this_thread</span><span class=o>::</span><span class=n>sleep_for</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>chrono</span><span class=o>::</span><span class=n>seconds</span><span class=p>(</span><span class=mi>1</span><span class=p>));</span>
</span></span><span class=line><span class=cl>		<span class=c1>// å»¶æ—¶1sï¼Œå¾…çª—å£å®Œå…¨éšè—åå†å°†çª—å£å±…ä¸­
</span></span></span><span class=line><span class=cl><span class=c1></span>		<span class=n>CenterWindow</span><span class=p>();</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>TRUE</span><span class=p>;</span>  <span class=c1>// é™¤éå°†ç„¦ç‚¹è®¾ç½®åˆ°æ§ä»¶ï¼Œå¦åˆ™è¿”å› TRUE
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=ç‚¹å‡»å…³é—­æ—¶éšè—çª—å£>ç‚¹å‡»å…³é—­æ—¶éšè—çª—å£<a hidden class=anchor aria-hidden=true href=#ç‚¹å‡»å…³é—­æ—¶éšè—çª—å£>#</a></h2><p>æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›åœ¨ç‚¹å‡»ä¸»çª—å£çš„å…³é—­æŒ‰é’®ä¹‹åå°†çª—å£éšè—æˆ–è€…æœ€å°åŒ–ï¼Œè€Œä¸æ˜¯é€€å‡ºç¨‹åºã€‚è¿™æ—¶åªéœ€è¦æ‹¦æˆªæ‰çª—å£çš„å…³é—­æ¶ˆæ¯å³å¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>// CxxxDlg.h å¤´æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>CxxxDlg</span> <span class=o>:</span> <span class=k>public</span> <span class=n>CDialogEx</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>protected</span><span class=o>:</span>
</span></span><span class=line><span class=cl>	<span class=n>afx_msg</span> <span class=kt>void</span> <span class=n>OnSysCommand</span><span class=p>(</span><span class=n>UINT</span> <span class=n>nID</span><span class=p>,</span> <span class=n>LPARAM</span> <span class=n>lParam</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>CxxxDlg</span><span class=o>::</span><span class=n>OnSysCommand</span><span class=p>(</span><span class=n>UINT</span> <span class=n>nID</span><span class=p>,</span> <span class=n>LPARAM</span> <span class=n>lParam</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>/////////////////////////////////////
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=c1>// è¿™é‡Œæ•è·çª—å£çš„å…³é—­æ¶ˆæ¯
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=c1>// ä¸ç›´æ¥å…³é—­çª—å£ï¼Œè€Œæ˜¯éšè—èµ·æ¥
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span> <span class=p>(</span><span class=n>nID</span> <span class=o>==</span> <span class=n>SC_CLOSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>ShowWindowAsync</span><span class=p>(</span><span class=n>m_hWnd</span><span class=p>,</span> <span class=n>SW_HIDE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=c1>/////////////////////////////////////
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>else</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=n>CDialogEx</span><span class=o>::</span><span class=n>OnSysCommand</span><span class=p>(</span><span class=n>nID</span><span class=p>,</span> <span class=n>lParam</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™æ ·å°±å¯ä»¥æ‹¦æˆªæ‰çª—å£çš„å…³é—­æ¶ˆæ¯äº†ï¼Œè¿™æ ·ä¸ä»…ä»…æ˜¯ç‚¹å‡»å…³é—­æŒ‰é’®æ—¶ä¼šéšè—çª—å£ï¼Œé€šè¿‡çª—å£èœå•å…³é—­çª—å£æˆ–æ˜¯ä½¿ç”¨<code>Alt+F4</code>éƒ½ä¸èƒ½çœŸæ­£å…³é—­çª—å£ã€‚é‚£ä¹ˆæˆ‘æ€æ ·æ‰èƒ½é€€å‡ºç¨‹åºå‘¢ï¼Œæ€»ä¸èƒ½ç”¨ä»»åŠ¡ç®¡ç†å™¨å§ã€‚</p><p>å…¶å®å¾ˆç®€å•ï¼Œåœ¨éœ€è¦é€€å‡ºç¨‹åºçš„æ—¶å€™å‘çª—å£å‘é€<code>WM_CLOSE</code>æ¶ˆæ¯å³å¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>SendMessage</span><span class=p>(</span><span class=n>WM_CLOSE</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=cfiledialogå¯¼è‡´cdialogexå¤±å»ç„¦ç‚¹çš„è§£å†³æ–¹æ³•><code>CFileDialog</code>å¯¼è‡´<code>CDialogEx</code>â€œå¤±å»ç„¦ç‚¹â€çš„è§£å†³æ–¹æ³•<a hidden class=anchor aria-hidden=true href=#cfiledialogå¯¼è‡´cdialogexå¤±å»ç„¦ç‚¹çš„è§£å†³æ–¹æ³•>#</a></h2><p>ç»§æ‰¿è‡ª<code>CDialogEx</code>çš„çª—å£åœ¨ä½¿ç”¨<code>CFileDialog</code>ä¹‹åä¼šå¯¼è‡´çª—å£æ ‡é¢˜æ å˜æˆç°è‰²ï¼Œå¾ˆåƒæ˜¯çª—å£å¤±å»äº†ç„¦ç‚¹ï¼Œæ­¤æ—¶çª—å£ä»ç„¶èƒ½å¤Ÿæ­£å¸¸æ“ä½œï¼Œä½†å³ä½¿é¼ æ ‡ç‚¹å‡»åœ¨çª—å£ä¸Šçª—å£çš„æ ‡é¢˜æ ä¾æ—§æ˜¯ç°è‰²ï¼Œæ— æ³•æ¢å¤åˆ°çª—å£æ¿€æ´»çŠ¶æ€çš„é¢œè‰²ï¼Œå³ä½¿å°†çª—å£å±æ€§è®¾ç½®ä¸º<code>WS_EX_TOPMOST</code>ï¼ˆç½®é¡¶ï¼‰ä¾æ—§æ˜¯è¿™æ ·ï¼Œå¿…é¡»ç‚¹å‡»çª—å£å¤–çš„å…¶å®ƒåŒºåŸŸæˆ–è€…ä½¿ç”¨Tabåˆ‡æ¢ä¸€ä¸‹æ‰èƒ½æ¢å¤æ­£å¸¸ã€‚</p><p>è€Œç»§æ‰¿è‡ª<code>CDialog</code>çš„çª—å£åˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†çª—å£çš„åŸºç±»æ”¹æˆ<code>CDialog</code>æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚å¯¹äºæˆ‘è¿™æ ·çš„å¼ºè¿«ç—‡æ¥è¯´æ˜¯æ— æ³•å¿å—çš„ï¼Œæ‰€ä»¥ç”¨å°½åƒæ–¹ç™¾è®¡ç»ˆäºæ‰¾åˆ°äº†ä¸€ä¸ªå¯è¡Œçš„è§£å†³æ–¹æ¡ˆã€‚</p><p>ç»è¿‡å°è¯•ï¼Œå•çº¯è®©çª—å£è·å–ç„¦ç‚¹æˆ–è€…å°†çª—å£æ”¾åˆ°å‰å°çš„æ–¹æ³•éƒ½æ˜¯æ— æ•ˆçš„ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>CFileDialog</span> <span class=nf>dlg</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=n>TRUE</span><span class=p>,</span> <span class=n>_T</span><span class=p>(</span><span class=s>&#34;ini&#34;</span><span class=p>),</span> <span class=k>nullptr</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=n>OFN_HIDEREADONLY</span> <span class=o>|</span> <span class=n>OFN_OVERWRITEPROMPT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=n>_T</span><span class=p>(</span><span class=s>&#34;ini(*.ini)|*.ini|TEXT(*.txt)|*.txt|&#34;</span><span class=p>),</span> <span class=k>this</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>auto</span> <span class=n>dlgResult</span> <span class=o>=</span> <span class=n>dlg</span><span class=p>.</span><span class=n>DoModal</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æ— æ•ˆçš„æ–¹æ³•
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>this</span><span class=o>-&gt;</span><span class=n>SetFocus</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=k>this</span><span class=o>-&gt;</span><span class=n>SetForegroundWindow</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰€ä»¥åªèƒ½æ›²çº¿æ•‘å›½ï¼Œæ—¢ç„¶é€šè¿‡æ‰‹åŠ¨åˆ‡æ¢çš„æ–¹å¼å¯ä»¥æ¢å¤åˆ°æ­£å¸¸çŠ¶æ€ï¼Œä¸å¦¨å…ˆåˆ‡æ¢åˆ°å…¶å®ƒçª—å£å†åˆ‡æ¢å›æ¥ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>CFileDialog</span> <span class=nf>dlg</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=n>TRUE</span><span class=p>,</span> <span class=n>_T</span><span class=p>(</span><span class=s>&#34;ini&#34;</span><span class=p>),</span> <span class=k>nullptr</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=n>OFN_HIDEREADONLY</span> <span class=o>|</span> <span class=n>OFN_OVERWRITEPROMPT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=n>_T</span><span class=p>(</span><span class=s>&#34;ini(*.ini)|*.ini|TEXT(*.txt)|*.txt|&#34;</span><span class=p>),</span> <span class=k>this</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>auto</span> <span class=n>dlgResult</span> <span class=o>=</span> <span class=n>dlg</span><span class=p>.</span><span class=n>DoModal</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// å…ˆå°†ç„¦ç‚¹æ”¾åˆ°æ¡Œé¢ï¼Œå†åˆ‡æ¢å›æœ¬çª—å£
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>::</span><span class=n>SetForegroundWindow</span><span class=p>(</span><span class=o>::</span><span class=n>GetDesktopWindow</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=k>this</span><span class=o>-&gt;</span><span class=n>SetForegroundWindow</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span></code></pre></td></tr></table></div></div><p>å®Œç¾è§£å†³äº†é—®é¢˜ã€‚</p><h2 id=çª—å£å¯ç”¨è§†è§‰æ ·å¼>çª—å£å¯ç”¨è§†è§‰æ ·å¼<a hidden class=anchor aria-hidden=true href=#çª—å£å¯ç”¨è§†è§‰æ ·å¼>#</a></h2><p>å¯ç”¨è§†è§‰æ ·å¼ä¹‹åï¼Œå¯ä»¥è®©ç¨‹åºçœ‹èµ·æ¥æ›´åŠ ç°ä»£åŒ–ä¸€äº›ï¼Œåªæ”¯æŒWindow XPä»¥åçš„ç³»ç»Ÿã€‚
å¯ä»¥é€šè¿‡ä¸ºç¨‹åºæ·»åŠ æ¸…å•æ–‡ä»¶æ¥å®ç°ï¼Œä¸è¿‡æ¯”è¾ƒéº»çƒ¦ã€‚åœ¨VC++ 2005ä¹‹åï¼Œç›´æ¥æ·»åŠ ç¼–è¯‘å™¨æŒ‡ä»¤åˆ°ä»£ç ä¸­å°±å¯ä»¥äº†ã€‚</p><p>åœ¨é¢„ç¼–è¯‘å¤´æ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢ä»£ç å³å¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#if defined _M_IX86
</span></span></span><span class=line><span class=cl><span class=cp>#pragma comment(linker,&#34;/manifestdependency:\&#34;type=&#39;win32&#39; name=&#39;Microsoft.Windows.Common-Controls&#39; version=&#39;6.0.0.0&#39; processorArchitecture=&#39;x86&#39; publicKeyToken=&#39;6595b64144ccf1df&#39; language=&#39;*&#39;\&#34;&#34;)
</span></span></span><span class=line><span class=cl><span class=cp>#elif defined _M_IA64
</span></span></span><span class=line><span class=cl><span class=cp>#pragma comment(linker,&#34;/manifestdependency:\&#34;type=&#39;win32&#39; name=&#39;Microsoft.Windows.Common-Controls&#39; version=&#39;6.0.0.0&#39; processorArchitecture=&#39;ia64&#39; publicKeyToken=&#39;6595b64144ccf1df&#39; language=&#39;*&#39;\&#34;&#34;)
</span></span></span><span class=line><span class=cl><span class=cp>#elif defined _M_X64
</span></span></span><span class=line><span class=cl><span class=cp>#pragma comment(linker,&#34;/manifestdependency:\&#34;type=&#39;win32&#39; name=&#39;Microsoft.Windows.Common-Controls&#39; version=&#39;6.0.0.0&#39; processorArchitecture=&#39;amd64&#39; publicKeyToken=&#39;6595b64144ccf1df&#39; language=&#39;*&#39;\&#34;&#34;)
</span></span></span><span class=line><span class=cl><span class=cp>#else
</span></span></span><span class=line><span class=cl><span class=cp>#pragma comment(linker,&#34;/manifestdependency:\&#34;type=&#39;win32&#39; name=&#39;Microsoft.Windows.Common-Controls&#39; version=&#39;6.0.0.0&#39; processorArchitecture=&#39;*&#39; publicKeyToken=&#39;6595b64144ccf1df&#39; language=&#39;*&#39;\&#34;&#34;)
</span></span></span><span class=line><span class=cl><span class=cp>#endif
</span></span></span></code></pre></td></tr></table></div></div><h2 id=ä»»åŠ¡æ æ˜¾ç¤ºè¿›åº¦>ä»»åŠ¡æ æ˜¾ç¤ºè¿›åº¦<a hidden class=anchor aria-hidden=true href=#ä»»åŠ¡æ æ˜¾ç¤ºè¿›åº¦>#</a></h2><p>ä¸ºçª—å£çš„ä»»åŠ¡æ å›¾æ ‡æ·»åŠ è¿›åº¦æ˜¾ç¤ºï¼Œä¹Ÿå¯ä»¥ä¸ºä»»åŠ¡æ æ·»åŠ æŒ‰é’®ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>ITaskbarList3</span><span class=o>*</span> <span class=n>pTaskbar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// åˆå§‹åŒ–COMç»„ä»¶
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>CoInitialize</span><span class=p>(</span><span class=nb>NULL</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>CoCreateInstance</span><span class=p>(</span><span class=n>CLSID_TaskbarList</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=n>CLSCTX_INPROC_SERVER</span><span class=p>,</span> <span class=n>IID_PPV_ARGS</span><span class=p>(</span><span class=o>&amp;</span><span class=n>pTaskbar</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// TBPF_NOPROGRESS	= 0,        // æ­£å¸¸çŠ¶æ€ï¼Œä¸æ˜¾ç¤ºè¿›åº¦
</span></span></span><span class=line><span class=cl><span class=c1>// TBPF_INDETERMINATE	= 0x1,  // å¿™ç¢ŒçŠ¶æ€ï¼Œä¸æ˜¾ç¤ºè¿›åº¦
</span></span></span><span class=line><span class=cl><span class=c1>// TBPF_NORMAL	= 0x2,          // æ­£å¸¸çŠ¶æ€ï¼Œæ˜¾ç¤ºè¿›åº¦ï¼ˆç»¿è‰²ï¼‰
</span></span></span><span class=line><span class=cl><span class=c1>// TBPF_ERROR	= 0x4,          // é”™è¯¯çŠ¶æ€ï¼Œæ˜¾ç¤ºè¿›åº¦ï¼ˆçº¢è‰²ï¼‰
</span></span></span><span class=line><span class=cl><span class=c1>// TBPF_PAUSED	= 0x8           // åœæ­¢çŠ¶æ€ï¼Œæ˜¾ç¤ºè¿›åº¦ï¼ˆé»„è‰²ï¼‰
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>pTaskbar</span><span class=o>-&gt;</span><span class=n>SetProgressState</span><span class=p>(</span><span class=n>GetSafeHwnd</span><span class=p>(),</span> <span class=n>TBPF_NORMAL</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>pTaskbar</span><span class=o>-&gt;</span><span class=n>SetProgressValue</span><span class=p>(</span><span class=n>GetSafeHwnd</span><span class=p>(),</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>100</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// è®¾ç½®æç¤ºä¿¡æ¯
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>pTaskbar</span><span class=o>-&gt;</span><span class=n>SetThumbnailTooltip</span><span class=p>(</span><span class=n>GetSafeHwnd</span><span class=p>(),</span> <span class=n>TEXT</span><span class=p>(</span><span class=s>&#34;Tooltip&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// è®¾ç½®è¦†ç›–å›¾æ ‡
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>HICON</span> <span class=n>hIcon</span> <span class=o>=</span> <span class=n>AfxGetApp</span><span class=p>()</span><span class=o>-&gt;</span><span class=n>LoadIcon</span><span class=p>(</span><span class=n>IDI_ICON_ERR</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>pTaskbar</span><span class=o>-&gt;</span><span class=n>SetOverlayIcon</span><span class=p>(</span><span class=n>GetSafeHwnd</span><span class=p>(),</span> <span class=n>hIcon</span><span class=p>,</span> <span class=n>_T</span><span class=p>(</span><span class=s>&#34;Error&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æ·»åŠ ä»»åŠ¡æ æŒ‰é’®
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>THUMBBUTTONMASK</span> <span class=n>dwMask</span> <span class=o>=</span> <span class=n>THB_ICON</span> <span class=o>|</span> <span class=n>THB_TOOLTIP</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>THUMBBUTTON</span> <span class=n>buttons</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>buttons</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>iId</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>buttons</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>dwMask</span> <span class=o>=</span> <span class=n>dwMask</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>buttons</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>hIcon</span> <span class=o>=</span> <span class=n>hIcon</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>memcpy</span><span class=p>(</span><span class=n>buttons</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>szTip</span><span class=p>,</span> <span class=n>TEXT</span><span class=p>(</span><span class=s>&#34;Tooltip&#34;</span><span class=p>),</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>buttons</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>szTip</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>pTaskbar</span><span class=o>-&gt;</span><span class=n>ThumbBarAddButtons</span><span class=p>(</span><span class=n>GetSafeHwnd</span><span class=p>(),</span> <span class=mi>3</span><span class=p>,</span> <span class=n>buttons</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æœ€åé‡Šæ”¾COMç»„ä»¶
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>CoUninitialize</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æœªå®Œå¾…ç»­æŒç»­æ›´æ–°ä¸­>æœªå®Œå¾…ç»­ï¼ŒæŒç»­æ›´æ–°ä¸­&mldr;<a hidden class=anchor aria-hidden=true href=#æœªå®Œå¾…ç»­æŒç»­æ›´æ–°ä¸­>#</a></h2><p><strong>å‚è€ƒ</strong></p><p><a href=https://blog.csdn.net/wgxh05/article/details/83415463>MFCç®€å•çš„å¯åŠ¨æ—¶éšè—ç•Œé¢æ–¹å¼(ä»…å¯åŠ¨æ—¶éšè—)</a></p><p><a href=https://docs.microsoft.com/zh-cn/windows/win32/controls/cookbook-overview>Enabling Visual Styles</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://kira-96.github.io/tags/mfc/>MFC</a></li></ul><nav class=paginav><a class=prev href=https://kira-96.github.io/posts/%E4%B8%89%E7%BB%B4%E5%9B%BE%E5%BD%A2%E7%9F%A9%E9%98%B5%E5%8F%98%E6%8D%A2/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>ä¸‰ç»´å›¾å½¢çŸ©é˜µå˜æ¢</span>
</a><a class=next href=https://kira-96.github.io/posts/%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96windows10%E4%B8%BB%E9%A2%98%E9%A2%9C%E8%89%B2/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>å¦‚ä½•è·å–Windows10ä¸»é¢˜é¢œè‰²</span></a></nav></footer><script src=https://utteranc.es/client.js repo=kira-96/kira-96.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>Copyright Â© 2019-2024 <a href=/>kira&rsquo;s blog</a> Â·</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>