[{"content":"éŸ³ä¹ Listen1 éŸ³ä¹æ’­æ”¾å™¨ [Windows/Linux/MacOS/Android]\nYesPlayMusic é«˜é¢œå€¼çš„ç¬¬ä¸‰æ–¹ç½‘æ˜“äº‘æ’­æ”¾å™¨ [Windows/Linux/MacOS]\nAIMP [Windows/Android]\nDopamine [Windows]\nè§†é¢‘ PotPlayer [Windows]\nMPC-BE [Windows]\nQQå½±éŸ³ [Window/MacOS/Android/iOS]\nMX Player [Android]\nç¾å›¾ä¸‹è½½ Pixiviz\npixivFANBOX\nSauceNAO\nPixEz [Android/iOS]\nä¸‹è½½ Flud ç§å­ä¸‹è½½å™¨ [Android]\nInternet Download Manager [Windows]\nFree Download Manager [Windows/MacOS/Linux/Android]\nMotrix [Windows/MacOS/Linux]\næˆªå›¾ã€å½•å± PixPin [Windows/MacOS]\nSnipaste [Windows/MacOS]\nGifCam [Windows]\nVeryCapture [Windows]\nScreenToGif [Windows]\nOBS Studio [Windows/Linux/MacOS]\npaint.net [Windows]\nå†™ä½œ Visual Studio Code [Windows/MacOS/Linux]\nTypora [Windows/MacOS/Linux] (ä»˜è´¹ä½¿ç”¨)\nMarkText [Window/MacOS/Linux]\nTypedown [Windows]\nJoplin [Windows/MacOS/Linux/Android/iOS]\nObsidian [Windows/MacOS/Linux/Android/iOS]\nå…¶å®ƒå·¥å…· Firefox [Windows/MacOS/Linux/Android/iOS]\nPowerToys [Windows]\nDevToys [Windows]\nWatt Toolkit [Windows/MacOS/Linux/Android/iOS]\nCrystal Disk Mark [Windows]\nGeek Uninstaller [Windows]\n7-Zip [Windows]\nZArchiver [Android]\nDism++ [Windows]\nLive2DViewerEX [Windows/Android]\nKeePass [Windows/MacOS/Linux/Android/iOS/\u0026hellip;]\nWinSCP [Windows]\nLocalSend [Windows/MacOS/Linux/Android/iOS/\u0026hellip;]\nWireShark [Windows/MacOS/Linux]\nDICOM Dump [Windows]\nInno Setup [Windows]\nOh My Posh [Windows/MacOS/Linux]\nTermius [Windows/MacOS/Linux/Android/iOS]\ntermux [Android]\nAurora Store [Android]\nVentoy [Windows/Linux]\nRufus [Windows]\nputty [Windows/Linux/MacOS]\næ¨¡æ‹Ÿå™¨ PPSSPP - A PSP emulator [Windows/MacOS/Linux/Android/iOS]\nYuzu â€“ ä»»å¤©å ‚ Switch æ¨¡æ‹Ÿå™¨ [Windows | Android | Linux | MacOS | iOS]\nRyujinx - Nintendo Switch Emulator [Windows/Linux/MacOS]\nCemu - Wii U Emulator [Windows]\nDolphin - ä»»å¤©å ‚ GameCube å’Œ Wii æ¨¡æ‹Ÿå™¨ [Windows/MacOS/Linux]\nRPCS3 - The PlayStation 3 Emulator [Windows/Linux/MacOS/FreeBSD]\nXenia - Xbox 360 Research Emulator [Windows]\nPS Remote Play [Windows/MacOS/Android/iOS]\nChiaki - Free and Open Source PlayStation Remote Play Client [Windows/Linux/MacOS/Android/Switch]\nå¼€æºå­—ä½“ Fira Code\nCascadia Code\nNerd Fonts\næ€æºé»‘ä½“\næ€æºå®‹ä½“\né˜¿é‡Œå·´å·´æ™®æƒ ä½“\nHarmonyOS Sans\nMiSans\nOPPO Sans\n","permalink":"https://kira-96.github.io/posts/%E4%B8%AA%E4%BA%BA%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%88%86%E4%BA%AB/","summary":"\u003ch2 id=\"éŸ³ä¹\"\u003eéŸ³ä¹\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"http://listen1.github.io/listen1/\"\u003eListen1 éŸ³ä¹æ’­æ”¾å™¨\u003c/a\u003e [Windows/Linux/MacOS/Android]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/qier222/YesPlayMusic\"\u003eYesPlayMusic é«˜é¢œå€¼çš„ç¬¬ä¸‰æ–¹ç½‘æ˜“äº‘æ’­æ”¾å™¨\u003c/a\u003e [Windows/Linux/MacOS]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.aimp.ru/\"\u003eAIMP\u003c/a\u003e [Windows/Android]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://www.digimezzo.com/software/dopamine/\"\u003eDopamine\u003c/a\u003e [Windows]\u003c/p\u003e\n\u003ch2 id=\"è§†é¢‘\"\u003eè§†é¢‘\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://daumpotplayer.com/\"\u003ePotPlayer\u003c/a\u003e [Windows]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://sourceforge.net/projects/mpcbe/\"\u003eMPC-BE\u003c/a\u003e [Windows]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://player.qq.com/\"\u003eQQå½±éŸ³\u003c/a\u003e [Window/MacOS/Android/iOS]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://mxplayerdownload.co/\"\u003eMX Player\u003c/a\u003e [Android]\u003c/p\u003e\n\u003ch2 id=\"ç¾å›¾ä¸‹è½½\"\u003eç¾å›¾ä¸‹è½½\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://pixiviz.pwp.app\"\u003ePixiviz\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.fanbox.cc\"\u003epixivFANBOX\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://saucenao.com\"\u003eSauceNAO\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/Notsfsssf/pixez-flutter\"\u003ePixEz\u003c/a\u003e [Android/iOS]\u003c/p\u003e\n\u003ch2 id=\"ä¸‹è½½\"\u003eä¸‹è½½\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"./\"\u003eFlud ç§å­ä¸‹è½½å™¨\u003c/a\u003e [Android]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://idman.ysepan.com/\"\u003eInternet Download Manager\u003c/a\u003e [Windows]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.freedownloadmanager.org/\"\u003eFree Download Manager\u003c/a\u003e [Windows/MacOS/Linux/Android]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://motrix.app/\"\u003eMotrix\u003c/a\u003e [Windows/MacOS/Linux]\u003c/p\u003e\n\u003ch2 id=\"æˆªå›¾å½•å±\"\u003eæˆªå›¾ã€å½•å±\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://pixpinapp.com/\"\u003ePixPin\u003c/a\u003e [Windows/MacOS]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://zh.snipaste.com/\"\u003eSnipaste\u003c/a\u003e [\u003ca href=\"https://www.microsoft.com/store/apps/9P1WXPKB68KX\"\u003eWindows\u003c/a\u003e/MacOS]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://blog.bahraniapps.com/gifcam/\"\u003eGifCam\u003c/a\u003e [Windows]\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://verycapture.com/cn/index.html\"\u003eVeryCapture\u003c/a\u003e [Windows]\u003c/p\u003e","title":"ä¸ªäººå¸¸ç”¨è½¯ä»¶åˆ†äº«"},{"content":"è½¯ä»¶åŒ… epics-modules/asyn: EPICS module for driver and device support epics-modules/busy: APS BCDA synApps module epics-modules/sequencer: The EPICS SNL Compiler and Sequencer DiamondLightSource/procServControl: EPICS/CA control of running procServ instances ralphlange/procServ: Wrapper to start arbitrary interactive commands in the background, with telnet or Unix domain socket access to stdin/stdout ç¼–è¯‘è½¯ä»¶åŒ… asyn æ­£å¸¸äº¤å‰ç¼–è¯‘ã€‚\nbusy ğŸ’¡ æç¤º ç¼–è¯‘busyæ¨¡å—æ—¶éœ€è¦ç”¨åˆ°autosaveï¼Œå¦‚æœä¸éœ€è¦ç¼–è¯‘busyæµ‹è¯•ç¨‹åºï¼Œå¯ä»¥æ³¨é‡Šconfigure/RELEASEä¸­çš„AUTOSAVEå®šä¹‰ã€‚\næ­£å¸¸äº¤å‰ç¼–è¯‘ã€‚\nsequencer â„¹ï¸ Title ç¼–è¯‘sequenceræ¨¡å—éœ€è¦ç”¨åˆ°re2cï¼Œå¯é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…ã€‚ apt install re2c\næ­£å¸¸äº¤å‰ç¼–è¯‘ã€‚\nprocServControl ä¿®æ”¹configure/RELEASEï¼š configure/RELEASE \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 index 244da04..98d30ca 100644 --- a/configure/RELEASE +++ b/configure/RELEASE @@ -20,15 +20,15 @@ # CONFIG_SITE file. TEMPLATE_TOP=$(EPICS_BASE)/templates/makeBaseApp/top -SUPPORT=/dls_sw/prod/R3.14.12.7/support +SUPPORT=/home/kira/epics/epics-modules # If using the sequencer, point SNCSEQ at its top directory: -SNCSEQ=$(SUPPORT)/seq/2-2-5dls1 -ASYN=$(SUPPORT)/asyn/4-41 -BUSY=$(SUPPORT)/busy/1-7-2dls5 +SNCSEQ=$(SUPPORT)/sequencer +ASYN=$(SUPPORT)/asyn +BUSY=$(SUPPORT)/busy # EPICS_BASE usually appears last so other apps can override stuff: -EPICS_BASE=/dls_sw/epics/R3.14.12.7/base +EPICS_BASE=/home/kira/epics/base-7.0.9 # Set RULES here if you want to take build rules from somewhere # other than EPICS_BASE: å¦‚æœéœ€è¦äº¤å‰ç¼–è¯‘ï¼Œä¿®æ”¹configure/CONFIG_SITEï¼š configure/CONFIG_SITE \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 index f30c124..53c5e23 100644 --- a/configure/CONFIG_SITE +++ b/configure/CONFIG_SITE @@ -19,7 +19,7 @@ CHECK_RELEASE = YES # Set this when you only want to compile this application # for a subset of the cross-compiled target architectures # that Base is built for. -CROSS_COMPILER_TARGET_ARCHS = +CROSS_COMPILER_TARGET_ARCHS = linux-loong64 # To install files into a location other than $(TOP) define # INSTALL_LOCATION here. ç¼–è¯‘ shell \u0026#9660; 1 make -j procServ æ„å»º shell \u0026#9660; 1 2 3 4 5 autoreconf -fi # é…ç½®äº¤å‰ç¼–è¯‘å™¨ ./configure --host=loongarch64-linux-gnu CC=loongarch64-linux-gnu-gcc --disable-doc # ç¼–è¯‘ make -j ç¼–è¯‘å®Œæˆåº”è¯¥å¯ä»¥çœ‹åˆ°å½“å‰ç›®å½•ç”Ÿæˆäº†procServå¯æ‰§è¡Œç¨‹åºã€‚\nä½¿ç”¨EPICSæ„å»ºç³»ç»Ÿ shell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 mkdir procServ \u0026amp;\u0026amp; cd procServ EPICS_HOST_ARCH=`${EPICS_BASE}/startup/EpicsHostArch` ${EPICS_BASE}/bin/${EPICS_HOST_ARCH}/makeBaseApp.pl -t example dummy rm -rf dummyApp git clone https://github.com/ralphlange/procServ.git procServApp cat \u0026gt; configure/RELEASE.local \u0026lt;\u0026lt; EOF EPICS_BASE=${EPICS_BASE} EOF cd procServApp # ä¿®æ”¹æºç  # å…·ä½“è§ä¸‹é¢ **ä¿®æ”¹procServæºç ** make ./configure --with-epics-top=.. --disable-doc # ç¼–è¯‘ make -j ç¼–è¯‘å®Œæˆå¯ä»¥çœ‹åˆ°procServ/bin/${EPICS_HOST_ARCH}ç›®å½•ç”Ÿæˆäº†procServå¯æ‰§è¡Œç¨‹åºã€‚\nä¿®æ”¹procServæºç \nä¿®æ”¹procServ.ccï¼š procServ.cc \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 index c8d04a2..385f788 100644 --- a/procServ.cc +++ b/procServ.cc @@ -65,7 +65,7 @@ int connectionNo; // Total number of connections char *ignChars = NULL; // Characters to ignore char killChar = 0x18; // Kill command character (default: ^X) char toggleRestartChar = 0x14; // Toggle autorestart character (default: ^T) -char restartChar = 0x12; // Restart character (default: ^R) +char restartChar = 0x18; // Restart character (default: ^X) char quitChar = 0x11; // Quit character (default: ^Q) char logoutChar = 0x00; // Logout client connection character (default: none) int killSig = SIGKILL; // Kill signal (default: SIGKILL) ä¿®æ”¹Makefile.Epics.inï¼š Makefile.Epics.in \u0026#9660; 1 2 3 4 5 6 7 8 9 10 index ef6073c..85336f9 100644 --- a/Makefile.Epics.in +++ b/Makefile.Epics.in @@ -17,6 +17,7 @@ procServ_OBJS = @LIBOBJS@ USR_CXXFLAGS += @DEFS@ procServ_SYS_LIBS += $(subst -l,,@LIBS@) +procServ_SYS_LIBS += util include $(TOP)/configure/RULES åœ¨ IOC ä¸­ä½¿ç”¨ procServControl ä¿®æ”¹configure/RELEASEï¼š configure/RELEASE \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 --- a/configure/RELEASE +++ b/configure/RELEASE @@ -29,9 +29,12 @@ SUPPORT=$(EPICS_BASE)/../epics-modules # If using the sequencer, point SNCSEQ at its top directory: +SNCSEQ = $(SUPPORT)/seq +ASYN=$(SUPPORT)/asyn +BUSY=$(SUPPORT)/busy +PROCSERVCTRL=$(SUPPORT)/procServControl # EPICS_BASE should appear last so earlier modules can override stuff: EPICS_BASE = /path/to/epics/base ä¿®æ”¹exampleApp/src/Makefileï¼š exampleApp/src/Makefile \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 --- a/exampleApp/src/Makefile +++ b/exampleApp/src/Makefile @@ -109,12 +109,21 @@ DB_INSTALLS += $(IOCADMIN)/db/iocAdminScanMon.db IOCRELEASE_DB += iocRelease.db endif +# procServControl +ifneq ($(PROCSERVCTRL),) +example_DBD += asyn.dbd +example_DBD += drvAsynIPPort.dbd +example_DBD += busySupport.dbd +example_DBD += procServControl.dbd +example_LIBS += asyn busy seq pv procServControl +endif + # Finally link IOC to the EPICS Base libraries sysStats_LIBS += $(EPICS_BASE_IOC_LIBS) ä¿®æ”¹exampleApp/Db/Makefileï¼š exampleApp/Db/Makefile \u0026#9660; 1 2 3 4 5 6 7 8 9 10 --- a/exampleApp/Db/Makefile +++ b/exampleApp/Db/Makefile @@ -6,6 +6,7 @@ include $(TOP)/configure/CONFIG # Install databases, templates \u0026amp; substitutions like this DB += exampleVersion.db +DB_INSTALLS += $(PROCSERVCTRL)/db/procServControl.template # If \u0026lt;anyname\u0026gt;.db template is not named \u0026lt;anyname\u0026gt;*.template add # \u0026lt;anyname\u0026gt;_TEMPLATE = \u0026lt;templatename\u0026gt; ä¿®æ”¹iocBoot/iocexample/st.cmdï¼š iocBoot/iocexample/st.cmd \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 --- a/iocBoot/iocexample/st.cmd +++ b/iocBoot/iocexample/st.cmd @@ -12,11 +12,16 @@ dbLoadDatabase \u0026#34;dbd/example.dbd\u0026#34; sysStats_registerRecordDeviceDriver pdbbase +## Connect to procServ +epicsEnvSet(\u0026#34;ASYN_PORT_NAME\u0026#34;, \u0026#34;port1\u0026#34;) +drvAsynIPPortConfigure(\u0026#34;${ASYN_PORT_NAME}\u0026#34;, \u0026#34;localhost:7001\u0026#34;, 100, 0, 0) + ## Load record instances # dbLoadTemplate \u0026#34;db/user.substitutions\u0026#34; # dbLoadRecords \u0026#34;db/dbSubExample.db\u0026#34;, \u0026#34;user=${USER}\u0026#34; dbLoadRecords \u0026#34;db/exampleVersion.db\u0026#34;, \u0026#34;user=${NAME}\u0026#34; # dbLoadRecords \u0026#34;db/iocAdminSoft.db\u0026#34;, \u0026#34;IOC=${NAME}\u0026#34; +dbLoadRecords \u0026#34;db/procServControl.template\u0026#34;, \u0026#34;P=${NAME},PORT=${ASYN_PORT_NAME}\u0026#34; #- Set this to see messages from mySub #-var mySubDebug 1 @@ -29,3 +34,4 @@ iocInit ## Start any sequence programs #seq sncExample, \u0026#34;user=${USER}\u0026#34; +seq procServControl, \u0026#34;P=${NAME}\u0026#34; ç¼–è¯‘ shell \u0026#9660; 1 make -j ä½¿ç”¨ procServ è¿è¡Œ IOC shell \u0026#9660; 1 2 cd /path/to/example/iocBoot/iocexample procServ -n $NAME -P 7001 ./st.cmd â„¹ï¸ æ³¨æ„ procServæŒ‡å®šçš„ç«¯å£ï¼ˆä¾‹ï¼š7001ï¼‰å¿…éœ€å’Œst.cmdè„šæœ¬ä¸­çš„ç«¯å£å¯¹åº”ã€‚\nâ„¹ï¸ The most important PVs provided are: $(P):START - Start IOC $(P):STOP - Stop IOC $(P):RESTART - Restart IOC $(P):IOCOUT - Last 20 lines of IOC output ","permalink":"https://kira-96.github.io/notes/epics-ioc-procservcontrol/","summary":"\u003ch2 id=\"è½¯ä»¶åŒ…\"\u003eè½¯ä»¶åŒ…\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/epics-modules/asyn\"\u003eepics-modules/asyn: EPICS module for driver and device support\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/epics-modules/busy\"\u003eepics-modules/busy: APS BCDA synApps module\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/epics-modules/sequencer\"\u003eepics-modules/sequencer: The EPICS SNL Compiler and Sequencer\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/DiamondLightSource/procServControl\"\u003eDiamondLightSource/procServControl: EPICS/CA control of running procServ instances\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/ralphlange/procServ\"\u003eralphlange/procServ: Wrapper to start arbitrary interactive commands in the background, with telnet or Unix domain socket access to stdin/stdout\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ç¼–è¯‘è½¯ä»¶åŒ…\"\u003eç¼–è¯‘è½¯ä»¶åŒ…\u003c/h2\u003e\n\u003ch3 id=\"asyn\"\u003easyn\u003c/h3\u003e\n\u003cp\u003eæ­£å¸¸äº¤å‰ç¼–è¯‘ã€‚\u003c/p\u003e\n\u003ch3 id=\"busy\"\u003ebusy\u003c/h3\u003e\n\n\n\n\u003cblockquote class=\"alert-blockquote alert-tip\"\u003e\n    \u003cp class=\"alert-heading\"\u003e\n        ğŸ’¡\n        \n        æç¤º\n        \n    \u003c/p\u003e\n    \u003cp\u003eç¼–è¯‘\u003cstrong\u003ebusy\u003c/strong\u003eæ¨¡å—æ—¶éœ€è¦ç”¨åˆ°\u003cstrong\u003eautosave\u003c/strong\u003eï¼Œå¦‚æœä¸éœ€è¦ç¼–è¯‘\u003cstrong\u003ebusy\u003c/strong\u003eæµ‹è¯•ç¨‹åºï¼Œå¯ä»¥æ³¨é‡Š\u003ccode\u003econfigure/RELEASE\u003c/code\u003eä¸­çš„\u003ccode\u003eAUTOSAVE\u003c/code\u003eå®šä¹‰ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eæ­£å¸¸äº¤å‰ç¼–è¯‘ã€‚\u003c/p\u003e\n\u003ch3 id=\"sequencer\"\u003esequencer\u003c/h3\u003e\n\n\n\n\u003cblockquote class=\"alert-blockquote alert-note\"\u003e\n    \u003cp class=\"alert-heading\"\u003e\n        â„¹ï¸\n        \n        Title\n        \n    \u003c/p\u003e\n    \u003cp\u003eç¼–è¯‘\u003cstrong\u003esequencer\u003c/strong\u003eæ¨¡å—éœ€è¦ç”¨åˆ°\u003cstrong\u003ere2c\u003c/strong\u003eï¼Œå¯é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…ã€‚\n\u003ccode\u003eapt install re2c\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eæ­£å¸¸äº¤å‰ç¼–è¯‘ã€‚\u003c/p\u003e\n\u003ch3 id=\"procservcontrol\"\u003eprocServControl\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eä¿®æ”¹\u003ccode\u003econfigure/RELEASE\u003c/code\u003eï¼š\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"configure/RELEASE\"\u003econfigure/RELEASE\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-diff\" data-lang=\"diff\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gh\"\u003eindex 244da04..98d30ca 100644\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e--- a/configure/RELEASE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+++ b/configure/RELEASE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e@@ -20,15 +20,15 @@\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e # CONFIG_SITE file.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e TEMPLATE_TOP=$(EPICS_BASE)/templates/makeBaseApp/top\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-SUPPORT=/dls_sw/prod/R3.14.12.7/support\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+SUPPORT=/home/kira/epics/epics-modules\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e # If using the sequencer, point SNCSEQ at its top directory:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-SNCSEQ=$(SUPPORT)/seq/2-2-5dls1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-ASYN=$(SUPPORT)/asyn/4-41\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-BUSY=$(SUPPORT)/busy/1-7-2dls5\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+SNCSEQ=$(SUPPORT)/sequencer\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+ASYN=$(SUPPORT)/asyn\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+BUSY=$(SUPPORT)/busy\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e # EPICS_BASE usually appears last so other apps can override stuff:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-EPICS_BASE=/dls_sw/epics/R3.14.12.7/base\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+EPICS_BASE=/home/kira/epics/base-7.0.9\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e # Set RULES here if you want to take build rules from somewhere\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e # other than EPICS_BASE:\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eå¦‚æœéœ€è¦äº¤å‰ç¼–è¯‘ï¼Œä¿®æ”¹\u003ccode\u003econfigure/CONFIG_SITE\u003c/code\u003eï¼š\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"configure/CONFIG_SITE\"\u003econfigure/CONFIG_SITE\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-diff\" data-lang=\"diff\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gh\"\u003eindex f30c124..53c5e23 100644\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e--- a/configure/CONFIG_SITE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+++ b/configure/CONFIG_SITE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e@@ -19,7 +19,7 @@ CHECK_RELEASE = YES\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e # Set this when you only want to compile this application\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e #   for a subset of the cross-compiled target architectures\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e #   that Base is built for.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-CROSS_COMPILER_TARGET_ARCHS =\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+CROSS_COMPILER_TARGET_ARCHS = linux-loong64\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e # To install files into a location other than $(TOP) define\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e #   INSTALL_LOCATION here.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003eç¼–è¯‘\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake -j\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003ch3 id=\"procserv\"\u003eprocServ\u003c/h3\u003e\n\u003ch4 id=\"æ„å»º\"\u003eæ„å»º\u003c/h4\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eautoreconf -fi\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# é…ç½®äº¤å‰ç¼–è¯‘å™¨\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --host\u003cspan class=\"o\"\u003e=\u003c/span\u003eloongarch64-linux-gnu \u003cspan class=\"nv\"\u003eCC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eloongarch64-linux-gnu-gcc --disable-doc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ç¼–è¯‘\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake -j\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eç¼–è¯‘å®Œæˆåº”è¯¥å¯ä»¥çœ‹åˆ°å½“å‰ç›®å½•ç”Ÿæˆäº†\u003ccode\u003eprocServ\u003c/code\u003eå¯æ‰§è¡Œç¨‹åºã€‚\u003c/p\u003e","title":"EPICS IOC ä½¿ç”¨ ProcServControl"},{"content":"ä»‹ç» Qt Remote Objects æ˜¯Qtæ¨å‡ºçš„è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰æ¨¡å—ï¼Œç”¨äºå®ç°è¿›ç¨‹é—´æˆ–è¿œç¨‹ç½‘ç»œé—´é€šä¿¡ï¼Œç®€åŒ–åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼€å‘ã€‚é€šè¿‡æŠ½è±¡åº•å±‚é€šä¿¡ç»†èŠ‚ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿåƒæ“ä½œæœ¬åœ°å¯¹è±¡ä¸€æ ·è°ƒç”¨è¿œç¨‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚\nå…³é”®ç»„æˆ\næºå¯¹è±¡ï¼ˆSourceï¼‰\nåœ¨æœåŠ¡ç«¯å®šä¹‰å®é™…å¯¹è±¡ï¼Œå¯¹å¤–æš´éœ²æ•°æ®å’Œæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ§åˆ¶è®¾å¤‡çš„ç±»å¯èƒ½åŒ…å«çŠ¶æ€å±æ€§å’Œæ§åˆ¶æŒ‡ä»¤æ–¹æ³•ã€‚ å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰\nå®¢æˆ·ç«¯é€šè¿‡å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰ä¸æºå¯¹è±¡ï¼ˆSourceï¼‰äº¤äº’ã€‚Replica ä¼šå°†å®¢æˆ·ç«¯çš„æ“ä½œè½¬å‘ç»™æœåŠ¡ç«¯ï¼Œå¹¶åŒæ­¥æ›´æ–°å±æ€§å˜åŒ–ã€‚ é€šä¿¡èŠ‚ç‚¹ï¼ˆNodeï¼‰\næœåŠ¡ç«¯é€šè¿‡ QRemoteObjectHost å‘å¸ƒå¯¹è±¡ï¼Œå®¢æˆ·ç«¯é€šè¿‡ QRemoteObjectNode è¿æ¥æœåŠ¡ç«¯å¹¶è·å–å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰ã€‚ å…³é”®ç‰¹æ€§\né€æ˜é€šä¿¡ï¼šå®¢æˆ·ç«¯è°ƒç”¨è¿œç¨‹æ–¹æ³•å¦‚åŒæœ¬åœ°è°ƒç”¨ã€‚ è‡ªåŠ¨åŒæ­¥ï¼šæºå¯¹è±¡çš„å±æ€§å˜åŒ–ä¼šè‡ªåŠ¨åŒæ­¥åˆ°æ‰€æœ‰å®¢æˆ·ç«¯å‰¯æœ¬ã€‚ å¤šåè®®æ”¯æŒï¼šæ”¯æŒæœ¬åœ°è¿›ç¨‹é€šä¿¡ï¼ˆlocal://ï¼‰ã€TCP ç½‘ç»œé€šä¿¡ï¼ˆtcp://ï¼‰ç­‰ã€‚ åŠ¨æ€å‘ç°ï¼šå¯é€‰æ³¨å†Œä¸­å¿ƒï¼ˆRegistryï¼‰å®ç°æœåŠ¡è‡ªåŠ¨å‘ç°ã€‚ å…¸å‹åœºæ™¯\nå¤šè¿›ç¨‹åä½œï¼šä¾‹å¦‚ GUI åº”ç”¨ä¸åå°æœåŠ¡åˆ†ç¦»ã€‚ åˆ†å¸ƒå¼åº”ç”¨ï¼šä¸»æ§ç¨‹åºä¸å¤šä¸ªå­è¿›ç¨‹å…±äº«é…ç½®æ•°æ®ã€‚ è·¨è®¾å¤‡æ§åˆ¶ï¼šå¦‚é€šè¿‡ PC æ§åˆ¶åµŒå…¥å¼è®¾å¤‡ã€‚ å¾®æœåŠ¡æ¶æ„ï¼šå°†åŠŸèƒ½æ¨¡å—æ‹†åˆ†ä¸ºç‹¬ç«‹è¿›ç¨‹ï¼Œé€šè¿‡ QtRO é€šä¿¡ã€‚ QtROä¸RPCæ¡†æ¶çš„åŠŸèƒ½æ¯”è¾ƒ\né€šä¿¡æ¨¡å¼ Qt Remote Objects RPC(Remote Procedure Call) å¤šå®¢æˆ·ç«¯ âœ… âœ… å•å‘è°ƒç”¨ âœ…ï¼ˆSlotsï¼‰ âœ… å‘å¸ƒ-è®¢é˜… âœ…ï¼ˆSignalsï¼‰ âŒ åŒå‘æµå¼ âŒ âœ… çŠ¶æ€åŒæ­¥ âœ… âŒ è¡¥å……è¯´æ˜\nReplica ç¼–è¯‘å™¨ï¼ˆrepcï¼‰åŸºäº API å®šä¹‰æ–‡ä»¶ï¼ˆâ€œrepâ€æ–‡ä»¶ï¼‰ç”Ÿæˆ QObject å¤´æ–‡ä»¶ã€‚å½“ repc å¤„ç†è¿™äº›æ–‡ä»¶æ—¶ï¼Œrepc ä¼šç”Ÿæˆ Source å¤´æ–‡ä»¶å’Œ Replica å¤´æ–‡ä»¶ã€‚\nQt Remote Objects æ”¯æŒé™æ€å’ŒåŠ¨æ€å‰¯æœ¬ä¸¤ç§æ–¹å¼ï¼Œä¸¤ç§æ–¹å¼çš„å®¢æˆ·ç«¯ä»£ç ç¼–å†™æ–¹å¼æœ‰æ‰€ä¸åŒã€‚\nè™½ç„¶ Qt Remote Objects æ”¯æŒé€šè¿‡ç½‘ç»œå…±äº«ä»»ä½• QObject å¯¹è±¡ï¼Œä½†ä½¿ç”¨ repc å®šä¹‰å¯¹è±¡æœ‰å‡ ä¸ªä¼˜ç‚¹ï¼š\nè™½ç„¶åŠ¨æ€å‰¯æœ¬ï¼ˆDynamicReplicasï¼‰å¾ˆæœ‰ç”¨ï¼Œä½†ä½¿ç”¨èµ·æ¥æ›´éº»çƒ¦ã€‚åœ¨å¯¹è±¡åˆå§‹åŒ–ä¹‹å‰ï¼Œæ˜¯ä¸çŸ¥é“APIçš„ï¼Œå¹¶ä¸”ä½¿ç”¨ API æ—¶éœ€è¦é€šè¿‡å…ƒå¯¹è±¡ï¼ˆQMetaObjectï¼‰çš„æ–¹æ³•è¿›è¡Œå­—ç¬¦ä¸²æŸ¥æ‰¾ã€‚ åœ¨ç¼–è¯‘æ—¶çŸ¥é“æ¥å£å¯ä»¥æ›´å®¹æ˜“å‘ç°ç¼–è¯‘æ—¶ä¸è¿è¡Œæ—¶çš„é—®é¢˜ã€‚ rep æ ¼å¼æ”¯æŒé»˜è®¤å€¼ï¼Œå¦‚æœæ‚¨æ— æ³•ç¡®ä¿åœ¨å®ä¾‹åŒ–å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰æ—¶æºå¯¹è±¡ï¼ˆSourceï¼‰å¯ç”¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ã€‚ ç®€å•ç¤ºä¾‹ é™æ€æ–¹å¼ å®šä¹‰æ¥å£ QtRO é™æ€æ–¹å¼éœ€è¦å…ˆå®šä¹‰å‰¯æœ¬å¯¹è±¡æ¥å£æ–‡ä»¶ï¼ˆ.repï¼‰ï¼Œæ–‡ä»¶è¯­æ³•å¯ä»¥å‚è€ƒQt Remote Objects Compilerã€‚\nè¿™é‡Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„è®¾å¤‡æ§åˆ¶æ¥å£æ–‡ä»¶ï¼š\ndevicecontroller.rep \u0026#9660; 1 2 3 4 5 6 7 8 class DeviceController { ENUM Status { Ok, Error }; // çŠ¶æ€æšä¸¾ PROP(Status status = Ok READONLY); // çŠ¶æ€å±æ€§ï¼Œåªè¯» SLOT(void controlDevice(QString command)); // æ§½å‡½æ•° SLOT(void uploadFile(QString fileName, QByteArray fileData)); // æ§½å‡½æ•° SIGNAL(fileReceived(QString fileName)); // ä¿¡å· }; æ¥ä¸‹æ¥éœ€è¦æŠŠæ¥å£æ–‡ä»¶æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼Œé¡¹ç›®åˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚\nmyproject.pro \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 # qmakeä¸­çš„å†™æ³• # æ·»åŠ  Qt Remote Objects æ”¯æŒ QT += remoteobjects # æœåŠ¡ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆæºå¯¹è±¡ï¼‰ REPC_SOURCE += devicecontroller.rep # å®¢æˆ·ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆå‰¯æœ¬å¯¹è±¡ï¼‰ REPC_REPLICA += devicecontroller.rep # åŒæ—¶ç”Ÿæˆæºå¯¹è±¡å’Œå‰¯æœ¬å¯¹è±¡çš„å¤´æ–‡ä»¶ REPC_MERGED = devicecontroller.rep CMakeLists.txt \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # cmakeä¸­çš„å†™æ³• set(CMAKE_INCLUDE_CURRENT_DIR ON) # æ·»åŠ  Qt Remote Objects æ”¯æŒ find_package(Qt6 REQUIRED COMPONENTS Core RemoteObjects) # æœåŠ¡ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆæºå¯¹è±¡ï¼‰ qt_add_repc_sources(${PROJECT_NAME} devicecontroller.rep ) # å®¢æˆ·ç«¯é¡¹ç›®ï¼ˆç”Ÿæˆå‰¯æœ¬å¯¹è±¡ï¼‰ qt_add_repc_replicas(${PROJECT_NAME} devicecontroller.rep ) # åŒæ—¶ç”Ÿæˆæºå¯¹è±¡å’Œå‰¯æœ¬å¯¹è±¡çš„å¤´æ–‡ä»¶ qt_add_repc_merged(${PROJECT_NAME} devicecontroller.rep ) æ·»åŠ å®Œæˆåï¼Œæ„å»ºä¸€ä¸‹é¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†æºå¯¹è±¡å¤´æ–‡ä»¶rep_devicecontroller_source.hå’Œå‰¯æœ¬å¯¹è±¡å¤´æ–‡ä»¶rep_devicecontroller_replica.hã€‚\nrep_devicecontroller_source.h \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 #ifndef REP_DEVICECONTROLLER_SOURCE_H #define REP_DEVICECONTROLLER_SOURCE_H // This is an autogenerated file. // Do not edit this file, any changes made will be lost the next time it is generated. #include \u0026lt;QtCore/qobject.h\u0026gt; #include \u0026lt;QtCore/qdatastream.h\u0026gt; #include \u0026lt;QtCore/qvariant.h\u0026gt; #include \u0026lt;QtCore/qmap.h\u0026gt; #include \u0026lt;QtCore/qmetatype.h\u0026gt; #include \u0026lt;QtRemoteObjects/qremoteobjectnode.h\u0026gt; #include \u0026lt;QtRemoteObjects/qremoteobjectsource.h\u0026gt; using namespace Qt::Literals::StringLiterals; class DeviceControllerSource : public QObject { Q_OBJECT Q_CLASSINFO(QCLASSINFO_REMOTEOBJECT_TYPE, \u0026#34;DeviceController\u0026#34;) Q_CLASSINFO(QCLASSINFO_REMOTEOBJECT_SIGNATURE, \u0026#34;3947cd1a592cb801ecdf88688ceb676821764dc3\u0026#34;) Q_PROPERTY(Status status READ status NOTIFY statusChanged) public: enum Status { Ok = 0, Error = 1, }; Q_ENUM(Status) public: explicit DeviceControllerSource(QObject *parent = nullptr) : QObject(parent) { qRegisterMetaType\u0026lt;Status\u0026gt;(); } public: ~DeviceControllerSource() override = default; virtual Status status() const = 0; Q_SIGNALS: void statusChanged(DeviceControllerSource::Status status); void fileReceived(QString fileName); public Q_SLOTS: virtual void controlDevice(QString command) = 0; virtual void uploadFile(QString fileName, QByteArray fileData) = 0; private: friend class QT_PREPEND_NAMESPACE(QRemoteObjectNode); }; class DeviceControllerSimpleSource : public DeviceControllerSource { Q_OBJECT public: explicit DeviceControllerSimpleSource(QObject *parent = nullptr) : DeviceControllerSource(parent) , m_status(Ok) {} public: ~DeviceControllerSimpleSource() override = default; Status status() const override { return m_status; } protected: virtual void setStatus(Status status) { if (status != m_status) { m_status = status; Q_EMIT statusChanged(m_status); } } private: Status m_status; }; ... #endif // REP_DEVICECONTROLLER_SOURCE_H æœåŠ¡ç«¯ æ¥ä¸‹æ¥ç¼–å†™æœåŠ¡ç«¯ä»£ç ï¼š\nmydeviceservice.h \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #ifndef MYDEVICESERVICE_H #define MYDEVICESERVICE_H #include \u0026#34;rep_devicecontroller_source.h\u0026#34; class MyDeviceService : public DeviceControllerSimpleSource { Q_OBJECT public: explicit MyDeviceService(QObject *parent = Q_NULLPTR); ~MyDeviceService(); public Q_SLOTS: virtual void controlDevice(QString command) Q_DECL_OVERRIDE; virtual void uploadFile(QString fileName, QByteArray fileData) Q_DECL_OVERRIDE; }; #endif // MYDEVICESERVICE_H mydeviceservice.cpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 #include \u0026#34;mydeviceservice.h\u0026#34; #include \u0026lt;QDebug\u0026gt; MyDeviceService::MyDeviceService(QObject *parent) : DeviceControllerSimpleSource{parent} { qDebug() \u0026lt;\u0026lt; __PRETTY_FUNCTION__; } MyDeviceService::~MyDeviceService() { qDebug() \u0026lt;\u0026lt; __PRETTY_FUNCTION__; } void MyDeviceService::controlDevice(QString command) { qDebug() \u0026lt;\u0026lt; __PRETTY_FUNCTION__ \u0026lt;\u0026lt; command; setStatus(Error); } void MyDeviceService::uploadFile(QString fileName, QByteArray fileData) { qDebug() \u0026lt;\u0026lt; __PRETTY_FUNCTION__; qDebug() \u0026lt;\u0026lt; \u0026#34;Receiving file:\u0026#34; \u0026lt;\u0026lt; fileName \u0026lt;\u0026lt; \u0026#34;\\nContent: \\n\u0026#34; \u0026lt;\u0026lt; QString::fromUtf8(fileData); setStatus(Ok); Q_EMIT fileReceived(fileName); } å¯åŠ¨æœåŠ¡ç«¯ï¼š\nmain.cpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 #include \u0026lt;QCoreApplication\u0026gt; #include \u0026#34;mydeviceservice.h\u0026#34; int main(int argc, char *argv[]) { QCoreApplication a(argc, argv); QRemoteObjectHost host; // è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰ // host.setHostUrl(QUrl(\u0026#34;local:devicecontroller\u0026#34;)); // è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰ host.setHostUrl(QUrl(\u0026#34;tcp://0.0.0.0:2333\u0026#34;)); MyDeviceService service; /** * ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æºå¯¹è±¡æŒ‡é’ˆ * ç¬¬äºŒä¸ªå‚æ•°æ˜¯æºå¯¹è±¡åå­—ï¼Œå®¢æˆ·ç«¯å¯æ ¹æ®åå­—è·å–æºå¯¹è±¡ï¼Œ * ä½¿ç”¨åŠ¨æ€å‰¯æœ¬çš„æ–¹å¼æ—¶ï¼Œå¿…é¡»å¡«å†™æºå¯¹è±¡åå­—ã€‚ */ host.enableRemoting(\u0026amp;service, \u0026#34;mydeviceservice\u0026#34;); return a.exec(); } å®¢æˆ·ç«¯ å®¢æˆ·ç«¯ä»£ç ï¼š\nmydevicecontroller.h \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 #ifndef MYDEVICECONTROLLER_H #define MYDEVICECONTROLLER_H #include \u0026lt;QObject\u0026gt; #include \u0026lt;QPointer\u0026gt; QT_BEGIN_NAMESPACE class QRemoteObjectNode; QT_END_NAMESPACE class MyDeviceController : public QObject { Q_OBJECT public: explicit MyDeviceController(QObject *parent = Q_NULLPTR); Q_INVOKABLE void test(const QUrl \u0026amp;url); private: QPointer\u0026lt;QRemoteObjectNode\u0026gt; node; // QPointer\u0026lt;DeviceControllerReplica\u0026gt; replica; }; #endif // MYDEVICECONTROLLER_H mydevicecontroller.h \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 #include \u0026#34;mydevicecontroller.h\u0026#34; #include \u0026#34;rep_devicecontroller_replica.h\u0026#34; MyDeviceController::MyDeviceController(QObject *parent) : QObject{parent} , node{new QRemoteObjectNode(this)} {} void MyDeviceController::test(const QUrl \u0026amp;url) { node-\u0026gt;connectToNode(url); qDebug() \u0026lt;\u0026lt; \u0026#34;connected to:\u0026#34; \u0026lt;\u0026lt; url; auto *replica = node-\u0026gt;acquire\u0026lt;DeviceControllerReplica\u0026gt;(\u0026#34;mydeviceservice\u0026#34;); connect(replica, \u0026amp;DeviceControllerReplica::statusChanged, this, [\u0026amp;](DeviceControllerReplica::Status s) { qDebug() \u0026lt;\u0026lt; \u0026#34;Device status changed to:\u0026#34; \u0026lt;\u0026lt; s; }); connect(replica, \u0026amp;DeviceControllerReplica::fileReceived, this, [\u0026amp;](QString fileName) { qDebug() \u0026lt;\u0026lt; \u0026#34;File sent. file -\u0026#34; \u0026lt;\u0026lt; fileName; }); connect(replica, \u0026amp;DeviceControllerReplica::stateChanged, this, [this](QRemoteObjectReplica::State state, QRemoteObjectReplica::State oldState) { qDebug() \u0026lt;\u0026lt; \u0026#34;replica state changed:\u0026#34; \u0026lt;\u0026lt; oldState \u0026lt;\u0026lt; \u0026#34;â†’\u0026#34; \u0026lt;\u0026lt; state; // å‰¯æœ¬å¯¹è±¡çŠ¶æ€å¯ç”¨æ—¶æ‰èƒ½è°ƒç”¨æ¥å£ if (state == QRemoteObjectReplica::Valid) { DeviceControllerReplica *replica = qobject_cast\u0026lt;DeviceControllerReplica*\u0026gt;(sender()); Q_ASSERT(replica); replica-\u0026gt;controlDevice(\u0026#34;echo\u0026#34;); replica-\u0026gt;uploadFile(\u0026#34;test.txt\u0026#34;, QString(\u0026#34;ä½ å¥½ï¼ä¸–ç•Œã€‚\u0026#34;).toUtf8()); } }); } å®¢æˆ·ç«¯è°ƒç”¨ï¼š\nmain.cpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #include \u0026lt;QCoreApplication\u0026gt; #include \u0026lt;QUrl\u0026gt; #include \u0026#34;mydevicecontroller.h\u0026#34; int main(int argc, char *argv[]) { QCoreApplication a(argc, argv); MyDeviceController client; // è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰ // client.test(QUrl(\u0026#34;local:devicecontroller\u0026#34;)); // è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰ client.test(QUrl(\u0026#34;tcp://192.168.1.3:2333\u0026#34;)); return a.exec(); } åŠ¨æ€å‰¯æœ¬ åŠ¨æ€å‰¯æœ¬çš„å®¢æˆ·ç«¯ä»£ç æœ‰æ‰€ä¸åŒã€‚\nmydevicecontroller.h \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 #ifndef MYDEVICECONTROLLER_H #define MYDEVICECONTROLLER_H #include \u0026lt;QObject\u0026gt; #include \u0026lt;QPointer\u0026gt; QT_BEGIN_NAMESPACE class QRemoteObjectNode; QT_END_NAMESPACE class MyDeviceController : public QObject { Q_OBJECT public: explicit MyDeviceController(QObject *parent = Q_NULLPTR); Q_INVOKABLE void test(const QUrl \u0026amp;url); Q_SLOT void onStatusChanged(int); Q_SLOT void onFileReceived(const QString\u0026amp;); private: QPointer\u0026lt;QRemoteObjectNode\u0026gt; node; }; #endif // MYDEVICECONTROLLER_H mydevicecontroller.cpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 #include \u0026#34;mydevicecontroller.h\u0026#34; #include \u0026#34;rep_devicecontroller_replica.h\u0026#34; MyDeviceController::MyDeviceController(QObject *parent) : QObject{parent} , node{new QRemoteObjectNode(this)} {} void MyDeviceController::test(const QUrl \u0026amp;url) { node-\u0026gt;connectToNode(url); qDebug() \u0026lt;\u0026lt; \u0026#34;connected to:\u0026#34; \u0026lt;\u0026lt; url; auto *replica = node-\u0026gt;acquireDynamic(\u0026#34;mydeviceservice\u0026#34;); connect(replica, \u0026amp;QRemoteObjectDynamicReplica::stateChanged, this, [this](QRemoteObjectReplica::State state, QRemoteObjectReplica::State oldState) { qDebug() \u0026lt;\u0026lt; \u0026#34;replica state changed:\u0026#34; \u0026lt;\u0026lt; oldState \u0026lt;\u0026lt; \u0026#34;â†’\u0026#34; \u0026lt;\u0026lt; state; if (state == QRemoteObjectReplica::Valid) { QRemoteObjectDynamicReplica *replica = qobject_cast\u0026lt;QRemoteObjectDynamicReplica*\u0026gt;(sender()); Q_ASSERT(replica); /** ç”±äºä½¿ç”¨åŠ¨æ€å‰¯æœ¬æ–¹å¼ï¼Œåœ¨å‰¯æœ¬åˆå§‹åŒ–å®Œæˆå‰ï¼Œæ— æ³•é¢„å…ˆçŸ¥é“APIï¼Œ * åªæœ‰åœ¨å‰¯æœ¬å¯¹è±¡çŠ¶æ€å¯ç”¨æ—¶ï¼Œæ‰èƒ½è¿›è¡Œä¿¡å·-æ§½è¿æ¥ã€‚ * å¹¶ä¸”æ— æ³•ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹å‚æ•°ï¼Œå¦‚ä¹‹å‰å®šä¹‰çš„æšä¸¾ã€‚ */ // connect(replica, SIGNAL(statusChanged(int)), this, SLOT(onStatusChanged(int))); connect(replica, SIGNAL(fileReceived(QString)), this, SLOT(onFileReceived(QString))); /** è°ƒç”¨æ¥å£éœ€è¦ä½¿ç”¨å…ƒå¯¹è±¡çš„`invokeMethod`æ–¹æ³• */ QMetaObject::invokeMethod(replica, \u0026#34;controlDevice\u0026#34;, Q_ARG(QString, \u0026#34;echo\u0026#34;)); QMetaObject::invokeMethod(replica, \u0026#34;uploadFile\u0026#34;, Q_ARG(QString, \u0026#34;test.txt\u0026#34;), Q_ARG(QByteArray, QString(\u0026#34;ä½ å¥½ï¼ä¸–ç•Œã€‚\u0026#34;).toUtf8())); } }); } void MyDeviceController::onStatusChanged(int s) { qDebug() \u0026lt;\u0026lt; \u0026#34;Device status changed to:\u0026#34; \u0026lt;\u0026lt; s; } void MyDeviceController::onFileReceived(const QString \u0026amp;fileName) { qDebug() \u0026lt;\u0026lt; \u0026#34;File sent. file -\u0026#34; \u0026lt;\u0026lt; fileName; } æ³¨æ„äº‹é¡¹ Qt Remote Objects ä½¿ç”¨å†…éƒ¨åè®®åœ¨è¿›ç¨‹å’Œ/æˆ–è®¾å¤‡ä¹‹é—´ä¼ é€’æ•°æ®ã€‚æ‰€æœ‰éƒ¨åˆ†éƒ½éœ€è¦ä½¿ç”¨ç›¸åŒçš„åè®®ç‰ˆæœ¬ï¼šå¦‚æœç‰ˆæœ¬ä¸åŒ¹é…ï¼Œè¿æ¥èŠ‚ç‚¹å°†è¾“å‡ºè­¦å‘Šï¼Œä¸»æœºèŠ‚ç‚¹å°†ä¸å‘é€ä»»ä½•æ•°æ®ã€‚\nç›®å‰å‘å¸ƒçš„ç‰ˆæœ¬ï¼š\nåè®®ç‰ˆæœ¬ Qtç‰ˆæœ¬ \u0026lt;1.2 åœ¨ QtRO çš„æŠ€æœ¯é¢„è§ˆé˜¶æ®µä½¿ç”¨ã€‚ 1.2 5.12.0 1.3 5.12.4 2.0 6.2.0 See Qt Remote Objects Protocol Versioning.\nå‚è€ƒ\nQt Remote Objectsè¿œç¨‹è°ƒç”¨æ¨¡å—çš„åŸºæœ¬ä½¿ç”¨ Qt Remote Objects å­¦ä¹ ç¬”è®°ï¼ˆQt è¿œç«¯å¯è°ƒç”¨å¯¹è±¡æ¡†æ¶) Qt Remote Objectï¼ˆQtROï¼‰åŠ¨æ€Replicaå®ç°è¿›ç¨‹é—´é€šä¿¡ ","permalink":"https://kira-96.github.io/posts/qt-remote-objects/","summary":"\u003ch2 id=\"ä»‹ç»\"\u003eä»‹ç»\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eQt Remote Objects\u003c/code\u003e æ˜¯Qtæ¨å‡ºçš„è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰æ¨¡å—ï¼Œç”¨äºå®ç°è¿›ç¨‹é—´æˆ–è¿œç¨‹ç½‘ç»œé—´é€šä¿¡ï¼Œç®€åŒ–åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼€å‘ã€‚é€šè¿‡æŠ½è±¡åº•å±‚é€šä¿¡ç»†èŠ‚ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿåƒæ“ä½œæœ¬åœ°å¯¹è±¡ä¸€æ ·è°ƒç”¨è¿œç¨‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eå…³é”®ç»„æˆ\u003c/strong\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eæºå¯¹è±¡ï¼ˆSourceï¼‰\u003cbr\u003e\nåœ¨æœåŠ¡ç«¯å®šä¹‰å®é™…å¯¹è±¡ï¼Œå¯¹å¤–æš´éœ²æ•°æ®å’Œæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ§åˆ¶è®¾å¤‡çš„ç±»å¯èƒ½åŒ…å«çŠ¶æ€å±æ€§å’Œæ§åˆ¶æŒ‡ä»¤æ–¹æ³•ã€‚\u003c/li\u003e\n\u003cli\u003eå‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰\u003cbr\u003e\nå®¢æˆ·ç«¯é€šè¿‡å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰ä¸æºå¯¹è±¡ï¼ˆSourceï¼‰äº¤äº’ã€‚\u003ccode\u003eReplica\u003c/code\u003e ä¼šå°†å®¢æˆ·ç«¯çš„æ“ä½œè½¬å‘ç»™æœåŠ¡ç«¯ï¼Œå¹¶åŒæ­¥æ›´æ–°å±æ€§å˜åŒ–ã€‚\u003c/li\u003e\n\u003cli\u003eé€šä¿¡èŠ‚ç‚¹ï¼ˆNodeï¼‰\u003cbr\u003e\næœåŠ¡ç«¯é€šè¿‡ \u003ccode\u003eQRemoteObjectHost\u003c/code\u003e å‘å¸ƒå¯¹è±¡ï¼Œå®¢æˆ·ç«¯é€šè¿‡ \u003ccode\u003eQRemoteObjectNode\u003c/code\u003e è¿æ¥æœåŠ¡ç«¯å¹¶è·å–å‰¯æœ¬å¯¹è±¡ï¼ˆReplicaï¼‰ã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cstrong\u003eå…³é”®ç‰¹æ€§\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eé€æ˜é€šä¿¡ï¼šå®¢æˆ·ç«¯è°ƒç”¨è¿œç¨‹æ–¹æ³•å¦‚åŒæœ¬åœ°è°ƒç”¨ã€‚\u003c/li\u003e\n\u003cli\u003eè‡ªåŠ¨åŒæ­¥ï¼šæºå¯¹è±¡çš„å±æ€§å˜åŒ–ä¼šè‡ªåŠ¨åŒæ­¥åˆ°æ‰€æœ‰å®¢æˆ·ç«¯å‰¯æœ¬ã€‚\u003c/li\u003e\n\u003cli\u003eå¤šåè®®æ”¯æŒï¼šæ”¯æŒæœ¬åœ°è¿›ç¨‹é€šä¿¡ï¼ˆ\u003ccode\u003elocal://\u003c/code\u003eï¼‰ã€TCP ç½‘ç»œé€šä¿¡ï¼ˆ\u003ccode\u003etcp://\u003c/code\u003eï¼‰ç­‰ã€‚\u003c/li\u003e\n\u003cli\u003eåŠ¨æ€å‘ç°ï¼šå¯é€‰æ³¨å†Œä¸­å¿ƒï¼ˆRegistryï¼‰å®ç°æœåŠ¡è‡ªåŠ¨å‘ç°ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eå…¸å‹åœºæ™¯\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¤šè¿›ç¨‹åä½œï¼šä¾‹å¦‚ GUI åº”ç”¨ä¸åå°æœåŠ¡åˆ†ç¦»ã€‚\u003c/li\u003e\n\u003cli\u003eåˆ†å¸ƒå¼åº”ç”¨ï¼šä¸»æ§ç¨‹åºä¸å¤šä¸ªå­è¿›ç¨‹å…±äº«é…ç½®æ•°æ®ã€‚\u003c/li\u003e\n\u003cli\u003eè·¨è®¾å¤‡æ§åˆ¶ï¼šå¦‚é€šè¿‡ PC æ§åˆ¶åµŒå…¥å¼è®¾å¤‡ã€‚\u003c/li\u003e\n\u003cli\u003eå¾®æœåŠ¡æ¶æ„ï¼šå°†åŠŸèƒ½æ¨¡å—æ‹†åˆ†ä¸ºç‹¬ç«‹è¿›ç¨‹ï¼Œé€šè¿‡ QtRO é€šä¿¡ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eQtROä¸RPCæ¡†æ¶çš„åŠŸèƒ½æ¯”è¾ƒ\u003c/strong\u003e\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eé€šä¿¡æ¨¡å¼\u003c/th\u003e\n          \u003cth\u003eQt Remote Objects\u003c/th\u003e\n          \u003cth\u003eRPC(Remote Procedure Call)\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eå¤šå®¢æˆ·ç«¯\u003c/td\u003e\n          \u003ctd\u003eâœ…\u003c/td\u003e\n          \u003ctd\u003eâœ…\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eå•å‘è°ƒç”¨\u003c/td\u003e\n          \u003ctd\u003eâœ…ï¼ˆSlotsï¼‰\u003c/td\u003e\n          \u003ctd\u003eâœ…\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eå‘å¸ƒ-è®¢é˜…\u003c/td\u003e\n          \u003ctd\u003eâœ…ï¼ˆSignalsï¼‰\u003c/td\u003e\n          \u003ctd\u003eâŒ\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eåŒå‘æµå¼\u003c/td\u003e\n          \u003ctd\u003eâŒ\u003c/td\u003e\n          \u003ctd\u003eâœ…\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eçŠ¶æ€åŒæ­¥\u003c/td\u003e\n          \u003ctd\u003eâœ…\u003c/td\u003e\n          \u003ctd\u003eâŒ\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e\u003cstrong\u003eè¡¥å……è¯´æ˜\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eReplica ç¼–è¯‘å™¨ï¼ˆrepcï¼‰åŸºäº API å®šä¹‰æ–‡ä»¶ï¼ˆâ€œrepâ€æ–‡ä»¶ï¼‰ç”Ÿæˆ QObject å¤´æ–‡ä»¶ã€‚å½“ repc å¤„ç†è¿™äº›æ–‡ä»¶æ—¶ï¼Œrepc ä¼šç”Ÿæˆ \u003ccode\u003eSource\u003c/code\u003e å¤´æ–‡ä»¶å’Œ \u003ccode\u003eReplica\u003c/code\u003e å¤´æ–‡ä»¶ã€‚\u003cbr\u003e\nQt Remote Objects æ”¯æŒ\u003cstrong\u003eé™æ€\u003c/strong\u003eå’Œ\u003cstrong\u003eåŠ¨æ€å‰¯æœ¬\u003c/strong\u003eä¸¤ç§æ–¹å¼ï¼Œä¸¤ç§æ–¹å¼çš„å®¢æˆ·ç«¯ä»£ç ç¼–å†™æ–¹å¼æœ‰æ‰€ä¸åŒã€‚\u003c/p\u003e","title":"Qt Remote Objects ç®€å•ä½¿ç”¨"},{"content":"CPUéš”ç¦»ä¸»è¦æ˜¯ä¸ºäº†ç¡®ä¿å…³é”®è¿›ç¨‹è·å¾—æ›´é«˜çš„æ€§èƒ½ï¼Œå‡å°‘å¹²æ‰°ã€‚å¸¸è§çš„éš”ç¦»æ–¹æ³•æœ‰cgroupsã€tasksetã€isolcpuså†…æ ¸å‚æ•°ï¼Œè¿˜æœ‰å®æ—¶å†…æ ¸ï¼ˆPREEMPT RTï¼‰é…ç½®ã€‚è¿˜æœ‰CPUäº²å’Œæ€§ã€IRQå±è”½æŠ€æœ¯ã€‚\nisolcpusï¼šåœ¨å¯åŠ¨å†…æ ¸æ—¶éš”ç¦»æŸäº›CPUæ ¸å¿ƒï¼Œé˜²æ­¢æ™®é€šè¿›ç¨‹ä½¿ç”¨ã€‚ä½†éœ€è¦ç»“åˆcgroupsæˆ–tasksetæ¥åˆ†é…è¿›ç¨‹åˆ°éš”ç¦»æ ¸å¿ƒã€‚ nohz_fullï¼šåœ¨éš”ç¦»æ ¸å¿ƒç¦ç”¨æ—¶é’Ÿä¸­æ–­ï¼ˆTickless æ¨¡å¼ï¼‰ã€‚ rcu_nocbsï¼šå°† RCU å›è°ƒä»»åŠ¡ç§»å‡ºéš”ç¦»æ ¸å¿ƒã€‚ ä¿®æ”¹å†…æ ¸å¯åŠ¨å‚æ•°\nä¸»è¦å‚æ•°ï¼šioslcpus=? nohz_full=? rcu_nocbs=?\nä¾‹ï¼š earlycon console=tty console=ttyS0,115200 isolcpus=1,2 nohz_full=1,2 rcu_nocbs=1,2 acpi=off rdinit=/sbin/init rootdelay=5 root=/dev/sda1\né€šè¿‡GRUBé…ç½®\n/etc/default/grub \u0026#9660; 1 2 # æ·»åŠ isolcpuså‚æ•° GRUB_CMDLINE_LINUX=\u0026#34;isolcpus=1,2 nohz_full=1,2 rcu_nocbs=1,2\u0026#34; ä¿®æ”¹å®Œæˆåæ›´æ–°GRUBé…ç½®ï¼šsudo update-grub\nè®¾ç½®è¿›ç¨‹CPUäº²å’Œæ€§\nshell \u0026#9660; 1 2 3 4 # å¯åŠ¨æ—¶ç»‘å®šåˆ°æ ¸å¿ƒ 1,2 taskset -a -c 1,2 ./st.cmd # ä¿®æ”¹è¿è¡Œä¸­è¿›ç¨‹çš„ CPU äº²å’Œæ€§ taskset -cp \u0026lt;core_list\u0026gt; \u0026lt;pid\u0026gt; IgH EtherCATé©±åŠ¨è®¾ç½®CPUäº²å’Œæ€§ åœ¨è„šæœ¬ä¸­æ·»åŠ å¯åŠ¨å‚æ•°run_on_cpu=?ï¼Œä¾‹ï¼š\n/sbin/ethercatctl \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 ## /sbin/ethercatctl ... # load master module if ! ${MODPROBE} ${MODPROBE_FLAGS} ec_master \\ main_devices=\u0026#34;${DEVICES}\u0026#34; backup_devices=\u0026#34;${BACKUPS}\u0026#34; run_on_cpu=1; then exit 1 fi ... è®¾ç½®ECMCçº¿ç¨‹çš„CPUäº²å’Œæ€§ st.cmd \u0026#9660; 1 2 3 4 5 #- go active (create ecmc_rt) ${SCRIPTEXEC} ${ecmccfg_DIR}setAppMode.cmd #- Set affinity of ecmc_rt (core 5) epicsThreadSetAffinity ecmc_rt 5 è¿›ä¸€æ­¥çš„è°ƒä¼˜å¯å°†å…¶ä»– CPU å¯†é›†å‹çº¿ç¨‹ç§»åŠ¨åˆ°ä¸“ç”¨å†…æ ¸ï¼Œä¾‹å¦‚ï¼šEPICS çº¿ç¨‹Â cbLowã€‚\nst.cmd \u0026#9660; 1 afterInit \u0026#34;epicsThreadSetAffinity cbLow 6\u0026#34; cbLowÂ åœ¨ iocInit åˆ›å»ºï¼Œå› æ­¤epicsThreadSetAffinityå¿…é¡»ä½¿ç”¨afterInitå‘½ä»¤æ‰§è¡Œã€‚\nè¿˜å¯ä»¥ä½¿ç”¨ EPICS æ¨¡å— MCoreUtils ä¸­çš„å·¥å…·è®¾ç½®CPUäº²å’Œæ€§ã€‚\nå‚è€ƒ\necmc server :: ecmccfg ","permalink":"https://kira-96.github.io/notes/linux-cpu-isolation/","summary":"\u003cp\u003eCPUéš”ç¦»ä¸»è¦æ˜¯ä¸ºäº†ç¡®ä¿å…³é”®è¿›ç¨‹è·å¾—æ›´é«˜çš„æ€§èƒ½ï¼Œå‡å°‘å¹²æ‰°ã€‚å¸¸è§çš„éš”ç¦»æ–¹æ³•æœ‰cgroupsã€tasksetã€isolcpuså†…æ ¸å‚æ•°ï¼Œè¿˜æœ‰å®æ—¶å†…æ ¸ï¼ˆPREEMPT RTï¼‰é…ç½®ã€‚è¿˜æœ‰CPUäº²å’Œæ€§ã€IRQå±è”½æŠ€æœ¯ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eisolcpus\u003c/code\u003eï¼šåœ¨å¯åŠ¨å†…æ ¸æ—¶éš”ç¦»æŸäº›CPUæ ¸å¿ƒï¼Œé˜²æ­¢æ™®é€šè¿›ç¨‹ä½¿ç”¨ã€‚ä½†éœ€è¦ç»“åˆcgroupsæˆ–tasksetæ¥åˆ†é…è¿›ç¨‹åˆ°éš”ç¦»æ ¸å¿ƒã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enohz_full\u003c/code\u003eï¼šåœ¨éš”ç¦»æ ¸å¿ƒç¦ç”¨æ—¶é’Ÿä¸­æ–­ï¼ˆTickless æ¨¡å¼ï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ercu_nocbs\u003c/code\u003eï¼šå°† RCU å›è°ƒä»»åŠ¡ç§»å‡ºéš”ç¦»æ ¸å¿ƒã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eä¿®æ”¹å†…æ ¸å¯åŠ¨å‚æ•°\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eä¸»è¦å‚æ•°ï¼š\u003ccode\u003eioslcpus=? nohz_full=? rcu_nocbs=?\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eä¾‹ï¼š\n\u003ccode\u003eearlycon console=tty console=ttyS0,115200 isolcpus=1,2 nohz_full=1,2 rcu_nocbs=1,2 acpi=off rdinit=/sbin/init rootdelay=5 root=/dev/sda1\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eé€šè¿‡GRUBé…ç½®\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"/etc/default/grub\"\u003e/etc/default/grub\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# æ·»åŠ isolcpuså‚æ•°\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eGRUB_CMDLINE_LINUX\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;isolcpus=1,2 nohz_full=1,2 rcu_nocbs=1,2\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eä¿®æ”¹å®Œæˆåæ›´æ–°GRUBé…ç½®ï¼š\u003ccode\u003esudo update-grub\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eè®¾ç½®è¿›ç¨‹CPUäº²å’Œæ€§\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# å¯åŠ¨æ—¶ç»‘å®šåˆ°æ ¸å¿ƒ 1,2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etaskset -a -c 1,2 ./st.cmd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ä¿®æ”¹è¿è¡Œä¸­è¿›ç¨‹çš„ CPU äº²å’Œæ€§\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etaskset -cp \u0026lt;core_list\u0026gt; \u0026lt;pid\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\n\u003cp\u003e\u003cdetails \u003e\n  \u003csummary markdown=\"span\"\u003eIgH EtherCATé©±åŠ¨è®¾ç½®CPUäº²å’Œæ€§\u003c/summary\u003e\n  \u003cp\u003eåœ¨è„šæœ¬ä¸­æ·»åŠ å¯åŠ¨å‚æ•°\u003ccode\u003erun_on_cpu=?\u003c/code\u003eï¼Œä¾‹ï¼š\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"/sbin/ethercatctl\"\u003e/sbin/ethercatctl\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e## /sbin/ethercatctl\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# load master module\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e ! \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eMODPROBE\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eMODPROBE_FLAGS\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e ec_master \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003emain_devices\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eDEVICES\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003ebackup_devices\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eBACKUPS\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003erun_on_cpu\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e1\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eexit\u003c/span\u003e \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e...\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003c/details\u003e\u003c/p\u003e","title":"Linux CPUæ ¸å¿ƒéš”ç¦»"},{"content":"å‰è¨€ æœ€è¿‘åœ¨è¯•ç€æŠŠè‡ªå®šä¹‰çš„QMLæ§ä»¶å°è£…æˆæ’ä»¶ä¾›å…¶ä»–ç¨‹åºè°ƒç”¨ï¼Œç”±äºæˆ‘ä½¿ç”¨çš„è¿˜æ˜¯Qt5ï¼Œåœ¨æ„å»ºçš„è¿‡ç¨‹ä¸­é‡åˆ°ä¸å°‘é—®é¢˜ï¼Œè¿™é‡Œåšä¸€ä¸‹ç®€å•æ±‡æ€»ã€‚\næ–°å»ºé¡¹ç›® æ–°å»ºåº“â†’Qt Quick2 Extension Pluginï¼ŒQt 5ç‰ˆæœ¬ä»…æ”¯æŒä½¿ç”¨QMakeä½œä¸ºæ„å»ºå¥—ä»¶ã€‚Qt 6æ‰æ”¯æŒä½¿ç”¨CMakeä½œä¸ºQMLæ‰©å±•æ’ä»¶çš„æ„å»ºå¥—ä»¶ã€‚\nç¼–å†™æ’ä»¶ ä¾‹å¦‚ï¼Œæˆ‘æ–°å»ºäº†ä¸€ä¸ªå«åšTestçš„æ’ä»¶åº“ï¼Œé¡¹ç›®ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªTestPluginçš„ç±»ï¼Œè¿™ä¸ªç±»ç»§æ‰¿è‡ªQQmlExtensionPluginï¼Œæˆ‘ä»¬éœ€è¦é‡å†™å®ƒçš„ä¸¤ä¸ªè™šå‡½æ•°ã€‚\ntestplugin.h \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 #include \u0026lt;QQmlExtensionPlugin\u0026gt; class TestPlugin : public QQmlExtensionPlugin { Q_OBJECT Q_PLUGIN_METADATA(IID QQmlExtensionInterface_iid) public: void registerTypes(const char *uri) Q_DECL_OVERRIDE; void initializeEngine(QQmlEngine *engine, const char *uri) Q_DECL_OVERRIDE; }; testplugin.cpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 #include \u0026#34;testplugin.h\u0026#34; #include \u0026#34;myitem.h\u0026#34; #include \u0026lt;qqml.h\u0026gt; void TestPlugin::registerTypes(const char *uri) { // @uri com.mycompany.qmlcomponents qmlRegisterType\u0026lt;MyItem\u0026gt;(uri, 1, 0, \u0026#34;MyItem\u0026#34;); } void TestPlugin::initializeEngine(QQmlEngine *engine, const char *uri) { QQmlExtensionPlugin::initializeEngine(engine, uri); } å…¶ä¸­ï¼ŒMyItemå°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„æ§ä»¶ã€‚ç®€å•çœ‹ä¸€ä¸‹ç¤ºä¾‹ä»£ç ï¼š\nmyitem.h \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 #include \u0026lt;QtQuick/QQuickPaintedItem\u0026gt; class MyItem : public QQuickPaintedItem { Q_OBJECT QML_ELEMENT Q_DISABLE_COPY(MyItem) public: explicit MyItem(QQuickItem *parent = Q_NULLPTR); void paint(QPainter *painter) Q_DECL_OVERRIDE; ~MyItem() Q_DECL_OVERRIDE; }; MyItemç»§æ‰¿è‡ªQQuickItemï¼Œå¹¶ä½¿ç”¨QML_ELEMENTå£°æ˜äº†å®ƒæ˜¯ä¸€ä¸ªQMLå…ƒç´ ï¼Œæœ€åå†ä½¿ç”¨qmlRegisterTypeæ³¨å†Œã€‚è¿™æ ·MyItemå°±å¯ä»¥åœ¨QMLä¸­ä½¿ç”¨äº†ã€‚\nä½¿ç”¨è¿™ç§æ–¹å¼ä¹Ÿå¯ä»¥æ³¨å†Œç»§æ‰¿è‡ªQObjectçš„ç±»ã€‚ä¾‹å¦‚ï¼š\nmyobject.h \u0026#9660; 1 2 3 4 5 6 7 class MyObject : public QObject { Q_OBJECT Q_DISABLE_COPY(MyObject) public: explicit MyObject(QObject *parent = Q_NULLPTR); }; ç„¶ååœ¨Pluginç±»ä¸­è¿›è¡Œæ³¨å†Œï¼š\ntestplugin.cpp \u0026#9660; 1 2 3 4 5 6 void TestPlugin::registerTypes(const char *uri) { // @uri com.mycompany.qmlcomponents qmlRegisterType\u0026lt;MyItem\u0026gt;(uri, 1, 0, \u0026#34;MyItem\u0026#34;); qmlRegisterType\u0026lt;MyObject\u0026gt;(uri, 1, 0, \u0026#34;MyObject\u0026#34;); } è‡ªå®šä¹‰QMLæ§ä»¶ QMLæ’ä»¶åº“å½“ç„¶ä¹Ÿå¯ä»¥å°è£….qmlçš„è‡ªå®šä¹‰æ’ä»¶ã€‚ä¾‹å¦‚ï¼š\nMyLabel.qml \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 import QtQuick 2.15 import QtQuick.Controls 2.15 Label { id: control property string backgroundColor background: Rectangle { color: backgroundColor } } æŠŠè‡ªå®šä¹‰çš„qmlæ§ä»¶æ·»åŠ åˆ°èµ„æºæ–‡ä»¶ï¼Œç„¶åå¯ä»¥åœ¨Pluginç±»ä¸­è¿›è¡Œæ³¨å†Œã€‚\ntestplugin.cpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 void TestPlugin::registerTypes(const char *uri) { // @uri com.mycompany.qmlcomponents qmlRegisterType\u0026lt;MyItem\u0026gt;(uri, 1, 0, \u0026#34;MyItem\u0026#34;); qmlRegisterType\u0026lt;MyObject\u0026gt;(uri, 1, 0, \u0026#34;MyObject\u0026#34;); // register qml types qmlRegisterType(QUrl(\u0026#34;qrc:/qml/MyLabel.qml\u0026#34;), uri, MAJOR, MINOR, \u0026#34;MyLabel\u0026#34;); } qmldiræ–‡ä»¶ qmldiræ–‡ä»¶ç”¨äºQMLæ’ä»¶æ¨¡å—ç®¡ç†ï¼Œæè¿°äº†qmlæ’ä»¶çš„åŸºæœ¬ä¿¡æ¯ã€‚ç¤ºä¾‹ï¼š\nqmldir \u0026#9660; 1 2 3 4 5 6 module com.mycompany.qmlcomponents plugin testplugin classname TestPlugin typeinfo plugins.qmltypes designersupported depends QtQuick.Controls 2.12 module å’Œæ’ä»¶çš„urié…ç½®ç›¸åŒ plugin æ’ä»¶æ–‡ä»¶åå­—ï¼Œé€šå¸¸æ˜¯å°å†™ classname æ’ä»¶ç±»çš„åå­— typeinfo æ’ä»¶çš„å…ƒæ•°æ®æ–‡ä»¶ï¼Œç¨åä¼šå†™æ€ä¹ˆç”Ÿæˆè¿™ä¸ªæ–‡ä»¶ é¡¹ç›®æ–‡ä»¶é…ç½® ä¸‹é¢æ˜¯æˆ‘çš„ä¸€ä¸ªé¡¹ç›®é…ç½®ï¼ŒåŒ…å«æ’ä»¶ä¿¡æ¯é…ç½®ï¼Œå’Œç”Ÿæˆå…ƒæ•°æ®çš„è‡ªå®šä¹‰å‘½ä»¤ã€‚\nTestPlugin.pro \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 ## TestPlugin.pro TEMPLATE = lib TARGET = testplugin QT += core qml quick CONFIG += plugin c++11 # CONFIG += qmltypes # æ’ä»¶çš„URI uri = com.mycompany.qmlcomponents QML_PLUGIN_NAME = $$TARGET # å¯ä»¥é€šè¿‡ import çš„æ–¹å¼åœ¨qmlä¸­ä½¿ç”¨æ’ä»¶ä¸­çš„æ§ä»¶ QML_IMPORT_NAME = $$uri # æ’ä»¶çš„ç‰ˆæœ¬å· QML_IMPORT_MAJOR_VERSION = 1 QML_IMPORT_MINOR_VERSION = 0 # ç”Ÿæˆæ’ä»¶çš„è·¯å¾„ DESTDIR = imports/$$replace(QML_IMPORT_NAME, \\., $$QMAKE_DIR_SEP) QMLTYPES_FILENAME = $$DESTDIR/plugins.qmltypes TARGET = $$qtLibraryTarget($$TARGET) HEADERS += ... SOURCES += ... # æ‹·è´qmldiræ–‡ä»¶åˆ°è¾“å‡ºç›®å½• DISTFILES = qmldir !equals(_PRO_FILE_PWD_, $$OUT_PWD) { copy_qmldir.target = $$DESTDIR/qmldir copy_qmldir.depends = $$_PRO_FILE_PWD_/qmldir copy_qmldir.commands = $(COPY_FILE) \u0026#34;$$replace(copy_qmldir.depends, /, $$QMAKE_DIR_SEP)\u0026#34; \u0026#34;$$replace(copy_qmldir.target, /, $$QMAKE_DIR_SEP)\u0026#34; QMAKE_EXTRA_TARGETS += copy_qmldir PRE_TARGETDEPS += $$copy_qmldir.target } # æ·»åŠ æ„å»ºåç”Ÿæˆå…ƒæ•°æ®çš„è‡ªå®šä¹‰å‘½ä»¤ qmltypes.commands = $$[QT_INSTALL_PREFIX]/bin/qmlplugindump -nonrelocatable $$QML_IMPORT_NAME \u0026#34;$${QML_IMPORT_MAJOR_VERSION}.$${QML_IMPORT_MINOR_VERSION}\u0026#34; $$OUT_PWD/imports \u0026gt; $$OUT_PWD/$$DESTDIR/plugins.qmltypes qmltypes.depends = $$QML_PLUGIN_NAME.target QMAKE_EXTRA_TARGETS += qmltypes # ç¡®ä¿æ„å»ºåæ‰§è¡Œå…ƒæ•°æ®ç”Ÿæˆ # POST_TARGETDEPS += $$QML_PLUGIN_NAME POST_TARGETDEPS += qmltypes è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„çš„ï¼š\næœ‰èµ„æ–™è¯´åŠ å…¥ CONFIG += qmltypes é…ç½®å°±å¯ä»¥è‡ªåŠ¨ç”Ÿæˆæ’ä»¶å…ƒæ•°æ®ä¿¡æ¯ï¼Œè¿™ç‚¹æˆ‘æµ‹è¯•ç¡®å®å¯ä»¥ï¼Œä½†ç”Ÿæˆçš„å…ƒæ•°æ®æ˜¯ä¸å®Œæ•´çš„ã€‚è¿™ä¸ªé…ç½®åªèƒ½ç”Ÿæˆä½¿ç”¨äº†QML_ELEMENTå®çš„ç±»ï¼Œæ— æ³•ç”ŸæˆQObjectç±»å’ŒQMLæ§ä»¶çš„å…ƒæ•°æ®ï¼ŒåŸºæœ¬ä¸Šæ— ç”¨ã€‚ ç”Ÿæˆå…ƒæ•°æ®å¿…é¡»ä½¿ç”¨qmlplugindumpå·¥å…·ï¼Œè¿™ä¸ªå·¥å…·å’Œqmakeåœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ã€‚ qmlplugindumpå·¥å…·çš„ä½¿ç”¨ è¿™é‡Œä½¿ç”¨çš„å‘½ä»¤å¦‚ä¸‹ï¼š\nqmlplugindump -nonrelocatable QMLå¯¼å…¥URI æ’ä»¶ç‰ˆæœ¬ æ’ä»¶ç›®å½• \u0026gt; ç”Ÿæˆplugins.qmltypesè·¯å¾„\nQMLå¯¼å…¥URIï¼šç¼–è¯‘æ’ä»¶æ—¶æŒ‡å®šçš„uriï¼Œå¦‚ï¼šcom.mycompany.qmlcomponents æ’ä»¶æœ¬æœ¬ï¼šç¼–è¯‘æ’ä»¶æ—¶æŒ‡å®šçš„ç‰ˆæœ¬ï¼Œå¦‚ï¼š1.0 æ’ä»¶ç›®å½•ï¼šè¿™ä¸ªéœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œè¿™ä¸ªæŒ‡çš„æ˜¯æ’ä»¶çš„ç›®å½•ï¼Œä¸æ˜¯æ’ä»¶åº“çš„ç›®å½•ã€‚æ¯”å¦‚æˆ‘ç”Ÿæˆçš„æ’ä»¶æ˜¯åœ¨importsç›®å½•ï¼Œæ„å»ºå¥—ä»¶ä¼šæ ¹æ®æ’ä»¶çš„uriè‡ªåŠ¨ç”Ÿæˆæ’ä»¶åº“çš„ç›®å½•ï¼Œå¦‚ï¼šimports/com/mycompany/qmlcomponents/testplugin.soï¼Œé‚£ä¹ˆè¿™é‡Œåº”è¯¥ä¼ å…¥å‚æ•°/path/to/importsï¼Œä¸è¦ä¼ å…¥æ’ä»¶åº“æ‰€åœ¨çš„ç›®å½•ã€‚ ç”Ÿæˆplugins.qmltypesè·¯å¾„ï¼šè¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è§£é‡Šçš„ï¼Œä½†æ³¨æ„plugins.qmltypeséœ€è¦å’Œæ’ä»¶åº“æ”¾åœ¨ç»Ÿä¸€ç›®å½•ï¼Œæ‰€ä»¥è¿™é‡Œæœ€åä¼ å…¥å‚æ•°/path/to/imports/com/mycompany/qmlcomponents/plugins.qmltypesã€‚ æ³¨æ„ï¼š\nqmldiræ–‡ä»¶å’Œç”Ÿæˆçš„æ’ä»¶éœ€è¦æ”¾åˆ°åŒä¸€ç›®å½•ä¸‹ï¼Œå¦åˆ™qmlplugindumpè¯»ä¸åˆ°æ’ä»¶ä¿¡æ¯ã€‚ å¦‚æœç”Ÿæˆçš„æ’ä»¶ä¾èµ–å…¶ä»–åŠ¨æ€åº“ï¼Œä¸€å®šè¦ç¡®ä¿qmlplugindumpèƒ½æ‰¾åˆ°è¿™äº›åº“ï¼Œå¦åˆ™æ’ä»¶æ— æ³•åŠ è½½å°±ä¸èƒ½ç”Ÿæˆå…ƒæ•°æ®ã€‚ é—®é¢˜ï¼š\nplugin cannot be loaded for module \u0026ldquo;com.mycompany.qmlcomponents\u0026rdquo;: Cannot load library testplugin.dll: æ‰¾ä¸åˆ°æŒ‡å®šçš„æ¨¡å—ã€‚(æ£€æŸ¥åŠ¨æ€åº“çš„è·¯å¾„ï¼Œå¯å°è¯•æ·»åŠ åˆ°ç¯å¢ƒå˜é‡) QQmlComponent: Component is not ready file:///path/to/imports/com/mycompany/qmlcomponents/qmldir: plugin cannot be loaded for module \u0026ldquo;\u0026rdquo;: Module namespace \u0026lsquo;com.mycompany.qmlcomponents\u0026rsquo; does not match import URI \u0026rsquo;\u0026rsquo; (æ£€æŸ¥ä¼ å…¥å‚æ•°çš„æ’ä»¶ç›®å½•æ˜¯å¦æ­£ç¡®ï¼Ÿ) ä½¿ç”¨QMLæ’ä»¶ ç¡®ä¿æ’ä»¶ç›®å½•ä¸­åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶ï¼štestplugin.soã€plugins.qmltypesã€qmldirã€‚ å°†æ’ä»¶ç›®å½•æ·»åŠ åˆ°Qml Emgineçš„å¯¼å…¥ç›®å½•åˆ—è¡¨ï¼š main.cpp \u0026#9660; 1 2 3 4 5 6 QGuiApplication app(argc, argv); QQmlApplicationEngine engine(\u0026amp;app); ... // æ·»åŠ æ’ä»¶è·¯å¾„åˆ°å¯¼å…¥ç›®å½•åˆ—è¡¨ engine.addImportPath(\u0026#34;imports\u0026#34;); engine.load(url); åœ¨qmlä¸­å¯¼å…¥ã€ä½¿ç”¨è‡ªå®šä¹‰æ§ä»¶ main.qml \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 import com.mycompany.qmlcomponents 1.0 Window { id: window width: 640 height: 480 visible: true title: qsTr(\u0026#34;Hello World\u0026#34;) // @disable-check M16 MyItem { id: myitem } MyLabel { id: mylabel text: qsTr(\u0026#34;Hello World\u0026#34;) backgroundColor: \u0026#39;red\u0026#39; } } å¦‚ä½•ä½¿ç”¨æ’ä»¶ä¸­çš„é™æ€å‡½æ•°ï¼Ÿ è¿™é‡Œéœ€è¦å¯¹é™æ€å‡½æ•°åšä¸€ä¸‹å°è£…ã€‚ä¾‹å¦‚ï¼Œæˆ‘å®šä¹‰äº†ä¸€ä¸ªé™æ€å‡½æ•°ï¼š\nmyutils.h \u0026#9660; 1 2 3 4 5 6 7 8 class MyUtils { public: static void myFunc() { printf(\u0026#34;Hello from myFunc().\u0026#34;); } }; è¿™é‡Œéœ€è¦å®šä¹‰ä¸€ä¸ªæ’ä»¶çš„Helperç±»ï¼Œç„¶ååœ¨æ’ä»¶é‡Œé¢æ³¨å†Œè¿™ä¸ªç±»ï¼Œåœ¨è¿™ä¸ªç±»é‡Œé¢å®ç°é™æ€å‡½æ•°è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š\ntestplugin.cpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #include \u0026#34;myutils.h\u0026#34; class TestPluginHelper : public QObject { Q_OBJECT public: Q_INVOKABLE void callMyFunc() { MyUtils::myFunc(); } }; #include \u0026#34;testplugin.moc\u0026#34; void TestPlugin::initializeEngine(QQmlEngine *engine, const char *uri) { QQmlExtensionPlugin::initializeEngine(engine, uri); // æ³¨å†Œå¯¹è±¡åˆ°ä¸Šä¸‹æ–‡ engine-\u0026gt;rootContext()-\u0026gt;setContextProperty(\u0026#34;testPluginHelper\u0026#34;, new TestPluginHelper); } åœ¨QMLä¸­è°ƒç”¨ï¼š\nqml \u0026#9660; 1 2 3 4 5 6 7 Item { id: item Component.onCompleted: { testPluginHelper.callMyFunc() } } ","permalink":"https://kira-96.github.io/posts/qt5-quick2-extension-plugin/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eæœ€è¿‘åœ¨è¯•ç€æŠŠè‡ªå®šä¹‰çš„QMLæ§ä»¶å°è£…æˆæ’ä»¶ä¾›å…¶ä»–ç¨‹åºè°ƒç”¨ï¼Œç”±äºæˆ‘ä½¿ç”¨çš„è¿˜æ˜¯Qt5ï¼Œåœ¨æ„å»ºçš„è¿‡ç¨‹ä¸­é‡åˆ°ä¸å°‘é—®é¢˜ï¼Œè¿™é‡Œåšä¸€ä¸‹ç®€å•æ±‡æ€»ã€‚\u003c/p\u003e\n\u003ch2 id=\"æ–°å»ºé¡¹ç›®\"\u003eæ–°å»ºé¡¹ç›®\u003c/h2\u003e\n\u003cp\u003eæ–°å»º\u003cem\u003eåº“â†’Qt Quick2 Extension Plugin\u003c/em\u003eï¼Œ\u003ccode\u003eQt 5\u003c/code\u003eç‰ˆæœ¬ä»…æ”¯æŒä½¿ç”¨\u003ccode\u003eQMake\u003c/code\u003eä½œä¸ºæ„å»ºå¥—ä»¶ã€‚\u003ccode\u003eQt 6\u003c/code\u003eæ‰æ”¯æŒä½¿ç”¨\u003ccode\u003eCMake\u003c/code\u003eä½œä¸ºQMLæ‰©å±•æ’ä»¶çš„æ„å»ºå¥—ä»¶ã€‚\u003c/p\u003e\n\u003ch2 id=\"ç¼–å†™æ’ä»¶\"\u003eç¼–å†™æ’ä»¶\u003c/h2\u003e\n\u003cp\u003eä¾‹å¦‚ï¼Œæˆ‘æ–°å»ºäº†ä¸€ä¸ªå«åš\u003ccode\u003eTest\u003c/code\u003eçš„æ’ä»¶åº“ï¼Œé¡¹ç›®ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª\u003ccode\u003eTestPlugin\u003c/code\u003eçš„ç±»ï¼Œè¿™ä¸ªç±»ç»§æ‰¿è‡ª\u003ccode\u003eQQmlExtensionPlugin\u003c/code\u003eï¼Œæˆ‘ä»¬éœ€è¦é‡å†™å®ƒçš„ä¸¤ä¸ªè™šå‡½æ•°ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"testplugin.h\"\u003etestplugin.h\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#include\u003c/span\u003e \u003cspan class=\"cpf\"\u003e\u0026lt;QQmlExtensionPlugin\u0026gt;\u003c/span\u003e\u003cspan class=\"cp\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTestPlugin\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eQQmlExtensionPlugin\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eQ_OBJECT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nf\"\u003eQ_PLUGIN_METADATA\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIID\u003c/span\u003e \u003cspan class=\"n\"\u003eQQmlExtensionInterface_iid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eregisterTypes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003eQ_DECL_OVERRIDE\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003einitializeEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eQQmlEngine\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eengine\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003eQ_DECL_OVERRIDE\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"testplugin.cpp\"\u003etestplugin.cpp\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#include\u003c/span\u003e \u003cspan class=\"cpf\"\u003e\u0026#34;testplugin.h\u0026#34;\u003c/span\u003e\u003cspan class=\"cp\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#include\u003c/span\u003e \u003cspan class=\"cpf\"\u003e\u0026#34;myitem.h\u0026#34;\u003c/span\u003e\u003cspan class=\"cp\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#include\u003c/span\u003e \u003cspan class=\"cpf\"\u003e\u0026lt;qqml.h\u0026gt;\u003c/span\u003e\u003cspan class=\"cp\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eTestPlugin\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eregisterTypes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// @uri com.mycompany.qmlcomponents\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eqmlRegisterType\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eMyItem\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;MyItem\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eTestPlugin\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003einitializeEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eQQmlEngine\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eengine\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eQQmlExtensionPlugin\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003einitializeEngine\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eengine\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eå…¶ä¸­ï¼Œ\u003ccode\u003eMyItem\u003c/code\u003eå°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„æ§ä»¶ã€‚ç®€å•çœ‹ä¸€ä¸‹ç¤ºä¾‹ä»£ç ï¼š\u003c/p\u003e","title":"Qt5ç¼–å†™Qt Quick2æ’ä»¶"},{"content":"IOC é…ç½®SNCSEQï¼š\nconfigure/RELEASE.local \u0026#9660; 1 2 3 4 5 EPICS_BASE = /path/to/your/build/of/epics-base SUPPORT = ${EPICS_BASE}/../epics-modules PVXS = ${SUPPORT}/pvxs # æ·»åŠ  SNCSEQ SNCSEQ = ${SUPPORT}/sequencer exampleå·¥ç¨‹ä¸­ç›¸å…³çš„ä»£ç ï¼š\nMakefile \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 # example/iocExampleApp/src/Makefile ... # Link in the code from our support library iocExample_LIBS += iocExampleSupport # To build SNL programs, SNCSEQ must be defined # in the \u0026lt;top\u0026gt;/configure/RELEASE file ifneq ($(SNCSEQ),) # Build sncExample into iocExampleSupport sncExample_SNCFLAGS += +r iocExample_DBD += sncExample.dbd # A .stt sequence program is *not* pre-processed: iocExampleSupport_SRCS += sncExample.stt iocExampleSupport_LIBS += seq pv iocExample_LIBS += seq pv # Build sncProgram as a standalone program PROD_HOST += sncProgram sncProgram_SNCFLAGS += +m # A .st sequence program *is* pre-processed: sncProgram_SRCS += sncProgram.st sncProgram_LIBS += seq pv sncProgram_LIBS += $(EPICS_BASE_HOST_LIBS) endif ... sncExample.dbd \u0026#9660; 1 2 3 4 5 # The name below is derived from the name of the SNL program # inside the source file, not from its filename. Here the # program is called sncExample, but is compiled in both the # sncExample.stt and sncProgram.st source files. registrar(sncExampleRegistrar) sncProgram.st \u0026#9660; 1 #include \u0026#34;../sncExample.stt\u0026#34; sncExample.stt \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 program sncExample double v; assign v to \u0026#34;{user}:aiExample\u0026#34;; monitor v; ss ss1 { state init { when (delay(10)) { printf(\u0026#34;sncExample: Startup delay over\\n\u0026#34;); } state low } state low { when (v \u0026gt; 5.0) { printf(\u0026#34;sncExample: Changing to high\\n\u0026#34;); } state high } state high { when (v \u0026lt;= 5.0) { printf(\u0026#34;sncExample: Changing to low\\n\u0026#34;); } state low } } ä¿®æ”¹å¯åŠ¨è„šæœ¬ï¼Œåœ¨IOCå¯åŠ¨æ—¶è¿è¡ŒSNLç¨‹åºï¼š\nst.cmd \u0026#9660; 1 2 3 4 ... ## Start any sequence programs seq sncExample, \u0026#34;user=$(USER)\u0026#34; ç¼–è¯‘ï¼š\nshell \u0026#9660; 1 make -j 8 æ­¤æ—¶æŸ¥çœ‹example/dbd/iocExample.dbdï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°ï¼š\ndbd/iocExample.dbd \u0026#9660; 1 2 3 ... registrar(sncExampleRegistrar) ... ","permalink":"https://kira-96.github.io/notes/epics-ioc-%E4%BD%BF%E7%94%A8-sncseq/","summary":"\u003cp\u003eIOC é…ç½®\u003ccode\u003eSNCSEQ\u003c/code\u003eï¼š\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"configure/RELEASE.local\"\u003econfigure/RELEASE.local\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eEPICS_BASE\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e /path/to/your/build/of/epics-base\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSUPPORT\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eEPICS_BASE\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/../epics-modules\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003ePVXS\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eSUPPORT\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/pvxs\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# æ·»åŠ  SNCSEQ\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSNCSEQ\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eSUPPORT\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/sequencer\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eexampleå·¥ç¨‹ä¸­ç›¸å…³çš„ä»£ç ï¼š\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"Makefile\"\u003eMakefile\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-Makefile\" data-lang=\"Makefile\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# example/iocExampleApp/src/Makefile\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Link in the code from our support library\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eiocExample_LIBS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e iocExampleSupport\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# To build SNL programs, SNCSEQ must be defined\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# in the \u0026lt;top\u0026gt;/configure/RELEASE file\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eifneq\u003c/span\u003e \u003cspan class=\"err\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003e\u003cspan class=\"nv\"\u003eSNCSEQ\u003c/span\u003e\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"err\"\u003e,)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e# Build sncExample into iocExampleSupport\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003esncExample_SNCFLAGS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e +r\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003eiocExample_DBD\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e sncExample.dbd\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# A .stt sequence program is *not* pre-processed:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003eiocExampleSupport_SRCS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e sncExample.stt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003eiocExampleSupport_LIBS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e seq pv\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003eiocExample_LIBS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e seq pv\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Build sncProgram as a standalone program\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003ePROD_HOST\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e sncProgram\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003esncProgram_SNCFLAGS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e +m\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# A .st sequence program *is* pre-processed:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003esncProgram_SRCS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e sncProgram.st\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003esncProgram_LIBS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e seq pv\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003esncProgram_LIBS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eEPICS_BASE_HOST_LIBS\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eendif\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e...\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"sncExample.dbd\"\u003esncExample.dbd\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# The name below is derived from the name of the SNL program\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# inside the source file, not from its filename. Here the\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# program is called sncExample, but is compiled in both the\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# sncExample.stt and sncProgram.st source files.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eregistrar\u003cspan class=\"o\"\u003e(\u003c/span\u003esncExampleRegistrar\u003cspan class=\"o\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"sncProgram.st\"\u003esncProgram.st\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e#include\u003c/span\u003e \u003cspan class=\"cpf\"\u003e\u0026#34;../sncExample.stt\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"sncExample.stt\"\u003esncExample.stt\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eprogram\u003c/span\u003e \u003cspan class=\"n\"\u003esncExample\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003edouble\u003c/span\u003e \u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eassign\u003c/span\u003e \u003cspan class=\"n\"\u003ev\u003c/span\u003e \u003cspan class=\"n\"\u003eto\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e{user}\u003c/span\u003e\u003cspan class=\"s2\"\u003e:aiExample\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003emonitor\u003c/span\u003e \u003cspan class=\"n\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ess\u003c/span\u003e \u003cspan class=\"n\"\u003ess1\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estate\u003c/span\u003e \u003cspan class=\"n\"\u003einit\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003ewhen\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edelay\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003eprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;sncExample: Startup delay over\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"n\"\u003estate\u003c/span\u003e \u003cspan class=\"n\"\u003elow\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estate\u003c/span\u003e \u003cspan class=\"n\"\u003elow\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003ewhen\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mf\"\u003e5.0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003eprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;sncExample: Changing to high\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"n\"\u003estate\u003c/span\u003e \u003cspan class=\"n\"\u003ehigh\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estate\u003c/span\u003e \u003cspan class=\"n\"\u003ehigh\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003ewhen\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ev\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"mf\"\u003e5.0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003eprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;sncExample: Changing to low\u003c/span\u003e\u003cspan class=\"se\"\u003e\\n\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"n\"\u003estate\u003c/span\u003e \u003cspan class=\"n\"\u003elow\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eä¿®æ”¹å¯åŠ¨è„šæœ¬ï¼Œåœ¨\u003ccode\u003eIOC\u003c/code\u003eå¯åŠ¨æ—¶è¿è¡ŒSNLç¨‹åºï¼š\u003c/p\u003e","title":"EPICS IOC ä½¿ç”¨ SNCSEQ"},{"content":"å‰è¨€ EPICS V7 ä¸­å¼•å…¥äº† pvAccessã€pvDataç­‰ç›¸å…³æ¨¡å—ï¼Œå¢åŠ äº†å¯¹ç»“æ„åŒ–æ•°æ®çš„æ”¯æŒã€‚ pvData (Process Variable Data, è¿‡ç¨‹å˜é‡æ•°æ®) æ˜¯EPICSæ ¸å¿ƒè½¯ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¿è¡Œæ—¶ç±»å‹ç³»ç»Ÿï¼Œå…·æœ‰ç”¨äºå¤„ç†ç»“æ„åŒ–æ•°æ®çš„åºåˆ—åŒ–å’Œå†…çœï¼ˆintrospectionï¼‰åŠŸèƒ½ã€‚\npvDataæœ‰å››ç§ç±»å‹çš„æ•°æ®å­—æ®µï¼šscalarã€scalarArrayã€structureå’ŒstructureArrayã€‚scalarï¼ˆæ ‡é‡ï¼‰å¯ä»¥æ˜¯ä»¥ä¸‹æ ‡é‡ç±»å‹ä¹‹ä¸€ï¼šBooleanã€Byteã€Shortã€Intã€Longã€U(nsigned)Byteã€Unsigned Shortã€Unsigned Intã€Unsigned Longã€Floatã€Doubleå’ŒStringã€‚scalarArrayæ˜¯ä¸€ç»´æ•°ç»„ï¼Œå…ƒç´ ç±»å‹ä¸ºä»»ä½•æ ‡é‡ç±»å‹ã€‚structureï¼ˆç»“æ„ä½“ï¼‰æ˜¯ä¸€ç»„æœ‰åºçš„å­—æ®µï¼Œå…¶ä¸­æ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªåç§°å’Œç±»å‹ã€‚structureArrayæ˜¯ç»“æ„ä½“æ•°ç»„ï¼Œç”±äºå­—æ®µå¯ä»¥æ˜¯ç»“æ„ï¼Œå› æ­¤å¯ä»¥åˆ›å»ºå¤æ‚çš„ç»“æ„ã€‚\nQSRVæ˜¯ä¸€ä¸ªä½¿ç”¨PVAccessåè®®çš„ç½‘ç»œæœåŠ¡å™¨ï¼Œåœ¨EPICS IOCè¿›ç¨‹ä¸­è¿è¡Œï¼Œå…è®¸å®¢æˆ·ç«¯è¯·æ±‚è®¿é—®å…¶ä¸­çš„è¿‡ç¨‹å˜é‡ï¼ˆPVï¼‰ã€‚ PVXSæ˜¯ä¸€ä¸ªPVAccessåè®®å®¢æˆ·ç«¯/æœåŠ¡å™¨çš„ç¨‹åºæ¨¡å—ã€‚åŠŸèƒ½ç­‰åŒäºÂ pvDataCPPï¼Œå¹¶å¸Œæœ›æœ€ç»ˆèƒ½å–ä»£CPPæ¨¡å—ã€‚\nPVAccess é»˜è®¤ç«¯å£ï¼š5076\nç¯å¢ƒå˜é‡è¡¨ï¼š\nVariable Client Server EPICS_PVA_ADDR_LIST Ã— Ã— EPICS_PVAS_BEACON_ADDR_LIST Ã— EPICS_PVA_AUTO_ADDR_LIST Ã— Ã— EPICS_PVAS_AUTO_BEACON_ADDR_LIST Ã— EPICS_PVAS_INTF_ADDR_LIST Ã— EPICS_PVA_SERVER_PORT Ã— Ã— EPICS_PVAS_SERVER_PORT Ã— EPICS_PVA_BROADCAST_PORT Ã— Ã— EPICS_PVAS_BROADCAST_PORT Ã— EPICS_PVAS_IGNORE_ADDR_LIST Ã— EPICS_PVA_CONN_TMO Ã— Ã— EPICS_PVA_NAME_SERVERS Ã— å¿«é€Ÿä½¿ç”¨ ä½¿ç”¨softIocPVAè½¯ä»¶ã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 cat \u0026lt;\u0026lt;EOF \u0026gt; p2pexample.db record(calc, \u0026#34;p2p:example:counter\u0026#34;) { field(INPA, \u0026#34;p2p:example:counter\u0026#34;) field(CALC, \u0026#34;A+1\u0026#34;) field(SCAN, \u0026#34;1 second\u0026#34;) } EOF ./bin/linux-x86_64/softIocPVA -d p2pexample.db æ·»åŠ  QSRV åˆ° IOC å¦‚æœä½¿ç”¨EPICS V7åˆ›å»ºIOCï¼Œé‚£ä¹ˆå¯ä»¥çœ‹åˆ°ç¨‹åºå·²ç»é»˜è®¤æ·»åŠ äº†QSRVåˆ°IOCä¸­ã€‚å¦‚ï¼š\nMakefile \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 # example/iocExampleApp/src/Makefile # Link QSRV (pvAccess Server) if available ifdef EPICS_QSRV_MAJOR_VERSION iocExampleApp_LIBS += qsrv iocExampleApp_LIBS += $(EPICS_BASE_PVA_CORE_LIBS) iocExampleApp_DBD += PVAServerRegister.dbd iocExampleApp_DBD += qsrv.dbd endif # Finally link IOC to the EPICS Base libraries iocExampleApp_LIBS += $(EPICS_BASE_IOC_LIBS) ç¼–è¯‘è¿è¡ŒIOCåï¼Œå¯ç›´æ¥ä½¿ç”¨pvgetã€pvputã€pvmonitorã€pvinfoç­‰å‘½ä»¤è¡Œå·¥å…·è®¿é—®è¿‡ç¨‹å˜é‡ã€‚\næ·»åŠ  PVXS åˆ° IOC éœ€è¦å…ˆç¼–è¯‘å®ŒæˆEPICS V7ã€‚\næºç æ„å»º PVXS è·å–pvxsæºç ï¼š\nshell \u0026#9660; 1 git clone --recursive https://github.com/epics-base/pvxs.git é…ç½®EPICS_BASEç¯å¢ƒå˜é‡ï¼š\nshell \u0026#9660; 1 2 3 cat \u0026lt;\u0026lt;EOF \u0026gt; pvxs/configure/RELEASE.local EPICS_BASE=\\$(TOP)/../epics-base EOF â€» ç¼–è¯‘libeventï¼ˆå¯é€‰ï¼‰ï¼š\nshell \u0026#9660; 1 make -C pvxs/bundle libevent # implies .$(EPICS_HOST_ARCH) â€» äº¤å‰ç¼–è¯‘libeventï¼ˆå¯é€‰ï¼‰ï¼š ä¿®æ”¹ bundle/Makefileï¼š\nbundle/Makefile \u0026#9660; 1 2 3 4 5 6 ifneq (,$(filter linux-%,$(EPICS_HOST_ARCH))) # cross mingw hosted on linux CMAKE_TOOLCHAIN_windows-x64-mingw ?= x86_64-w64-mingw32 # æ·»åŠ ä¸‹é¢ä¸€è¡Œ CMAKE_TOOLCHAIN_$(EPICS_HOST_ARCH) ?= $(EPICS_HOST_ARCH).cmake endif linux-loong64.cmake\nlinux-loong64.cmake \u0026#9660; 1 2 3 4 5 6 7 8 set(CMAKE_SYSTEM_NAME Linux) set(CMAKE_SYSTEM_PROCESSOR AMD64) set(CMAKE_C_COMPILER loongarch64-linux-gnu-gcc) set(CMAKE_CXX_COMPILER loongarch64-linux-gnu-g++) set(CMAKE_FIND_ROOT_PATH /usr/linux-loong64 ) set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER) set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY) set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY) äº¤å‰ç¼–è¯‘ï¼š\nshell \u0026#9660; 1 make -C pvxs/bundle libevent.linux-loong64 EPICS_HOST_ARCH=linux-loong64 å‘½ä»¤è¡Œå·¥å…·ï¼š\npvxcallÂ - ä¸Â pvcall ç›¸ä¼¼ pvxgetÂ - ä¸Â pvget ç›¸ä¼¼ pvxinfoÂ - ä¸Â pvinfo ç›¸ä¼¼ pvxmonitorÂ - ä¸Â pvmonitorÂ æˆ–Â pvgetÂ -m ç›¸ä¼¼ pvxputÂ - ä¸Â pvput ç›¸ä¼¼ pvxvctÂ - UDP search/beacon Troubleshooting tool. æ·»åŠ  PVXS åˆ° IOC\né…ç½®EPICS_BSAEå’ŒPVXSï¼š\nshell \u0026#9660; 1 2 3 4 cat \u0026lt;\u0026lt;EOF \u0026gt;\u0026gt; configure/RELEASE.local EPICS_BASE=/path/to/your/build/of/epics-base PVXS=/path/to/your/build/of/pvxs EOF å°†pvxså’ŒpvxsIocä½œä¸ºä¾èµ–åº“æ·»åŠ åˆ°IOCï¼š\nMakefile \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # example/iocExampleApp/src/Makefile # Link PVXS if available ifdef PVXS_MAJOR_VERSION iocExampleApp_LIBS += pvxsIoc pvxs iocExampleApp_DBD += pvxsIoc.dbd else # Link QSRV (pvAccess Server) if available ifdef EPICS_QSRV_MAJOR_VERSION iocExampleApp_LIBS += qsrv iocExampleApp_LIBS += $(EPICS_BASE_PVA_CORE_LIBS) iocExampleApp_DBD += PVAServerRegister.dbd iocExampleApp_DBD += qsrv.dbd endif endif # Finally link IOC to the EPICS Base libraries iocExampleApp_LIBS += $(EPICS_BASE_IOC_LIBS) pvxsIocåªåº”åŒ…å«åœ¨IOCä¸­ï¼Œåœ¨ç¼–å†™åº”ç”¨ç¨‹åºæ—¶åªåº”è¯¥ä¾èµ–pvxsã€‚\nç¼–è¯‘è¿è¡Œ\nshell \u0026#9660; 1 make -j 8 QSRV å•ä¸ª PV â€œå•ä¸ªâ€PVæ˜¯ç”±CAæœåŠ¡å™¨ï¼ˆRSRVï¼‰æä¾›çš„è®°å½•åå­—ï¼Œæ‰€æœ‰è®°å½•å­—æ®µéƒ½å¯ä»¥è¢«è®¿é—®ã€‚å› æ­¤ï¼Œæ‰€æœ‰å¯é€šè¿‡CAè®¿é—®çš„æ•°æ®ä¹Ÿå¯é€šè¿‡PVAccessè®¿é—®ã€‚ QSRVå°†æ‰€æœ‰â€œå•ä¸ªâ€PVå‘ˆç°ä¸ºç¬¦åˆè§„èŒƒç±»å‹NTScalarã€NTScalarArrayæˆ–NTEnumçš„ç»“æ„ï¼Œå…·ä½“å–å†³äºåŸç”ŸDBFå­—æ®µç±»å‹ã€‚\nå®šä¹‰PVç»„ â€œç»„â€æ˜¯ä½¿ç”¨JSONè¯­æ³•å®šä¹‰çš„ï¼Œç»„åç§°ä¹Ÿæ˜¯PVåç§°ã€‚ä¸â€œè®°å½•â€ä¸åŒï¼š\nRecords have fields ï¼ˆè®°å½•æ‹¥æœ‰å­—æ®µï¼‰ Channels/PVs have properties ï¼ˆé€šé“/PV æ‹¥æœ‰å±æ€§ï¼‰ ç»„å®šä¹‰å¯ä»¥åœ¨å¤šä¸ªè®°å½•ä¸­æ‹†åˆ†ï¼Œå‚è€ƒexample/iocExampleApp/Db/circle.dbï¼Œæˆ–è€…åŒ…å«åœ¨å•ç‹¬çš„JSONæ–‡ä»¶ä¸­ï¼Œå‚è€ƒJSON referenceã€‚ æ‹†åˆ†å†™æ³•ï¼š\nrecords.db \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 record(ai, \u0026#34;rec:X\u0026#34;) { info(Q:group, { \u0026#34;grp:name\u0026#34;: { \u0026#34;X\u0026#34;: {+channel:\u0026#34;VAL\u0026#34;} } }) } record(ai, \u0026#34;rec:Y\u0026#34;) { info(Q:group, { \u0026#34;grp:name\u0026#34;: { \u0026#34;Y\u0026#34;: {+channel:\u0026#34;VAL\u0026#34;} # .VAL in enclosing record() } }) } JSONæ–‡ä»¶å†™æ³•ï¼š\nsome.db \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 # Store in some .db record(ai, \u0026#34;rec:X\u0026#34;) {} record(ai, \u0026#34;rec:Y\u0026#34;) {} # Store in some .json { \u0026#34;grp:name\u0026#34;: { \u0026#34;X\u0026#34;: {\u0026#34;+channel\u0026#34;:\u0026#34;rec:X.VAL\u0026#34;}, # full PV name \u0026#34;Y\u0026#34;: {\u0026#34;+channel\u0026#34;:\u0026#34;rec:Y.VAL\u0026#34;} } } åŠ è½½JSONæ–‡ä»¶ï¼š\nshell \u0026#9660; 1 2 3 # voidÂ dbLoadGroup(constÂ charÂ *file,Â constÂ charÂ *macros) # Load Group definitions from a separate JSON file. eg. dbLoadGroup \u0026#34;db/some.json\u0026#34;, \u0026#34;user=root\u0026#34; PVAccess é“¾æ¥\nPVA é“¾æ¥ JSON schemaã€‚\nä¾‹ï¼š\nrecords.db \u0026#9660; 1 2 3 4 record(longin, \u0026#34;tgt\u0026#34;) {} record(longin, \u0026#34;src\u0026#34;) { field(INP, {pva:{pv:\u0026#34;tgt\u0026#34;}}) } æˆ–ï¼š\nrecords.db \u0026#9660; 1 2 3 4 5 6 record(longout, \u0026#34;src\u0026#34;) { field(INP, {pva:{ pv:\u0026#34;target:pv\u0026#34;, proc:\u0026#34;CP\u0026#34; }}) } å‚è€ƒé“¾æ¥\nEPICS V4 è§„èŒƒç±»å‹ EPICS 7, pvAccess and pvData â€” EPICS Documentation documentation pva2pva: pva2pva Home of QSRV and pvAccess 2 pvAccess gateway PVXS client/server for PVA Protocol EPICS 101 - Beam Line Controls IOC 101 - Beam Line Controls ","permalink":"https://kira-96.github.io/posts/epics-pvaccess-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E7%A0%94%E7%A9%B6/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eEPICS V7 ä¸­å¼•å…¥äº† pvAccessã€pvDataç­‰ç›¸å…³æ¨¡å—ï¼Œå¢åŠ äº†å¯¹ç»“æ„åŒ–æ•°æ®çš„æ”¯æŒã€‚\npvData (Process Variable Data, è¿‡ç¨‹å˜é‡æ•°æ®) æ˜¯EPICSæ ¸å¿ƒè½¯ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¿è¡Œæ—¶ç±»å‹ç³»ç»Ÿï¼Œå…·æœ‰ç”¨äºå¤„ç†ç»“æ„åŒ–æ•°æ®çš„åºåˆ—åŒ–å’Œå†…çœï¼ˆintrospectionï¼‰åŠŸèƒ½ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003epvData\u003c/strong\u003eæœ‰å››ç§ç±»å‹çš„æ•°æ®å­—æ®µï¼š\u003ccode\u003escalar\u003c/code\u003eã€\u003ccode\u003escalarArray\u003c/code\u003eã€\u003ccode\u003estructure\u003c/code\u003eå’Œ\u003ccode\u003estructureArray\u003c/code\u003eã€‚\u003ccode\u003escalar\u003c/code\u003eï¼ˆæ ‡é‡ï¼‰å¯ä»¥æ˜¯ä»¥ä¸‹æ ‡é‡ç±»å‹ä¹‹ä¸€ï¼šBooleanã€Byteã€Shortã€Intã€Longã€U(nsigned)Byteã€Unsigned Shortã€Unsigned Intã€Unsigned Longã€Floatã€Doubleå’ŒStringã€‚\u003ccode\u003escalarArray\u003c/code\u003eæ˜¯ä¸€ç»´æ•°ç»„ï¼Œå…ƒç´ ç±»å‹ä¸ºä»»ä½•æ ‡é‡ç±»å‹ã€‚\u003ccode\u003estructure\u003c/code\u003eï¼ˆç»“æ„ä½“ï¼‰æ˜¯ä¸€ç»„æœ‰åºçš„å­—æ®µï¼Œå…¶ä¸­æ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªåç§°å’Œç±»å‹ã€‚\u003ccode\u003estructureArray\u003c/code\u003eæ˜¯ç»“æ„ä½“æ•°ç»„ï¼Œç”±äºå­—æ®µå¯ä»¥æ˜¯ç»“æ„ï¼Œå› æ­¤å¯ä»¥åˆ›å»ºå¤æ‚çš„ç»“æ„ã€‚\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://epics-base.github.io/pva2pva/qsrv_page.html\"\u003e\u003cstrong\u003eQSRV\u003c/strong\u003e\u003c/a\u003eæ˜¯ä¸€ä¸ªä½¿ç”¨PVAccessåè®®çš„ç½‘ç»œæœåŠ¡å™¨ï¼Œåœ¨EPICS IOCè¿›ç¨‹ä¸­è¿è¡Œï¼Œå…è®¸å®¢æˆ·ç«¯è¯·æ±‚è®¿é—®å…¶ä¸­çš„è¿‡ç¨‹å˜é‡ï¼ˆPVï¼‰ã€‚\n\u003ca href=\"https://epics-base.github.io/pvxs/\"\u003e\u003cstrong\u003ePVXS\u003c/strong\u003e\u003c/a\u003eæ˜¯ä¸€ä¸ªPVAccessåè®®å®¢æˆ·ç«¯/æœåŠ¡å™¨çš„ç¨‹åºæ¨¡å—ã€‚åŠŸèƒ½ç­‰åŒäºÂ \u003ca href=\"https://github.com/epics-base/pvDataCPP\"\u003epvDataCPP\u003c/a\u003eï¼Œå¹¶å¸Œæœ›æœ€ç»ˆèƒ½å–ä»£\u003ca href=\"https://github.com/epics-base/pvAccessCPP\"\u003eCPP\u003c/a\u003eæ¨¡å—ã€‚\u003c/p\u003e\n\u003cp\u003ePVAccess é»˜è®¤ç«¯å£ï¼š5076\u003c/p\u003e\n\u003cp\u003eç¯å¢ƒå˜é‡è¡¨ï¼š\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eVariable\u003c/th\u003e\n          \u003cth\u003eClient\u003c/th\u003e\n          \u003cth\u003eServer\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVA_ADDR_LIST\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVAS_BEACON_ADDR_LIST\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVA_AUTO_ADDR_LIST\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVAS_AUTO_BEACON_ADDR_LIST\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVAS_INTF_ADDR_LIST\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVA_SERVER_PORT\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVAS_SERVER_PORT\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVA_BROADCAST_PORT\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVAS_BROADCAST_PORT\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVAS_IGNORE_ADDR_LIST\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVA_CONN_TMO\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eEPICS_PVA_NAME_SERVERS\u003c/td\u003e\n          \u003ctd\u003eÃ—\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"å¿«é€Ÿä½¿ç”¨\"\u003eå¿«é€Ÿä½¿ç”¨\u003c/h2\u003e\n\u003cp\u003eä½¿ç”¨\u003ccode\u003esoftIocPVA\u003c/code\u003eè½¯ä»¶ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ecat\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eEOF\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ep2pexample\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003erecord\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecalc\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;p2p:example:counter\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003efield\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eINPA\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;p2p:example:counter\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003efield\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCALC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;A+1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003efield\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSCAN\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;1 second\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ebin\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003elinux\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ex86_64\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003esoftIocPVA\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e \u003cspan class=\"n\"\u003ep2pexample\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edb\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003ch2 id=\"æ·»åŠ -qsrv-åˆ°-ioc\"\u003eæ·»åŠ  QSRV åˆ° IOC\u003c/h2\u003e\n\u003cp\u003eå¦‚æœä½¿ç”¨EPICS V7åˆ›å»ºIOCï¼Œé‚£ä¹ˆå¯ä»¥çœ‹åˆ°ç¨‹åºå·²ç»é»˜è®¤æ·»åŠ äº†\u003cstrong\u003eQSRV\u003c/strong\u003eåˆ°IOCä¸­ã€‚å¦‚ï¼š\u003c/p\u003e","title":"EPICS PVAccess ä½¿ç”¨æ–¹æ³•ç ”ç©¶"},{"content":"å‰è¨€ ä¹‹å‰è®²è¿‡Linuxçš„GPIOæ“ä½œï¼Œä¸»è¦æ˜¯ä½¿ç”¨ç¨‹åºè®¿é—®Linuxç³»ç»Ÿæä¾›çš„ç”¨æˆ·ç©ºé—´æ¥å£ã€‚è¿™æ¬¡æ˜¯ä»‹ç»å¦‚ä½•ä½¿ç”¨EPICS IOCæ§åˆ¶GPIOçš„è¾“å…¥æˆ–è¾“å‡ºã€‚EPICSæœ‰è®¸å¤šè®¾å¤‡æ”¯æŒç¨‹åºï¼Œå…¶ä¸­å°±åŒ…æ‹¬Linux GPIOé©±åŠ¨ï¼Œå¯¹äºæŸäº›éœ€è¦ä½¿ç”¨EPICSæ§åˆ¶è®¾å¤‡GPIOçš„æƒ…å†µååˆ†æœ‰ç”¨ã€‚\nç¼–è¯‘GPIOè®¾å¤‡æ”¯æŒæ¨¡å— ä½¿ç”¨åˆ°çš„è½¯ä»¶æ¨¡å— epics-base - (launchpad.net) / epics-base/epics-base / EPICS Base (anl.gov)\nffeldbauer/epics-devgpio: EPICS device support to control GPIOs on the BeagleBone Black / Raspberry Pi via the /sys/class/gpio interface\néœ€è¦å…ˆå®‰è£…å¥½EPICS Base.\nç¼–è¯‘ devgpio æ³¨æ„ï¼šgpioè®¾å¤‡æ”¯æŒç”¨åˆ°äº†Linux 5.x å†…æ ¸æä¾›çš„gpioåº”ç”¨ç¨‹åºæ¥å£ã€‚\nVersion 2 of this device support uses the new V2 ABI for GPIO character device (c.f. /usr/include/linux/gpio.h) which was introduced in Kernel 5.x.\nå¦‚æœä½ ä½¿ç”¨çš„æ˜¯æ—§ç‰ˆçš„linxuå†…æ ¸ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨R1-0-6ã€‚\näº¤å‰ç¼–è¯‘æ—¶gpio.hçš„è·¯å¾„ï¼š${SDKTARGETSYSROOT}/usr/include/linux/gpio.h\nç¼–è¯‘æ­¥éª¤ï¼š\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 cd epics-devgpio touch configure/RELEASE.local vi configure/RELEASE.local # ä¿®æ”¹æˆå’ŒEPICS Baseä¸€æ ·çš„æ¶æ„ # EPICS_HOST_ARCH=linux-loong64 # EPICS Baseè·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ EPICS_BASE=/path/to/epics/base-7.0.8.1 # ç›´æ¥ç¼–è¯‘ # make # äº¤å‰ç¼–è¯‘ï¼ˆç¤ºä¾‹ï¼‰ # make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++ make ä½¿ç”¨GPIOçš„è®¾å¤‡æ”¯æŒåº“ ä¸ºIOCç¨‹åºæ·»åŠ GPIOè®¾å¤‡æ”¯æŒï¼Œå’Œå…¶ä»–è®¾å¤‡æ”¯æŒç¨‹åºä½¿ç”¨æ–¹æ³•ä¸€æ ·ã€‚\nç¤ºä¾‹ï¼š\nä¿®æ”¹configure/RELEASE æ·»åŠ devgpioçš„æ¨¡å—ä½ç½®\nconfigure/RELEASE \u0026#9660; 1 2 SUPPORT=/path/to/epics/epics-modules DEVGPIO=$(SUPPORT)/epics-devgpio ä¿®æ”¹ç¨‹åºçš„Makefile ä¾‹ï¼šä¿®æ”¹exampleApp/src/Makefile\nMakefile \u0026#9660; 1 2 3 4 5 # æ·»åŠ ä»¥ä¸‹å†…å®¹ ifneq ($(DEVGPIO),) example_DBD += devgpio.dbd example_LIBS += devgpio endif ç¼–å†™db ä¾‹ï¼šæ·»åŠ exampleApp/Db/gpio.db\nDb/gpio.db \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 record(bo, \u0026#34;${IOC}:GPIO:IO39:OUT\u0026#34;) { field(DESC, \u0026#34;GPIO 39 output\u0026#34;) field(DTYP, \u0026#34;devgpio\u0026#34;) field(OUT, \u0026#34;@39\u0026#34;) field(ZNAM, \u0026#34;OFF\u0026#34;) field(ONAM, \u0026#34;ON\u0026#34;) } record(bi, \u0026#34;${IOC}:GPIO:IO38:IN\u0026#34;) { field(DESC, \u0026#34;GPIO 38 input\u0026#34;) field(DTYP, \u0026#34;devgpio\u0026#34;) field(INP, \u0026#34;@38 both\u0026#34;) field(SCAN, \u0026#34;I/O Intr\u0026#34;) field(ZNAM, \u0026#34;OFF\u0026#34;) field(ONAM, \u0026#34;ON\u0026#34;) } ä¿®æ”¹exampleApp/Db/Makefile\nDb/Makefile \u0026#9660; 1 2 # æ·»åŠ ç¼–å†™çš„db DB += gpio.db ä¿®æ”¹å¯åŠ¨è„šæœ¬st.cmd ä¾‹ï¼šä¿®æ”¹iocBoot/iocexample/st.cmd\nst.cmd \u0026#9660; 1 2 3 4 # è®¾ç½®gpioè®¾å¤‡ï¼Œç¤ºä¾‹ï¼š GpioChip \u0026#34;/dev/gpiochip0\u0026#34; # åŠ è½½db dbLoadRecords \u0026#34;db/gpio.db\u0026#34;, \u0026#34;IOC=${IOC}\u0026#34; ç¼–è¯‘IOC shell \u0026#9660; 1 2 cd example make è‡³æ­¤ï¼Œæ‰€æœ‰æ­¥éª¤éƒ½å®Œæˆäº†ï¼Œç°åœ¨å¯ä»¥è¿è¡Œæµ‹è¯•ã€‚\næµ‹è¯•è¿è¡Œ shell \u0026#9660; 1 2 cd iocBoot/iocexample ./st.cmd è¾“å…¥æ¨¡å¼ï¼š\nshell \u0026#9660; 1 2 3 4 5 6 \u0026gt; camonitor iocexample:GPIO:IO38:IN iocexample:GPIO:IO38:IN \u0026lt;undefined\u0026gt; OFF UDF INVALID iocexample:GPIO:IO38:IN 2024-12-02 11:21:05.738442 ON iocexample:GPIO:IO38:IN 2024-12-02 11:21:13.115063 OFF iocexample:GPIO:IO38:IN 2024-12-02 11:21:48.090581 ON iocexample:GPIO:IO38:IN 2024-12-02 11:21:51.567303 OFF è¾“å‡ºæ¨¡å¼ï¼š\nshell \u0026#9660; 1 2 3 4 5 6 \u0026gt; caput iocexample:GPIO:IO39:OUT 1 Old : iocexample:GPIO:IO39:OUT OFF New : iocexample:GPIO:IO39:OUT ON \u0026gt; caput iocexample:GPIO:IO39:OUT 0 Old : iocexample:GPIO:IO39:OUT ON New : iocexample:GPIO:IO39:OUT OFF å…³äºrecordçš„ç¼–å†™ ä»¥ä¸‹è¯´æ˜ä¸­ \u0026lt;\u0026gt; ä¸ºå¿…å¡«å†…å®¹ï¼Œ[] ä¸ºå¯é€‰å†…å®¹ã€‚\ndevgpioæ”¯æŒbiã€boã€mbbi/oã€mbbi/oDirectç±»å‹çš„è®°å½•ã€‚ recordçš„DTYPå­—æ®µå¿…é¡»ä¸ºdevgpioã€‚ recordçš„INPå­—æ®µè¯­æ³•ä¸ºï¼š@\u0026lt;GPIO1\u0026gt; [GPIO2] [LOW] [FALLING/RISING/BOTH] GPIOxä¸ºGPIOçš„ç¼–å·ï¼Œå…·ä½“å¯ä»¥æŸ¥é˜…ç›¸åº”å¼€å‘æ¿çš„æ‰‹å†Œã€‚å¯¹äºbiç±»å‹çš„è®°å½•ï¼Œåªæ”¯æŒä¸€ä¸ªGPIOã€‚\nLOWæ ‡å¿—å¯ä»¥å°†GPIOåˆ‡æ¢åˆ°ä½ç”µå¹³æ¨¡å¼ï¼Œå¯¹åº”çš„é€‰é¡¹ä¸ºlowæˆ–è€…lã€‚ FALLING/RISING/BOTHè¡¨ç¤ºGPIOè¾“å…¥çš„ä¸­æ–­æ–¹å¼ã€‚falling/fè¡¨ç¤ºä¸‹é™æ²¿è§¦å‘ä¸­æ–­ï¼Œrising/rè¡¨ç¤ºä¸Šå‡æ²¿è§¦å‘ä¸­æ–­ï¼Œboth/bè¡¨ç¤ºä¸¤ä¾§å‡å¯ä»¥è§¦å‘ä¸­æ–­ã€‚åªæœ‰å¯ç”¨äº†æ­¤é€‰é¡¹ï¼Œæ‰å¯ä»¥å°†SCANå­—æ®µè®¾ç½®ä¸ºI/O Intrã€‚ recordçš„OUTå­—æ®µè¯­æ³•ä¸ºï¼š@\u0026lt;GPIO1\u0026gt; [GPIO2] [LOW] GPIOxä¸ºGPIOçš„ç¼–å·ï¼Œå…·ä½“å¯ä»¥æŸ¥é˜…ç›¸åº”å¼€å‘æ¿çš„æ‰‹å†Œã€‚å¯¹äºboç±»å‹çš„è®°å½•ï¼Œåªæ”¯æŒä¸€ä¸ªGPIOã€‚\nLOWæ ‡å¿—å¯ä»¥å°†GPIOåˆ‡æ¢åˆ°ä½ç”µå¹³æ¨¡å¼ï¼Œå¯¹åº”çš„é€‰é¡¹ä¸ºlowæˆ–è€…lã€‚ ","permalink":"https://kira-96.github.io/posts/epics-ioc-gpio-device-support/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eä¹‹å‰è®²è¿‡\u003ca href=\"../linux-gpio%E6%93%8D%E4%BD%9C%E5%85%B6%E4%B8%80\"\u003eLinuxçš„GPIOæ“ä½œ\u003c/a\u003eï¼Œä¸»è¦æ˜¯ä½¿ç”¨ç¨‹åºè®¿é—®Linuxç³»ç»Ÿæä¾›çš„ç”¨æˆ·ç©ºé—´æ¥å£ã€‚è¿™æ¬¡æ˜¯ä»‹ç»å¦‚ä½•ä½¿ç”¨EPICS IOCæ§åˆ¶GPIOçš„è¾“å…¥æˆ–è¾“å‡ºã€‚EPICSæœ‰è®¸å¤šè®¾å¤‡æ”¯æŒç¨‹åºï¼Œå…¶ä¸­å°±åŒ…æ‹¬Linux GPIOé©±åŠ¨ï¼Œå¯¹äºæŸäº›éœ€è¦ä½¿ç”¨EPICSæ§åˆ¶è®¾å¤‡GPIOçš„æƒ…å†µååˆ†æœ‰ç”¨ã€‚\u003c/p\u003e\n\u003ch2 id=\"ç¼–è¯‘gpioè®¾å¤‡æ”¯æŒæ¨¡å—\"\u003eç¼–è¯‘GPIOè®¾å¤‡æ”¯æŒæ¨¡å—\u003c/h2\u003e\n\u003ch3 id=\"ä½¿ç”¨åˆ°çš„è½¯ä»¶æ¨¡å—\"\u003eä½¿ç”¨åˆ°çš„è½¯ä»¶æ¨¡å—\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://git.launchpad.net/epics-base\"\u003eepics-base - (launchpad.net)\u003c/a\u003e / \u003ca href=\"https://github.com/epics-base/epics-base\"\u003eepics-base/epics-base\u003c/a\u003e / \u003ca href=\"https://epics.anl.gov/base/index.php\"\u003eEPICS Base (anl.gov)\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/ffeldbauer/epics-devgpio/\"\u003effeldbauer/epics-devgpio: EPICS device support to control GPIOs on the BeagleBone Black / Raspberry Pi via the /sys/class/gpio interface\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eéœ€è¦å…ˆå®‰è£…å¥½EPICS Base.\u003c/strong\u003e\u003c/p\u003e\n\u003ch3 id=\"ç¼–è¯‘-devgpio\"\u003eç¼–è¯‘ devgpio\u003c/h3\u003e\n\n\n\n\u003cblockquote\u003e\n    \u003cp\u003eæ³¨æ„ï¼šgpioè®¾å¤‡æ”¯æŒç”¨åˆ°äº†Linux 5.x å†…æ ¸æä¾›çš„gpioåº”ç”¨ç¨‹åºæ¥å£ã€‚\u003c/p\u003e\n\n\u003c/blockquote\u003e\n\n\n\n\n\u003cblockquote\u003e\n    \u003cp\u003eVersion 2 of this device support uses the new V2 ABI for GPIO character device (c.f. /usr/include/linux/gpio.h) which was introduced in Kernel 5.x.\u003c/p\u003e\n\n\u003c/blockquote\u003e\n\n\u003cp\u003eå¦‚æœä½ ä½¿ç”¨çš„æ˜¯æ—§ç‰ˆçš„linxuå†…æ ¸ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨\u003ca href=\"https://github.com/ffeldbauer/epics-devgpio/releases/tag/R1-0-6\"\u003eR1-0-6\u003c/a\u003eã€‚\u003c/p\u003e\n\u003cp\u003eäº¤å‰ç¼–è¯‘æ—¶\u003ccode\u003egpio.h\u003c/code\u003eçš„è·¯å¾„ï¼š\u003ccode\u003e${SDKTARGETSYSROOT}/usr/include/linux/gpio.h\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eç¼–è¯‘æ­¥éª¤ï¼š\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e epics-devgpio\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etouch configure/RELEASE.local\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evi configure/RELEASE.local\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ä¿®æ”¹æˆå’ŒEPICS Baseä¸€æ ·çš„æ¶æ„\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# EPICS_HOST_ARCH=linux-loong64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# EPICS Baseè·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eEPICS_BASE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/path/to/epics/base-7.0.8.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ç›´æ¥ç¼–è¯‘\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# make\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# äº¤å‰ç¼–è¯‘ï¼ˆç¤ºä¾‹ï¼‰\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003ch2 id=\"ä½¿ç”¨gpioçš„è®¾å¤‡æ”¯æŒåº“\"\u003eä½¿ç”¨GPIOçš„è®¾å¤‡æ”¯æŒåº“\u003c/h2\u003e\n\u003cp\u003eä¸º\u003ccode\u003eIOC\u003c/code\u003eç¨‹åºæ·»åŠ GPIOè®¾å¤‡æ”¯æŒï¼Œå’Œå…¶ä»–è®¾å¤‡æ”¯æŒç¨‹åºä½¿ç”¨æ–¹æ³•ä¸€æ ·ã€‚\u003c/p\u003e","title":"EPICS IOC GPIOè®¾å¤‡æ”¯æŒçš„ä½¿ç”¨"},{"content":"åŸæ–‡ï¼šIOC Access Security\nåŠŸèƒ½ è®¿é—®å®‰å…¨åŠŸèƒ½ç”¨äºä¿æŠ¤IOCæ•°æ®åº“ï¼Œé™åˆ¶æ¥è‡ªæœªç»æˆæƒçš„CAæˆ–pvAccesså®¢æˆ·ç«¯è®¿é—®ã€‚è®¿é—®å®‰å…¨æ€§åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š\nWho å®¢æˆ·ç«¯çš„ç”¨æˆ·IDï¼ˆChannel Access/pvAccessï¼‰ã€‚\nWhere ç”¨æˆ·ç™»å½•çš„ä¸»æœº IDã€‚å®¢æˆ·ç«¯è¿è¡Œçš„ä¸»æœºï¼Œä½†ä¸ä¼šåˆ†è¾¨ç”¨æˆ·æ˜¯æœ¬åœ°ç”¨æˆ·æˆ–è¿œç¨‹ç™»å½•åˆ°ä¸»æœºçš„ç”¨æˆ·ã€‚\nWhat è®°å½•çš„å„ä¸ªå­—æ®µéƒ½å—åˆ°ä¿æŠ¤ã€‚æ¯æ¡è®°å½•éƒ½æœ‰ä¸€ä¸ªå­—æ®µåŒ…å«è®°å½•çš„è®¿é—®å®‰å…¨ç»„ï¼ˆASGï¼‰ã€‚æ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªè®¿é—®å®‰å…¨çº§åˆ«ï¼ˆASL0æˆ–ASL1ï¼‰ã€‚å®‰å…¨çº§åˆ«åœ¨è®°å½•å®šä¹‰æ–‡ä»¶ï¼ˆ.dbdï¼‰ä¸­å®šä¹‰ã€‚\nWhen è®¿é—®è§„åˆ™å¯ä»¥åŒ…å«ç±»ä¼¼äºCALC Recordçš„è¾“å…¥è®¡ç®—ã€‚\nå®šä¹‰ ASL è®¿é—®å®‰å…¨çº§åˆ«\nASG è®¿é—®å®‰å…¨ç»„\nUAG ç”¨æˆ·è®¿é—®ç»„\nHAG ä¸»æœºè®¿é—®ç»„\nå¿«é€Ÿä¸Šæ‰‹ ä¸ºäº†å¯ç”¨ç‰¹å®š IOC çš„è®¿é—®å®‰å…¨æ€§ï¼Œéœ€è¦å®Œæˆä»¥ä¸‹æ“ä½œï¼š\nåˆ›å»ºè®¿é—®å®‰å…¨æ–‡ä»¶ï¼ˆ.acfï¼‰ å¯èƒ½éœ€è¦ä¿®æ”¹IOCæ•°æ®åº“ è®°å½•å®ä¾‹å¯èƒ½éœ€è¦è®¾ç½®è®¿é—®å®‰å…¨ç»„ASGå­—æ®µã€‚å¦‚æœASGä¸ºç©ºï¼Œè®°å½•å°†ä¼šä½¿ç”¨â€œDEFAULTâ€è®¿é—®å®‰å…¨ç»„ã€‚\nè®¿é—®å®‰å…¨æ–‡ä»¶å¯ä»¥åœ¨iocInitä¹‹åé€šè¿‡asSubInitå’ŒasSubProcessä½œä¸ºå…³è”çš„å­ç¨‹åºé‡æ–°åŠ è½½ã€‚å°†å€¼1å†™å…¥æ­¤è®°å½•å°†å¯¼è‡´é‡æ–°åŠ è½½ã€‚\nå¿…é¡»å¯åŠ¨è„šæœ¬åœ¨çš„iocInitä¹‹å‰åŒ…å«ä»¥ä¸‹å‘½ä»¤ï¼š\nst.cmd \u0026#9660; 1 2 3 4 asSetFilename(\u0026#34;/full/path/to/accessSecurityFile\u0026#34;) /* ä¸‹é¢æ˜¯ä¸€ä¸ªå¯é€‰å‘½ä»¤ */ /* ä½¿ç”¨å®æ›¿æ¢ */ asSetSubstitutions(\u0026#34;var1=sub1,var2=sub2,...\u0026#34;) å¦‚æœåœ¨iocInitä¹‹å‰æœªæ‰§è¡ŒasSetFilenameï¼Œå°±ä¸ä¼šå¯ç”¨è®¿é—®å®‰å…¨é™åˆ¶ã€‚\nå¦‚æœç»™å®šasSetFilenameï¼Œä½†åœ¨é¦–æ¬¡åˆå§‹åŒ–è®¿é—®å®‰å…¨æ€§æ—¶å‘ç”Ÿé”™è¯¯ï¼Œåˆ™å¯¹è¯¥IOCçš„æ‰€æœ‰è®¿é—®éƒ½ä¼šè¢«æ‹’ç»ã€‚\næˆåŠŸå¯åŠ¨è®¿é—®å®‰å…¨æ€§åï¼Œå°è¯•é‡æ–°å¯åŠ¨æ—¶å‡ºç°é”™è¯¯ï¼Œå°†ä¼šä¿æŒä¸Šæ¬¡çš„è®¿é—®å®‰å…¨é…ç½®ã€‚\nå¯åŠ¨IOCå¹¶å¯ç”¨è®¿é—®å®‰å…¨åï¼Œå¯ä»¥é€šè¿‡asSetFilenameã€asSetSubstitutionså’ŒasInitæ¥æ›´æ”¹è®¿é—®å®‰å…¨è§„åˆ™ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨å‡½æ•°asInitializeã€asInitFileå’ŒasInitFPã€‚\nåœ¨å¯åŠ¨IOCä¹‹åé‡æ–°åˆå§‹åŒ–è®¿é—®å®‰å…¨é…ç½®æ“ä½œæ˜¯â€œéå¸¸æ˜‚è´µâ€çš„æ“ä½œï¼Œå°½é‡ä¸è¦è¿™æ ·åšã€‚\nè®¿é—®å®‰å…¨é…ç½®æ–‡ä»¶ æœ¬èŠ‚ä»‹ç»åŒ…å«ç”¨æˆ·è®¿é—®ç»„ï¼ˆUAGï¼‰ã€ä¸»æœºè®¿é—®ç»„ï¼ˆHAGï¼‰å’Œè®¿é—®å®‰å…¨ç»„ï¼ˆASGï¼‰ã€‚IOCä¼šè¯»å–è®¿é—®é…ç½®æ–‡ä»¶ï¼ˆå»ºè®®ä½¿ç”¨æ‰©å±•å.acfï¼‰ç„¶ååˆ›å»ºè®¿é—®é…ç½®æ•°æ®åº“ã€‚é¦–å…ˆç»™å‡ºä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œç„¶åæ˜¯å®Œæ•´çš„è¯­æ³•æè¿°ã€‚\nç®€å•ç¤ºä¾‹\naccessSecurityFile.acf \u0026#9660; 1 2 3 4 5 6 7 8 9 UAG(uag) {user1,user2} HAG(hag) {host1,host2} ASG(DEFAULT) { RULE(1,READ) RULE(1,WRITE) { UAG(uag) HAG(hag) } } ä¸Šé¢çš„è§„åˆ™æä¾›äº†æ— é™åˆ¶çš„è¯»æƒé™ï¼ˆREADï¼‰ï¼Œè€Œä½äºä¸»æœºhost1å’Œhost2ä¸Šçš„ç”¨æˆ·user1å’Œuser2åˆ™æ‹¥æœ‰å†™æƒé™ï¼ˆWRITEï¼‰ã€‚\nè¯­æ³•å®šä¹‰\nåœ¨ä»¥ä¸‹æè¿°ä¸­ï¼š\n[] å¯é€‰é¡¹\n| å¤‡é€‰é¡¹\n... ä»»æ„æ•°é‡çš„å®šä¹‰\nå…ƒç´ \u0026lt;name\u0026gt;ã€\u0026lt;user\u0026gt;ã€\u0026lt;host\u0026gt;ã€\u0026lt;pvname\u0026gt;å’Œ\u0026lt;calculation\u0026gt;å¯ä»¥æ˜¯å¸¦å¼•å·æˆ–ä¸å¸¦å¼•å·çš„å­—ç¬¦ä¸²ã€‚\naccessSecurityFile.acf \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 UAG(\u0026lt;name\u0026gt;) [{ \u0026lt;user\u0026gt; [, \u0026lt;user\u0026gt; ...] }] ... HAG(\u0026lt;name\u0026gt;) [{ \u0026lt;host\u0026gt; [, \u0026lt;host\u0026gt; ...] }] ... ASG(\u0026lt;name\u0026gt;) [{ [INP\u0026lt;index\u0026gt;(\u0026lt;pvname\u0026gt;) ...] RULE(\u0026lt;level\u0026gt;,NONE | READ | WRITE [, NOTRAPWRITE | TRAPWRITE]) { [UAG(\u0026lt;name\u0026gt; [,\u0026lt;name\u0026gt; ...])] [HAG(\u0026lt;name\u0026gt; [,\u0026lt;name\u0026gt; ...])] CALC(\u0026lt;calculation\u0026gt;) } ... }] ... UAGï¼šç”¨æˆ·è®¿é—®ç»„ã€‚è¿™æ˜¯ç”¨æˆ·ååˆ—è¡¨ï¼Œåˆ—è¡¨å¯ä»¥ç©ºã€‚ä¸€ä¸ªç”¨æˆ·åå¯ä»¥å‡ºç°åœ¨å¤šä¸ªUAGä¸­ã€‚ç”¨æˆ·åå¿…é¡»å’Œè¿è¡ŒCAå®¢æˆ·ç«¯çš„ä¸»æœºä¸Šçš„ç”¨æˆ·åç›¸åŒã€‚å¯¹äºvxWorkså®¢æˆ·ç«¯ï¼Œç”¨æˆ·åé€šå¸¸å–è‡ªå¼•å¯¼å‚æ•°çš„ç”¨æˆ·å­—æ®µã€‚\nHAGï¼šä¸»æœºè®¿é—®ç»„ã€‚è¿™æ˜¯ä¸»æœºååˆ—è¡¨ï¼Œåˆ—è¡¨å¯ä»¥ç©ºã€‚åŒä¸€ä¸»æœºåå¯ä»¥å‡ºç°åœ¨å¤šä¸ªHAGä¸­ã€‚ä¸»æœºåå¿…é¡»å’Œè¿è¡ŒCAå®¢æˆ·ç«¯çš„ä¸»æœºä¸»æœºåç›¸åŒã€‚å¯¹äºvxWorkså®¢æˆ·ç«¯ï¼Œä¸»æœºåé€šå¸¸å–è‡ªå¼•å¯¼å‚æ•°çš„ç›®æ ‡åç§°ã€‚\nASGï¼šè®¿é—®å®‰å…¨ç»„ã€‚DEFAULTæ˜¯é»˜è®¤çš„è®¿é—®å®‰å…¨ç»„ã€‚\nINP\u0026lt;index\u0026gt;ï¼šindexå¿…é¡»æ˜¯Aåˆ°Lä¸­çš„ä¸€ä¸ªå€¼ã€‚ç±»ä¼¼äºCALC recordçš„INPå­—æ®µã€‚å¦‚æœåœ¨ASGçš„è§„åˆ™ä¸­å®šä¹‰äº†CALCå­—æ®µï¼Œåˆ™éœ€è¦INPå­—æ®µã€‚\nRULEï¼šå®šä¹‰è®¿é—®æƒé™\u0026lt;level\u0026gt;å¿…é¡»ä¸º0æˆ–1ã€‚çº§åˆ«1å­—æ®µçš„æƒé™ç»§æ‰¿äº†çº§åˆ«0å­—æ®µçš„æƒé™ã€‚æƒé™ä¸ºNONEã€READå’ŒWRITEï¼ŒWRITEä¹Ÿç»§æ‰¿äº†READæƒé™ã€‚æ ‡å‡†EPICSè®°å½•ç±»å‹çš„æ‰€æœ‰å­—æ®µé™¤VALã€CMDï¼ˆå‘½ä»¤ï¼‰å’ŒRESï¼ˆé‡ç½®ï¼‰å¤–éƒ½è®¾ç½®ä¸º1çº§ã€‚å¯é€‰å‚æ•°æŒ‡å®šæ˜¯å¦åº”æ•è·å†™å…¥ï¼Œå¦‚æœæœªç»™å®šï¼Œåˆ™é»˜è®¤ä¸ºNOTRAPWRITEã€‚\nUAGæŒ‡å®šå¯ä»¥è®¿é—®çš„ç”¨æˆ·è®¿é—®ç»„åˆ—è¡¨ã€‚å¦‚æœæœªå®šä¹‰UAGï¼Œåˆ™å…è®¸æ‰€æœ‰ç”¨æˆ·è®¿é—®ã€‚\nHAGæŒ‡å®šå…·æœ‰è®¿é—®æƒé™çš„ä¸»æœºè®¿é—®ç»„åˆ—è¡¨ã€‚å¦‚æœæœªå®šä¹‰HAGï¼Œåˆ™å…è®¸æ‰€æœ‰ä¸»æœºè®¿é—®ã€‚\nCALCä¸è®¡ç®—è®°å½•çš„CALCå­—æ®µç±»ä¼¼ï¼Œä½†ç»“æœå¿…é¡»è®¡ç®—ä¸ºTRUEæˆ–FALSEã€‚åªæœ‰å½“è®¡ç®—ç»“æœä¸ºTRUEæ‰é€‚ç”¨è¯¥è§„åˆ™ï¼ˆRULEï¼‰ï¼Œå…¶ä¸­å®é™…æµ‹è¯•å¯¹äºï¼ˆ0.99 \u0026lt; result \u0026lt; 1.01ï¼‰ä¸ºTRUEã€‚ä»»ä½•å…¶ä»–ç»“æœéƒ½è¢«è®¤ä¸ºFALSEï¼Œå¹¶å°†å¯¼è‡´è¯¥è§„åˆ™è¢«å¿½ç•¥ã€‚\nå¯ä»¥ä¸ºASGå®šä¹‰å¤šæ¡RULEï¼Œç›¸åŒçš„RULEçº§åˆ«å’Œè®¿é—®æƒé™ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªã€‚ç”¨äºå®¢æˆ·ç«¯çš„TRAPWRITEè®¾ç½®ç”±é€šè¿‡è§„åˆ™æ£€æŸ¥çš„ç¬¬ä¸€ä¸ªWRITEè§„åˆ™ç¡®å®šã€‚\næ¯ä¸ªè®°å½•ç±»å‹çš„å­—æ®µéƒ½æœ‰ä¸€ä¸ªå…³è”çš„è®¿é—®å®‰å…¨çº§åˆ«ASL0æˆ–ASL1ï¼ˆé»˜è®¤å€¼ï¼‰ã€‚æ“ä½œå‘˜é€šå¸¸æ›´æ”¹çš„å­—æ®µè¢«åˆ†é…ä¸ºASL0ï¼Œå…¶ä»–å­—æ®µè¢«åˆ†é…ç»™ASL1ã€‚ä¾‹å¦‚ï¼Œæ¨¡æ‹Ÿè¾“å‡ºè®°å½•çš„VALå­—æ®µè¢«åˆ†é…ä¸ºASL0ï¼Œå…¶ä»–å­—æ®µåˆ†é…ä¸ºASL1ã€‚è¿™æ˜¯å› ä¸ºåœ¨æ­£å¸¸æ“ä½œè¿‡ç¨‹ä¸­åªåº”ä¿®æ”¹VALå­—æ®µã€‚\nåˆ›å»ºæˆ–ä¿®æ”¹è®¿é—®é…ç½®æ–‡ä»¶åï¼Œå¯ä»¥ä½¿ç”¨ascheckå‘½ä»¤æŸ¥æ‰¾è¯­æ³•é”™è¯¯ï¼š\nshell \u0026#9660; 1 ascheck -S \u0026#34;xxx=yyy,...\u0026#34; \u0026lt; \u0026#34;filename\u0026#34; -Sè¡¨ç¤ºä½¿ç”¨å®æ›¿æ¢ã€‚æ­¤å‘½ä»¤ä¼šæ˜¾ç¤ºè¯­æ³•é”™è¯¯çš„ä½ç½®ï¼Œæ­£ç¡®åˆ™ä¸ä¼šæœ‰ä»»ä½•è¾“å‡ºã€‚\nå®éªŒ é¦–å…ˆæ–°å»ºä¸€ä¸ªç¤ºä¾‹IOCã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ mkdir example $ cd example/ $ makeBaseApp.pl -t example test $ makeBaseApp.pl -i -t example test The following target architectures are available in base: linux-loong64 linux-x86_64 What architecture do you want to use? linux-x86_64 The following applications are available: test What application should the IOC(s) boot? The default uses the IOC\u0026#39;s name, even if not listed above. Application name? test $ make ç„¶ååˆ›å»ºè®¿é—®å®‰å…¨é…ç½®æ–‡ä»¶accessSecurity.acfã€‚\nshell \u0026#9660; 1 2 cd iocBoot/ioctest/ touch accessSecurity.acf ä¿®æ”¹é…ç½®æ–‡ä»¶å†…å®¹ï¼Œç¤ºä¾‹ï¼š\naccessSecurityFile.acf \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 UAG(read) {deepin} UAG(write) {deepin} HAG(hosts) {LAPTOP-CTDCXXXX, 172.19.176.1} ASG(DEFAULT) { RULE(1,READ) RULE(1,WRITE) { HAG(hosts) } } ASG(deepin) { RULE(1,READ) { UAG(read,write) HAG(hosts) } RULE(1,WRITE,TRAPWRITE) { UAG(write) HAG(hosts) } } ç¨å¾®è§£é‡Šä¸€ä¸‹ï¼š\nåˆ›å»ºäº†ä¸¤ä¸ªç”¨æˆ·è®¿é—®ç»„ï¼ˆUAGï¼‰ï¼Œåç§°ä¸ºreadå’Œwriteï¼Œä¸¤ä¸ªç”¨æˆ·è®¿é—®ç»„éƒ½åªåŒ…å«ç”¨æˆ·deepinã€‚\nåˆ›å»ºäº†ä¸€ä¸ªä¸»æœºè®¿é—®ç»„ï¼ˆHAGï¼‰ï¼Œåç§°ä¸ºhostsï¼ŒåŒ…å«ä¸»æœºåLAPTOP-CTDCXXXXå’Œä¸€ä¸ªIPåœ°å€ã€‚\nåˆ›å»ºäº†é»˜è®¤ï¼ˆDEFAULTï¼‰è®¿é—®å®‰å…¨ç»„ï¼ˆASGï¼‰ï¼Œä¸é™åˆ¶è¯»å–ï¼ˆREADï¼‰æƒé™ï¼Œåªæœ‰hostsä¸»æœºè®¿é—®ç»„çš„ç”¨æˆ·æ‹¥æœ‰å†™å…¥ï¼ˆWRITEï¼‰æƒé™ã€‚\nåˆ›å»ºäº†è®¿é—®å®‰å…¨ç»„ï¼ˆASGï¼‰ï¼Œåç§°ä¸ºdeepinï¼Œhostsä¸»æœºè®¿é—®ç»„æ‰€åŒ…å«ä¸»æœºä¸Šçš„deepinç”¨æˆ·æ‰æ‹¥æœ‰è¯»å–ï¼ˆREADï¼‰å’Œå†™å…¥ï¼ˆWRITEï¼‰æƒé™ã€‚\nå¯ä»¥ä½¿ç”¨ascheckå·¥å…·æ£€æŸ¥ä¸€ä¸‹è¯­æ³•æ˜¯å¦æ­£ç¡®ã€‚\nshell \u0026#9660; 1 ascheck accessSecurity.acf ç„¶åè¿˜å¯ä»¥ä¿®æ”¹ä¸€ä¸‹dbæ–‡ä»¶ï¼Œä¾‹ï¼š\nshell \u0026#9660; 1 2 cd example/db/ vi dbExample2.db diff \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 record(ai, \u0026#34;$(user):aiExample$(no)\u0026#34;) { field(DESC, \u0026#34;Analog input No. $(no)\u0026#34;) field(INP, \u0026#34;$(user):calcExample$(no).VAL NPP NMS\u0026#34;) field(EGUF, \u0026#34;10\u0026#34;) field(EGU, \u0026#34;Counts\u0026#34;) field(HOPR, \u0026#34;10\u0026#34;) field(LOPR, \u0026#34;0\u0026#34;) field(HIHI, \u0026#34;8\u0026#34;) field(HIGH, \u0026#34;6\u0026#34;) field(LOW, \u0026#34;4\u0026#34;) field(LOLO, \u0026#34;2\u0026#34;) field(HHSV, \u0026#34;MAJOR\u0026#34;) field(HSV, \u0026#34;MINOR\u0026#34;) field(LSV, \u0026#34;MINOR\u0026#34;) field(LLSV, \u0026#34;MAJOR\u0026#34;) +\tfield(ASG, \u0026#34;deepin\u0026#34;) } alias(\u0026#34;$(user):aiExample$(no)\u0026#34;,\u0026#34;$(user):ai$(no)\u0026#34;) è¿™é‡ŒæŒ‡å®š$(user):aiExample$(no) recordä½¿ç”¨ deepin è®¿é—®å®‰å…¨ç»„ã€‚\næœ€åï¼Œä¿®æ”¹st.cmdæ¥å¯ç”¨è®¿é—®å®‰å…¨é…ç½®åŠŸèƒ½ã€‚\nshell \u0026#9660; 1 2 cd example/iocBoot/ioctest/ vi st.cmd diff \u0026#9660; 1 2 3 4 5 6 7 8 9 #- Run this to trace the stages of iocInit #-traceIocInit + #- Set asCheckClientIP=1 to translate hostnames into IPs + var asCheckClientIP 1 + asSetFilename(\u0026#34;${TOP}/iocBoot/${IOC}/accessSecurity.acf\u0026#34;) cd \u0026#34;${TOP}/iocBoot/${IOC}\u0026#34; iocInit å¯åŠ¨IOCã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 cd example/iocBoot/ioctest/ ./st.cmd #!../../bin/linux-x86_64/test \u0026lt; envPaths epicsEnvSet(\u0026#34;IOC\u0026#34;,\u0026#34;ioctest\u0026#34;) epicsEnvSet(\u0026#34;TOP\u0026#34;,\u0026#34;/home/deepin/example\u0026#34;) epicsEnvSet(\u0026#34;EPICS_BASE\u0026#34;,\u0026#34;/usr/local/epics/base-7.0.8\u0026#34;) epicsEnvSet(\u0026#34;EPICS_HOST_ARCH\u0026#34;, \u0026#34;linux-x86_64\u0026#34;) cd \u0026#34;/home/deepin/example\u0026#34; ## Register all support components dbLoadDatabase \u0026#34;dbd/test.dbd\u0026#34; test_registerRecordDeviceDriver pdbbase ## Load record instances dbLoadTemplate \u0026#34;db/user.substitutions\u0026#34; dbLoadRecords \u0026#34;db/testVersion.db\u0026#34;, \u0026#34;user=deepin\u0026#34; dbLoadRecords \u0026#34;db/dbSubExample.db\u0026#34;, \u0026#34;user=deepin\u0026#34; asSetFilename(\u0026#34;/home/deepin/example/iocBoot/ioctest/accessSecurity.acf\u0026#34;) cd \u0026#34;/home/deepin/example/iocBoot/ioctest\u0026#34; iocInit Starting iocInit ############################################################################ ## EPICS R7.0.8 ## Rev. 2024-03-01T16:27+0800 ## Rev. Date build date/time: ############################################################################ iocRun: All initialization complete ## Start any sequence programs #seq sncExample, \u0026#34;user=deepin\u0026#34; epics\u0026gt; ç„¶åæ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯çª—å£è¿›è¡Œæµ‹è¯•ã€‚\næ³¨æ„ï¼Œæˆ‘è¿™é‡Œçš„ä¸»æœºåæ˜¯LAPTOP-CTDCXXXXï¼Œä¸»æœºæœ‰ä¸¤ä¸ªç”¨æˆ·deepinå’Œrootã€‚\nåˆ†åˆ«ä½¿ç”¨ä¸¤ä¸ªç”¨æˆ·è®¿é—®ä½¿ç”¨é»˜è®¤ï¼ˆDEFAULTï¼‰å’Œåä¸ºdeepinè®¿é—®å®‰å…¨ç»„çš„å˜é‡ã€‚\nshell \u0026#9660; 1 2 3 4 deepin@LAPTOP-CTDCXXXX:~$ caget deepin:circle:angle deepin:circle:angle 186 deepin@LAPTOP-CTDCXXXX:~$ caget deepin:aiExample1 deepin:aiExample1 6 ç”¨æˆ·deepinå¯¹ä½¿ç”¨ä¸åŒè®¿é—®å®‰å…¨ç»„çš„å˜é‡éƒ½å¯ä»¥è®¿é—®ã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 # ä½¿ç”¨rootç”¨æˆ· deepin@LAPTOP-CTDCXXXX:~$ sudo su root@LAPTOP-CTDCXXXX:/home/deepin# caget deepin:circle:angle deepin:circle:angle 55 root@LAPTOP-CTDCXXXX:/home/deepin# caget deepin:aiExample1 Read operation timed out: some PV data was not read. deepin:aiExample1 *** no read access ç”¨æˆ·rootå¯ä»¥è®¿é—®ä½¿ç”¨é»˜è®¤ï¼ˆDEFAULTï¼‰è®¿é—®å®‰å…¨ç»„çš„å˜é‡ï¼Œè€Œä¸å¯è®¿é—®ä½¿ç”¨åä¸ºdeepinè®¿é—®å®‰å…¨ç»„çš„å˜é‡ã€‚\næµ‹è¯•ç»“æœä¸ç¼–å†™çš„è®¿é—®å®‰å…¨é…ç½®è§„åˆ™ç›¸ç¬¦åˆï¼Œè¯´æ˜è®¿é—®å®‰å…¨é…ç½®æˆåŠŸã€‚\nä¸è¿‡ï¼Œæ­¤æ¬¡å®éªŒåªæµ‹è¯•äº†æœ¬æœºä¸Šçš„ä¸åŒç”¨æˆ·ï¼Œå¯¹äºæ›´ä¸ºå¤æ‚çš„æ§åˆ¶ç³»ç»Ÿçš„æ•°æ®å®‰å…¨è®¿é—®æƒé™ï¼Œåˆ™éœ€è¦åšæ›´å®Œå–„çš„å®‰å…¨é…ç½®ã€‚\n","permalink":"https://kira-96.github.io/posts/epics-ioc-access-security/","summary":"\u003cp\u003eåŸæ–‡ï¼š\u003ca href=\"https://docs.epics-controls.org/en/latest/appdevguide/AccessSecurity.html\"\u003eIOC Access Security\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"åŠŸèƒ½\"\u003eåŠŸèƒ½\u003c/h3\u003e\n\u003cp\u003eè®¿é—®å®‰å…¨åŠŸèƒ½ç”¨äºä¿æŠ¤IOCæ•°æ®åº“ï¼Œé™åˆ¶æ¥è‡ªæœªç»æˆæƒçš„CAæˆ–pvAccesså®¢æˆ·ç«¯è®¿é—®ã€‚è®¿é—®å®‰å…¨æ€§åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWho\u003c/strong\u003e å®¢æˆ·ç«¯çš„ç”¨æˆ·IDï¼ˆChannel Access/pvAccessï¼‰ã€‚\u003cbr\u003e\n\u003cstrong\u003eWhere\u003c/strong\u003e ç”¨æˆ·ç™»å½•çš„ä¸»æœº IDã€‚å®¢æˆ·ç«¯è¿è¡Œçš„ä¸»æœºï¼Œä½†ä¸ä¼šåˆ†è¾¨ç”¨æˆ·æ˜¯æœ¬åœ°ç”¨æˆ·æˆ–è¿œç¨‹ç™»å½•åˆ°ä¸»æœºçš„ç”¨æˆ·ã€‚\u003cbr\u003e\n\u003cstrong\u003eWhat\u003c/strong\u003e è®°å½•çš„å„ä¸ªå­—æ®µéƒ½å—åˆ°ä¿æŠ¤ã€‚æ¯æ¡è®°å½•éƒ½æœ‰ä¸€ä¸ªå­—æ®µåŒ…å«è®°å½•çš„è®¿é—®å®‰å…¨ç»„ï¼ˆASGï¼‰ã€‚æ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªè®¿é—®å®‰å…¨çº§åˆ«ï¼ˆASL0æˆ–ASL1ï¼‰ã€‚å®‰å…¨çº§åˆ«åœ¨è®°å½•å®šä¹‰æ–‡ä»¶ï¼ˆ.dbdï¼‰ä¸­å®šä¹‰ã€‚\u003cbr\u003e\n\u003cstrong\u003eWhen\u003c/strong\u003e è®¿é—®è§„åˆ™å¯ä»¥åŒ…å«ç±»ä¼¼äºCALC Recordçš„è¾“å…¥è®¡ç®—ã€‚\u003c/p\u003e\n\u003ch3 id=\"å®šä¹‰\"\u003eå®šä¹‰\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eASL\u003c/strong\u003e è®¿é—®å®‰å…¨çº§åˆ«\u003cbr\u003e\n\u003cstrong\u003eASG\u003c/strong\u003e è®¿é—®å®‰å…¨ç»„\u003cbr\u003e\n\u003cstrong\u003eUAG\u003c/strong\u003e ç”¨æˆ·è®¿é—®ç»„\u003cbr\u003e\n\u003cstrong\u003eHAG\u003c/strong\u003e ä¸»æœºè®¿é—®ç»„\u003c/p\u003e\n\u003ch3 id=\"å¿«é€Ÿä¸Šæ‰‹\"\u003eå¿«é€Ÿä¸Šæ‰‹\u003c/h3\u003e\n\u003cp\u003eä¸ºäº†å¯ç”¨ç‰¹å®š IOC çš„è®¿é—®å®‰å…¨æ€§ï¼Œéœ€è¦å®Œæˆä»¥ä¸‹æ“ä½œï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eåˆ›å»ºè®¿é—®å®‰å…¨æ–‡ä»¶ï¼ˆ.acfï¼‰\u003c/li\u003e\n\u003cli\u003eå¯èƒ½éœ€è¦ä¿®æ”¹IOCæ•°æ®åº“\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eè®°å½•å®ä¾‹å¯èƒ½éœ€è¦è®¾ç½®è®¿é—®å®‰å…¨ç»„\u003ccode\u003eASG\u003c/code\u003eå­—æ®µã€‚å¦‚æœ\u003ccode\u003eASG\u003c/code\u003eä¸ºç©ºï¼Œè®°å½•å°†ä¼šä½¿ç”¨â€œ\u003ccode\u003eDEFAULT\u003c/code\u003eâ€è®¿é—®å®‰å…¨ç»„ã€‚\u003c/p\u003e\n\u003cp\u003eè®¿é—®å®‰å…¨æ–‡ä»¶å¯ä»¥åœ¨\u003ccode\u003eiocInit\u003c/code\u003eä¹‹åé€šè¿‡\u003ccode\u003easSubInit\u003c/code\u003eå’Œ\u003ccode\u003easSubProcess\u003c/code\u003eä½œä¸ºå…³è”çš„å­ç¨‹åºé‡æ–°åŠ è½½ã€‚å°†å€¼\u003cem\u003e1\u003c/em\u003eå†™å…¥æ­¤è®°å½•å°†å¯¼è‡´é‡æ–°åŠ è½½ã€‚\u003c/p\u003e\n\u003cp\u003eå¿…é¡»å¯åŠ¨è„šæœ¬åœ¨çš„\u003ccode\u003eiocInit\u003c/code\u003eä¹‹å‰åŒ…å«ä»¥ä¸‹å‘½ä»¤ï¼š\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"st.cmd\"\u003est.cmd\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-c\" data-lang=\"c\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003easSetFilename\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;/full/path/to/accessSecurityFile\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e/* ä¸‹é¢æ˜¯ä¸€ä¸ªå¯é€‰å‘½ä»¤ */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e/* ä½¿ç”¨å®æ›¿æ¢ */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003easSetSubstitutions\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;var1=sub1,var2=sub2,...\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eå¦‚æœåœ¨\u003ccode\u003eiocInit\u003c/code\u003eä¹‹å‰æœªæ‰§è¡Œ\u003ccode\u003easSetFilename\u003c/code\u003eï¼Œå°±ä¸ä¼šå¯ç”¨è®¿é—®å®‰å…¨é™åˆ¶ã€‚\u003c/p\u003e\n\u003cp\u003eå¦‚æœç»™å®š\u003ccode\u003easSetFilename\u003c/code\u003eï¼Œä½†åœ¨é¦–æ¬¡åˆå§‹åŒ–è®¿é—®å®‰å…¨æ€§æ—¶å‘ç”Ÿé”™è¯¯ï¼Œåˆ™å¯¹è¯¥IOCçš„æ‰€æœ‰è®¿é—®éƒ½ä¼šè¢«æ‹’ç»ã€‚\u003c/p\u003e\n\u003cp\u003eæˆåŠŸå¯åŠ¨è®¿é—®å®‰å…¨æ€§åï¼Œå°è¯•é‡æ–°å¯åŠ¨æ—¶å‡ºç°é”™è¯¯ï¼Œå°†ä¼šä¿æŒä¸Šæ¬¡çš„è®¿é—®å®‰å…¨é…ç½®ã€‚\u003c/p\u003e\n\u003cp\u003eå¯åŠ¨IOCå¹¶å¯ç”¨è®¿é—®å®‰å…¨åï¼Œå¯ä»¥é€šè¿‡\u003ccode\u003easSetFilename\u003c/code\u003eã€\u003ccode\u003easSetSubstitutions\u003c/code\u003eå’Œ\u003ccode\u003easInit\u003c/code\u003eæ¥æ›´æ”¹è®¿é—®å®‰å…¨è§„åˆ™ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨å‡½æ•°\u003ccode\u003easInitialize\u003c/code\u003eã€\u003ccode\u003easInitFile\u003c/code\u003eå’Œ\u003ccode\u003easInitFP\u003c/code\u003eã€‚\u003cbr\u003e\n\u003cstrong\u003eåœ¨å¯åŠ¨IOCä¹‹åé‡æ–°åˆå§‹åŒ–è®¿é—®å®‰å…¨é…ç½®æ“ä½œæ˜¯â€œéå¸¸æ˜‚è´µâ€çš„æ“ä½œï¼Œå°½é‡ä¸è¦è¿™æ ·åšã€‚\u003c/strong\u003e\u003c/p\u003e\n\u003ch3 id=\"è®¿é—®å®‰å…¨é…ç½®æ–‡ä»¶\"\u003eè®¿é—®å®‰å…¨é…ç½®æ–‡ä»¶\u003c/h3\u003e\n\u003cp\u003eæœ¬èŠ‚ä»‹ç»åŒ…å«ç”¨æˆ·è®¿é—®ç»„ï¼ˆUAGï¼‰ã€ä¸»æœºè®¿é—®ç»„ï¼ˆHAGï¼‰å’Œè®¿é—®å®‰å…¨ç»„ï¼ˆASGï¼‰ã€‚IOCä¼šè¯»å–è®¿é—®é…ç½®æ–‡ä»¶ï¼ˆå»ºè®®ä½¿ç”¨æ‰©å±•å.acfï¼‰ç„¶ååˆ›å»ºè®¿é—®é…ç½®æ•°æ®åº“ã€‚é¦–å…ˆç»™å‡ºä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œç„¶åæ˜¯å®Œæ•´çš„è¯­æ³•æè¿°ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eç®€å•ç¤ºä¾‹\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"accessSecurityFile.acf\"\u003eaccessSecurityFile.acf\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-c\" data-lang=\"c\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003eUAG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euag\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003euser1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003euser2\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003eHAG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehag\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003ehost1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003ehost2\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003eASG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDEFAULT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nf\"\u003eRULE\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003eREAD\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nf\"\u003eRULE\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003eWRITE\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nf\"\u003eUAG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003euag\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nf\"\u003eHAG\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ehag\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eä¸Šé¢çš„è§„åˆ™æä¾›äº†æ— é™åˆ¶çš„è¯»æƒé™ï¼ˆREADï¼‰ï¼Œè€Œä½äºä¸»æœº\u003ccode\u003ehost1\u003c/code\u003eå’Œ\u003ccode\u003ehost2\u003c/code\u003eä¸Šçš„ç”¨æˆ·\u003ccode\u003euser1\u003c/code\u003eå’Œ\u003ccode\u003euser2\u003c/code\u003eåˆ™æ‹¥æœ‰å†™æƒé™ï¼ˆWRITEï¼‰ã€‚\u003c/p\u003e","title":"EPICS IOC è®¿é—®å®‰å…¨"},{"content":"å‰è¨€ IgH EtherCAT Master æ˜¯ä¸€ä¸ªå¼€æºçš„EtherCATä¸»ç«™é©±åŠ¨ç¨‹åºï¼Œç”¨äºç®¡ç†EtherCATä»ç«™è®¾å¤‡ï¼Œæ”¯æŒLinuxæ“ä½œç³»ç»Ÿï¼Œå·¥æ§ä¸Šä½¿ç”¨çš„æ¯”è¾ƒå¤šã€‚\ndls ethercatæ˜¯ç”±è‹±å›½é’»çŸ³å…‰æºå¼€å‘çš„ç”¨äº EPICS æ§åˆ¶ç³»ç»Ÿ EtherCAT è®¾å¤‡çš„æ”¯æŒç¨‹åºï¼ŒåŸºäº IgH Master ä¸»ç«™ç¨‹åºå¼€å‘ï¼Œå®ç°å¯¹ EtherCAT æ€»çº¿è®¾å¤‡çš„è¯»å†™ã€‚\näº¤å‰ç¼–è¯‘ç¯å¢ƒï¼šUbuntu\nè¿è¡Œå¼€å‘æ¿ï¼šé¾™èŠ¯2K0500é‡‘é¾™å¼€å‘æ¿\nå†…æ ¸ç‰ˆæœ¬ï¼šLinux LS-GD 5.10.0-rt17.lsgd #1 PREEMPT_RT\nç›¸å…³è½¯ä»¶åŒ…ä¸‹è½½åœ°å€ epics-base - (launchpad.net) / epics-base/epics-base / EPICS Base (anl.gov)\nepics-modules/asyn: EPICS module for driver and device support\nepics-modules/busy: APS BCDA synApps module: busy\nepics-modules/autosave: APS BCDA synApps module: autosave\ndls-controls/ethercat: EPICS support to read/write to ethercat based hardware\nIgH EtherCAT Master for Linux\nPREEMPT RT patch\né…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ å…³äºè¿™ä¸€èŠ‚ï¼Œä¹‹å‰çš„æ–‡ç« å·²ç»è¯¦ç»†è®²è¿‡ï¼Œå‚è€ƒé…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒã€‚\nå¦‚æœä½ ä½¿ç”¨çš„æ˜¯å…¶ä»–å¼€å‘å¥—ä»¶ï¼Œè¯·æŒ‰ç…§å¼€å‘æ‰‹å†Œå®‰è£…é…ç½®å¥½ç¯å¢ƒã€‚\nç¼–è¯‘ IgH EtherCAT Master æºç ä¸€å®šè¦ä¸‹è½½ stable-1.5 åˆ†æ”¯çš„ï¼Œå…¶ä»–ç‰ˆæœ¬æˆ‘ä¹Ÿæ²¡æœ‰æµ‹è¯•ï¼\næ‰“è¡¥ä¸(æ­¤æ­¥éª¤å¯ä»¥è·³è¿‡) shell \u0026#9660; 1 2 3 4 5 6 7 # å…ˆå°†è¡¥ä¸å¤åˆ¶åˆ°ethercaté©±åŠ¨æºç ä¸‹ cp ethercat-master/etc/makeDocumentation/configurable-error-suppression.patch ethercat-stable-1.5/ cd ethercat-stable-1.5/ # æ‰“è¡¥ä¸ patch -p1 \u0026lt; configurable-error-suppression.patch # è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹patchçš„è¾“å‡ºç»“æœ ç”±äºè¡¥ä¸çš„æ—¶é—´æ¯”è¾ƒæ—©ï¼Œè·Ÿç°æœ‰çš„æºç ä¸å¤ªåŒ¹é…ï¼Œæœ‰äº›åœ°æ–¹è¡¥ä¸ä¼šå¤±è´¥ï¼ˆFAILEDï¼‰ã€‚æ¯”å¦‚æˆ‘è¿™é‡Œçš„æŠ¥é”™ï¼Œå¯èƒ½éœ€è¦å†æ‰‹åŠ¨ä¿®æ”¹ä¸€ä¸‹ã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 patching file lib/Makefile.am Hunk #1 succeeded at 32 (offset -2 lines). patching file lib/common.c patching file lib/domain.c patching file lib/liberror-documentation.txt patching file lib/liberror.c patching file lib/liberror.h patching file lib/master.c Hunk #1 succeeded at 37 (offset -2 lines). ... Hunk #12 FAILED at 419. Hunk #13 FAILED at 448. ... 2 out of 31 hunks FAILED -- saving rejects to file lib/master.c.rej patching file lib/reg_request.c Hunk #1 succeeded at 39 (offset -2 lines). ... patching file lib/sdo_request.c Hunk #1 succeeded at 39 (offset -2 lines). ... patching file lib/slave_config.c Hunk #1 succeeded at 39 (offset -1 lines). ... patching file lib/voe_handler.c Hunk #1 succeeded at 40 (offset -2 lines). ... æˆ‘ä»¬å‚è€ƒlib/master.c.rejï¼Œæ‰‹åŠ¨ä¿®æ”¹ä¸€ä¸‹ã€‚\ndiff \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 # lib/master.c.rej --- lib/master.c\tTue Feb 12 17:31:08 2013 +0100 +++ lib/master.c\tMon Mar 23 15:52:53 2015 +0000 @@ -419,7 +431,8 @@ if (EC_IOCTL_ERRNO(ret) == EIO \u0026amp;\u0026amp; abort_code) { *abort_code = download.abort_code; } - fprintf(stderr, \u0026#34;Failed to execute SDO download: %s\\n\u0026#34;, + ecrt_errcode = ECRT_ERRMASTERSDODOWNLOAD; + ERRPRINTF(\u0026#34;Failed to execute SDO download: %s\\n\u0026#34;, strerror(EC_IOCTL_ERRNO(ret))); return -EC_IOCTL_ERRNO(ret); } @@ -448,7 +461,8 @@ if (EC_IOCTL_ERRNO(ret) == EIO \u0026amp;\u0026amp; abort_code) { *abort_code = download.abort_code; } - fprintf(stderr, \u0026#34;Failed to execute SDO download: %s\\n\u0026#34;, + ecrt_errcode = ECRT_ERRMASTERSDODOWNLOADCOMPLETE; + ERRPRINTF(\u0026#34;Failed to execute SDO download: %s\\n\u0026#34;, strerror(EC_IOCTL_ERRNO(ret))); return -EC_IOCTL_ERRNO(ret); } ç„¶åè¿™ä¸ªè¡¥ä¸è¿˜æœ‰ç‚¹é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ä¿®æ”¹ä¸€ä¸‹lib/liberror.cã€‚è¿™é‡Œæºæ–‡ä»¶å’Œå¤´æ–‡ä»¶å˜é‡å®šä¹‰ä¸ä¸€è‡´ï¼Œç¼–è¯‘ä¼šæŠ¥é”™ï¼Œä»¥å¤´æ–‡ä»¶ä¸ºå‡†ã€‚\nc \u0026#9660; 1 2 3 4 5 6 7 #include \u0026#34;liberror.h\u0026#34; int ecrt_err_to_stderr = 1; // char *ecrt_errstring[ERRSTRING_LEN]; char ecrt_errstring[ERRSTRING_LEN]; int ecrt_errcode; å‡†å¤‡å†…æ ¸æºç  ç”±äºéœ€è¦å°†æºç ç¼–è¯‘æˆç›¸åº”çš„ç³»ç»Ÿé©±åŠ¨ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦ä½¿ç”¨å†…æ ¸çš„æºç ã€‚\nå¦‚æœæ˜¯æ ‡å‡†ç³»ç»Ÿï¼Œå¯ä»¥ç›´æ¥å®‰è£…linux-headersã€‚\nshell \u0026#9660; 1 2 # Ubuntu/Debian sudo apt install linux-headers-$(uname -r) æ ‘è“æ´¾ç³»ç»Ÿ\nshell \u0026#9660; 1 sudo apt install raspberrypi-kernel-headers è€Œå¯¹äºå¼€å‘æ¿ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨éšå¼€å‘æ¿æä¾›çš„å†…æ ¸æºç ã€‚\nå†…æ ¸çš„ç¼–è¯‘æ­¥éª¤è¯·æ ¹æ®å¼€å‘æ¿çš„ç”¨æˆ·æ‰‹å†Œå®Œæˆã€‚\næœ€å¥½å†ç»™å†…æ ¸æ‰“ä¸Š PREEMPT_RT è¡¥ä¸ã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # è§£å‹å†…æ ¸æºç  tar -xvf linux-5.10-2k500-src-f45937d-build.20230721100738.tar.gz # linux-5.10-2k500-cbd-src cd linux-5.10-2k500-cbd-src/ # ä¸ºå†…æ ¸æ‰“ä¸Šå®æ—¶è¡¥ä¸ï¼ˆå¯é€‰ï¼‰ patch -p1 \u0026lt; patch-5.10-rt17.patch # é…ç½®äº¤å‰ç¼–è¯‘å™¨ ./set_env.sh # ç¼–è¯‘å†…æ ¸ make loongson_2k500_defconfig # make menuconfig make uImage # ç¼–è¯‘æ¨¡å— make modules ç¼–è¯‘ EtherCAT Master é©±åŠ¨ shell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 cd ethercat-stable-1.5/ # to create the configure script, if downloaded from the repo ./bootstrap # è¿™é‡Œéœ€è¦æ³¨æ„æ˜¯å¦å‡ºç°æŠ¥é”™ï¼Œéœ€è¦å®‰è£… autoconfã€libtoolã€pkg-config ç­‰å·¥å…· # æ‰§è¡Œconfigure # `--host` æŒ‡å®šç¨‹åºè¿è¡Œçš„ä¸»æœºæ¶æ„ # `--with-linux-dir` Linuxå†…æ ¸æºç  # `--with-devices` å†—ä½™æ¥å£éœ€è¦ \u0026gt; 1 # `--enable-hrtimer` ä½¿ç”¨é«˜åˆ†è¾¨ç‡å®šæ—¶å™¨è®©ä¸»çŠ¶æ€æœºåœ¨å‘é€å¸§ä¹‹é—´ä¼‘çœ  # `--enable-wildcards` å…è®¸ä½¿ç”¨0xffffffä½œä¸ºä¾›åº”å•†IDå’Œäº§å“ä»£ç çš„é€šé…ç¬¦ # å¦‚æœæ˜¯å®‰è£…çš„linux-headersï¼Œé€šå¸¸åœ¨ /usr/src/linux-headers-xxx # å¦‚æœç›´æ¥ä½¿ç”¨å†…æ ¸æºç ï¼Œåˆ™å¿…é¡»é€šè¿‡ä¸Šè¿°ç¼–è¯‘æ­¥éª¤ï¼ # --prefix æŒ‡å®šå®‰è£…ç›®å½• ./configure --host=loongarch64-linux-gnu CC=loongarch64-linux-gnu-gcc --enable-generic=yes --enable-8139too=no --with-linux-dir=/path/to/linux-5.10-2k500-cbd-src --prefix=/path/to/__install_dir # ç¼–è¯‘ make all modules # æˆ–è€… # make # make ARCH=loongarch CORSS_COMPILE=loongarch64-linux-gnu- modules # å®‰è£…ç”Ÿæˆçš„æ–‡ä»¶ # make install å¦‚æœå®Œå…¨æŒ‰ç…§ä¸Šè¿°æ­¥éª¤ï¼Œåº”è¯¥å¯ä»¥ç¼–è¯‘æˆåŠŸã€‚\nä¸‹é¢æ•´ç†ä¸€ä¸‹ç”Ÿæˆçš„æ–‡ä»¶ã€‚\nshell \u0026#9660; 1 2 3 4 5 # å¤åˆ¶ç”Ÿæˆçš„ä¸»ç¨‹åº cp tool/ethercat /path/to/__install_dir/bin/ # å¤åˆ¶ç”Ÿæˆçš„é©±åŠ¨ç¨‹åº cp devices/ec_generic.ko /path/to/__install_dir/modules/ cp master/ec_master.ko /path/to/__install_dir/modules/ è¿™æ˜¯æˆ‘æ•´ç†çš„æ–‡ä»¶ï¼Œåé¢éœ€è¦å°†è¿™äº›æ–‡ä»¶ä¸‹è½½åˆ°å¼€å‘æ¿ã€‚\n\u0026#9660; __install_dir â”œâ”€ bin â”‚ â””â”€ ethercat (ä¸»ç¨‹åº) â”œâ”€ etc (é…ç½®) â”œâ”€ include (å¤´æ–‡ä»¶) â”œâ”€ lib (libethercat.so) â”œâ”€ modules (é©±åŠ¨ç›®å½•) â”‚ â”œâ”€ ec_master.ko â”‚ â””â”€ ec_generic.ko â”œâ”€ sbin â”‚ â””â”€ ethercatctl â””â”€ share â””â”€ bash-completion/ (bashè‡ªåŠ¨è¡¥å…¨) ç¼–è¯‘ EPICS ethercat æ¨¡å— ä»¥ä¸‹æ­¥éª¤éœ€è¦å…ˆå®‰è£…å¥½EPICS Base!\nç¼–è¯‘ asyn shell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 cd asyn touch configure/RELEASE.local vi configure/RELEASE.local # ä¿®æ”¹æˆå’ŒEPICS Baseä¸€æ ·çš„æ¶æ„ EPICS_HOST_ARCH=linux-loong64 # EPICS Baseè·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ EPICS_BASE=/home/ubuntu/loongson/base-7.0.8 # æ”¾ç½®EPICSæ¨¡å—çš„è·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ SUPPORT=/home/ubuntu/loongson/modules # SSCANæ¨¡å—è·¯å¾„ # SSCAN=$(SUPPORT)/sscan # CALCæ¨¡å—è·¯å¾„ # CALC=$(SUPPORT)/calc # ç›´æ¥ç¼–è¯‘ # make # äº¤å‰ç¼–è¯‘ï¼ˆç¤ºä¾‹ï¼‰ make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++ ç¼–è¯‘ autosave shell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 cd autosave touch configure/RELEASE.local vi configure/RELEASE.local # ä¿®æ”¹æˆå’ŒEPICS Baseä¸€æ ·çš„æ¶æ„ EPICS_HOST_ARCH=linux-loong64 # EPICS Baseè·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ EPICS_BASE=/home/ubuntu/loongson/base-7.0.8 # æ”¾ç½®EPICSæ¨¡å—çš„è·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ SUPPORT=/home/ubuntu/loongson/modules # ç›´æ¥ç¼–è¯‘ # make # äº¤å‰ç¼–è¯‘ï¼ˆç¤ºä¾‹ï¼‰ make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++ ç¼–è¯‘ busy shell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 cd busy touch configure/RELEASE.local vi configure/RELEASE.local # ä¿®æ”¹æˆå’ŒEPICS Baseä¸€æ ·çš„æ¶æ„ EPICS_HOST_ARCH=linux-loong64 # EPICS Baseè·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ EPICS_BASE=/home/ubuntu/loongson/base-7.0.8 # æ”¾ç½®EPICSæ¨¡å—çš„è·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ SUPPORT=/home/ubuntu/loongson/modules # ASYNæ¨¡å—è·¯å¾„ ASYN=$(SUPPORT)/asyn # AUTOSAVEæ¨¡å—è·¯å¾„ AUTOSAVE=$(SUPPORT)/autosave # BUSYæ¨¡å—è·¯å¾„ BUSY=$(SUPPORT)/busy # ç›´æ¥ç¼–è¯‘ # make # äº¤å‰ç¼–è¯‘ï¼ˆç¤ºä¾‹ï¼‰ make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++ ç¼–è¯‘ ethercat è¿™ä¸€æ­¥å¯ä»¥è¯´æ˜¯æœ€éº»çƒ¦ï¼Œé—®é¢˜æœ€å¤šçš„ã€‚ç¼–è¯‘å‡ºä»€ä¹ˆé—®é¢˜éƒ½éœ€è¦å»æ‰¾åˆ°ç›¸åº”çš„Makefileä¿®æ”¹ã€‚\nç”±äºè¯¥è½¯ä»¶åŒ…å·²ç»é•¿æ—¶é—´æ— äººç»´æŠ¤ï¼Œå»ºè®®ä½¿ç”¨æˆ‘ä¿®æ”¹è¿‡çš„ç‰ˆæœ¬ã€‚\né¦–å…ˆéœ€è¦å®‰è£…æ‰€éœ€çš„åŒ…libxml2-devã€‚ä½†æˆ‘ä»¬å®é™…ä¸Šå¹¶ä¸éœ€è¦ç”¨è¿™ä¸ªè½¯ä»¶åŒ…ï¼Œæˆ‘ä»¬åªéœ€è¦å®ƒçš„å¤´æ–‡ä»¶ã€‚\nè½¯ä»¶ä¾èµ–çš„åŠ¨æ€åº“(.so)æ–‡ä»¶ï¼Œæˆ‘ä»¬åˆ™éœ€è¦ä»å¼€å‘æ¿ç³»ç»Ÿä¸­æ‹·è´å‡ºæ¥ï¼Œæ— æ³•ç›´æ¥ç”¨ç¼–è¯‘ç”µè„‘çš„åŠ¨æ€åº“ã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 cd ethercat-master/ # åˆ›å»º 3rd ç›®å½•ï¼Œç”¨äºæ”¾ç½®æ‰€éœ€çš„å¤´æ–‡ä»¶å’ŒåŠ¨æ€åº“ mkdir 3rd mkdir 3rd/include mkdir 3rd/lib # å®‰è£… libxml2-dev sudo apt install libxml2-dev # ä»ç³»ç»Ÿç›®å½•ä¸­å¤åˆ¶å‡ºlibxml2çš„å¤´æ–‡ä»¶ # å› ä¸ºè¿˜éœ€è¦åšä¸€äº›ä¿®æ”¹ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ cp -r /usr/include/libxml2/ ./3rd/include/ # å¤åˆ¶åˆšåˆšç¼–è¯‘ç”Ÿæˆçš„ libethercat cp /path/to/__install_dir/lib/libethercat.so* ./3rd/lib/ # ä»å¼€å‘æ¿ç³»ç»Ÿå¤åˆ¶æ‰€éœ€è¦çš„åŠ¨æ€åº“ # libxml2 ä¾èµ– libz å’Œ liblzma scp root@192.168.1.10:/usr/lib/libxml2.so.2.9.12 ./3rd/lib/ scp root@192.168.1.10:/usr/lib/libz.so.1.2.11 ./3rd/lib/ scp root@192.168.1.10:/usr/lib/liblzma.so.5.2.5 ./3rd/lib/ # æ‰‹åŠ¨åˆ›å»ºä¸€ä¸‹é“¾æ¥ cd 3rd/lib/ ln -s libxml2.so.2.9.12 libxml2.so.2 ln -s libxml2.so.2 libxml2.so ln -s liblzma.so.5.2.5 liblzma.so.5 ln -s liblzma.so.5 liblzma.so ln -s libz.so.1.2.11 libz.so.1 ln -s libz.so.1 libz.so ç„¶åéœ€è¦ä¿®æ”¹ä¸€ä¸‹libxml2çš„å¤´æ–‡ä»¶ï¼Œä¸ç„¶ç¼–è¯‘çš„æ—¶å€™ä¼šæŠ¥é”™ã€‚\næŠ¥é”™ä¿¡æ¯ï¼š\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 In file included from ../../../libxml2/libxml/parser.h:812, from ../../../libxml2/libxml/globals.h:18, from ../../../libxml2/libxml/threads.h:35, from ../../../libxml2/libxml/xmlmemory.h:218, from ../../../libxml2/libxml/tree.h:1307, from ../parser.c:10: ../../../libxml2/libxml/encoding.h:31:10: fatal error: unicode/ucnv.h: No such file or directory #include \u0026lt;unicode/ucnv.h\u0026gt; ^~~~~~~~~~~~~~~~ compilation terminated. è§£å†³æ–¹æ³•ï¼š\nshell \u0026#9660; 1 2 3 4 5 6 # ä¿®æ”¹ xmlversion.h vi 3rd/include/libxml2/libxml/xmlversion.h # æ‰¾åˆ°ä¸‹é¢è¡Œï¼Œç¦ç”¨ LIBXML_ICU_ENABLED #define LIBXML_ICU_ENABLED # å°† #if 1 æ”¹ä¸º #if 0 diff \u0026#9660; 1 2 3 4 5 6 7 8 9 /** * LIBXML_ICU_ENABLED: * * Whether icu support is available */ - #if 0 + #if 1 #define LIBXML_ICU_ENABLED #endif åšå¥½ä¸Šé¢çš„å‡†å¤‡å·¥ä½œï¼Œè¿˜éœ€è¦ä¿®æ”¹æºç ä¸­çš„è·¯å¾„é…ç½®ï¼Œç„¶åæ‰èƒ½æ­£å¸¸ç¼–è¯‘ã€‚\nä¸‹é¢éƒ½æ˜¯æˆ‘è¸©å‘ç•™ä¸‹çš„è®°å½•ã€‚\nä¿®æ”¹ configure/RELEASE shell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 cd ethercat-master/ # é¦–å…ˆä¿®æ”¹ configure/RELEASE vi configure/RELEASE # éœ€è¦ä¿®æ”¹çš„æœ‰4é¡¹ # æ”¾ç½®EPICSæ¨¡å—çš„è·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ SUPPORT=/home/ubuntu/loongson/modules # ASYNæ¨¡å—è·¯å¾„ ASYN=$(SUPPORT)/asyn # BUSYæ¨¡å—è·¯å¾„ BUSY=$(SUPPORT)/busy # ä¿®æ”¹æˆå’ŒEPICS Baseä¸€æ ·çš„æ¶æ„ EPICS_HOST_ARCH=linux-loong64 # EPICS Baseè·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ EPICS_BASE=/home/ubuntu/loongson/base-7.0.8 ä¿®æ”¹ ethercatApp/scannerSrc/Makefile shell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 cd ethercat-master/ # ä¿®æ”¹ ethercatApp/scannerSrc/Makefile vi ethercatApp/scannerSrc/Makefile # éœ€è¦ä¿®æ”¹ EtherCAT Master æºç ç›¸å…³è·¯å¾„ã€ # libxml2å¤´æ–‡ä»¶è·¯å¾„ã€åŠ¨æ€åº“(.so)è·¯å¾„ # ä¿®æ”¹ ETHERLAB æºç è·¯å¾„ ETHERLAB=/path/to/ethercat-stable-1.5 ETHERLABPREFIX=$(ETHERLAB) USR_INCLUDES += -I$(ETHERLABPREFIX)/include # ä¿®æ”¹åŠ¨æ€åº“è·¯å¾„ USR_LDFLAGS += -L$(TOP)/3rd/lib -Wl,-rpath=$(TOP)/3rd/lib # ä¿®æ”¹ libxml2 å¤´æ–‡ä»¶è·¯å¾„ USR_INCLUDES += -I$(TOP)/3rd/include/libxml2 USR_SYS_LIBS += ethercat xml2 # ä¸‹é¢ç±»ä¼¼ scanner_INCLUDES += -I$(ETHERLAB)/lib serialtool_INCLUDES += -I$(ETHERLAB)/master get-slave-revisions_INCLUDES += -I$(ETHERLAB)/master ä¿®æ”¹ ethercatApp/src/Makefileï¼Œä¸ä¸Šé¢ç±»ä¼¼ã€‚ shell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 cd ethercat-master/ # ä¿®æ”¹ ethercatApp/src/Makefile vi ethercatApp/src/Makefile # éœ€è¦ä¿®æ”¹ EtherCAT Master æºç ç›¸å…³è·¯å¾„ã€ # libxml2å¤´æ–‡ä»¶è·¯å¾„ã€åŠ¨æ€åº“(.so)è·¯å¾„ # ä¿®æ”¹ ETHERLAB æºç è·¯å¾„ ETHERLAB=/path/to/ethercat-stable-1.5 # ecAsyn_INCLUDES += -I$(ETHERLAB)/src/ethercat-$(subst -,.,$(VERSION))/include # gadc_INCLUDES += -I$(ETHERLAB)/src/ethercat-$(subst -,.,$(VERSION))/include ecAsyn_INCLUDES += -I$(ETHERLAB)/include gadc_INCLUDES += -I$(ETHERLAB)/include # ä¿®æ”¹ libxml2 å¤´æ–‡ä»¶è·¯å¾„ USR_INCLUDES += -I$(TOP)/3rd/include/libxml2 # æ·»åŠ åŠ¨æ€åº“è·¯å¾„ USR_LDFLAGS += -L$(TOP)/3rd/lib -Wl,-rpath=$(TOP)/3rd/lib USR_SYS_LIBS += xml2 ä¿®æ”¹æºç  ç”±äºethercat-masterçš„æºç åŸæœ¬æ˜¯ä¸ºx86_64æ¶æ„ç¼–å†™çš„ï¼Œç¼–è¯‘åˆ°LoongArchæ¶æ„çš„è®¾å¤‡ä¸Šè¿è¡Œå¯èƒ½ä¼šå‡ºç°ä¸€äº›å¥‡æ€ªçš„é”™è¯¯ã€‚\nä¾‹å¦‚ï¼Œåœ¨è¿è¡Œslaveinfoæ—¶ä¼šå‡ºç°Segmentation faulté”™è¯¯ï¼Œè€Œè¿™é€šå¸¸æ˜¯ç©ºæŒ‡é’ˆå¯¼è‡´å†…å­˜è®¿é—®å‡ºé”™ã€‚\nåŸå› åˆ†æï¼š\nslaveinfoåœ¨è¿è¡Œæ—¶ä¼šæ ¹æ®ç¨‹åºè‡ªå·±çš„è·¯å¾„å¯»æ‰¾slave-types.txtæ–‡ä»¶ï¼Œé—®é¢˜å°±å‡ºåœ¨è¿™é‡Œã€‚æ¥çœ‹æºç  ethercatApp/scannerSrc/slave-list-path.cã€‚\nc \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 // ethercatApp/scannerSrc/slave-list-path.c int get_root_dir_index(const char *program_name) { // Search for the binary path char binary_dir[] = \u0026#34;bin/linux-x86_64/\u0026#34;; // Find the binary path in the program path and return the pointer char *found = strstr(program_name, binary_dir); // Handle the case where it is not found if (found == NULL) { return -1; } // Calculate the difference in the pointers to get the index return found - program_name; } è¿™ä¸ªget_root_dir_indexå‡½æ•°æ˜¯ç”¨äºè®¡ç®—å½“å‰ç¨‹åº(slaveinfo)æ‰€åœ¨çš„æ ¹ç›®å½•ã€‚è¿™é‡Œå‘ä¸ŠæŸ¥æ‰¾çš„è·¯å¾„ä¸ºbin/linux-x86_64ï¼Œå½“ç„¶ä¸èƒ½æ‰¾åˆ°LoongArchçš„ç›®å½•bin/linux-loong64äº†ã€‚æ‰€ä»¥ï¼Œæ­¤å‡½æ•°åªåœ¨è·¯å¾„ä¸ºbin/linux-x86_64/slaveinfoæ—¶æ‰èƒ½æ­£å¸¸è¿è¡Œï¼Œå…¶å®ƒæƒ…å†µéƒ½è¿”å›-1ã€‚ï¼ˆç¬¬ä¸€æ¬¡è§åˆ°è¿™æ ·å†™çš„ï¼ŒçœŸæ— è¯­äº†â€¦â€¦ï¼‰\nc \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 // ethercatApp/scannerSrc/slave-list-path.c char *get_slave_list_filename(const char *program_path) { char relative_path[] = \u0026#34;etc/scripts/slave-types.txt\u0026#34;; char *slave_list_filename = NULL; // Get absolute path of application char *real_path = calloc(PATH_MAX, sizeof(char)); get_app_path(program_path, real_path); // Get root directory int root_dir_index = get_root_dir_index(real_path); if (root_dir_index != -1) { slave_list_filename = calloc(root_dir_index + strlen(relative_path) + 1, sizeof(char)); strncpy(slave_list_filename, real_path, root_dir_index); } // Append relative path strcat(slave_list_filename, relative_path); // Check file struct stat fstat; int result = stat(slave_list_filename, \u0026amp;fstat); if (result) { printf(\u0026#34;Could not find slave list file at %s\\n\u0026#34;, slave_list_filename); } // Cleanup free(real_path); return slave_list_filename; } è€Œåœ¨get_slave_list_filenameå‡½æ•°ä¸­ï¼Œåªå¤„ç†äº†get_root_dir_indexæ­£å¸¸è¿”å›çš„æƒ…å†µã€‚å½“get_root_dir_indexè¿”å›-1æ—¶ï¼Œslave_list_filenameå§‹ç»ˆä¸ºNULLï¼Œè¿™å°±å¯¼è‡´åç»­æ“ä½œå‡ºé”™ã€‚\nå…¶å®è¿™ä¸ªé—®é¢˜ç›´æ¥æŠŠç¨‹åºæ”¾åˆ°bin/linux-x86_64ç›®å½•ä¸‹è¿è¡Œå°±å¯ä»¥äº†ï¼Œä¸è¿‡æ—¢ç„¶æ‰¾åˆ°äº†é—®é¢˜ï¼Œç´¢æ€§å°±æ”¹ä¸€æ”¹ã€‚\nç°åœ¨å·²ç»çŸ¥é“äº†å‡ºé”™çš„åœ°æ–¹ï¼Œè¯¥å¦‚ä½•ä¿®æ”¹å‘¢ï¼Ÿè¿™é‡Œæˆ‘æœ¬ç€å°½é‡å°‘æ”¹åŠ¨æºç çš„åŸåˆ™ï¼Œåœ¨get_root_dir_indexæŸ¥æ‰¾æ ¹ç›®å½•å‡ºé”™æ—¶ï¼Œç›´æ¥ä½¿ç”¨å½“å‰ç›®å½•ã€‚\ndiff \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 char *get_slave_list_filename(const char *program_path) { char relative_path[] = \u0026#34;etc/scripts/slave-types.txt\u0026#34;; char *slave_list_filename = NULL; // Get absolute path of application char *real_path = calloc(PATH_MAX, sizeof(char)); get_app_path(program_path, real_path); // Get root directory int root_dir_index = get_root_dir_index(real_path); if (root_dir_index != -1) { slave_list_filename = calloc(root_dir_index + strlen(relative_path) + 1, sizeof(char)); strncpy(slave_list_filename, real_path, root_dir_index); } + else + { + slave_list_filename = calloc(PATH_MAX, sizeof(char)); + if (NULL != getcwd(slave_list_filename, PATH_MAX)) + { + strcat(slave_list_filename, \u0026#34;/\u0026#34;); + } + } // Append relative path strcat(slave_list_filename, relative_path); // Check file struct stat fstat; int result = stat(slave_list_filename, \u0026amp;fstat); if (result) { printf(\u0026#34;Could not find slave list file at %s\\n\u0026#34;, slave_list_filename); } // Cleanup free(real_path); return slave_list_filename; } ç›®å‰åªå‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼Œå¸Œæœ›åé¢æ²¡æœ‰å‘äº†ã€‚\nä¿®æ”¹scanner.cï¼Œä¸å†å¼•ç”¨liberror.hï¼Œè¿™æ ·å°±ä¸éœ€è¦ä¿®æ”¹IgH EtherCATé©±åŠ¨æºç äº†ã€‚\ndiff \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 #include \u0026#34;unpack.h\u0026#34; #include \u0026#34;simulation.h\u0026#34; #include \u0026#34;version.h\u0026#34; - #include \u0026#34;liberror.h\u0026#34; @@ -290,8 +297,6 @@ void cyclic_task(void * usr) nslaves++; } - /* suppress errors to stderr */ - ecrt_err_to_stderr = 0; while(1) { rtMessageQueueReceive(scanner-\u0026gt;workq, msg, scanner-\u0026gt;max_message); @@ -500,7 +505,7 @@ void cyclic_task(void * usr) { if (error_to_console) { - fprintf(stderr,\u0026#34;etherlab library error: %s\u0026#34;, ecrt_errstring); + fprintf(stderr,\u0026#34;etherlab library error: %d\u0026#34;, slave_info_status); error_to_console = FALSE; } } ç¼–è¯‘ æœ€åç»ˆäºå¯ä»¥å¼€å§‹ç¼–è¯‘äº†ã€‚\nshell \u0026#9660; 1 2 3 cd ethercat-master/ # æ‰§è¡Œäº¤å‰ç¼–è¯‘ make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++ åˆ°è¿™é‡Œï¼Œç¼–è¯‘è¿‡ç¨‹è¿˜å¯èƒ½ä¼šå‡ºé”™ï¼Œä¸è¿‡å·²ç»å¯ä»¥ç¼–è¯‘å‡ºæˆ‘ä»¬æ‰€éœ€è¦çš„ä¸œè¥¿äº†ã€‚\næœ€ç»ˆç¼–è¯‘å¾—åˆ°scannerã€slaveinfoç¨‹åºå°±å¯ä»¥äº†ã€‚\nä»¥ä¸‹æ˜¯æˆ‘ç¼–è¯‘æ—¶çš„è¾“å‡ºï¼š\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 ... Installing library ../../../lib/linux-loong64/libscannerlib.a ... Installing created executable ../../../bin/linux-loong64/serialtool Installing created executable ../../../bin/linux-loong64/get-slave-revisions Installing created executable ../../../bin/linux-loong64/scanner Installing created executable ../../../bin/linux-loong64/slaveinfo Installing created executable ../../../bin/linux-loong64/parsertest ... Installing shared library ../../../lib/linux-loong64/libecAsyn.so Installing library ../../../lib/linux-loong64/libecAsyn.a Installing created executable ../../../bin/linux-loong64/parsertest ... Installing template file ../../../db/EK1100.template ... make -C ./protocol install make[2]: è¿›å…¥ç›®å½•â€œ/home/deepin/ethercat-master/ethercatApp/protocolâ€ make[2]: *** æ²¡æœ‰è§„åˆ™å¯åˆ¶ä½œç›®æ ‡â€œinstallâ€ã€‚ åœæ­¢ã€‚ make[2]: ç¦»å¼€ç›®å½•â€œ/home/deepin/ethercat-master/ethercatApp/protocolâ€ make[1]: *** [/usr/local/epics/base-7.0.8/configure/RULES_DIRS:85ï¼šprotocol.install] é”™è¯¯ 2 make[1]: ç¦»å¼€ç›®å½•â€œ/home/deepin/ethercat-master/ethercatAppâ€ make: *** [/usr/local/epics/base-7.0.8/configure/RULES_DIRS:85ï¼šethercatApp.install] é”™è¯¯ 2 æœ€åçš„é”™è¯¯ï¼Œæˆ‘ç›´æ¥å¿½ç•¥äº†ï¼Œå› ä¸ºå·²ç»å¾—åˆ°äº†éœ€è¦çš„å¯æ‰§è¡Œç¨‹åºã€‚\næ•´ç†ä¸€ä¸‹ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶ï¼š\n\u0026#9660; ethercat-master â”œâ”€ bin â”‚ â””â”€ linux-loong64 â”œâ”€ db â”œâ”€ dbd â””â”€ lib â””â”€ linux-loong64 æµ‹è¯•è¿è¡Œ å°†æ•´ç†å¥½çš„æ–‡ä»¶ä¸‹è½½åˆ°å¼€å‘æ¿åï¼Œæˆ‘ä»¬æµ‹è¯•è¿è¡Œä¸€ä¸‹ã€‚\næµ‹è¯•å®‰è£… EtherCAT ä¸»ç«™é©±åŠ¨ç¨‹åºã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 [root@LS-GD modules]# modinfo ec_generic.ko filename: /root/__install/modules/ec_generic.ko version: 1.5.2 unknown license: GPL description: EtherCAT master generic Ethernet device module author: Florian Pose \u0026lt;fp@igh-essen.com\u0026gt; srcversion: 848BB80F1C588A2FDA42EDB depends: ec_master name: ec_generic vermagic: 5.10.0-rt17.lsgd preempt_rt mod_unload modversions LOONGARCH 64BIT [root@LS-GD modules]# insmod ec_master.ko [root@LS-GD modules]# insmod ec_generic.ko [root@LS-GD modules]# lsmod Module Size Used by ec_generic 6427 0 ec_master 464125 1 ec_generic æµ‹è¯•ethercatä¸»ç¨‹åºã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 [root@LS-GD tool]# ./ethercat Please specify a command! Usage: ethercat \u0026lt;COMMAND\u0026gt; [OPTIONS] [ARGUMENTS] Commands (can be abbreviated): alias Write alias addresses. config Show slave configurations. crc CRC error register diagnosis. cstruct Generate slave PDO information in C language. data Output binary domain process data. debug Set the master\u0026#39;s debug level. domains Show configured domains. download Write an SDO entry to a slave. eoe Display Ethernet over EtherCAT statictics. foe_read Read a file from a slave via FoE. foe_write Store a file on a slave via FoE. graph Output the bus topology as a graph. master Show master and Ethernet device information. pdos List Sync managers, PDO assignment and mapping. reg_read Output a slave\u0026#39;s register contents. reg_write Write data to a slave\u0026#39;s registers. rescan Rescan the bus. sdos List SDO dictionaries. sii_read Output a slave\u0026#39;s SII contents. sii_write Write SII contents to a slave. slaves Display slaves on the bus. soe_read Read an SoE IDN from a slave. soe_write Write an SoE IDN to a slave. states Request application-layer states. upload Read an SDO entry from a slave. version Show version information. xml Generate slave information XML. Global options: --master -m \u0026lt;master\u0026gt; Comma separated list of masters to select, ranges are allowed. Examples: \u0026#39;1,3\u0026#39;, \u0026#39;5-7,9\u0026#39;, \u0026#39;-3\u0026#39;. Default: \u0026#39;-\u0026#39; (all). --force -f Force a command. --quiet -q Output less information. --verbose -v Output more information. --help -h Show this help. Numerical values can be specified either with decimal (no prefix), octal (prefix \u0026#39;0\u0026#39;) or hexadecimal (prefix \u0026#39;0x\u0026#39;) base. Call \u0026#39;ethercat \u0026lt;COMMAND\u0026gt; --help\u0026#39; for command-specific help. Send bug reports to fp@igh.de. æµ‹è¯•scannerä¸»ç¨‹åºã€‚\nshell \u0026#9660; 1 2 3 [root@LS-GD linux-loong64]# chmod +x scanner [root@LS-GD linux-loong64]# ./scanner usage: scanner [-m master_index] [-s] [-q] scanner.xml socket_path å¯ä»¥çœ‹åˆ°ï¼Œé©±åŠ¨ç¨‹åºå’Œä¸»ç¨‹åºéƒ½èƒ½åœ¨å¼€å‘æ¿ä¸Šè¿è¡Œï¼Œè¯´æ˜å·²ç»ç¼–è¯‘å®Œæˆäº†ã€‚\nå®‰è£… EtherCAT ä¸»ç«™åˆ°å¼€å‘æ¿ç³»ç»Ÿ é¦–å…ˆå°†ç¼–è¯‘å¥½çš„EtherCAT Masterä¸‹è½½åˆ°å¼€å‘æ¿ç³»ç»Ÿï¼Œç„¶åå°†å„ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶æ”¾åˆ°ç›¸åº”çš„ç³»ç»Ÿç›®å½•ä¸‹ã€‚ï¼ˆè¿™é‡Œæˆ‘è¿˜ä»¥__install_dirçš„ç›®å½•ç»“æ„ä¸ºä¾‹ã€‚ï¼‰\nåŸæ–‡ä»¶/ç›®å½• ç³»ç»Ÿæ–‡ä»¶/ç›®å½• bin/ethercat /usr/bin/ethercat etc/init.d/ethercat /etc/init.d/ethercat etc/sysconfig/ethercat /etc/sysconfig/ethercat etc/ethercat.conf /etc/ethercat.conf include/ - lib/libethercat.so* /usr/lib/libethercat.so* modules/ /lib/modules/5.10.0-rt17.lsgd/ sbin/ethercatctl /sbin/ethercatctl share/bash-completion/ /usr/share/bash-completion/ æ³¨æ„ï¼šå¦‚æœç³»ç»Ÿç›®å½•å­˜åœ¨/lib/modules/{å†…æ ¸ç‰ˆæœ¬}ç›®å½•ï¼Œåˆ™å¯ä»¥å°†modulesç›®å½•ä¸‹çš„ec_master.koå’Œec_generic.koå¤åˆ¶åˆ°è¯¥ç›®å½•ä¸‹ï¼Œç„¶ååœ¨ç»ˆç«¯æ‰§è¡Œdepmodå‘½ä»¤ã€‚å¦åˆ™ï¼Œå¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤åšç›¸åº”ä¿®æ”¹ã€‚\nä¾‹å¦‚ï¼Œå°†modulesä¸‹çš„é©±åŠ¨æ–‡ä»¶æ”¾åˆ°å¼€å‘æ¿æ–‡ä»¶ç³»ç»Ÿçš„/root/modules/ç›®å½•ä¸‹ã€‚\nä¿®æ”¹/etc/init.d/ethercatå’Œ/sbin/ethercatctlè„šæœ¬æ–‡ä»¶ã€‚\nä¾‹ï¼š/etc/init.d/ethercat\ndiff \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 LSMOD=/sbin/lsmod MODPROBE=/sbin/modprobe + INSMOD=/sbin/insmod RMMOD=/sbin/rmmod MODINFO=/sbin/modinfo - ETHERCAT=/home/loongson/__install_dir/bin/ethercat + ETHERCAT=/usr/bin/ethercat MASTER_ARGS= + MODULE_DIR=/root/modules start) echo -n \u0026#34;Starting EtherCAT master 1.5.2 \u0026#34; ... # load master module - if ! ${MODPROBE} ${MODPROBE_FLAGS} ec_master \u0026#34;${MASTER_ARGS}\u0026#34; \\ + if ! ${INSMOD} ${MODULE_DIR}/ec_master.ko \u0026#34;${MASTER_ARGS}\u0026#34; \\ main_devices=\u0026#34;${DEVICES}\u0026#34; backup_devices=\u0026#34;${BACKUPS}\u0026#34;; then exit_fail fi # check for modules to replace for MODULE in ${DEVICE_MODULES}; do ECMODULE=ec_${MODULE} - if ! ${MODINFO} \u0026#34;${ECMODULE}\u0026#34; \u0026gt; /dev/null; then - continue # ec_* module not found - fi if [ \u0026#34;${MODULE}\u0026#34; != \u0026#34;generic\u0026#34; ]; then if ${LSMOD} | grep \u0026#34;^${MODULE} \u0026#34; \u0026gt; /dev/null; then if ! ${RMMOD} \u0026#34;${MODULE}\u0026#34;; then exit_fail fi fi fi - if ! ${MODPROBE} ${MODPROBE_FLAGS} \u0026#34;${ECMODULE}\u0026#34;; then + if ! ${INSMOD} \u0026#34;${MODULE_DIR}/${ECMODULE}.ko\u0026#34;; then if [ \u0026#34;${MODULE}\u0026#34; != \u0026#34;generic\u0026#34; ]; then ${MODPROBE} ${MODPROBE_FLAGS} \u0026#34;${MODULE}\u0026#34; # try to restore fi exit_fail fi done exit_success ;; ä¾‹ï¼š/sbin/ethercatctl\ndiff \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 LSMOD=/sbin/lsmod MODPROBE=/sbin/modprobe + INSMOD=/sbin/insmod RMMOD=/sbin/rmmod MODINFO=/sbin/modinfo IP=/bin/ip - ETHERCAT=/home/loongson/__install_dir/bin/ethercat + ETHERCAT=/usr/bin/ethercat + MODULE_DIR=/root/modules #------------------------------------------------------------------------------ - ETHERCAT_CONFIG=/home/loongson/__install_dir/etc/ethercat.conf + ETHERCAT_CONFIG=/etc/ethercat.conf start) ... # load master module - if ! ${MODPROBE} ${MODPROBE_FLAGS} ec_master \\ + if ! ${INSMOD} ${MODULE_DIR}/ec_master.ko \\ main_devices=\u0026#34;${DEVICES}\u0026#34; backup_devices=\u0026#34;${BACKUPS}\u0026#34;; then exit 1 fi LOADED_MODULES=ec_master # check for modules to replace for MODULE in ${DEVICE_MODULES}; do ECMODULE=ec_${MODULE} - if ! ${MODINFO} \u0026#34;${ECMODULE}\u0026#34; \u0026gt; /dev/null; then - continue # ec_* module not found - fi if [ \u0026#34;${MODULE}\u0026#34; != \u0026#34;generic\u0026#34; ] \u0026amp;\u0026amp; [ \u0026#34;${MODULE}\u0026#34; != \u0026#34;ccat\u0026#34; ]; then # unload standard module and check if unloading was successful ${RMMOD} \u0026#34;${MODULE}\u0026#34; 2\u0026gt; /dev/null || true if ${LSMOD} | grep \u0026#34;^${MODULE} \u0026#34; \u0026gt; /dev/null; then # could not unload module ${RMMOD} ${LOADED_MODULES} exit 1 fi fi - if ! ${MODPROBE} ${MODPROBE_FLAGS} \u0026#34;${ECMODULE}\u0026#34;; then + if ! ${INSMOD} \u0026#34;${MODULE_DIR}/${ECMODULE}.ko\u0026#34;; then if [ \u0026#34;${MODULE}\u0026#34; != \u0026#34;generic\u0026#34; ] \u0026amp;\u0026amp; [ \u0026#34;${MODULE}\u0026#34; != \u0026#34;ccat\u0026#34; ]; then ${MODPROBE} ${MODPROBE_FLAGS} \u0026#34;${MODULE}\u0026#34; # try to restore fi ${RMMOD} ${LOADED_MODULES} exit 1 fi LOADED_MODULES=\u0026#34;${ECMODULE} ${LOADED_MODULES}\u0026#34; done exit 0 ;; ä¿®æ”¹ EtherCAT Master é…ç½®æ–‡ä»¶ã€‚\nä¾‹ï¼š/etc/sysconfig/ethercatå’Œ/etc/ethercat.conf\nshell \u0026#9660; 1 2 3 4 5 6 MASTER0_DEVICE=\u0026#34;00:11:22:33:44:55\u0026#34; #MASTER1_DEVICE=\u0026#34;\u0026#34; #MASTER0_BACKUP=\u0026#34;\u0026#34; DEVICE_MODULES=\u0026#34;generic\u0026#34; MASTER\u0026lt;X\u0026gt;_DEVICEé…ç½®ç½‘å¡çš„ç‰©ç†åœ°å€ï¼ˆMACï¼‰ï¼Œå¯é€šè¿‡ifconfigå‘½ä»¤æŸ¥çœ‹ã€‚\nDEVICE_MODULESé…ç½®ä½¿ç”¨çš„æ¨¡å—åç§°ï¼Œè¿™é‡Œä»…ä½¿ç”¨é€šç”¨ç½‘å¡é©±åŠ¨genericã€‚\nè¿è¡Œ EtherCAT Master å¯åŠ¨EtherCATä¸»ç«™ç¨‹åºã€‚\nshell \u0026#9660; 1 2 3 /etc/init.d/ethercat start # æˆ–è€… /sbin/ethercatctl start å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œå¯ä»¥çœ‹åˆ°/devç›®å½•ä¸‹æœ‰EtherCAT0è®¾å¤‡æ–‡ä»¶ã€‚\næŸ¥çœ‹ä¸»ç«™ä¿¡æ¯\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 [root@LS-GD ~]# ethercat master Master0 Phase: Idle Active: no Slaves: 1 Ethernet devices: Main: 00:11:22:33:44:55 (attached) Link: UP Tx frames: 370862 Tx bytes: 22319896 Rx frames: 370861 Rx bytes: 22319836 Tx errors: 0 Tx frame rate [1/s]: 125 125 125 Tx rate [KByte/s]: 7.3 7.3 7.3 Rx frame rate [1/s]: 125 125 125 Rx rate [KByte/s]: 7.3 7.3 7.3 Common: Tx frames: 1108336 Tx bytes: 66704720 Rx frames: 1108307 Rx bytes: 66702980 Lost frames: 29 Tx frame rate [1/s]: 125 125 125 Tx rate [KByte/s]: 7.3 7.3 7.3 Rx frame rate [1/s]: 125 125 125 Rx rate [KByte/s]: 7.3 7.3 7.3 Loss rate [1/s]: 0 0 0 Frame loss [%]: 0.0 0.0 0.0 Distributed clocks: Reference clock: Slave 0 DC reference time: 0 Application time: 0 2000-01-01 00:00:00.000000000 æŸ¥çœ‹ä»ç«™è®¾å¤‡\nshell \u0026#9660; 1 2 [root@LS-GD ~]# ethercat slaves 0 0:0 PREOP + XB6-EC0002(Modules/Slots and MDP) ç”Ÿæˆä»ç«™ä¿¡æ¯XMLæ–‡ä»¶\nshell \u0026#9660; 1 [root@LS-GD ~]# ethercat xml \u0026gt; scanner.xml å…¶ä»–ethercatå‘½ä»¤\nä½¿ç”¨ethercat -hå‘½ä»¤æŸ¥çœ‹å…¶ä»–å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•ã€‚\nå‚è€ƒ IgH EtherCAT Master Building and installing IgH EtherCAT Master IgH EtherCAT Master for Linux EtherCAT DRIVER AND TOOLS FOR EPICS AND LINUX AT PSI INTEGRATION OF EtherCAT HARDWARE INTO THE EPICS BASED DISTRIBUTED CONTROL SYSTEM AT iThemba LABS åœ¨â€œç¦ç‘2.0â€ä¸»æœºä¸Šç¼–è¯‘EPICS Ehtercaté©±åŠ¨è½¯ä»¶çš„ä½“éªŒ ","permalink":"https://kira-96.github.io/posts/%E9%BE%99%E8%8A%AF%E5%BC%80%E5%8F%91%E6%9D%BF%E7%A7%BB%E6%A4%8Digh-ethercat-master/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eIgH EtherCAT Master æ˜¯ä¸€ä¸ªå¼€æºçš„EtherCATä¸»ç«™é©±åŠ¨ç¨‹åºï¼Œç”¨äºç®¡ç†EtherCATä»ç«™è®¾å¤‡ï¼Œæ”¯æŒLinuxæ“ä½œç³»ç»Ÿï¼Œå·¥æ§ä¸Šä½¿ç”¨çš„æ¯”è¾ƒå¤šã€‚\u003c/p\u003e\n\u003cp\u003edls ethercatæ˜¯ç”±è‹±å›½é’»çŸ³å…‰æºå¼€å‘çš„ç”¨äº EPICS æ§åˆ¶ç³»ç»Ÿ EtherCAT è®¾å¤‡çš„æ”¯æŒç¨‹åºï¼ŒåŸºäº IgH Master ä¸»ç«™ç¨‹åºå¼€å‘ï¼Œå®ç°å¯¹ EtherCAT æ€»çº¿è®¾å¤‡çš„è¯»å†™ã€‚\u003c/p\u003e\n\u003cp\u003eäº¤å‰ç¼–è¯‘ç¯å¢ƒï¼šUbuntu\u003c/p\u003e\n\u003cp\u003eè¿è¡Œå¼€å‘æ¿ï¼šé¾™èŠ¯2K0500é‡‘é¾™å¼€å‘æ¿\u003c/p\u003e\n\u003cp\u003eå†…æ ¸ç‰ˆæœ¬ï¼šLinux LS-GD 5.10.0-rt17.lsgd #1 PREEMPT_RT\u003c/p\u003e\n\u003ch2 id=\"ç›¸å…³è½¯ä»¶åŒ…ä¸‹è½½åœ°å€\"\u003eç›¸å…³è½¯ä»¶åŒ…ä¸‹è½½åœ°å€\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://git.launchpad.net/epics-base\"\u003eepics-base - (launchpad.net)\u003c/a\u003e / \u003ca href=\"https://github.com/epics-base/epics-base\"\u003eepics-base/epics-base\u003c/a\u003e / \u003ca href=\"https://epics.anl.gov/base/index.php\"\u003eEPICS Base (anl.gov)\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/epics-modules/asyn\"\u003eepics-modules/asyn: EPICS module for driver and device support\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/epics-modules/busy\"\u003eepics-modules/busy: APS BCDA synApps module: busy\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/epics-modules/autosave\"\u003eepics-modules/autosave: APS BCDA synApps module: autosave\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/dls-controls/ethercat\"\u003edls-controls/ethercat: EPICS support to read/write to ethercat based hardware\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://gitlab.com/etherlab.org/ethercat/-/tree/stable-1.5\"\u003eIgH EtherCAT Master for Linux\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://mirrors.tuna.tsinghua.edu.cn/kernel/projects/rt/\"\u003ePREEMPT RT patch\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"é…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ\"\u003eé…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ\u003c/h2\u003e\n\u003cp\u003eå…³äºè¿™ä¸€èŠ‚ï¼Œä¹‹å‰çš„æ–‡ç« å·²ç»è¯¦ç»†è®²è¿‡ï¼Œå‚è€ƒ\u003ca href=\"../%E9%BE%99%E8%8A%AF2k500%E5%BC%80%E5%8F%91%E6%9D%BF%E4%B8%8A%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%91%BC%E5%90%B8%E7%81%AF%E6%95%88%E6%9E%9C/#%E9%85%8D%E7%BD%AE%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E7%8E%AF%E5%A2%83\"\u003eé…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ\u003c/a\u003eã€‚\u003c/p\u003e","title":"é¾™èŠ¯å¼€å‘æ¿ç§»æ¤ IgH EtherCAT Master"},{"content":"HugoåŸç”Ÿæ”¯æŒGoATï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨goatä»£ç å—ã€‚\ngoat \u0026#9660; . . . .--- 1 .-- 1 / 1 / \\ | | .---+ .-+ + / \\ .---+---. .--+--. | \u0026#39;--- 2 | \u0026#39;-- 2 / \\ 2 + + | | | | ---+ ---+ + / \\ / \\ .-+-. .-+-. .+. .+. | .--- 3 | .-- 3 \\ / 3 / \\ / \\ | | | | | | | | \u0026#39;---+ \u0026#39;-+ + 1 2 3 4 1 2 3 4 1 2 3 4 \u0026#39;--- 4 \u0026#39;-- 4 \\ 4 goat \u0026#9660; o o o o o * * * * * * * o o * o o o * * * o o o Â· * Â· Â· Â· Â· Â· Â· o o o o o * * * * * o o o o * o o o o * * * * * o * * Â· * * Â· Â· Â· Â· Â· Â· o o o o o * * * * * o * o o o o o o o o * * * * * o o o o o Â· o Â· Â· o Â· Â· * * Â· o o o o o * * * * * o * o o o o o o o * * * * o * o o Â· Â· Â· Â· o Â· Â· * Â· o o o o o * * * * * * * * * o o o o * * * o * o Â· Â· Â· Â· Â· Â· Â· * goat \u0026#9660; ___ ___ .---+---+---+---+---. .---+---+---+---. .---. .---. ___/ \\___/ \\ | | | | | | / \\ / \\ / \\ / \\ / | +---+ | / \\___/ \\___/ +---+---+---+---+---+ +---+---+---+---+ +---+ +---+ \\___/ b \\___/ \\ | | | b | | | \\ / \\a/ \\b/ \\ / \\ | +---+ | / a \\___/ \\___/ +---+---+---+---+---+ +---+---+---+---+ +---+ b +---+ \\___/ \\___/ \\ | | a | | | | / \\ / \\ / \\ / \\ / | a +---+ | \\___/ \\___/ \u0026#39;---+---+---+---+---\u0026#39; \u0026#39;---+---+---+---\u0026#39; \u0026#39;---\u0026#39; \u0026#39;---\u0026#39; goat \u0026#9660; +-------------------+ ^ .---. | A Box |__.--.__ __.--\u0026gt; | .-. | | | | \u0026#39;--\u0026#39; v | * |\u0026lt;--- | | +-------------------+ \u0026#39;-\u0026#39; | | Round *---(-. | .-----------------. .-------. .----------. .-------. | | | | Mixed Rounded | | | / Diagonals \\ | | | | | | | \u0026amp; Square Corners | \u0026#39;--. .--\u0026#39; / \\ |---+---| \u0026#39;-)-\u0026#39; .--------. \u0026#39;--+------------+-\u0026#39; .--. | \u0026#39;-------+--------\u0026#39; | | | | / Search / | | | | \u0026#39;---. | \u0026#39;-------\u0026#39; | \u0026#39;-+------\u0026#39; |\u0026lt;----------\u0026gt;| | | | v Interior | ^ \u0026#39; \u0026lt;---\u0026#39; \u0026#39;----\u0026#39; .-----------. ---. .--- v | .------------------. Diag line | .-------. +---. \\ / . | | if (a \u0026gt; b) +---. .---\u0026gt;| | | | | Curved line \\ / / \\ | | obj-\u0026gt;fcn() | \\ / | \u0026#39;-------\u0026#39; |\u0026lt;--\u0026#39; + / \\ | \u0026#39;------------------\u0026#39; \u0026#39;--\u0026#39; \u0026#39;--+--------\u0026#39; .--. .--. | .-. +Done?+-\u0026#39; .---+-----. | ^ |\\ | | /| .--+ | | \\ / | | | Join \\|/ | | Curved | \\| |/ | | \\ | \\ / | | +----\u0026gt; o --o-- \u0026#39;-\u0026#39; Vertical \u0026#39;--\u0026#39; \u0026#39;--\u0026#39; \u0026#39;-- \u0026#39;--\u0026#39; + .---. \u0026lt;--+---+-----\u0026#39; | /|\\ | | 3 | v not:line \u0026#39;quotes\u0026#39; .-\u0026#39; \u0026#39;---\u0026#39; .-. .---+--------. / A || B *bold* | ^ | | | Not a dot | \u0026lt;---+---\u0026lt;-- A dash--is not a line v | \u0026#39;-\u0026#39; \u0026#39;---------+--\u0026#39; / Nor/is this. --- æœ¬åšå®¢è¿˜æ”¯æŒMermaid.jsä½œå›¾ã€‚\nsequenceDiagram participant Alice participant Bob Alice-\u003e\u003eJohn: Hello John, how are you? loop Healthcheck John-\u003e\u003eJohn: Fight against hypochondria end Note right of John: Rational thoughts prevail! John--\u003e\u003eAlice: Great! John-\u003e\u003eBob: How about you? Bob--\u003e\u003eJohn: Jolly good! gantt dateFormat YYYY-MM-DD title Adding GANTT diagram to mermaid excludes weekdays 2014-01-10 section A section Completed task :done, des1, 2014-01-06,2014-01-08 Active task :active, des2, 2014-01-09, 3d Future task : des3, after des2, 5d Future task2 : des4, after des3, 5d gitGraph commit commit branch develop commit commit commit checkout main commit commit xychart-beta title \"Sales Revenue\" x-axis [jan, feb, mar, apr, may, jun, jul, aug, sep, oct, nov, dec] y-axis \"Revenue (in $)\" 4000 --\u003e 11000 bar [5000, 6000, 7500, 8200, 9500, 10500, 11000, 10200, 9200, 8500, 7000, 6000] line [5000, 6000, 7500, 8200, 9500, 10500, 11000, 10200, 9200, 8500, 7000, 6000] æ”¯æŒåŒºå—å¼•ç”¨\nâ„¹ï¸ Note Do not approach or handle without protective gear.\nâš ï¸ Radiation hazard Do not approach or handle without protective gear.\nå‚è€ƒ\nDiagrams | Hugo Hugoåšå®¢æ·»åŠ mermaidä½œå›¾ Render ASCII art as SVG diagrams Mermaid å…¥é—¨æ–‡æ¡£ Blockquote render hooks Hugoåšå®¢æ·»åŠ GitHubé£æ ¼çš„Alertå—å¼•ç”¨ ","permalink":"https://kira-96.github.io/notes/hugo-diagrams/","summary":"\u003cp\u003eHugoåŸç”Ÿæ”¯æŒ\u003ca href=\"https://github.com/bep/goat\"\u003eGoAT\u003c/a\u003eï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨goatä»£ç å—ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"goat\"\u003egoat\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-goat\" data-lang=\"goat\"\u003e      .               .                .               .--- 1          .-- 1     / 1\n     / \\              |                |           .---+            .-+         +\n    /   \\         .---+---.         .--+--.        |   \u0026#39;--- 2      |   \u0026#39;-- 2   / \\ 2\n   +     +        |       |        |       |    ---+            ---+          +\n  / \\   / \\     .-+-.   .-+-.     .+.     .+.      |   .--- 3      |   .-- 3   \\ / 3\n /   \\ /   \\    |   |   |   |    |   |   |   |     \u0026#39;---+            \u0026#39;-+         +\n 1   2 3   4    1   2   3   4    1   2   3   4         \u0026#39;--- 4          \u0026#39;-- 4     \\ 4\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"goat\"\u003egoat\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-goat\" data-lang=\"goat\"\u003e  o o o o o  * * * * *  * * o o *    o o o      * * *      o o o     Â· * Â· Â· Â·     Â· Â· Â·\n  o o o o o  * * * * *  o o o o *   o o o o    * * * *    * o * *    Â· * * Â· Â·    Â· Â· Â· Â·\n  o o o o o  * * * * *  o * o o o  o o o o o  * * * * *  o o o o o   Â· o Â· Â· o   Â· Â· * * Â·\n  o o o o o  * * * * *  o * o o o   o o o o    * * * *    o * o o    Â· Â· Â· Â· o    Â· Â· * Â·\n  o o o o o  * * * * *  * * * * o    o o o      * * *      o * o     Â· Â· Â· Â· Â·     Â· Â· *\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"goat\"\u003egoat\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-goat\" data-lang=\"goat\"\u003e       ___     ___      .---+---+---+---+---.     .---+---+---+---.  .---.   .---.\n   ___/   \\___/   \\     |   |   |   |   |   |    / \\ / \\ / \\ / \\ /   |   +---+   |\n  /   \\___/   \\___/     +---+---+---+---+---+   +---+---+---+---+    +---+   +---+\n  \\___/ b \\___/   \\     |   |   | b |   |   |    \\ / \\a/ \\b/ \\ / \\   |   +---+   |\n  / a \\___/   \\___/     +---+---+---+---+---+     +---+---+---+---+  +---+ b +---+\n  \\___/   \\___/   \\     |   | a |   |   |   |    / \\ / \\ / \\ / \\ /   | a +---+   |\n      \\___/   \\___/     \u0026#39;---+---+---+---+---\u0026#39;   \u0026#39;---+---+---+---\u0026#39;    \u0026#39;---\u0026#39;   \u0026#39;---\u0026#39;\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"goat\"\u003egoat\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-goat\" data-lang=\"goat\"\u003e+-------------------+                           ^                      .---.\n|    A Box          |__.--.__    __.--\u0026gt;         |      .-.             |   |\n|                   |        \u0026#39;--\u0026#39;               v     | * |\u0026lt;---        |   |\n+-------------------+                                  \u0026#39;-\u0026#39;             |   |\n                       Round                                       *---(-. |\n  .-----------------.  .-------.    .----------.         .-------.     | | |\n |   Mixed Rounded  | |         |  / Diagonals  \\        |   |   |     | | |\n | \u0026amp; Square Corners |  \u0026#39;--. .--\u0026#39;  /              \\       |---+---|     \u0026#39;-)-\u0026#39;       .--------.\n \u0026#39;--+------------+-\u0026#39;  .--. |     \u0026#39;-------+--------\u0026#39;      |   |   |       |        / Search /\n    |            |   |    | \u0026#39;---.        |               \u0026#39;-------\u0026#39;       |       \u0026#39;-+------\u0026#39;\n    |\u0026lt;----------\u0026gt;|   |    |      |       v                Interior                 |     ^\n    \u0026#39;           \u0026lt;---\u0026#39;      \u0026#39;----\u0026#39;   .-----------.              ---.     .---       v     |\n .------------------.  Diag line    | .-------. +---.              \\   /           .     |\n |   if (a \u0026gt; b)     +---.      .---\u0026gt;| |       | |    | Curved line  \\ /           / \\    |\n |   obj-\u0026gt;fcn()     |    \\    /     | \u0026#39;-------\u0026#39; |\u0026lt;--\u0026#39;                +           /   \\   |\n \u0026#39;------------------\u0026#39;     \u0026#39;--\u0026#39;      \u0026#39;--+--------\u0026#39;      .--. .--.     |  .-.     +Done?+-\u0026#39;\n    .---+-----.                        |   ^           |\\ | | /|  .--+ |   |     \\   /\n    |   |     | Join        \\|/        |   | Curved    | \\| |/ | |    \\    |      \\ /\n    |   |     +----\u0026gt;  o    --o--        \u0026#39;-\u0026#39;  Vertical  \u0026#39;--\u0026#39; \u0026#39;--\u0026#39;  \u0026#39;--  \u0026#39;--\u0026#39;        +  .---.\n \u0026lt;--+---+-----\u0026#39;       |     /|\\                                                    |  | 3 |\n                      v                             not:line    \u0026#39;quotes\u0026#39;        .-\u0026#39;   \u0026#39;---\u0026#39;\n  .-.             .---+--------.            /            A || B   *bold*       |        ^\n |   |           |   Not a dot  |      \u0026lt;---+---\u0026lt;--    A dash--is not a line    v        |\n  \u0026#39;-\u0026#39;             \u0026#39;---------+--\u0026#39;          /           Nor/is this.            ---\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eæœ¬åšå®¢è¿˜æ”¯æŒ\u003ca href=\"https://mermaid.js.org/\"\u003eMermaid.js\u003c/a\u003eä½œå›¾ã€‚\u003c/p\u003e","title":"Hugo Diagrams"},{"content":"å‰è¨€ MODBUSæ˜¯ä¸€ç§åº”ç”¨å±‚æ¶ˆæ¯ä¼ é€’åè®®ï¼Œé€šå¸¸ç”¨äº I/O ç³»ç»Ÿé€šä¿¡å’Œå¯ç¼–ç¨‹é€»è¾‘æ§åˆ¶å™¨ï¼ˆPLCï¼‰é€šä¿¡ã€‚\né“¾æ¥ç±»å‹ æè¿° MODBUS TCP TCP/IP ä½¿ç”¨502ç«¯å£ MODBUS RTU RTUé€šå¸¸é€šè¿‡ä¸²è¡Œé€šä¿¡é“¾è·¯è¿è¡Œï¼Œå³RS-232ã€ RS-422 æˆ– RS-485ã€‚RTU ä½¿ç”¨é¢å¤–çš„ CRC è¿›è¡Œæ•°æ®åŒ…æ£€æŸ¥ã€‚åè®®ç›´æ¥å°†æ¯ä¸ªå­—èŠ‚ä½œä¸º 8 ä¸ªæ•°æ®ä½ä¼ è¾“ï¼Œå› æ­¤ä½¿ç”¨â€œäºŒè¿›åˆ¶â€ è€Œä¸æ˜¯ ASCII ç¼–ç ã€‚ä½¿ç”¨ä¸²è¡Œé“¾è·¯å¼€å§‹å’Œç»“æŸæ—¶ï¼Œæ¶ˆæ¯å¸§æ˜¯æŒ‰æ—¶é—´è€Œä¸æ˜¯æŒ‰ç‰¹å®šå­—ç¬¦æ£€æµ‹çš„ã€‚ MODBUS ASCII ä¸²è¡Œåè®®ï¼Œé€šå¸¸åœ¨ä¸²è¡Œé€šä¿¡é“¾è·¯ä¸Šè¿è¡Œï¼Œå³ RS-232ã€RS-422 æˆ– RS-485ã€‚ä¸²è¡Œ ASCII ä½¿ç”¨é¢å¤–çš„ LRC æ•°æ®åŒ…æ£€æŸ¥ã€‚è¯¥åè®®å°†æ¯ä¸ªå­—èŠ‚ç¼–ç ä¸º 2 ä¸ª ASCII å­—ç¬¦ã€‚æ¶ˆæ¯å¸§çš„å¼€å§‹å’Œç»“æŸç”±ç‰¹å®šå­—ç¬¦æ£€æµ‹ ï¼ˆâ€œ:â€ å¼€å§‹æ¶ˆæ¯ï¼ŒCR/LF ç»“æŸæ¶ˆæ¯ï¼‰ã€‚è¯¥åè®®æ•ˆç‡ä½äº Modbus RTUï¼Œä½†åœ¨æŸäº›ç¯å¢ƒä¸­å¯èƒ½æ›´å¯é ã€‚ Modbus æä¾›å¯¹ä»¥ä¸‹ 4 ç§ç±»å‹çš„æ•°æ®çš„è®¿é—®ï¼š\nä¸»è¡¨ å¯¹è±¡ç±»å‹ è®¿é—® è¯´æ˜ ç¦»æ•£è¾“å…¥ 1bit åªè¯» è¿™ç§ç±»å‹çš„æ•°æ®å¯ä»¥ç”± I/O ç³»ç»Ÿæä¾›ã€‚ çº¿åœˆ 1bit è¯»å†™ æ­¤ç±»æ•°æ®å¯ç”±åº”ç”¨ç¨‹åºæ›´æ”¹ã€‚ è¾“å…¥å¯„å­˜å™¨ 16ä½å­—(2å­—èŠ‚) åªè¯» è¿™ç§ç±»å‹çš„æ•°æ®å¯ä»¥ç”± I/O ç³»ç»Ÿæä¾›ã€‚ ä¿æŒå¯„å­˜å™¨ 16ä½å­—(2å­—èŠ‚) è¯»å†™ æ­¤ç±»æ•°æ®å¯ç”±åº”ç”¨ç¨‹åºæ›´æ”¹ã€‚ Modbus é€šä¿¡ç”±ä» Modbus å®¢æˆ·ç«¯å‘é€åˆ° Modbus æœåŠ¡å™¨çš„è¯·æ±‚æ¶ˆæ¯ç»„æˆã€‚æœåŠ¡å™¨ä½¿ç”¨å“åº”æ¶ˆæ¯è¿›è¡Œå›å¤ã€‚Modbus è¯·æ±‚æ¶ˆæ¯åŒ…å«ï¼š\næè¿°æ•°æ®ä¼ è¾“ç±»å‹çš„ Modbus åŠŸèƒ½ç ï¼ˆ1å­—èŠ‚ï¼‰ã€‚ Modbus åœ°å€ï¼ˆ2å­—èŠ‚ï¼‰ï¼Œç”¨äºæè¿°ä»æœåŠ¡å™¨ä¸­è¯»å–æˆ–å†™å…¥æ•°æ®çš„åœ°å€ã€‚ å¯¹äºå†™å…¥æ“ä½œï¼Œåˆ™éœ€è¦ä¼ è¾“å†™å…¥çš„æ•°æ®ã€‚ Modbusæ¨¡å— æ”¯æŒä»¥ä¸‹ 9 ä¸ª Modbus åŠŸèƒ½ç ï¼š\nè®¿é—® åŠŸèƒ½è¯´æ˜ åŠŸèƒ½ç  1bit è¯»å–çº¿åœˆ 1 1bit è¯»å–ç¦»æ•£è¾“å…¥ 2 1bit å†™å…¥å•çº¿åœˆ 5 1bit å†™å…¥å¤šä¸ªçº¿åœˆ 15 16ä½å­—è®¿é—®(2å­—èŠ‚) è¯»å–è¾“å…¥å¯„å­˜å™¨ 4 16ä½å­—è®¿é—®(2å­—èŠ‚) è¯»å–ä¿æŒå¯„å­˜å™¨ 3 16ä½å­—è®¿é—®(2å­—èŠ‚) å†™å…¥å•ä¸ªå¯„å­˜å™¨ 6 16ä½å­—è®¿é—®(2å­—èŠ‚) å†™å…¥å¤šä¸ªå¯„å­˜å™¨ 16 16ä½å­—è®¿é—®(2å­—èŠ‚) è¯»/å†™å¤šä¸ªå¯„å­˜å™¨ 23 Modbusè¯»å–æ“ä½œä»…é™äºä¼ è¾“125ä¸ª16ä½å­—æˆ–2000 bitã€‚Modbuså†™å…¥æ“ä½œä»…é™äºä¼ è¾“123ä¸ª16ä½å­—æˆ–1968 bitã€‚\nç¼–è¯‘MODBUSæ¨¡å— ä½¿ç”¨åˆ°çš„æ¨¡å—ä¸‹è½½åœ°å€ epics-base - (launchpad.net) / epics-base/epics-base / EPICS Base (anl.gov) epics-modules/asyn: EPICS module for driver and device support epics-modules/modbus: EPICS support for communication with Programmable Logic Controllers (PLCs) and other devices via the Modbus protocol over TCP, serial RTU, and serial ASCII links epics-modules/sscan: APS BCDA synApps module: sscan epics-modules/calc: APS BCDA synApps module: calc epics-modules/ipac: IPAC Carrier and Communication Module Drivers sequencer / Download and Installation â€” EPICS Sequencer Version 2.2 (bessy.de) ä»¥ä¸‹æ­¥éª¤éœ€è¦å…ˆå®‰è£…å¥½EPICS Base.\nç¼–è¯‘ SSCANï¼ˆå¯é€‰ï¼‰ configure/RELEASE.local \u0026#9660; 1 2 3 4 5 6 # ä¿®æ”¹æˆå’ŒEPICS Baseä¸€æ ·çš„æ¶æ„ # EPICS_HOST_ARCH=linux-loong64 # EPICS Baseè·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ EPICS_BASE=/home/ubuntu/loongson/base-7.0.8 # æ”¾ç½®EPICSæ¨¡å—çš„è·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ SUPPORT=$(EPICS_BASE)/../modules shell \u0026#9660; 1 2 3 4 5 # ç›´æ¥ç¼–è¯‘ # make # äº¤å‰ç¼–è¯‘ï¼ˆç¤ºä¾‹ï¼‰ # make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++ make ç¼–è¯‘ CALCï¼ˆå¯é€‰ï¼‰ configure/RELEASE.local \u0026#9660; 1 2 3 4 5 6 7 8 # ä¿®æ”¹æˆå’ŒEPICS Baseä¸€æ ·çš„æ¶æ„ # EPICS_HOST_ARCH=linux-loong64 # EPICS Baseè·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ EPICS_BASE=/home/ubuntu/loongson/base-7.0.8 # æ”¾ç½®EPICSæ¨¡å—çš„è·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ SUPPORT=$(EPICS_BASE)/../modules # SSCANæ¨¡å—è·¯å¾„ SSCAN=$(SUPPORT)/sscan shell \u0026#9660; 1 2 3 4 5 # ç›´æ¥ç¼–è¯‘ # make # äº¤å‰ç¼–è¯‘ï¼ˆç¤ºä¾‹ï¼‰ # make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++ make ç¼–è¯‘ asynï¼ˆå¿…éœ€ï¼‰ configure/RELEASE.local \u0026#9660; 1 2 3 4 5 6 7 8 9 10 # ä¿®æ”¹æˆå’ŒEPICS Baseä¸€æ ·çš„æ¶æ„ # EPICS_HOST_ARCH=linux-loong64 # EPICS Baseè·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ EPICS_BASE=/home/ubuntu/loongson/base-7.0.8 # æ”¾ç½®EPICSæ¨¡å—çš„è·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ SUPPORT=$(EPICS_BASE)/../modules # SSCANæ¨¡å—è·¯å¾„ SSCAN=$(SUPPORT)/sscan # CALCæ¨¡å—è·¯å¾„ CALC=$(SUPPORT)/calc shell \u0026#9660; 1 2 3 4 5 # ç›´æ¥ç¼–è¯‘ # make # äº¤å‰ç¼–è¯‘ï¼ˆç¤ºä¾‹ï¼‰ # make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++ make ç¼–è¯‘ modbus configure/RELEASE.local \u0026#9660; 1 2 3 4 5 6 7 8 # ä¿®æ”¹æˆå’ŒEPICS Baseä¸€æ ·çš„æ¶æ„ # EPICS_HOST_ARCH=linux-loong64 # EPICS Baseè·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ EPICS_BASE=/home/ubuntu/loongson/base-7.0.8 # æ”¾ç½®EPICSæ¨¡å—çš„è·¯å¾„ï¼ˆç¤ºä¾‹ï¼‰ SUPPORT=$(EPICS_BASE)/../modules # ASYNæ¨¡å—è·¯å¾„ ASYN=$(SUPPORT)/asyn shell \u0026#9660; 1 2 3 4 5 # ç›´æ¥ç¼–è¯‘ # make # äº¤å‰ç¼–è¯‘ï¼ˆç¤ºä¾‹ï¼‰ # make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++ make ç¼–è¯‘å®Œæˆåï¼Œå¯ä»¥çœ‹åˆ°bin\\\u0026lt;EPICS_HOST_ARCH\u0026gt;è·¯å¾„ä¸‹ç”Ÿæˆäº†å¯æ‰§è¡Œç¨‹åºmodbusAppï¼Œå®ƒå°±æ˜¯ä¸Modbusè®¾å¤‡é€šä¿¡çš„ä¸»ç¨‹åºäº†ã€‚\nä½¿ç”¨ MODBUS ç¨‹åº åœ¨Modbusæ¨¡å—çš„iocBoot/iocTestç›®å½•ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å¾ˆå¤šç¤ºä¾‹ç¨‹åºã€‚è¿™é‡Œæ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æ—¶ä¸»è¦éœ€è¦ç¼–å†™ä¸¤éƒ¨åˆ†å†…å®¹ã€‚\nç”¨äºé…ç½®è®¾å¤‡è¿æ¥å’Œé€šä¿¡çš„.cmdæ–‡ä»¶ ç”¨äºä½¿ç”¨æ¨¡æ¿è§£ææ•°æ®çš„.substitutionsæ–‡ä»¶ è¿™é‡Œç»™å‡ºç¤ºä¾‹å¹¶åšç®€è¦è¯´æ˜ã€‚\nenvPathsæ–‡ä»¶ï¼šç”¨äºé…ç½®ç¨‹åºè¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡è·¯å¾„ã€‚\nè¿™é‡Œéœ€è¦é…ç½®å¥½baseã€asynã€modbusæ¨¡å—çš„è·¯å¾„ã€‚\nenvPaths \u0026#9660; 1 2 3 4 5 6 7 epicsEnvSet(\u0026#34;IOC\u0026#34;,\u0026#34;app\u0026#34;) epicsEnvSet(\u0026#34;TOP\u0026#34;,\u0026#34;../..\u0026#34;) epicsEnvSet(\u0026#34;SUPPORT\u0026#34;,\u0026#34;/root/modules\u0026#34;) epicsEnvSet(\u0026#34;ASYN\u0026#34;,\u0026#34;/root/modules/asyn\u0026#34;) epicsEnvSet(\u0026#34;MODBUS\u0026#34;,\u0026#34;/root/modules/modbus\u0026#34;) epicsEnvSet(\u0026#34;EPICS_BASE\u0026#34;,\u0026#34;/root/base\u0026#34;) # epicsEnvSet(\u0026#34;EPICS_CAS_SERVER_PORT\u0026#34;, 9001) AMSAMOTION.cmd \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 #!../../bin/linux-loong64/modbusApp \u0026lt; envPaths dbLoadDatabase(\u0026#34;$(MODBUS)/dbd/modbusApp.dbd\u0026#34;) modbusApp_registerRecordDeviceDriver(pdbbase) # MODBUS TCP é…ç½® # Use the following commands for TCP/IP #drvAsynIPPortConfigure(const char *portName, # const char *hostInfo, # unsigned int priority, # int noAutoConnect, # int noProcessEos); drvAsynIPPortConfigure(\u0026#34;AMSAMOTION\u0026#34;,\u0026#34;192.168.xxx.xxx:502\u0026#34;,0,0,1) #asynSetOption(\u0026#34;AMSAMOTION\u0026#34;,0, \u0026#34;disconnectOnReadTimeout\u0026#34;, \u0026#34;Y\u0026#34;) # MODBUS RTUé…ç½® #drvAsynSerialPortConfigure(const char *portName, # const char *ttyName, # unsigned int priority, # int noAutoConnect, # int noProcessEos); # drvAsynSerialPortConfigure(\u0026#34;Koyo1\u0026#34;, \u0026#34;/dev/ttyS1\u0026#34;, 0, 0, 0) # asynSetOption(\u0026#34;Koyo1\u0026#34;,0,\u0026#34;baud\u0026#34;,\u0026#34;38400\u0026#34;) # asynSetOption(\u0026#34;Koyo1\u0026#34;,0,\u0026#34;parity\u0026#34;,\u0026#34;none\u0026#34;) # asynSetOption(\u0026#34;Koyo1\u0026#34;,0,\u0026#34;bits\u0026#34;,\u0026#34;8\u0026#34;) # asynSetOption(\u0026#34;Koyo1\u0026#34;,0,\u0026#34;stop\u0026#34;,\u0026#34;1\u0026#34;) # Modbus ASCII è¿˜éœ€é…ç½®å…¶ä»–é¡¹ # asynOctetSetOutputEos(\u0026#34;Koyo1\u0026#34;,0,\u0026#34;\\r\\n\u0026#34;) # asynOctetSetInputEos(\u0026#34;Koyo1\u0026#34;,0,\u0026#34;\\r\\n\u0026#34;) # è¶…æ—¶è®¾ç½® #modbusInterposeConfig(const char *portName, # modbusLinkType linkType, # int timeoutMsec, # int writeDelayMsec) # Modbus Link Type: 0 = TCP/IPï¼Œ1 = RTUï¼Œ2 = ASCII modbusInterposeConfig(\u0026#34;AMSAMOTION\u0026#34;,0,5000,0) # è¯»å–/å†™å…¥é…ç½® #drvModbusAsynConfigure(portName, # tcpPortName, # slaveAddress, # modbusFunction, # modbusStartAddress, # modbusLength, # dataType, # pollMsec, # plcType); drvModbusAsynConfigure(\u0026#34;AMSA:AI\u0026#34;, \u0026#34;AMSAMOTION\u0026#34;, 1, 4, 0, 6, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:AO1\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;, 1, 6, 0, 1, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:AO2\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;, 1, 6, 1, 1, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:AOSta\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;,1, 3, 0, 2, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:DI\u0026#34;, \u0026#34;AMSAMOTION\u0026#34;, 1, 2, 0, 8, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:DO1\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;, 1, 5, 0, 1, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:DO2\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;, 1, 5, 1, 1, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:DO3\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;, 1, 5, 2, 1, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:DO4\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;, 1, 5, 3, 1, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:DO5\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;, 1, 5, 4, 1, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:DO6\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;, 1, 5, 5, 1, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:DO7\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;, 1, 5, 6, 1, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:DO8\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;, 1, 5, 7, 1, 0, 100, \u0026#34;AMSA\u0026#34;) drvModbusAsynConfigure(\u0026#34;AMSA:DOSta\u0026#34;,\u0026#34;AMSAMOTION\u0026#34;,1, 1, 0, 8, 0, 100, \u0026#34;AMSA\u0026#34;) # Enable ASYN_TRACEIO_HEX on modbus server asynSetTraceIOMask(\u0026#34;AMSAMOTION\u0026#34;,0,4) # Dump up to 512 bytes in asynTrace asynSetTraceIOTruncateSize(\u0026#34;AMSAMOTION\u0026#34;,0,512) dbLoadTemplate(\u0026#34;AMSAMOTION.substitutions\u0026#34;) iocInit AMSAMOTION.substitutions \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 # asyn record for the underlying asyn octet port file \u0026#34;$(ASYN)/db/asynRecord.db\u0026#34; { pattern {P, R, PORT, ADDR, IMAX, OMAX} {AMSAMOTION: OctetAsyn, AMSAMOTION, 0, 80, 80} } file \u0026#34;$(TOP)/db/ai.template\u0026#34; { pattern {P, R, PORT, OFFSET, BITS, EGUL, EGUF, PREC, SCAN} {AMSAMOTION:, AI1, AMSA:AI, 0, 0xFFFF, 0, 65535, 0, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION:, AI2, AMSA:AI, 1, 0xFFFF, 0, 65535, 0, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION:, AI3, AMSA:AI, 2, 0xFFFF, 0, 65535, 0, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION:, AI4, AMSA:AI, 3, 0xFFFF, 0, 65535, 0, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION:, AI5, AMSA:AI, 4, 0xFFFF, 0, 65535, 0, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION:, AI6, AMSA:AI, 5, 0xFFFF, 0, 65535, 0, \u0026#34;I/O Intr\u0026#34;} } file \u0026#34;$(TOP)/db/ao.template\u0026#34; { pattern {P, R, PORT, OFFSET, BITS, EGUL, EGUF, PREC} {AMSAMOTION: AO1, AMSA:AO1, 0, 0xFFFF, 0, 65535, 0} {AMSAMOTION: AO2, AMSA:AO2, 0, 0xFFFF, 0, 65535, 0} } file \u0026#34;$(TOP)/db/ai.template\u0026#34; { pattern {P, R, PORT, OFFSET, BITS, EGUL, EGUF, PREC, SCAN} {AMSAMOTION:, AO1:STATE, AMSA:AOSta, 0, 0xFFFF, 0, 65535, 0, \u0026#34;1 second\u0026#34;} {AMSAMOTION:, AO2:STATE, AMSA:AOSta, 1, 0xFFFF, 0, 65535, 0, \u0026#34;1 second\u0026#34;} } file \u0026#34;$(TOP)/db/bi_bit.template\u0026#34; { pattern {P, R, PORT, OFFSET, ZNAM, ONAM, ZSV, OSV, SCAN} {AMSAMOTION: DI1, AMSA:DI, 0, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DI2, AMSA:DI, 1, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DI3, AMSA:DI, 2, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DI4, AMSA:DI, 3, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DI5, AMSA:DI, 4, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DI6, AMSA:DI, 5, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DI7, AMSA:DI, 6, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DI8, AMSA:DI, 7, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} } file \u0026#34;$(TOP)/db/bi_bit.template\u0026#34; { pattern {P, R, PORT, OFFSET, ZNAM, ONAM, ZSV, OSV, SCAN} {AMSAMOTION: DO1:STATE, AMSA:DOSta, 0, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DO2:STATE, AMSA:DOSta, 1, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DO3:STATE, AMSA:DOSta, 2, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DO4:STATE, AMSA:DOSta, 3, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DO5:STATE, AMSA:DOSta, 4, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DO6:STATE, AMSA:DOSta, 5, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DO7:STATE, AMSA:DOSta, 6, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} {AMSAMOTION: DO8:STATE, AMSA:DOSta, 7, OFF, ON, NO_ALARM, MAJOR, \u0026#34;I/O Intr\u0026#34;} } file \u0026#34;$(TOP)/db/bo_bit.template\u0026#34; { pattern {P, R, PORT, OFFSET, ZNAM, ONAM} {AMSAMOTION: DO1, AMSA:DO1, 0, OFF, ON} {AMSAMOTION: DO2, AMSA:DO2, 0, OFF, ON} {AMSAMOTION: DO3, AMSA:DO3, 0, OFF, ON} {AMSAMOTION: DO4, AMSA:DO4, 0, OFF, ON} {AMSAMOTION: DO5, AMSA:DO5, 0, OFF, ON} {AMSAMOTION: DO6, AMSA:DO6, 0, OFF, ON} {AMSAMOTION: DO7, AMSA:DO7, 0, OFF, ON} {AMSAMOTION: DO8, AMSA:DO8, 0, OFF, ON} } æœ€åè¿è¡Œç¨‹åºï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œï¼š\nshell \u0026#9660; 1 /path/to/modbus/bin/\u0026lt;EPICS_HOST_ARCH\u0026gt;/modbusApp AMSAMOTION.cmd æˆ–è€…åœ¨.cmdæ–‡ä»¶ç¬¬ä¸€è¡Œæ·»åŠ ä¸‹é¢ä¸€è¡Œï¼š\nshell \u0026#9660; 1 #!../../bin/\u0026lt;EPICS_HOST_ARCH\u0026gt;/modbusApp ç„¶åç›´æ¥æ‰§è¡Œ.cmdè„šæœ¬ã€‚\nshell \u0026#9660; 1 2 chmod +x AMSAMOTION.cmd ./AMSAMOTION.cmd å‚è€ƒ\nOverview of Modbus Creating a modbus port driver EPICS Process Database Concepts ","permalink":"https://kira-96.github.io/posts/build-epics-module-modbus/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eMODBUSæ˜¯ä¸€ç§åº”ç”¨å±‚æ¶ˆæ¯ä¼ é€’åè®®ï¼Œé€šå¸¸ç”¨äº I/O ç³»ç»Ÿé€šä¿¡å’Œå¯ç¼–ç¨‹é€»è¾‘æ§åˆ¶å™¨ï¼ˆPLCï¼‰é€šä¿¡ã€‚\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: center\"\u003eé“¾æ¥ç±»å‹\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003eæè¿°\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003eMODBUS TCP\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eTCP/IP ä½¿ç”¨502ç«¯å£\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003eMODBUS RTU\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eRTUé€šå¸¸é€šè¿‡ä¸²è¡Œé€šä¿¡é“¾è·¯è¿è¡Œï¼Œå³RS-232ã€ RS-422 æˆ– RS-485ã€‚RTU ä½¿ç”¨é¢å¤–çš„ CRC è¿›è¡Œæ•°æ®åŒ…æ£€æŸ¥ã€‚åè®®ç›´æ¥å°†æ¯ä¸ªå­—èŠ‚ä½œä¸º 8 ä¸ªæ•°æ®ä½ä¼ è¾“ï¼Œå› æ­¤ä½¿ç”¨â€œäºŒè¿›åˆ¶â€ è€Œä¸æ˜¯ ASCII ç¼–ç ã€‚ä½¿ç”¨ä¸²è¡Œé“¾è·¯å¼€å§‹å’Œç»“æŸæ—¶ï¼Œæ¶ˆæ¯å¸§æ˜¯æŒ‰æ—¶é—´è€Œä¸æ˜¯æŒ‰ç‰¹å®šå­—ç¬¦æ£€æµ‹çš„ã€‚\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003eMODBUS ASCII\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eä¸²è¡Œåè®®ï¼Œé€šå¸¸åœ¨ä¸²è¡Œé€šä¿¡é“¾è·¯ä¸Šè¿è¡Œï¼Œå³ RS-232ã€RS-422 æˆ– RS-485ã€‚ä¸²è¡Œ ASCII ä½¿ç”¨é¢å¤–çš„ LRC æ•°æ®åŒ…æ£€æŸ¥ã€‚è¯¥åè®®å°†æ¯ä¸ªå­—èŠ‚ç¼–ç ä¸º 2 ä¸ª ASCII å­—ç¬¦ã€‚æ¶ˆæ¯å¸§çš„å¼€å§‹å’Œç»“æŸç”±ç‰¹å®šå­—ç¬¦æ£€æµ‹ ï¼ˆâ€œ:â€ å¼€å§‹æ¶ˆæ¯ï¼ŒCR/LF ç»“æŸæ¶ˆæ¯ï¼‰ã€‚è¯¥åè®®æ•ˆç‡ä½äº Modbus RTUï¼Œä½†åœ¨æŸäº›ç¯å¢ƒä¸­å¯èƒ½æ›´å¯é ã€‚\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eModbus æä¾›å¯¹ä»¥ä¸‹ 4 ç§ç±»å‹çš„æ•°æ®çš„è®¿é—®ï¼š\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: center\"\u003eä¸»è¡¨\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003eå¯¹è±¡ç±»å‹\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003eè®¿é—®\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003eè¯´æ˜\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003eç¦»æ•£è¾“å…¥\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1bit\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eåªè¯»\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eè¿™ç§ç±»å‹çš„æ•°æ®å¯ä»¥ç”± I/O ç³»ç»Ÿæä¾›ã€‚\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003eçº¿åœˆ\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1bit\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eè¯»å†™\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eæ­¤ç±»æ•°æ®å¯ç”±åº”ç”¨ç¨‹åºæ›´æ”¹ã€‚\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003eè¾“å…¥å¯„å­˜å™¨\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e16ä½å­—(2å­—èŠ‚)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eåªè¯»\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eè¿™ç§ç±»å‹çš„æ•°æ®å¯ä»¥ç”± I/O ç³»ç»Ÿæä¾›ã€‚\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003eä¿æŒå¯„å­˜å™¨\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e16ä½å­—(2å­—èŠ‚)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eè¯»å†™\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eæ­¤ç±»æ•°æ®å¯ç”±åº”ç”¨ç¨‹åºæ›´æ”¹ã€‚\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eModbus é€šä¿¡ç”±ä» Modbus å®¢æˆ·ç«¯å‘é€åˆ° Modbus æœåŠ¡å™¨çš„è¯·æ±‚æ¶ˆæ¯ç»„æˆã€‚æœåŠ¡å™¨ä½¿ç”¨å“åº”æ¶ˆæ¯è¿›è¡Œå›å¤ã€‚Modbus è¯·æ±‚æ¶ˆæ¯åŒ…å«ï¼š\u003c/p\u003e","title":"EPICSçš„MODBUSæ¨¡å—çš„ç¼–è¯‘å’Œä½¿ç”¨"},{"content":"å…³äº ACAI ACAI æ˜¯ä¸€ä¸ªC++å°è£…çš„Channel Accessåè®®åº”ç”¨å¼€å‘æ¥å£ï¼ˆAPIï¼‰ï¼Œæä¾›å¼‚æ­¥é€šé“è®¿é—®æ¥å£ã€‚\nACAI Channel Access Interface\nEPICS Qtä¾èµ–ACAIæä¾›çš„Channel Accessæ¥å£ã€‚\nå‰ç½®æ­¥éª¤ è¿™ç¯‡ç¬”è®°æ˜¯äº¤å‰ç¼–è¯‘EPICSå’ŒIOCå†…å®¹çš„è¡¥å……ã€‚\nåœ¨è¿›è¡Œä¸‹é¢æ­¥éª¤å‰ï¼Œè¯·å®Œæˆé…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒå’Œç¼–è¯‘ EPICS Baseã€‚\nè¿™é‡Œä¾æ—§ä»¥é¾™èŠ¯æ¶æ„ä¸ºä¾‹ã€‚\nEPICS base ç¼–è¯‘å®Œæˆåï¼Œå¯ä»¥çœ‹åˆ°binç›®å½•ä¸‹æœ‰linux-loong64ã€linux-x86_64ä¸¤ä¸ªç›®å½•ï¼Œlinux-x86_64ç›®å½•ä¸‹æ¯”linux-loong64ç›®å½•å¤šå‡ºäº†è®¸å¤šperlè„šæœ¬ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™äº›è„šæœ¬å¤åˆ¶åˆ°é¾™æ¶æ„çš„ç›®å½•ä¸‹ï¼Œä¸‹é¢ç¼–è¯‘éœ€è¦ç”¨åˆ°ã€‚\nshell \u0026#9660; 1 $ cp ./bin/linux-x86_64/*.pl ./bin/linux-loong64/ ç¼–è¯‘ åœ¨EPICS-Qtå®‰è£…ä¸­å·²ç»ä»‹ç»è¿‡ç¼–è¯‘ACAIã€‚è¿™æ¬¡æ˜¯ä½¿ç”¨äº¤å‰ç¼–è¯‘æ–¹å¼ï¼Œæ­¥éª¤ç•¥æœ‰ä¸åŒã€‚\nsh \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 cd ~/loongson/ git clone https://github.com/andrewstarritt/acai.git cd acai vi configure/RELEASE.local # ä¿®æ”¹äº¤å‰ç¼–è¯‘çš„ç›®æ ‡æ¶æ„ï¼Œå’ŒEPICS baseä¸­ä¿æŒä¸€è‡´ # EPICS_HOST_ARCH=linux-loong64 # ä¿®æ”¹EPICS_BASEè·¯å¾„ï¼Œä¾‹ï¼š EPICS_BASE=/home/ubuntu/loongson/base-7.0.8 # make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++ make # ç­‰å¾…ç¼–è¯‘å®Œæˆ ç¼–è¯‘å®Œæˆåå¯ä»¥åœ¨lib/linux-loong64/ç›®å½•ä¸‹æ‰¾åˆ°libacai.soã€‚\n","permalink":"https://kira-96.github.io/notes/cross-compiling-acai/","summary":"\u003ch2 id=\"å…³äº-acai\"\u003eå…³äº ACAI\u003c/h2\u003e\n\u003cp\u003eACAI æ˜¯ä¸€ä¸ªC++å°è£…çš„\u003ccode\u003eChannel Access\u003c/code\u003eåè®®åº”ç”¨å¼€å‘æ¥å£ï¼ˆAPIï¼‰ï¼Œæä¾›å¼‚æ­¥é€šé“è®¿é—®æ¥å£ã€‚\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/andrewstarritt/acai\"\u003eACAI Channel Access Interface\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eEPICS Qtä¾èµ–ACAIæä¾›çš„Channel Accessæ¥å£ã€‚\u003c/p\u003e\n\u003ch2 id=\"å‰ç½®æ­¥éª¤\"\u003eå‰ç½®æ­¥éª¤\u003c/h2\u003e\n\u003cp\u003eè¿™ç¯‡ç¬”è®°æ˜¯\u003ca href=\"../../posts/%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91epics%E5%92%8Cioc/\"\u003eäº¤å‰ç¼–è¯‘EPICSå’ŒIOC\u003c/a\u003eå†…å®¹çš„è¡¥å……ã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨è¿›è¡Œä¸‹é¢æ­¥éª¤å‰ï¼Œè¯·å®Œæˆ\u003cstrong\u003eé…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ\u003c/strong\u003eå’Œ\u003cstrong\u003eç¼–è¯‘ EPICS Base\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eè¿™é‡Œä¾æ—§ä»¥é¾™èŠ¯æ¶æ„ä¸ºä¾‹ã€‚\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eEPICS base ç¼–è¯‘å®Œæˆåï¼Œå¯ä»¥çœ‹åˆ°\u003ccode\u003ebin\u003c/code\u003eç›®å½•ä¸‹æœ‰\u003ccode\u003elinux-loong64\u003c/code\u003eã€\u003ccode\u003elinux-x86_64\u003c/code\u003eä¸¤ä¸ªç›®å½•ï¼Œ\u003ccode\u003elinux-x86_64\u003c/code\u003eç›®å½•ä¸‹æ¯”\u003ccode\u003elinux-loong64\u003c/code\u003eç›®å½•å¤šå‡ºäº†è®¸å¤š\u003ccode\u003eperl\u003c/code\u003eè„šæœ¬ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™äº›è„šæœ¬å¤åˆ¶åˆ°é¾™æ¶æ„çš„ç›®å½•ä¸‹ï¼Œä¸‹é¢ç¼–è¯‘éœ€è¦ç”¨åˆ°ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ cp ./bin/linux-x86_64/*.pl ./bin/linux-loong64/\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003ch2 id=\"ç¼–è¯‘\"\u003eç¼–è¯‘\u003c/h2\u003e\n\u003cp\u003eåœ¨\u003ca href=\"../../posts/epics-qt%E5%AE%89%E8%A3%85/\"\u003eEPICS-Qtå®‰è£…\u003c/a\u003eä¸­å·²ç»ä»‹ç»è¿‡ç¼–è¯‘ACAIã€‚è¿™æ¬¡æ˜¯ä½¿ç”¨äº¤å‰ç¼–è¯‘æ–¹å¼ï¼Œæ­¥éª¤ç•¥æœ‰ä¸åŒã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"sh\"\u003esh\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e ~/loongson/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clone https://github.com/andrewstarritt/acai.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e acai\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evi configure/RELEASE.local\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ä¿®æ”¹äº¤å‰ç¼–è¯‘çš„ç›®æ ‡æ¶æ„ï¼Œå’ŒEPICS baseä¸­ä¿æŒä¸€è‡´\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# EPICS_HOST_ARCH=linux-loong64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ä¿®æ”¹EPICS_BASEè·¯å¾„ï¼Œä¾‹ï¼š\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eEPICS_BASE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/home/ubuntu/loongson/base-7.0.8\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# make LD=loongarch64-linux-gnu-ld CC=loongarch64-linux-gnu-gcc CCC=loongarch64-linux-gnu-g++\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ç­‰å¾…ç¼–è¯‘å®Œæˆ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eç¼–è¯‘å®Œæˆåå¯ä»¥åœ¨\u003ccode\u003elib/linux-loong64/\u003c/code\u003eç›®å½•ä¸‹æ‰¾åˆ°\u003ccode\u003elibacai.so\u003c/code\u003eã€‚\u003c/p\u003e","title":"äº¤å‰ç¼–è¯‘ ACAI"},{"content":"å‰è¨€ ä¹‹å‰å·²ç»è®²è¿‡åœ¨é¾™èŠ¯3A5000(loongarch64)ä¸Šç¼–è¯‘è¿è¡ŒEPICSï¼Œä¸è¿‡è¿™ç§æƒ…å†µåªé€‚ç”¨äºæœ‰å®Œæ•´å¼€å‘ç¯å¢ƒçš„æƒ…å†µä¸‹è¿›è¡Œç¼–è¯‘ã€‚ä¸€äº›æ—¶å€™ï¼Œæˆ‘ä»¬åªæœ‰ç¼–è¯‘å™¨ï¼Œè€Œç¼ºå°‘makeï¼Œperlç­‰å·¥å…·ï¼Œæ¯”å¦‚ä¸€äº›å¼€å‘æ¿å‚å•†æä¾›çš„å¼€å‘å¥—ä»¶ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå°±éœ€è¦é€šè¿‡äº¤å‰ç¼–è¯‘(cross-compiling)çš„æ–¹å¼æ¥ç¼–è¯‘EPICSã€‚\nè¿™é‡Œä»¥é¾™èŠ¯é‡‘é¾™2K500å…ˆé”‹å¼€å‘æ¿ä¸ºä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨Ubuntu-20.04ä½œä¸ºæ„å»ºç³»ç»Ÿï¼Œè¯¦ç»†è®²è§£å¦‚ä½•æ„å»ºå‡ºå¯ä»¥åœ¨å¼€å‘æ¿ä¸Šè¿è¡Œçš„EPICSå·¥å…·åŒ…ï¼Œå¹¶éƒ¨ç½²åœ¨å¼€å‘æ¿ä¸Šã€‚\nç”±äºå¼€å‘æ¿ä¸Šæ²¡æœ‰å¼€å‘ç¯å¢ƒï¼Œå³ä½¿ç¼–è¯‘å‡ºç›®æ ‡å¹³å°çš„EPICS Baseï¼Œæˆ‘ä»¬ä¾ç„¶ä¸èƒ½ç›´æ¥åœ¨å¼€å‘æ¿ä¸Šåˆ›å»ºå’Œç¼–è¯‘IOCã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨Ubuntu-20.04ä½œä¸ºæ„å»ºç³»ç»Ÿï¼Œåˆ›å»ºå¹¶ç¼–è¯‘IOCï¼Œæœ€ååœ¨å¼€å‘æ¿ä¸Šè¿è¡Œã€‚\né…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ å…³äºè¿™ä¸€èŠ‚ï¼Œä¹‹å‰çš„æ–‡ç« å·²ç»è¯¦ç»†è®²è¿‡ï¼Œå‚è€ƒé…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒã€‚\nå¦‚æœä½ ä½¿ç”¨çš„æ˜¯å…¶ä»–å¼€å‘å¥—ä»¶ï¼Œè¯·æŒ‰ç…§å¼€å‘æ‰‹å†Œå®‰è£…é…ç½®å¥½ç¯å¢ƒã€‚\nç¼–è¯‘ EPICS Base é¦–å…ˆï¼Œä¸‹è½½ã€è§£å‹Baseï¼Œå‚è€ƒä»¥å‰çš„æ–‡ç« ã€‚\nåœ¨é¾™èŠ¯3A5000(loongarch64)ä¸Šç¼–è¯‘è¿è¡ŒEPICSä¸­æˆ‘å·²ç»è¯¦ç»†è®²è§£äº†å¦‚ä½•åœ¨é¾™æ¶æ„ä¸Šç¼–è¯‘EPICSï¼Œè¿™æ¬¡ï¼Œéœ€è¦åœ¨åŸæ¥å¯¹æºç ä¿®æ”¹çš„åŸºç¡€ä¸Šï¼Œå†å¢åŠ å¯¹äº¤å‰ç¼–è¯‘çš„æ”¯æŒã€‚\næ·»åŠ configure/os/CONFIG.linux-x86_64.linux-loong64\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 # CONFIG.linux-x86_64.linux-loong64 # # Definitions for linux-x86_64 host - linux-loong64 target builds # Sites may override these in CONFIG_SITE.linux-x86_64.linux-loong64 #------------------------------------------------------- VALID_BUILDS = Ioc Command GNU_TARGET = loongarch64-linux-gnu # prefix of compiler tools CMPLR_SUFFIX = CMPLR_PREFIX = $(addsuffix -,$(GNU_TARGET)) # Provide a link-time path for readline if needed OP_SYS_INCLUDES += $(READLINE_DIR:%=-I%/include) READLINE_LDFLAGS = $(READLINE_DIR:%=-L%/lib) RUNTIME_LDFLAGS_READLINE_YES_NO = $(READLINE_DIR:%=-Wl,-rpath,%/lib) RUNTIME_LDFLAGS += \\ $(RUNTIME_LDFLAGS_READLINE_$(LINKER_USE_RPATH)_$(STATIC_BUILD)) SHRLIBDIR_LDFLAGS += $(READLINE_LDFLAGS) PRODDIR_LDFLAGS += $(READLINE_LDFLAGS) # Library flags STATIC_LDFLAGS_YES= -Wl,-Bstatic STATIC_LDFLAGS_NO= STATIC_LDLIBS_YES= -Wl,-Bdynamic STATIC_LDLIBS_NO= æ·»åŠ configure/os/CONFIG_SITE.linux-x86_64.linux-loong64\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 # CONFIG_SITE.linux-x86_64.linux-loong64 # # Site specific definitions for linux-x86_64 host - linux-loong64 target builds #------------------------------------------------------- # Set GNU crosscompiler target name GNU_TARGET = loongarch64-linux-gnu # Set GNU tools install path # Examples is the installation at the APS: GNU_DIR = /opt/loongson-gnu-toolchain-8.3-x86_64-loongarch64-linux-gnu-rc1.2 # If cross-building shared libraries and the paths on the target machine are # different than on the build host, you should uncomment the lines below to # disable embedding compile-time library paths into the generated files. # You will need to provide another way for programs to find their shared # libraries at runtime, such as by setting LD_LIBRARY_PATH or (better) using # mechanisms related to /etc/ld.so.conf #SHRLIBDIR_RPATH_LDFLAGS_YES_NO = #PRODDIR_RPATH_LDFLAGS_YES_NO = # However it is usually simpler to set STATIC_BUILD=YES here and not # try to use shared libraries at all when cross-building, like this: #STATIC_BUILD=YES #SHARED_LIBRARIES=NO # To use libreadline, point this to its install prefix #READLINE_DIR = $(GNU_DIR) #READLINE_DIR = /tools/cross/linux-x86.linux-loong64/readline # See CONFIG_SITE.Common.linux-loong64 for other COMMANDLINE_LIBRARY values #COMMANDLINE_LIBRARY = READLINE GNU_DIRéœ€è¦æ”¹ä¸ºå®‰è£…äº¤å‰ç¼–è¯‘å·¥å…·é“¾çš„è·¯å¾„ã€‚\nSTATIC_BUILDå’ŒSHARED_LIBRARIESå¯ä»¥è®¾ç½®æ˜¯å¦ä¸ºéé™æ€ç¼–è¯‘ï¼Œå³æ˜¯å¦ç”ŸæˆåŠ¨æ€åº“.soï¼Œä¸¤ä¸ªè®¾ç½®é¡¹å¿…é¡»ä¸€èµ·ä¿®æ”¹ï¼Œè¿™é‡Œçš„è®¾ç½®ä¼šè¦†ç›–æ‰configure/CONFIG_SITEä¸­çš„è®¾ç½®ã€‚ç”±äºåŠ¨æ€åº“åœ¨ç¼–è¯‘ä¸€äº›å…¶ä»–å·¥å…·æ—¶è¿˜ä¼šç”¨åˆ°ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘é€‰æ‹©ç”ŸæˆåŠ¨æ€åº“ã€‚\nshell \u0026#9660; 1 2 # STATIC_BUILD=YES # SHARED_LIBRARIES=NO ç„¶åï¼Œéœ€è¦è®¾ç½®äº¤å‰ç¼–è¯‘çš„ç›®æ ‡æ¶æ„ã€‚\næ–°å¢configure/CONFIG_SITE.localï¼Œæˆ–è€…ç›´æ¥ä¿®æ”¹configure/CONFIG_SITEï¼ˆä¸æ¨èï¼‰ã€‚\nshell \u0026#9660; 1 CROSS_COMPILER_TARGET_ARCHS=linux-loong64 æœ€åï¼Œè¿›è¡Œç¼–è¯‘å³å¯ã€‚ï¼ˆç¡®ä¿æ„å»ºç³»ç»Ÿä¸Šæœ‰makeå’Œperlï¼Œåº”è¯¥éƒ½æœ‰å§ã€‚ï¼‰\nshell \u0026#9660; 1 2 3 # åˆ°æºç ç›®å½•ä¸‹ $ cd ~/loongson/base-7.0.8 $ make -j8 ç­‰å¾…ç¼–è¯‘å®Œæˆå³å¯ã€‚\nç¼–è¯‘å®Œæˆåï¼Œå¯ä»¥çœ‹åˆ°binå’Œlibç›®å½•ä¸‹ï¼Œéƒ½æœ‰linux-loong64ã€linux-x86_64ä¸¤ä¸ªç›®å½•ï¼Œå…¶ä¸­linux-loong64ç›®å½•ä¸‹å°±æ˜¯æˆ‘ä»¬è¦åœ¨å¼€å‘æ¿ä¸Šè¿è¡Œçš„EPICSå·¥å…·åŒ…äº†ã€‚linux-x86_64ç›®å½•ä¸‹çš„åˆ™æ˜¯ç¼–è¯‘ç”Ÿæˆçš„æœ¬æœºçš„EPICSå·¥å…·åŒ…ï¼Œå¾…ä¼šå„¿æˆ‘ä»¬è¿˜ä¼šç”¨åˆ°ã€‚\nç”±äºå¼€å‘æ¿çš„å­˜å‚¨ç©ºé—´å¾ˆå°ï¼Œåªæœ‰å‡ ç™¾å…†ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åªèƒ½å•ç‹¬å°†é¾™æ¶æ„çš„å†…å®¹ä¸‹è½½åˆ°æ¿å­ä¸Šã€‚\nç›®å½•å¦‚ä¸‹ï¼š\n\u0026#9660; base â”œâ”€ bin â”‚ â””â”€ linux-loong64 â”œâ”€ db â”œâ”€ dbd â”œâ”€ include (å¯é€‰) â””â”€ lib â””â”€ linux-loong64 å°†ç›®å½•ä¸­çš„å†…å®¹å…¨éƒ¨æ‰“åŒ…ä¸‹è½½åˆ°å¼€å‘æ¿å³å¯ã€‚\nshell \u0026#9660; 1 2 3 4 5 # åœ¨å¼€å‘æ¿ä¸Šè¿è¡Œ $ cd base/bin/linux-loong64 # è¿è¡Œè½¯IOCæµ‹è¯• $ ./softIoc epics\u0026gt; â€» å¦‚æœä½¿ç”¨éé™æ€ç¼–è¯‘ï¼ˆç”ŸæˆåŠ¨æ€åº“ï¼‰çš„æ–¹å¼ç¼–è¯‘ï¼Œè¿è¡Œæ—¶å¯èƒ½ä¼šæç¤ºæ‰¾ä¸åˆ°åŠ¨æ€åº“ã€‚éœ€è¦å°†åŠ¨æ€åº“æ·»åŠ åˆ°ç³»ç»Ÿçš„åŠ¨æ€åº“è·¯å¾„ã€‚\nå¦‚ä¸‹ï¼ˆæ ¹æ®å®é™…æƒ…å†µä¿®æ”¹è·¯å¾„ï¼‰ï¼š\nshell \u0026#9660; 1 $ export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/root/base/lib/linux-loong64 â€» include ç›®å½•ä¸æ˜¯EPICSè¿è¡Œå¿…éœ€çš„ï¼Œä½†å¦‚æœè¦åŸºäºEPICSè¿›è¡Œå¼€å‘ï¼Œå¯èƒ½éœ€è¦ç”¨åˆ°EPICSçš„å¤´æ–‡ä»¶ã€‚\nä¾‹å¦‚ï¼šäº¤å‰ç¼–è¯‘ ACAI\nç¼–è¯‘ IOC å‰é¢å·²ç»è®²äº†ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ„å»ºä¸»æœºä¸Šäº¤å‰ç¼–è¯‘IOCï¼Œå…·ä½“æ­¥éª¤å’Œç›´æ¥åˆ›å»ºç¼–è¯‘IOCåŸºæœ¬ä¸€æ ·ã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 $ cd ~ # åˆ›å»ºç›®å½• $ mkdir test $ cd test/ # æ›¿æ¢æˆè‡ªå·±ç¼–è¯‘EPICSçš„ç›®å½•ï¼Œæ³¨æ„æ˜¯ä½¿ç”¨linux-x86_64ç›®å½•ä¸‹çš„è„šæœ¬ $ ~/loongson/base-7.0.8/bin/linux-x86_64/makeBaseApp.pl -t example test $ ~/loongson/base-7.0.8/bin/linux-x86_64/makeBaseApp.pl -i -t example test The following target architectures are available in base: linux-loong64 linux-x86_64 What architecture do you want to use? linux-loong64 The following applications are available: test What application should the IOC(s) boot? The default uses the IOC\u0026#39;s name, even if not listed above. Application name? test è¿™é‡Œå”¯ä¸€å¤šçš„æ­¥éª¤å°±æ˜¯é€‰æ‹©ç›®æ ‡æ¶æ„ï¼Œè¾“å…¥linux-loong64å³å¯ã€‚\nç„¶åä¿®æ”¹ç¼–è¯‘è®¾ç½®ï¼Œè¿™é‡Œå°±ä¸ç”¨ç”ŸæˆåŠ¨æ€åº“äº†ï¼Œç›´æ¥ä½¿ç”¨é™æ€ç¼–è¯‘ã€‚\næ·»åŠ configure/CONFIG_SITE.localï¼Œå¯ç”¨é™æ€ç¼–è¯‘ã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 # Build shared libraries (DLLs on Windows). # Must be either YES or NO. Definitions in the target-specific # os/CONFIG.Common.\u0026lt;target\u0026gt; and os/CONFIG_SITE.Common.\u0026lt;target\u0026gt; files may # override this setting. On Windows only these combinations are valid: # SHARED_LIBRARIES = YES and STATIC_BUILD = NO # SHARED_LIBRARIES = NO and STATIC_BUILD = YES SHARED_LIBRARIES=NO # Build client objects statically. # Must be either YES or NO. STATIC_BUILD=YES æœ€åç¼–è¯‘ã€‚\nshell \u0026#9660; 1 2 $ cd ~/test $ make ç­‰å¾…ç¼–è¯‘å®Œæˆå³å¯ã€‚ç„¶åå°†ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸‹è½½åˆ°å¼€å‘æ¿ï¼Œè¿™é‡Œä¾æ—§æ˜¯åªä¸‹è½½è¿è¡ŒIOCæ‰€å¿…éœ€çš„å†…å®¹ã€‚\nç›®å½•å¦‚ä¸‹ï¼š\n\u0026#9660; test â”œâ”€ bin â”‚ â””â”€ linux-loong64 â”œâ”€ db â”œâ”€ dbd â””â”€ iocBoot â””â”€ ioctest åœ¨æŠŠIOCå¤åˆ¶åˆ°å¼€å‘æ¿ä¸Šä¹‹åï¼Œè¿˜éœ€è¦æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹IOCè¿è¡Œçš„ç¯å¢ƒå˜é‡ã€‚\nä¿®æ”¹iocBoot/ioctest/envPaths\nshell \u0026#9660; 1 2 3 4 epicsEnvSet(\u0026#34;IOC\u0026#34;,\u0026#34;ioctest\u0026#34;) epicsEnvSet(\u0026#34;TOP\u0026#34;,\u0026#34;/root/test\u0026#34;) epicsEnvSet(\u0026#34;EPICS_BASE\u0026#34;,\u0026#34;/root/base\u0026#34;) epicsEnvSet(\u0026#34;EPICS_HOST_ARCH\u0026#34;,\u0026#34;linux-loong64\u0026#34;) æœ€ååœ¨å¼€å‘æ¿ä¸Šè¿è¡ŒIOCã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 # åœ¨å¼€å‘æ¿ä¸Šè¿è¡Œ $ cd ~/test/iocBoot/ioctest # æ·»åŠ å¯æ‰§è¡Œæƒé™ $ chmod +x st.cmd $ ./st.cmd #!../../bin/linux-loong64/test \u0026lt; envPaths epicsEnvSet(\u0026#34;IOC\u0026#34;,\u0026#34;ioctest\u0026#34;) epicsEnvSet(\u0026#34;TOP\u0026#34;,\u0026#34;/root/test\u0026#34;) epicsEnvSet(\u0026#34;EPICS_BASE\u0026#34;,\u0026#34;/root/base\u0026#34;) epicsEnvSet(\u0026#34;EPICS_HOST_ARCH\u0026#34;,\u0026#34;linux-loong64\u0026#34;) cd \u0026#34;/root/test\u0026#34; ## Register all support components dbLoadDatabase \u0026#34;dbd/test.dbd\u0026#34; test_registerRecordDeviceDriver pdbbase Warning: IOC is booting with TOP = \u0026#34;/root/test\u0026#34; but was built with TOP = \u0026#34;/home/ubuntu/test\u0026#34; ## Load record instances dbLoadTemplate \u0026#34;db/user.substitutions\u0026#34; dbLoadRecords \u0026#34;db/testVersion.db\u0026#34;, \u0026#34;user=lsgd\u0026#34; dbLoadRecords \u0026#34;db/dbSubExample.db\u0026#34;, \u0026#34;user=lsgd\u0026#34; cd \u0026#34;/root/test/iocBoot/ioctest\u0026#34; iocInit Starting iocInit ############################################################################ ## EPICS R7.0.8 ## Rev. 2023-12-30T14:06+0800 ## Rev. Date build date/time: ############################################################################ iocRun: All initialization complete ## Start any sequence programs #seq sncExample, \u0026#34;user=lsgd\u0026#34; epics\u0026gt; è¿™é‡Œå¯ä»¥çœ‹åˆ°å¯åŠ¨æ—¶ä¼šæœ‰ä¸€ä¸ªWarningï¼Œè­¦å‘ŠIOCè¿è¡Œæ—¶å’Œç¼–è¯‘æ—¶çš„TOPè·¯å¾„ä¸ä¸€è‡´ï¼Œä½†å®é™…ä¸Šå¹¶ä¸å½±å“IOCè¿è¡Œï¼Œå¿½ç•¥å³å¯ã€‚\næ­¤æ—¶å¯ä»¥ä½¿ç”¨dblã€dbprç­‰å‘½ä»¤æŸ¥çœ‹å˜é‡ã€‚æˆ–è€…åœ¨å…¶ä»–ç»ˆç«¯è¿è¡Œcamonitorç¨‹åºã€‚\n","permalink":"https://kira-96.github.io/posts/%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91epics%E5%92%8Cioc/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eä¹‹å‰å·²ç»è®²è¿‡\u003ca href=\"../%E9%BE%99%E8%8A%AF3a5000loongarch64%E4%B8%8A%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8Cepics/\"\u003eåœ¨é¾™èŠ¯3A5000(loongarch64)ä¸Šç¼–è¯‘è¿è¡ŒEPICS\u003c/a\u003eï¼Œä¸è¿‡è¿™ç§æƒ…å†µåªé€‚ç”¨äºæœ‰å®Œæ•´å¼€å‘ç¯å¢ƒçš„æƒ…å†µä¸‹è¿›è¡Œç¼–è¯‘ã€‚ä¸€äº›æ—¶å€™ï¼Œæˆ‘ä»¬åªæœ‰ç¼–è¯‘å™¨ï¼Œè€Œç¼ºå°‘makeï¼Œperlç­‰å·¥å…·ï¼Œæ¯”å¦‚ä¸€äº›å¼€å‘æ¿å‚å•†æä¾›çš„å¼€å‘å¥—ä»¶ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå°±éœ€è¦é€šè¿‡äº¤å‰ç¼–è¯‘(cross-compiling)çš„æ–¹å¼æ¥ç¼–è¯‘EPICSã€‚\u003c/p\u003e\n\u003cp\u003eè¿™é‡Œä»¥\u003cstrong\u003eé¾™èŠ¯é‡‘é¾™2K500å…ˆé”‹å¼€å‘æ¿\u003c/strong\u003eä¸ºä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨Ubuntu-20.04ä½œä¸ºæ„å»ºç³»ç»Ÿï¼Œè¯¦ç»†è®²è§£å¦‚ä½•æ„å»ºå‡ºå¯ä»¥åœ¨å¼€å‘æ¿ä¸Šè¿è¡Œçš„EPICSå·¥å…·åŒ…ï¼Œå¹¶éƒ¨ç½²åœ¨å¼€å‘æ¿ä¸Šã€‚\u003c/p\u003e\n\u003cp\u003eç”±äºå¼€å‘æ¿ä¸Šæ²¡æœ‰å¼€å‘ç¯å¢ƒï¼Œå³ä½¿ç¼–è¯‘å‡ºç›®æ ‡å¹³å°çš„EPICS Baseï¼Œæˆ‘ä»¬ä¾ç„¶ä¸èƒ½ç›´æ¥åœ¨å¼€å‘æ¿ä¸Šåˆ›å»ºå’Œç¼–è¯‘IOCã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨Ubuntu-20.04ä½œä¸ºæ„å»ºç³»ç»Ÿï¼Œåˆ›å»ºå¹¶ç¼–è¯‘IOCï¼Œæœ€ååœ¨å¼€å‘æ¿ä¸Šè¿è¡Œã€‚\u003c/p\u003e\n\u003ch2 id=\"é…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ\"\u003eé…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ\u003c/h2\u003e\n\u003cp\u003eå…³äºè¿™ä¸€èŠ‚ï¼Œä¹‹å‰çš„æ–‡ç« å·²ç»è¯¦ç»†è®²è¿‡ï¼Œå‚è€ƒ\u003ca href=\"../%E9%BE%99%E8%8A%AF2k500%E5%BC%80%E5%8F%91%E6%9D%BF%E4%B8%8A%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%91%BC%E5%90%B8%E7%81%AF%E6%95%88%E6%9E%9C/#%E9%85%8D%E7%BD%AE%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E7%8E%AF%E5%A2%83\"\u003eé…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ\u003c/a\u003eã€‚\u003c/p\u003e\n\u003cp\u003eå¦‚æœä½ ä½¿ç”¨çš„æ˜¯å…¶ä»–å¼€å‘å¥—ä»¶ï¼Œè¯·æŒ‰ç…§å¼€å‘æ‰‹å†Œå®‰è£…é…ç½®å¥½ç¯å¢ƒã€‚\u003c/p\u003e\n\u003ch2 id=\"ç¼–è¯‘-epics-base\"\u003eç¼–è¯‘ EPICS Base\u003c/h2\u003e\n\u003cp\u003eé¦–å…ˆï¼Œä¸‹è½½ã€è§£å‹Baseï¼Œå‚è€ƒ\u003ca href=\"../%E9%BE%99%E8%8A%AF3a5000loongarch64%E4%B8%8A%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8Cepics/\"\u003eä»¥å‰çš„æ–‡ç« \u003c/a\u003eã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨\u003ca href=\"../%E9%BE%99%E8%8A%AF3a5000loongarch64%E4%B8%8A%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8Cepics/\"\u003eé¾™èŠ¯3A5000(loongarch64)ä¸Šç¼–è¯‘è¿è¡ŒEPICS\u003c/a\u003eä¸­æˆ‘å·²ç»è¯¦ç»†è®²è§£äº†å¦‚ä½•åœ¨é¾™æ¶æ„ä¸Šç¼–è¯‘EPICSï¼Œè¿™æ¬¡ï¼Œéœ€è¦åœ¨åŸæ¥å¯¹æºç ä¿®æ”¹çš„åŸºç¡€ä¸Šï¼Œå†å¢åŠ å¯¹äº¤å‰ç¼–è¯‘çš„æ”¯æŒã€‚\u003c/p\u003e\n\u003cp\u003eæ·»åŠ \u003ccode\u003econfigure/os/CONFIG.linux-x86_64.linux-loong64\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# CONFIG.linux-x86_64.linux-loong64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Definitions for linux-x86_64 host - linux-loong64 target builds\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Sites may override these in CONFIG_SITE.linux-x86_64.linux-loong64\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#-------------------------------------------------------\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eVALID_BUILDS\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e Ioc Command\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eGNU_TARGET\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e loongarch64-linux-gnu\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# prefix of compiler tools\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eCMPLR_SUFFIX\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eCMPLR_PREFIX\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eaddsuffix -,\u003cspan class=\"k\"\u003e$(\u003c/span\u003eGNU_TARGET\u003cspan class=\"k\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Provide a link-time path for readline if needed\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eOP_SYS_INCLUDES\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eREADLINE_DIR:%\u003cspan class=\"o\"\u003e=\u003c/span\u003e-I%/include\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eREADLINE_LDFLAGS\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eREADLINE_DIR:%\u003cspan class=\"o\"\u003e=\u003c/span\u003e-L%/lib\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eRUNTIME_LDFLAGS_READLINE_YES_NO\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eREADLINE_DIR:%\u003cspan class=\"o\"\u003e=\u003c/span\u003e-Wl,-rpath,%/lib\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eRUNTIME_LDFLAGS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003e$(\u003c/span\u003eRUNTIME_LDFLAGS_READLINE_\u003cspan class=\"k\"\u003e$(\u003c/span\u003eLINKER_USE_RPATH\u003cspan class=\"k\"\u003e)\u003c/span\u003e_\u003cspan class=\"k\"\u003e$(\u003c/span\u003eSTATIC_BUILD\u003cspan class=\"k\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSHRLIBDIR_LDFLAGS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eREADLINE_LDFLAGS\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003ePRODDIR_LDFLAGS\u003c/span\u003e \u003cspan class=\"o\"\u003e+=\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003eREADLINE_LDFLAGS\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Library flags\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSTATIC_LDFLAGS_YES\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e -Wl,-Bstatic\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSTATIC_LDFLAGS_NO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSTATIC_LDLIBS_YES\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e -Wl,-Bdynamic\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSTATIC_LDLIBS_NO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eæ·»åŠ \u003ccode\u003econfigure/os/CONFIG_SITE.linux-x86_64.linux-loong64\u003c/code\u003e\u003c/p\u003e","title":"äº¤å‰ç¼–è¯‘EPICSå’ŒIOC"},{"content":"éœ€è¦ä½¿ç”¨çš„è½¯ä»¶ Strawberry Perl for Windows EPICS Base ç¼–è¯‘Baseéœ€è¦æœ‰gccã€g++ã€makeã€perlè¿™äº›å·¥å…·ï¼Œä½†å…¶å®æˆ‘ä»¬åªéœ€è¦å®‰è£…Strawberry Perlå°±å¯ä»¥äº†ï¼Œå®‰è£…å®Œæˆåå°±æœ‰äº†MinGWçš„ç¼–è¯‘ç¯å¢ƒï¼Œè¶³å¤Ÿç¼–è¯‘å®‰è£…EPICSäº†ã€‚\nè¿™é‡Œä½¿ç”¨MinGWç¯å¢ƒç¼–è¯‘EPICSï¼Œä¸ä½¿ç”¨MSVCç¼–è¯‘å™¨ã€‚\nå®‰è£… Strawberry Perl è¿™é‡Œé€‰æ‹© Strawberry Perl 5.38.2.1ã€‚\nç›´æ¥å®‰è£…å³å¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®‰è£…è·¯å¾„ä¸èƒ½æœ‰ç©ºæ ¼å’Œä¸­æ–‡ï¼Œæœ€å¥½æ”¾åœ¨ç›˜ç¬¦çš„æ ¹ç›®å½•ä¸‹ã€‚\nä¾‹ï¼šD:\\Strawberry\nå®‰è£…å®Œæˆåæ£€æŸ¥ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼ŒæŸ¥çœ‹ç³»ç»ŸPathç¯å¢ƒå˜é‡æ˜¯å¦æœ‰Strawberry Perlçš„è·¯å¾„ã€‚æ²¡æœ‰åˆ™æ‰‹åŠ¨æ·»åŠ ï¼Œä»¥å®‰è£…åœ¨Dç›˜ä¸ºä¾‹ã€‚\nshell \u0026#9660; 1 2 3 D:\\Strawberry\\c\\bin D:\\Strawberry\\perl\\site\\bin D:\\Strawberry\\perl\\bin å…¶ä¸­D:\\Strawberry\\c\\binå°±æ˜¯MinGWç¯å¢ƒçš„è·¯å¾„ã€‚\næŸ¥çœ‹Perlç‰ˆæœ¬ï¼Œæ£€æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯è£…å¥½äº†ã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt; perl -v This is perl 5, version 38, subversion 2 (v5.38.2) built for MSWin32-x64-multi-thread Copyright 1987-2023, Larry Wall Perl may be copied only under the terms of either the Artistic License or the GNU General Public License, which may be found in the Perl 5 source kit. Complete documentation for Perl, including FAQ lists, should be found on this system using \u0026#34;man perl\u0026#34; or \u0026#34;perldoc perl\u0026#34;. If you have access to the Internet, point your browser at https://www.perl.org/, the Perl Home Page. æ³¨æ„ï¼šperl 5.32.1.1 ä¹‹åçš„ç‰ˆæœ¬å¯èƒ½ä¼šæç¤º\nLocale \u0026lsquo;Chinese (Simplified)_China.936\u0026rsquo; is unsupported, and may crash the interpreter.\néœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡LC_ALL=Cã€‚\nç¼–è¯‘å®‰è£…EPICS Base ä¿®æ”¹baseæºç ç›®å½•ä¸‹çš„startup/windows.batæ–‡ä»¶ã€‚\nbat \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 rem The location of Strawberry Perl (pathname). If empty, Strawberry Perl rem is assumed to already be in PATH and will not be added. If nonempty, rem Strawberry Perl will be added to PATH. rem è®¾ç½®Strawberry Perlå®‰è£…è·¯å¾„ set _strawberry_perl_home=D:\\Strawberry rem The EPICS host architecture specification for EPICS_HOST_ARCH rem (\u0026lt;os\u0026gt;-\u0026lt;arch\u0026gt;[-\u0026lt;toolset\u0026gt;] as defined in configure/CONFIG_SITE). rem è®¾ç½®ç¼–è¯‘ä¸»æœºæ¶æ„ï¼Œè¿™é‡Œä½¿ç”¨mingw set _epics_host_arch=windows-x64-mingw rem The install location of EPICS Base (pathname). If nonempty and rem _auto_path_append is yes, it will be used to add the host architecture rem bin directory to PATH. set _epics_base=C:\\EPICS\\base-7.0.8 rem Set the environment for Microsoft Visual Studio rem ä½¿ç”¨ rem æ³¨é‡Šæ‰ä¸‹é¢ä¸€è¡Œ rem call \u0026#34;%_visual_studio_home%\\VC\\Auxiliary\\Build\\vcvarsall.bat\u0026#34; x64 æ³¨æ„ï¼Œç¼–è¯‘éœ€è¦ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·cmdï¼Œä¸èƒ½ç”¨powershellã€‚\næ³¨æ„ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ perl è‡ªå¸¦çš„ç¼–è¯‘å·¥å…·ï¼Œå¦‚æœè¦ä½¿ç”¨å…¶ä»–ç‰ˆæœ¬çš„MinGWï¼Œåˆ™éœ€è¦è‡ªè¡Œé…ç½®ç¯å¢ƒå˜é‡ã€‚\næ¯”å¦‚è¿™é‡Œä½¿ç”¨ MinGW 12.2.0ï¼Œåˆ™éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡ã€‚\nbat \u0026#9660; 1 set Path=C:\\WINDOWS;C:\\WINDOWS\\System32;C:\\WINDOWS\\System32\\Wbem;D:\\Strawberry\\perl\\bin;D:\\Tools\\mingw1220_64\\bin;D:\\Tools\\mingw1220_64\\libexec\\gcc\\x86_64-w64-mingw32\\12.2.0 bat \u0026#9660; 1 2 3 4 5 6 7 cd base-7.0.8 .\\startup\\windows.bat # æ ¹æ®ä½¿ç”¨çš„ç¼–è¯‘å·¥å…·æ‰§è¡Œå‘½ä»¤ # perl ç¯å¢ƒçš„makeå‘½åä¸ºgmake gmake -j16 # mingw32-make -j16 ç­‰å¾…ç¼–è¯‘å®Œæˆã€‚\nç¼–è¯‘å®Œæˆåçš„å·¥å…·åœ¨bin\\windows-x64-mingwç›®å½•ä¸‹ã€‚\næµ‹è¯•ä½¿ç”¨ï¼š\nbat \u0026#9660; 1 2 3 cd bin\\windows-x64-mingw softIoc.exe epics\u0026gt; ","permalink":"https://kira-96.github.io/notes/windows%E4%B8%8A%E4%BD%BF%E7%94%A8mingw%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85epics/","summary":"\u003ch2 id=\"éœ€è¦ä½¿ç”¨çš„è½¯ä»¶\"\u003eéœ€è¦ä½¿ç”¨çš„è½¯ä»¶\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://strawberryperl.com/\"\u003eStrawberry Perl for Windows\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://epics.anl.gov/base/index.php\"\u003eEPICS Base\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eç¼–è¯‘Baseéœ€è¦æœ‰gccã€g++ã€makeã€perlè¿™äº›å·¥å…·ï¼Œä½†å…¶å®æˆ‘ä»¬åªéœ€è¦å®‰è£…\u003ccode\u003eStrawberry Perl\u003c/code\u003eå°±å¯ä»¥äº†ï¼Œå®‰è£…å®Œæˆåå°±æœ‰äº†\u003ccode\u003eMinGW\u003c/code\u003eçš„ç¼–è¯‘ç¯å¢ƒï¼Œè¶³å¤Ÿç¼–è¯‘å®‰è£…EPICSäº†ã€‚\u003c/p\u003e\n\u003cp\u003eè¿™é‡Œä½¿ç”¨MinGWç¯å¢ƒç¼–è¯‘EPICSï¼Œä¸ä½¿ç”¨MSVCç¼–è¯‘å™¨ã€‚\u003c/p\u003e\n\u003ch2 id=\"å®‰è£…-strawberry-perl\"\u003eå®‰è£… Strawberry Perl\u003c/h2\u003e\n\u003cp\u003eè¿™é‡Œé€‰æ‹© \u003ca href=\"https://strawberryperl.com/release-notes/5.38.2.1-64bit.html\"\u003eStrawberry Perl 5.38.2.1\u003c/a\u003eã€‚\u003c/p\u003e\n\u003cp\u003eç›´æ¥å®‰è£…å³å¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®‰è£…è·¯å¾„ä¸èƒ½æœ‰ç©ºæ ¼å’Œä¸­æ–‡ï¼Œæœ€å¥½æ”¾åœ¨ç›˜ç¬¦çš„æ ¹ç›®å½•ä¸‹ã€‚\u003cbr\u003e\nä¾‹ï¼š\u003ccode\u003eD:\\Strawberry\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eå®‰è£…å®Œæˆåæ£€æŸ¥\u003cstrong\u003eç³»ç»Ÿç¯å¢ƒå˜é‡\u003c/strong\u003eï¼ŒæŸ¥çœ‹ç³»ç»Ÿ\u003ccode\u003ePath\u003c/code\u003eç¯å¢ƒå˜é‡æ˜¯å¦æœ‰\u003ccode\u003eStrawberry Perl\u003c/code\u003eçš„è·¯å¾„ã€‚æ²¡æœ‰åˆ™æ‰‹åŠ¨æ·»åŠ ï¼Œä»¥å®‰è£…åœ¨Dç›˜ä¸ºä¾‹ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD:\u003cspan class=\"se\"\u003e\\S\u003c/span\u003etrawberry\u003cspan class=\"se\"\u003e\\c\\b\u003c/span\u003ein\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD:\u003cspan class=\"se\"\u003e\\S\u003c/span\u003etrawberry\u003cspan class=\"se\"\u003e\\p\u003c/span\u003eerl\u003cspan class=\"se\"\u003e\\s\u003c/span\u003eite\u003cspan class=\"se\"\u003e\\b\u003c/span\u003ein\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eD:\u003cspan class=\"se\"\u003e\\S\u003c/span\u003etrawberry\u003cspan class=\"se\"\u003e\\p\u003c/span\u003eerl\u003cspan class=\"se\"\u003e\\b\u003c/span\u003ein\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eå…¶ä¸­\u003ccode\u003eD:\\Strawberry\\c\\bin\u003c/code\u003eå°±æ˜¯MinGWç¯å¢ƒçš„è·¯å¾„ã€‚\u003c/p\u003e\n\u003cp\u003eæŸ¥çœ‹\u003ccode\u003ePerl\u003c/code\u003eç‰ˆæœ¬ï¼Œæ£€æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯è£…å¥½äº†ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026gt; perl -v\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eThis is perl 5, version 38, subversion \u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003ev5.38.2\u003cspan class=\"o\"\u003e)\u003c/span\u003e built \u003cspan class=\"k\"\u003efor\u003c/span\u003e MSWin32-x64-multi-thread\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCopyright 1987-2023, Larry Wall\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePerl may be copied only under the terms of either the Artistic License or the\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGNU General Public License, which may be found in the Perl \u003cspan class=\"m\"\u003e5\u003c/span\u003e \u003cspan class=\"nb\"\u003esource\u003c/span\u003e kit.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eComplete documentation \u003cspan class=\"k\"\u003efor\u003c/span\u003e Perl, including FAQ lists, should be found on\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ethis system using \u003cspan class=\"s2\"\u003e\u0026#34;man perl\u0026#34;\u003c/span\u003e or \u003cspan class=\"s2\"\u003e\u0026#34;perldoc perl\u0026#34;\u003c/span\u003e.  If you have access to the\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eInternet, point your browser at https://www.perl.org/, the Perl Home Page.\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eæ³¨æ„ï¼šperl 5.32.1.1 ä¹‹åçš„ç‰ˆæœ¬å¯èƒ½ä¼šæç¤º\u003c/p\u003e","title":"Windowsä¸Šä½¿ç”¨MinGWç¼–è¯‘å®‰è£…EPICS"},{"content":"å‰è¨€ Linux å†…æ ¸æä¾›äº†ä¸°å¯Œçš„è®¾å¤‡é©±åŠ¨æ¥å£ï¼Œå…¶ä¸­GPIOå’ŒLEDå±äºæ˜¯æœ€åŸºæœ¬çš„ä¸€ç±»äº†ã€‚ä¹‹å‰å°±å·²ç»è®²è¿‡ç”¨æˆ·ç©ºé—´ä¸‹çš„GPIOè¯»å†™æ“ä½œï¼ŒLEDè®¾å¤‡çš„æ“ä½œä¹ŸåŸºæœ¬ç›¸åŒã€‚å…¶å®å®Œå…¨å¯ä»¥ä½¿ç”¨GPIOé©±åŠ¨å»æ§åˆ¶LEDï¼Œä½†LEDçš„é©±åŠ¨é’ˆå¯¹LEDæä¾›äº†æ›´å¤šçš„åŠŸèƒ½ï¼Œä¸€èµ·æ¥çœ‹ä¸€ä¸‹å§ã€‚\né…ç½®è®¾å¤‡æ ‘ è®¾å¤‡æ ‘ä¸­çš„LEDèŠ‚ç‚¹é…ç½®ï¼Œä¾‹ï¼š\nc \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 /* kernel/arch/arm/boot/dts/imx6ul-14x14-evk-c-emmc.dts */ leds { compatible = \u0026#34;gpio-leds\u0026#34;; pinctrl-names = \u0026#34;default\u0026#34;; status = \u0026#34;okay\u0026#34;; led1{ label = \u0026#34;led1\u0026#34;; gpios = \u0026lt;\u0026amp;gpio5 9 GPIO_ACTIVE_LOW\u0026gt;; default-state = \u0026#34;off\u0026#34;; }; led2{ label = \u0026#34;led2\u0026#34;; gpios = \u0026lt;\u0026amp;gpio1 9 GPIO_ACTIVE_LOW\u0026gt;; default-state = \u0026#34;off\u0026#34;; }; led3{ label = \u0026#34;heartbeat\u0026#34;; gpios = \u0026lt;\u0026amp;gpio5 5 GPIO_ACTIVE_LOW\u0026gt;; linux,default-trigger = \u0026#34;heartbeat\u0026#34;; }; }; èŠ‚ç‚¹å±æ€§è¯´æ˜ï¼š\nlabelï¼šLEDè®¾å¤‡çš„åå­—ï¼Œåå­—å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™ä¼šä½¿ç”¨èŠ‚ç‚¹çš„åå­—ã€‚\ngpiosï¼šGPIOçš„ç¼–å·ï¼Œä»¥åŠé«˜ä½ç”µå¹³è®¾ç½®ï¼ŒGPIO_ACTIVE_LOWä½ç”µå¹³ç‚¹äº®ï¼ŒGPIO_ACTIVE_HIGHé«˜ç”µå¹³ç‚¹äº®ã€‚\ndefault-stateï¼šé»˜è®¤çŠ¶æ€ï¼Œon/offã€‚\nlinux,default-triggerï¼šè®¾ç½®LEDçš„è§¦å‘å™¨ã€‚backlight-èƒŒå…‰ç¯ï¼Œheartbeat-å¿ƒè·³ç¯ï¼Œtimer-å®šæ—¶ï¼Œdefault-on-é»˜è®¤å¼€çŠ¶æ€ï¼Œdisk-activity-ç¡¬ç›˜çŠ¶æ€ï¼Œgpioï¼Œnoneã€‚\nç”¨æˆ·ç©ºé—´ä¸‹çš„LEDæ“ä½œ æ³¨æ„ï¼šä»¥ä¸‹æ“ä½œéƒ½éœ€è¦rootæƒé™ï¼\nç”¨æˆ·ç©ºé—´ä¸‹çš„GPIOæ–‡ä»¶ç³»ç»Ÿæ¥å£åœ¨/sys/class/leds/{label}ç›®å½•ä¸‹ã€‚\nLEDèŠ‚ç‚¹æœ‰ä»¥ä¸‹å±æ€§å¯ä»¥é…ç½®ï¼š\ntrigger\nè®¾ç½®LEDçš„è§¦å‘å™¨ã€‚\nsh \u0026#9660; 1 echo heartbeat \u0026gt; /sys/class/leds/led1/trigger brightness\nè®¾ç½®LEDçš„å¼€å…³æˆ–è€…äº®åº¦ã€‚\nsh \u0026#9660; 1 2 3 4 # å…³é—­LED echo 0 \u0026gt; /sys/class/leds/led1/brightness # æ‰“å¼€LED echo 1 \u0026gt; /sys/class/leds/led1/brightness å¯¹äºå†™å…¥çš„ä»»ä½•é0å€¼ï¼Œéƒ½ä¼šæ˜¯æ‰“å¼€LEDçš„æ“ä½œï¼Œå¯å†™å…¥å€¼èŒƒå›´ä¸º0~255ã€‚\nè€Œå¯¹äºä½¿ç”¨PWMæ§åˆ¶çš„LEDç¯ï¼Œbrightnessæ‰å¯ä»¥æ§åˆ¶ç¯çš„äº®åº¦ã€‚å‚è€ƒå‘¼å¸ç¯çš„å®ç°ã€‚\nç¨‹åºæ§åˆ¶LEDç¯ ç¤ºä¾‹è¯»å–ï¼š\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 quint8 readLed(const QString \u0026amp;led) { QFile file(QString(\u0026#34;/sys/class/leds/%1/brightness\u0026#34;).arg(led)); if (!file.open(QIODevice::ReadOnly)) return 0; QByteArray ba = file.readAll(); file.close(); return (quint8)QString(ba).toInt(); } ç¤ºä¾‹å†™å…¥ï¼š\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 bool writeLed(const QString \u0026amp;led, quint8 value) { QFile file(QString(\u0026#34;/sys/class/leds/%1/brightness\u0026#34;).arg(led)); if (!file.open(QIODevice::WriteOnly)) return false; QByteArray ba = QString::number(value).toLatin1(); return file.write(ba) == ba.size(); } å‚è€ƒ\nDocumentation/devicetree/bindings/leds/common.txt (v4.13) LEDå­ç³»ç»Ÿè¯¦è§£ ","permalink":"https://kira-96.github.io/posts/linux-led%E5%AD%90%E7%B3%BB%E7%BB%9F/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eLinux å†…æ ¸æä¾›äº†ä¸°å¯Œçš„è®¾å¤‡é©±åŠ¨æ¥å£ï¼Œå…¶ä¸­GPIOå’ŒLEDå±äºæ˜¯æœ€åŸºæœ¬çš„ä¸€ç±»äº†ã€‚ä¹‹å‰å°±å·²ç»è®²è¿‡\u003ca href=\"../linux-gpio%E6%93%8D%E4%BD%9C%E5%85%B6%E4%B8%80/#%E7%94%A8%E6%88%B7%E7%A9%BA%E9%97%B4%E4%B8%8B%E7%9A%84gpio%E8%AF%BB%E5%86%99%E6%93%8D%E4%BD%9C\"\u003eç”¨æˆ·ç©ºé—´ä¸‹çš„GPIOè¯»å†™æ“ä½œ\u003c/a\u003eï¼ŒLEDè®¾å¤‡çš„æ“ä½œä¹ŸåŸºæœ¬ç›¸åŒã€‚å…¶å®å®Œå…¨å¯ä»¥ä½¿ç”¨GPIOé©±åŠ¨å»æ§åˆ¶LEDï¼Œä½†LEDçš„é©±åŠ¨é’ˆå¯¹LEDæä¾›äº†æ›´å¤šçš„åŠŸèƒ½ï¼Œä¸€èµ·æ¥çœ‹ä¸€ä¸‹å§ã€‚\u003c/p\u003e\n\u003ch2 id=\"é…ç½®è®¾å¤‡æ ‘\"\u003eé…ç½®è®¾å¤‡æ ‘\u003c/h2\u003e\n\u003cp\u003eè®¾å¤‡æ ‘ä¸­çš„LEDèŠ‚ç‚¹é…ç½®ï¼Œä¾‹ï¼š\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"c\"\u003ec\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-c\" data-lang=\"c\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e/* kernel/arch/arm/boot/dts/imx6ul-14x14-evk-c-emmc.dts */\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eleds\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003ecompatible\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;gpio-leds\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003epinctrl\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003enames\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;default\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003estatus\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;okay\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eled1\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"n\"\u003elabel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;led1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"n\"\u003egpios\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003egpio5\u003c/span\u003e \u003cspan class=\"mi\"\u003e9\u003c/span\u003e \u003cspan class=\"n\"\u003eGPIO_ACTIVE_LOW\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003estate\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;off\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eled2\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"n\"\u003elabel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;led2\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"n\"\u003egpios\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003egpio1\u003c/span\u003e \u003cspan class=\"mi\"\u003e9\u003c/span\u003e \u003cspan class=\"n\"\u003eGPIO_ACTIVE_LOW\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003estate\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;off\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eled3\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"n\"\u003elabel\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;heartbeat\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"n\"\u003egpios\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003egpio5\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e \u003cspan class=\"n\"\u003eGPIO_ACTIVE_LOW\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"n\"\u003elinux\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003etrigger\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;heartbeat\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eèŠ‚ç‚¹å±æ€§è¯´æ˜ï¼š\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003elabel\u003c/code\u003eï¼šLEDè®¾å¤‡çš„åå­—ï¼Œåå­—å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™ä¼šä½¿ç”¨èŠ‚ç‚¹çš„åå­—ã€‚\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003egpios\u003c/code\u003eï¼šGPIOçš„ç¼–å·ï¼Œä»¥åŠé«˜ä½ç”µå¹³è®¾ç½®ï¼Œ\u003ccode\u003eGPIO_ACTIVE_LOW\u003c/code\u003eä½ç”µå¹³ç‚¹äº®ï¼Œ\u003ccode\u003eGPIO_ACTIVE_HIGH\u003c/code\u003eé«˜ç”µå¹³ç‚¹äº®ã€‚\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003edefault-state\u003c/code\u003eï¼šé»˜è®¤çŠ¶æ€ï¼Œ\u003ccode\u003eon/off\u003c/code\u003eã€‚\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003elinux,default-trigger\u003c/code\u003eï¼šè®¾ç½®LEDçš„è§¦å‘å™¨ã€‚\u003ccode\u003ebacklight\u003c/code\u003e-èƒŒå…‰ç¯ï¼Œ\u003ccode\u003eheartbeat\u003c/code\u003e-å¿ƒè·³ç¯ï¼Œ\u003ccode\u003etimer\u003c/code\u003e-å®šæ—¶ï¼Œ\u003ccode\u003edefault-on\u003c/code\u003e-é»˜è®¤å¼€çŠ¶æ€ï¼Œ\u003ccode\u003edisk-activity\u003c/code\u003e-ç¡¬ç›˜çŠ¶æ€ï¼Œ\u003ccode\u003egpio\u003c/code\u003eï¼Œ\u003ccode\u003enone\u003c/code\u003eã€‚\u003c/p\u003e\n\u003ch2 id=\"ç”¨æˆ·ç©ºé—´ä¸‹çš„ledæ“ä½œ\"\u003eç”¨æˆ·ç©ºé—´ä¸‹çš„LEDæ“ä½œ\u003c/h2\u003e\n\n\n\n\u003cblockquote\u003e\n    \u003cp\u003eæ³¨æ„ï¼šä»¥ä¸‹æ“ä½œéƒ½éœ€è¦rootæƒé™ï¼\u003c/p\u003e\n\n\u003c/blockquote\u003e\n\n\u003cp\u003eç”¨æˆ·ç©ºé—´ä¸‹çš„GPIOæ–‡ä»¶ç³»ç»Ÿæ¥å£åœ¨\u003ccode\u003e/sys/class/leds/{label}\u003c/code\u003eç›®å½•ä¸‹ã€‚\u003c/p\u003e\n\u003cp\u003eLEDèŠ‚ç‚¹æœ‰ä»¥ä¸‹å±æ€§å¯ä»¥é…ç½®ï¼š\u003c/p\u003e","title":"Linux LEDå­ç³»ç»Ÿ"},{"content":"å‰è¨€ æœ¬æ–‡ä¸»è¦è®°å½•äº†EPICS Qtåœ¨Linuxä¸Šçš„å®‰è£…æ­¥éª¤ã€‚è¿™é‡Œä»¥loongnixæ“ä½œç³»ç»Ÿä¸ºä¾‹ï¼ŒUbuntuç³»ç»Ÿä¸Šç¼–è¯‘å®‰è£…æ­¥éª¤ç±»ä¼¼ã€‚\nEPICS Qtæ˜¯ä¸€ä¸ªåŸºäºQtçš„åˆ†å±‚æ¡†æ¶ï¼Œä½¿ç”¨Channel Access ï¼ˆCAï¼‰ and PV Accessï¼ˆPVAï¼‰è®¿é—®EPICSæ•°æ®ã€‚å®ƒæ˜¯ä¸ºå¿«é€Ÿå¼€å‘æ§åˆ¶ç³»ç»Ÿå›¾å½¢ç•Œé¢è€Œè®¾è®¡çš„ï¼Œæœ€åˆæ˜¯åœ¨æ¾³å¤§åˆ©äºšåŒæ­¥åŠ é€Ÿå™¨å¼€å‘çš„ã€‚\nå®‰è£…EPICS è¿™é‡Œä¸å†å†™å…·ä½“æ­¥éª¤äº†ï¼Œæ€»ä¹‹å°±æ˜¯éå¸¸ç®€å•ï¼Œä¸‹è½½ã€è§£å‹ã€ç¼–è¯‘å³å¯ã€‚å…·ä½“æ­¥éª¤å¯ä»¥å‚è€ƒä»¥å‰çš„æ–‡ç« ã€‚\nå®‰è£…Qt ç›´æ¥ä½¿ç”¨ç»ˆç«¯å®‰è£…Qt\nsh \u0026#9660; 1 2 3 4 5 sudo apt update sudo apt install qtbase5-dev qt5-qmake qtcreator sudo apt install qtdeclarative5-dev qttools5-dev # å®‰è£…Qt Svgåº“ï¼Œç¼–è¯‘QWTæ—¶éœ€è¦ç”¨åˆ° sudo apt install libqt5svg5-dev å®‰è£…QWT Qt EPICSæ¨èä½¿ç”¨Qwt 6.1.4ï¼Œå¦‚æœåœ¨Ubuntu 20.04ä¸Šç›´æ¥é€šè¿‡ç»ˆç«¯å®‰è£…ä¹Ÿæ˜¯è¿™ä¸ªç‰ˆæœ¬ã€‚æˆ‘ä½¿ç”¨Qwt 6.2.0ç¼–è¯‘ï¼Œä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œè¿™é‡Œä»¥Qwt 6.2.0ä¸ºä¾‹ã€‚\næœ€æ–°æµ‹è¯•ï¼šQwt 6.3.0ä¹Ÿå¯ä»¥ç”¨ ~\nå…ˆä¸‹è½½Qwtçš„æºç  ä¸‹è½½Qwt-6.2.0ã€‚ ä¸‹è½½å®Œæˆåè§£å‹\nsh \u0026#9660; 1 2 3 4 # è§£å‹tar.bz2 tar -jxvf qwt-6.2.0.tar.bz2 # è§£å‹zip unzip qwt-6.2.0.zip è§£å‹å®Œæˆåç¼–è¯‘Qwtï¼Œä½¿ç”¨QtCreatoræˆ–è€…åœ¨ç»ˆç«¯ä½¿ç”¨qmakeéƒ½å¯ä»¥ã€‚\nç„¶åæ‰‹åŠ¨å°†ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶å¤åˆ¶åˆ°ä»¥ä¸‹ä½ç½®ï¼Œä¾‹ï¼š\nsh \u0026#9660; 1 2 3 4 5 6 7 # å¤åˆ¶ç¼–è¯‘ç”Ÿæˆçš„qwt sudo cp -r build-qwt-unknown-Release/lib/* /usr/lib/loongarch64-linux-gnu/ # å¤åˆ¶ç¼–è¯‘ç”Ÿæˆçš„designeræ’ä»¶ sudo cp build-qwt-unknown-Release/designer/plugins/designer/libqwt_designer_plugin.so /usr/lib/loongarch64-linux-gnu/qt5/plugins/designer/ # å¤åˆ¶qwtå¤´æ–‡ä»¶ sudo mkdir /usr/include/qwt sudo cp qwt-6.2.0/src/*.h /usr/include/qwt å®‰è£…ACAI ACAI Channel Access Interface\nEPICS Qtä¾èµ–ACAIæä¾›çš„Channel Accessæ¥å£ã€‚\nsh \u0026#9660; 1 2 3 4 5 6 7 8 cd /usr/local/epics/modules/ git clone https://github.com/andrewstarritt/acai.git cd acai vi configure/RELEASE.local # ä¿®æ”¹EPICS_BASEè·¯å¾„ï¼Œä¾‹ï¼š # EPICS_BASE=/usr/local/epics/base-7.0.8 make -j8 # ç­‰å¾…ç¼–è¯‘å®Œæˆ å®‰è£…google protobuf å¦‚æœéœ€è¦EPICS Qtæ”¯æŒEPICS Archiver Applianceï¼Œéœ€è¦å®‰è£…google protobufã€‚\nsh \u0026#9660; 1 sudo apt install protobuf-compiler libprotobuf-dev EPICS Qt é¦–å…ˆå…‹éš†EPICS Qtçš„ä¸¤ä¸ªä»£ç ä»“åº“ã€‚\nsh \u0026#9660; 1 2 3 4 # framework and support libraries git clone https://github.com/qtepics/qeframework.git # QEGui display manager git clone https://github.com/qtepics/qegui.git è¿™é‡Œæˆ‘å°†ä»£ç éƒ½æ”¾åœ¨~/QtEpicsç›®å½•ã€‚\nåœ¨å¼€å§‹ç¼–è¯‘å‰ï¼Œéœ€è¦å…ˆé…ç½®ä¸€äº›ç¯å¢ƒå˜é‡ï¼ˆæ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µè®¾ç½®ï¼‰ã€‚å…·ä½“å¯ä»¥å‚è€ƒ EPICS Qt Environment Variables\nsh \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 export EPICS_HOST_ARCH=linux-loong64 export EPICS_BASE=/usr/local/epics/base-7.0.8 export ACAI=/usr/local/epics/modules/acai export QWT_INCLUDE_PATH=/usr/include/qwt export QWT_ROOT=/usr/lib/loongarch64-linux-gnu export QE_FRAMEWORK=\u0026#34;$HOME/QtEpics/qeframework\u0026#34; # æ”¯æŒPV Access export QE_PVACCESS_SUPPORT=YES # æ”¯æŒArchiver Appliance export QE_ARCHAPPL_SUPPORT=YES export PROTOBUF_INCLUDE_PATH=/usr/include/google/protobuf export PROTOBUF_LIB_DIR=/usr/lib/loongarch64-linux-gnu å¦‚æœç¯å¢ƒå˜é‡è®¾ç½®äº†æ”¯æŒArchiver Applianceï¼Œéœ€è¦å…ˆç¼–è¯‘archapplDataSupã€‚\nsh \u0026#9660; 1 2 cd ~/QtEpics/qeframework/archapplDataSup/ make ç¼–è¯‘å®Œæˆåï¼Œå¯ä»¥çœ‹åˆ°~/QtEpics/qeframework/lib/linux-loong64ç›®å½•ä¸‹æœ‰libarchapplData.aã€libarchapplData.soä¸¤ä¸ªæ–‡ä»¶ã€‚\nç„¶åä¾æ¬¡ç¼–è¯‘ qeframework qeplugin qeguiã€‚EPICS Qtæ–‡æ¡£è¯´æ˜éœ€è¦ä¿®æ”¹configure/RELEASEæ–‡ä»¶ï¼Œä½†æˆ‘è¿™é‡Œä¿®æ”¹åä¼¼ä¹æ²¡æœ‰ç”Ÿæ•ˆï¼Œå¯èƒ½æ˜¯ä½¿ç”¨äº†Qt Creatorçš„åŸå› ï¼Œåªèƒ½é€šè¿‡ä¸Šé¢çš„ç¯å¢ƒå˜é‡è®¾ç½®ã€‚\næ³¨æ„ï¼šè¿™é‡Œè®¾ç½®å®Œç¯å¢ƒå˜é‡ï¼Œéœ€è¦ç›´æ¥é€šè¿‡ç»ˆç«¯æ‰“å¼€Qt Creatorã€‚\nç¼–è¯‘qeframework $HOME/QtEpics/qeframework/qeframeworkSup/project/framework.pro ç¼–è¯‘qeplugin $HOME/QtEpics/qeframework/qepluginApp/project/qeplugin.pro ç¼–è¯‘qegui $HOME/QtEpics/qegui/qeguiApp/project/QEGuiApp.pro æœ€åå°†ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶å¤åˆ¶åˆ°ç³»ç»Ÿç›®å½•ï¼Œç¤ºä¾‹ï¼š\nsh \u0026#9660; 1 2 3 4 sudo cp /usr/local/epics/modules/acai/lib/linux-loong64/libacai.so* /usr/lib/loongarch64-linux-gnu/ sudo cp ~/QtEpics/qeframework/lib/linux-loong64/libarchapplData.so /usr/lib/loongarch64-linux-gnu/ sudo cp ~/QtEpics/qeframework/lib/linux-loong64/libQEFramework.so /usr/lib/loongarch64-linux-gnu/ sudo cp ~/QtEpics/qeframework/lib/linux-loong64/designer/libQEPlugin.so /usr/lib/loongarch64-linux-gnu/qt5/plugins/designer/ è¿è¡ŒQEGuiApp\nsh \u0026#9660; 1 2 cd ~/epics/qtepics/qegui/bin/linux-loong64 ./qegui è¿è¡Œæµ‹è¯• è¿è¡Œæ—¶ç¯å¢ƒå˜é‡è®¾ç½®ï¼Œä¾‹ï¼š\nsh \u0026#9660; 1 2 3 export QE_ARCHIVE_TYPE=ARCHAPPL export QE_ARCHIVE_LIST=\u0026#34;http://192.168.1.2:17665/mgmt/bpl\u0026#34; export EPICS_CA_ADDR_LIST=\u0026#34;192.168.1.2:5732 192.168.1.3:6666\u0026#34; é—®é¢˜æ±‡æ€» ç¼–è¯‘è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°ä¸€äº›é—®é¢˜\næ‰¾ä¸åˆ°Qwtçš„å¤´æ–‡ä»¶ è§£å†³åŠæ³•: ä¿®æ”¹qeframework/qeframeworkSup/project/common/common.pri\ndiff \u0026#9660; 1 2 INCLUDEPATH += $$PWD +INCLUDEPATH += $$(QWT_INCLUDE_PATH) æ‰¾ä¸åˆ°QEFrameworkçš„å¤´æ–‡ä»¶ è§£å†³åŠæ³•: ä¿®æ”¹å¯¹åº”é¡¹ç›®çš„é¡¹ç›®æ–‡ä»¶\ndiff \u0026#9660; 1 +INCLUDEPATH += $$(QE_FRAMEWORK)/include Windowsä¸Šç¼–è¯‘è¸©å‘\næˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯MinGWç¼–è¯‘å™¨ï¼Œä»…ä¾›å‚è€ƒã€‚Windowsç¼–è¯‘å®‰è£…EPICSï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„ç¬”è®°ã€‚\nACAIç¼–è¯‘æŠ¥é”™ï¼Œè¿™ä¸ªæ˜¯ç”±äºå¹³å°å‡½æ•°çš„å·®å¼‚å¯¼è‡´çš„æŠ¥é”™ã€‚\næˆ‘å·²ç»æäº¤äº†ä¿®å¤è¡¥ä¸ï¼Œå‚è€ƒ fix build error on windowsã€‚\nç¼–è¯‘ google protobuf\nç½‘ä¸Šæœ‰å¾ˆå¤šå…³äºwindowsç¼–è¯‘google protobufçš„æ–‡ç« ã€‚è¯·è‡ªè¡Œæœç´¢è§£å†³ã€‚\nç¼–è¯‘ QEFramework\nè¿™é‡Œéœ€è¦ä¿®æ”¹configure/RELEASE.localï¼Œç¤ºä¾‹ï¼š\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 EPICS_HOST_ARCH=windows-x64-mingw EPICS_BASE=C:\\Users\\YourName\\.epics\\base-7.0.8 ACAI=D:\\source\\acai QE_FRAMEWORK=D:\\source\\qeframework QE_PVACCESS_SUPPORT=YES QE_ARCHAPPL_SUPPORT=YES PROTOBUF_INCLUDE_PATH=D:\\source\\protobuf-3.21.12\\src PROTOBUF_LIB_DIR=D:\\source\\protobuf-3.21.12\\build QWT_INCLUDE_PATH=D:\\source\\qwt-6.3.0\\src QWT_ROOT=D:\\source\\qwt-6.3.0\\build\\Desktop_Qt_5_15_14_MinGW_64_bit-Release Windowsä¸Šè¿è¡Œç¨‹åº\nå°†ç¼–è¯‘è¿‡ç¨‹ä¸­ç”Ÿæˆçš„DLLå…¨éƒ¨å¤åˆ¶åˆ°qeguiç¨‹åºç›®å½•ä¸‹ï¼Œå¤§è‡´æ±‡æ€»ä¸€ä¸‹æœ‰ï¼š\nqwt.dllï¼Œlibprotobuf.dllï¼Œacai.dllï¼ŒQEFramework.dllï¼ŒarchapplData.dllï¼ˆè¿™ä¸ªæ˜¯åœ¨Windowsä¸Šæ‰ä¼šç”Ÿæˆï¼Œåœ¨qeframework\\archapplDataSup\\src\\O.windows-x64-mingw\\ç›®å½•ä¸‹å¯ä»¥æ‰¾åˆ°ï¼‰\ndesigner/QEPlugin.dllï¼Œè¿™ä¸ªä¹Ÿå¾ˆé‡è¦ï¼Œä¸ç„¶qeguiåŠ è½½.uiæ–‡ä»¶ä¼šæ˜¾ç¤ºç©ºç™½ã€‚\nEPICSç›¸å…³çš„DLL:\nca.dllï¼ŒCom.dllï¼Œnt.dllï¼ŒpvAccess.dllï¼ŒpvData.dll\nä»¥åŠQtç›¸å…³çš„DLLã€‚\nå‚è€ƒé“¾æ¥ EPICS Qt at GitHub EPICS Qt Getting Started Archiver Appliance Support for EPICS Qt ","permalink":"https://kira-96.github.io/posts/epics-qt%E5%AE%89%E8%A3%85/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eæœ¬æ–‡ä¸»è¦è®°å½•äº†EPICS Qtåœ¨Linuxä¸Šçš„å®‰è£…æ­¥éª¤ã€‚è¿™é‡Œä»¥loongnixæ“ä½œç³»ç»Ÿä¸ºä¾‹ï¼ŒUbuntuç³»ç»Ÿä¸Šç¼–è¯‘å®‰è£…æ­¥éª¤ç±»ä¼¼ã€‚\u003c/p\u003e\n\u003cp\u003eEPICS Qtæ˜¯ä¸€ä¸ªåŸºäºQtçš„åˆ†å±‚æ¡†æ¶ï¼Œä½¿ç”¨Channel Access ï¼ˆCAï¼‰ and PV Accessï¼ˆPVAï¼‰è®¿é—®EPICSæ•°æ®ã€‚å®ƒæ˜¯ä¸ºå¿«é€Ÿå¼€å‘æ§åˆ¶ç³»ç»Ÿå›¾å½¢ç•Œé¢è€Œè®¾è®¡çš„ï¼Œæœ€åˆæ˜¯åœ¨æ¾³å¤§åˆ©äºšåŒæ­¥åŠ é€Ÿå™¨å¼€å‘çš„ã€‚\u003c/p\u003e\n\u003ch2 id=\"å®‰è£…epics\"\u003eå®‰è£…EPICS\u003c/h2\u003e\n\u003cp\u003eè¿™é‡Œä¸å†å†™å…·ä½“æ­¥éª¤äº†ï¼Œæ€»ä¹‹å°±æ˜¯éå¸¸ç®€å•ï¼Œä¸‹è½½ã€è§£å‹ã€ç¼–è¯‘å³å¯ã€‚å…·ä½“æ­¥éª¤å¯ä»¥å‚è€ƒ\u003ca href=\"https://kira-96.github.io/posts/%E9%BE%99%E8%8A%AF3a5000loongarch64%E4%B8%8A%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8Cepics/\"\u003eä»¥å‰çš„æ–‡ç« \u003c/a\u003eã€‚\u003c/p\u003e\n\u003ch2 id=\"å®‰è£…qt\"\u003eå®‰è£…Qt\u003c/h2\u003e\n\u003cp\u003eç›´æ¥ä½¿ç”¨ç»ˆç«¯å®‰è£…Qt\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"sh\"\u003esh\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt update\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt install qtbase5-dev qt5-qmake qtcreator\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt install qtdeclarative5-dev qttools5-dev\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# å®‰è£…Qt Svgåº“ï¼Œç¼–è¯‘QWTæ—¶éœ€è¦ç”¨åˆ°\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt install libqt5svg5-dev\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003ch2 id=\"å®‰è£…qwt\"\u003eå®‰è£…QWT\u003c/h2\u003e\n\u003cp\u003eQt EPICSæ¨èä½¿ç”¨Qwt 6.1.4ï¼Œå¦‚æœåœ¨Ubuntu 20.04ä¸Šç›´æ¥é€šè¿‡ç»ˆç«¯å®‰è£…ä¹Ÿæ˜¯è¿™ä¸ªç‰ˆæœ¬ã€‚æˆ‘ä½¿ç”¨Qwt 6.2.0ç¼–è¯‘ï¼Œä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œè¿™é‡Œä»¥Qwt 6.2.0ä¸ºä¾‹ã€‚\u003c/p\u003e\n\n\n\n\u003cblockquote\u003e\n    \u003cp\u003eæœ€æ–°æµ‹è¯•ï¼šQwt 6.3.0ä¹Ÿå¯ä»¥ç”¨ ~\u003c/p\u003e\n\n\u003c/blockquote\u003e\n\n\u003cp\u003eå…ˆä¸‹è½½Qwtçš„æºç  \u003ca href=\"https://sourceforge.net/projects/qwt/files/qwt/6.2.0/qwt-6.2.0.tar.bz2/download\"\u003eä¸‹è½½Qwt-6.2.0\u003c/a\u003eã€‚\nä¸‹è½½å®Œæˆåè§£å‹\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"sh\"\u003esh\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# è§£å‹tar.bz2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etar -jxvf qwt-6.2.0.tar.bz2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# è§£å‹zip\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eunzip qwt-6.2.0.zip\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eè§£å‹å®Œæˆåç¼–è¯‘Qwtï¼Œä½¿ç”¨QtCreatoræˆ–è€…åœ¨ç»ˆç«¯ä½¿ç”¨\u003ccode\u003eqmake\u003c/code\u003eéƒ½å¯ä»¥ã€‚\u003c/p\u003e\n\u003cp\u003eç„¶åæ‰‹åŠ¨å°†ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶å¤åˆ¶åˆ°ä»¥ä¸‹ä½ç½®ï¼Œä¾‹ï¼š\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"sh\"\u003esh\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# å¤åˆ¶ç¼–è¯‘ç”Ÿæˆçš„qwt\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo cp -r build-qwt-unknown-Release/lib/* /usr/lib/loongarch64-linux-gnu/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# å¤åˆ¶ç¼–è¯‘ç”Ÿæˆçš„designeræ’ä»¶\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo cp build-qwt-unknown-Release/designer/plugins/designer/libqwt_designer_plugin.so /usr/lib/loongarch64-linux-gnu/qt5/plugins/designer/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# å¤åˆ¶qwtå¤´æ–‡ä»¶\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo mkdir /usr/include/qwt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo cp qwt-6.2.0/src/*.h /usr/include/qwt\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003ch2 id=\"å®‰è£…acai\"\u003eå®‰è£…ACAI\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/andrewstarritt/acai\"\u003eACAI Channel Access Interface\u003c/a\u003e\u003c/p\u003e","title":"EPICS Qtå®‰è£…"},{"content":"å‰è¨€ æœ¬æ¥è¿™ç¯‡æ–‡ç« åº”è¯¥åœ¨ä¸Šå‘¨å°±å†™å®Œçš„ï¼Œä¸è¿‡çªç„¶è¢«å®‰æ’å‡ºå·®ï¼Œä¸€ç›´å¿™åˆ°äº†ç°åœ¨ï¼Œç»ˆäºå¯ä»¥é™ä¸‹å¿ƒæ¥åšäº›å…¶å®ƒäº‹æƒ…ã€‚\nä¹‹å‰å’Œé¾™èŠ¯3A5000ä¸»æœºä¸€èµ·é€è¿‡æ¥çš„è¿˜æœ‰ä¸€å—é¾™èŠ¯2K500çš„è¿·ä½ å¼€å‘æ¿ï¼Œæ•´ä¸ªæ¿å­ä¸åˆ°å·´æŒå¤§å°ã€‚ä¹‹å‰åªæ˜¯ç®€å•åšäº†ä¸Šç”µå¯åŠ¨ï¼Œè¿™æ¬¡æ‹¿åˆ°äº†æ¯”è¾ƒå®Œæ•´çš„å¼€å‘èµ„æ–™ï¼Œå¯ä»¥å°è¯•ä¸ºå¼€å‘æ¿ç¼–å†™ä¸€äº›ç¨‹åºäº†ã€‚\nç”±äºæš‚æ—¶æ²¡æœ‰å±å¹•ï¼Œåªèƒ½å…ˆè¯•ç€åšä¸€äº›å…¶å®ƒçš„äº‹æƒ…ï¼Œå¦‚é€šä¿¡å’ŒIOæ§åˆ¶ï¼Œå…¶ä¸­æœ€ç®€å•ï¼Œæœ€åŸºç¡€çš„å°±æ˜¯LEDç¯çš„æ§åˆ¶ã€‚ç„¶åæˆ‘å°±å‘ç°ï¼Œè¿™ä¸ªæ¿å­å±…ç„¶æœ‰ä¸€é¢—å¯ä»¥è°ƒèŠ‚äº®åº¦çš„LEDç¯ï¼æ²¡é”™ï¼Œä¹‹å‰åšçš„LEDæ§åˆ¶éƒ½åªèƒ½è¿›è¡Œå¼€å…³æ“ä½œï¼Œè€Œå¯ä»¥è°ƒèŠ‚äº®åº¦ï¼Œæ„å‘³ç€å¯ä»¥åšå‡ºæ›´å¤šçš„æ˜¾ç¤ºæ•ˆæœï¼Œè¿™æ¬¡æˆ‘å°±åšäº†ä¸€ä¸ªå‘¼å¸ç¯çš„æ•ˆæœã€‚\nç„¶åï¼Œæˆ‘ä¹Ÿç®€å•äº†è§£äº†ä¸€ä¸‹è¿™ç§äº®åº¦è°ƒèŠ‚çš„åŸç†ï¼Œå®é™…ä¸Šå°±æ˜¯é€šè¿‡è°ƒèŠ‚PWMè¾“å‡ºçš„å ç©ºæ¯”ï¼Œæ”¹å˜ä¸€ä¸ªå‘¨æœŸå†…è¾“å‡ºçš„é«˜ä½ç”µå¹³æ‰€å çš„æ¯”ä¾‹ï¼Œå®ç°æ§åˆ¶LEDç¯äº®åº¦çš„æ•ˆæœã€‚ç”±äºå¼•è„šè¾“å‡ºçš„ç”µå‹æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡æ”¹å˜ç”µå¹³æ¥æ§åˆ¶äº®åº¦ï¼Œè€Œæ”¹å˜é«˜ä½ç”µå¹³çš„å ç©ºæ¯”åˆ™æ˜¯å¦ä¸€ç§æ€è·¯ï¼ŒåµŒå…¥å¼è®¾å¤‡çš„å±å¹•èƒŒå…‰äº®åº¦è°ƒèŠ‚ä¹Ÿæ˜¯åŸºäºåŒæ ·çš„åŸç†ã€‚\nå¼€å‘æ¿ä¸Šç”µå¯åŠ¨ã€è¿æ¥ä¸²å£ç»ˆç«¯ ç”±äºæš‚æ—¶æ²¡æœ‰å±å¹•ï¼Œæƒ³è¦å’Œå¼€å‘æ¿è¿›è¡Œäº¤äº’å°±åªèƒ½é€šè¿‡ç»ˆç«¯çš„æ–¹å¼ï¼Œé€šå¸¸å¼€å‘æ¿éƒ½ä¼šæœ‰è°ƒè¯•ä¸²å£ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ä¸²å£ç»ˆç«¯ç™»å½•è®¾å¤‡ï¼Œé…ç½®å¥½ç½‘å£IPåœ°å€åï¼Œå†é€šè¿‡ç½‘ç»œè¿æ¥ç™»å½•è®¾å¤‡ã€‚\nä¸²å£çš„è¿æ¥æ–¹å¼å¦‚ä¸‹å›¾ï¼š\nå°†ç»¿ã€ç™½ã€é»‘ä¸‰è‰²çº¿ä»¥å›¾ä¸­æ–¹å¼æ¥å¥½ï¼ˆçº¢çº¿ä¸ç”¨æ¥ï¼‰ï¼ŒUSBç«¯æ’å…¥åˆ°ç”µè„‘ï¼Œåº”è¯¥ä¸éœ€è¦è£…é©±åŠ¨ï¼Œç”µè„‘å¯ä»¥ç›´æ¥è¯†åˆ«å‡ºä¸²å£è®¾å¤‡ã€‚\næ‰“å¼€ä¸²å£ç»ˆç«¯å·¥å…·ï¼Œæ¯”å¦‚Windows MobaXtermï¼Œlinux minicomç­‰ï¼Œæˆ‘æ¯”è¾ƒå–œæ¬¢ç”¨puttyã€‚\né…ç½®å¥½ç«¯å£ï¼Œè®¾ç½®\næ³¢ç‰¹ç‡ï¼š115200\næ•°æ®ä½ï¼š8ä½\nåœæ­¢ä½ï¼š1ä½\næ ¡éªŒï¼šæ— \nç¡¬ä»¶æµæ§ï¼šæ— \nç„¶åç»™å¼€å‘æ¿æ¥é€šç”µæºï¼Œå°±å¯ä»¥çœ‹åˆ°è°ƒè¯•è¾“å‡ºä¿¡æ¯äº†ã€‚\næŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°è¿è¡Œçš„æ˜¯å®‰è£…äº†PREEMPT_RTè¡¥ä¸çš„å®æ—¶æ“ä½œç³»ç»Ÿã€‚\nsh \u0026#9660; 1 2 3 [root@LS-GD ~]# uname -a Linux LS-GD 5.10.0.lsgd-g434b00a6badf #1 PREEMPT Wed Sep 14 12:57:58 CST 2022 loongarch64 GNU/Linux [root@LS-GD ~]# é…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ 2K500å¼€å‘æ¿æ˜¯loongarch64æ¶æ„çš„åµŒå…¥å¼æ¿å¡ã€‚ä¸‹è½½å¥½å¯¹åº”çš„äº¤å‰ç¼–è¯‘å·¥å…·é“¾åï¼Œè§£å‹åˆ°ç³»ç»Ÿ/opt/ç›®å½•ä¸‹ã€‚æŒ‰æ‰‹å†Œæ¥å°±å¥½~\nsh \u0026#9660; 1 $ sudo tar -xf toolchain-loongarch64-linux-gnu-gcc8-host-x86_64-2022-07-18.tar.xz -C /opt/ ç„¶åæˆ‘ä»¬éœ€è¦å°†äº¤å‰ç¼–è¯‘å™¨æ·»åŠ åˆ°ç³»ç»Ÿè·¯å¾„ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ¥ä¸‹æ¥ä½¿ç”¨ã€‚\nè¿™é‡Œæˆ‘ç›´æ¥å°†é…ç½®å†™æˆè„šæœ¬ï¼Œæ–¹ä¾¿ä¸‹æ¬¡ä½¿ç”¨ã€‚\nsh \u0026#9660; 1 2 3 4 5 6 7 8 $ cd /opt/toolchain-loongarch64-linux-gnu-gcc8-host-x86_64-2022-07-18 # åˆ›å»ºè„šæœ¬ $ sudo touch environment-setup-loongarch64-linux-gnu # æ·»åŠ å¯æ‰§è¡Œæƒé™ $ sudo chmod +x environment-setup-loongarch64-linux-gnu # ä¿®æ”¹è„šæœ¬å†…å®¹ $ sudo vi environment-setup-loongarch64-linux-gnu # å†…å®¹å¦‚ä¸‹~ sh \u0026#9660; 1 2 3 4 5 6 7 8 # environment-setup-loongarch64-linux-gnu CC_PREFIX=/opt/toolchain-loongarch64-linux-gnu-gcc8-host-x86_64-2022-07-18 export PATH=$CC_PREFIX/bin:$PATH export LD_LIBRARY_PATH=$CC_PREFIX/lib:$LD_LIBRARY_PATH export LD_LIBRARY_PATH=$CC_PREFIX/loongarch64-linux-gnu/lib64:$LD_LIBRARY_PATH export ARCH=loongarch export CROSS_COMPILE=loongarch64-linux-gnu- æ¥ä¸‹æ¥æµ‹è¯•ä¸€ä¸‹äº¤å‰ç¼–è¯‘ç¯å¢ƒ\nsh \u0026#9660; 1 2 3 4 5 6 7 8 9 10 $ cd ~ $ . /opt/toolchain-loongarch64-linux-gnu-gcc8-host-x86_64-2022-07-18/environment-setup-loongarch64-linux-gnu $ loongarch64-linux-gnu-gcc -v Using built-in specs. COLLECT_GCC=loongarch64-linux-gnu-gcc COLLECT_LTO_WRAPPER=/opt/toolchain-loongarch64-linux-gnu-gcc8-host-x86_64-2022-07-18/bin/../libexec/gcc/loongarch64-linux-gnu/8.3.0/lto-wrapper Target: loongarch64-linux-gnu Configured with: /dev/shm/build_loongarch64_gcc8-host-x86_64_2022-07-18/src/gcc/configure --build=x86_64-redhat-linux --host=x86_64-redhat-linux --target=loongarch64-linux-gnu --program-prefix=loongarch64-linux-gnu- --prefix=/dev/shm/build_loongarch64_gcc8-host-x86_64_2022-07-18/cross --libdir=/dev/shm/build_loongarch64_gcc8-host-x86_64_2022-07-18/cross/lib --with-gxx-include-dir=/dev/shm/build_loongarch64_gcc8-host-x86_64_2022-07-18/cross/sysroot/usr/include/c++ --with-sysroot=/dev/shm/build_loongarch64_gcc8-host-x86_64_2022-07-18/cross/sysroot --with-native-system-header-dir=/usr/include --with-arch=loongarch64 --with-abi=lp64 --with-multilib-list=lp64d,lp64s --with-pkgversion=\u0026#39;LoongArch\\ GNU\\ toolchain\\ vec.32-rc2\u0026#39; --disable-linker-build-id --with-newlib --without-headers --disable-shared --enable-threads=posix --enable-tls --enable-languages=c,c++,fortran --enable-__cxa_atexit --enable-libquadmath-support --disable-gcov --disable-libcc1 --enable-initfini-array --disable-nls --disable-bootstrap --with-glibc-version=2.28 Thread model: posix gcc version 8.3.0 (LoongArch GNU toolchain vec.32-rc2) å¯ä»¥çœ‹åˆ°loongarchäº¤å‰ç¼–è¯‘å™¨çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œé…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒå®Œæˆã€‚\nç¼–å†™ç¨‹åº æ§åˆ¶LEDç¯çš„äº®åº¦ï¼ŒLinuxç³»ç»Ÿå·²ç»æœ‰é©±åŠ¨å®ç°äº†ï¼Œæˆ‘ä»¬è¦åšçš„æ“ä½œå°±æ˜¯å‘ç›¸åº”çš„æ–‡ä»¶ä¸­å†™å…¥æ•°å€¼å³å¯ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯ç³»ç»Ÿçš„äº‹æƒ…ã€‚\nå¯¹äºä¸€èˆ¬çš„LEDç¯ï¼Œåªæœ‰å¼€å…³ä¸¤ä¸ªé€‰é¡¹ï¼Œå†™å…¥0ä¸ºå…³é—­ï¼Œå†™å…¥é0å€¼æ‰“å¼€ã€‚\nè€Œå¯¹äºPWMæ§åˆ¶çš„LEDç¯ï¼Œéœ€è¦å†™å…¥å…·ä½“æ•°å€¼æ¥æ§åˆ¶ç¯çš„äº®åº¦ï¼ŒåŒæ ·ï¼Œ0ä¸ºå…³é—­ï¼Œå†™å…¥æ•°å€¼è¶Šå¤§LEDç¯å°±è¶Šäº®ï¼Œå½“ç„¶ï¼Œè¿™æ˜¯æœ‰ä¸Šé™çš„ã€‚è¿™é‡Œç»è¿‡æµ‹è¯•ï¼Œå†™å…¥255åï¼ŒLEDç¯è¾¾åˆ°æœ€äº®ã€‚\nè€Œè¿™æ¬¡å†™çš„å‘¼å¸ç¯ç¨‹åºï¼Œåˆ™æ˜¯é€æ¸æ”¹å˜LEDç¯çš„äº®åº¦ï¼Œå®ç°LEDç¯ç¼“æ…¢é—ªçƒçš„æ•ˆæœã€‚\nè¿™é‡Œæˆ‘å°†äº®åº¦åˆ†ä¸º10ä¸ªçº§åˆ«ï¼Œä»0åˆ°255ï¼ˆ2^8 - 1ï¼‰ï¼Œæ¯100msæ”¹å˜ä¸€ä¸‹LEDç¯çš„äº®åº¦ï¼Œä¸€ä¸ªå‘¨æœŸåˆšå¥½ä¸º2ç§’ï¼ˆä»ç­åˆ°æœ€äº®ï¼Œç„¶åä»æœ€äº®åˆ°ç­ï¼‰ã€‚\nè‡³äºä¸ºä»€ä¹ˆæ˜¯åˆ†ä¸ºè¿™10ä¸ªçº§åˆ«ï¼Œè€Œä¸æ˜¯ä»0~255å˜åŒ–ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±è¯•è¯•ï¼Œçœ‹ä¸€ä¸‹æ•ˆæœã€‚\nä»¥ä¸‹æ˜¯å®Œæ•´ç¨‹åºï¼š\nc \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 /** * file: led-pwm.c */ #include \u0026lt;fcntl.h\u0026gt; #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; /** * @brief å‘¼å¸ç¯æ•ˆæœ * @param fd è®¾å¤‡æ–‡ä»¶ */ void breath(int fd); int main(int argc, char *argv[]) { if (argc \u0026lt; 2) { printf(\u0026#34;Please input LED device.\\n\u0026#34;); return -1; } int fd; char file[64]; sprintf(file, \u0026#34;%s/brightness\u0026#34;, argv[1]); /* æ‰“å¼€è®¾å¤‡æ–‡ä»¶ */ fd = open(file, O_WRONLY); if (fd \u0026lt; 0) { printf(\u0026#34;Error open file: %s\\n\u0026#34;, file); return fd; } breath(fd); /* å…³é—­è®¾å¤‡æ–‡ä»¶ */ close(fd); return 0; } void breath(int fd) { const int values[15] = { 0, 1, 2, 4, 8, 16, 32, 64, 96, 128, 160, 192, 224, 255, 255 }; char buf[5]; while (1) { for (int i = 0; i \u0026lt; 30; i++) { int j = i \u0026lt; 15 ? i : (29 - i); sprintf(buf, \u0026#34;%d\u0026#34;, values[j]); write(fd, buf, sizeof(buf)); usleep(100000); // ä¼‘çœ 100ms } } } ç„¶åç¼–è¯‘ï¼Œå¾—åˆ°åœ¨å¼€å‘æ¿ä¸Šè¿è¡Œå¯æ‰§è¡Œç¨‹åºã€‚\nsh \u0026#9660; 1 $ loongarch64-linux-gnu-gcc led-pwm.c -o led-pwm ä¸‹è½½ç¨‹åºåˆ°å¼€å‘æ¿ è¿è¡Œå‰çš„æœ€åä¸€æ­¥ï¼Œéœ€è¦å°†ç¼–è¯‘å¥½å¯æ‰§è¡Œç¨‹åºå¤åˆ¶åˆ°å¼€å‘æ¿ä¸Šï¼Œæˆ‘é€šå¸¸æ˜¯ä½¿ç”¨scpå‘½ä»¤å°†æ–‡ä»¶å¤åˆ¶åˆ°å¼€å‘æ¿ã€‚\néœ€è¦å…ˆåœ¨ä¸²å£ç»ˆç«¯é€šè¿‡ifconfigè®¾ç½®å¼€å‘æ¿çš„ç½‘å£IPï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨scpå‰ï¼Œéœ€è¦å…ˆç”¨sshç™»å½•åˆ°å¼€å‘æ¿ã€‚\nç³»ç»Ÿé»˜è®¤è´¦æˆ·ä¸ºrootï¼Œé»˜è®¤å¯†ç ä¸º123\nç”±äºä¹‹å‰ä¸çŸ¥é“é»˜è®¤å¯†ç æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥å…ˆç”¨passwdå‘½ä»¤æ”¹äº†å¯†ç ğŸ˜…ã€‚\nsh \u0026#9660; 1 2 3 4 5 6 7 8 # ä¾‹ï¼šå°†å¯æ‰§è¡Œç¨‹åºå¤åˆ¶åˆ°å¼€å‘æ¿ $ scp ./led-pwm root@192.168.0.10:~/ # ä½¿ç”¨ ssh ç™»å½•å¼€å‘æ¿ $ ssh root@192.168.0.10 # ä¸ºç¨‹åºæ·»åŠ å¯æ‰§è¡Œæƒé™ï¼ˆåœ¨å¼€å‘æ¿æ“ä½œï¼‰ ~ $ chmod +x ./led-pwm # è¿è¡Œç¨‹åº ~ $ ./led-pwm /sys/class/leds/led1-pwm å®é™…è¿è¡Œæ•ˆæœ ç”±äºå¼€å‘æ¿çš„LED2é»˜è®¤æ˜¯å¿ƒè·³æ¨¡å¼[heartbeat]ï¼Œæ‰€ä»¥ä¼šä¸€ç›´ä¸€é—ªä¸€é—ªçš„ï¼Œåœ¨è¿è¡Œå‘¼å¸ç¯ç¨‹åºå‰ï¼Œå¯ä»¥å…ˆæŠŠLED2æ”¹ä¸º[none]æ¨¡å¼ã€‚\nsh \u0026#9660; 1 ~ $ echo none \u0026gt; /sys/class/leds/led2/trigger æ‰§è¡Œç¼–å†™çš„å‘¼å¸ç¯ç¨‹åº\nsh \u0026#9660; 1 ~ $ ./led-pwm /sys/class/leds/led1-pwm å®é™…è¿è¡Œæ•ˆæœå¦‚ä¸‹ï¼š\n\u003c!DOCTYPE HTML\u003e ","permalink":"https://kira-96.github.io/posts/%E9%BE%99%E8%8A%AF2k500%E5%BC%80%E5%8F%91%E6%9D%BF%E4%B8%8A%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%91%BC%E5%90%B8%E7%81%AF%E6%95%88%E6%9E%9C/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eæœ¬æ¥è¿™ç¯‡æ–‡ç« åº”è¯¥åœ¨ä¸Šå‘¨å°±å†™å®Œçš„ï¼Œä¸è¿‡çªç„¶è¢«å®‰æ’å‡ºå·®ï¼Œä¸€ç›´å¿™åˆ°äº†ç°åœ¨ï¼Œç»ˆäºå¯ä»¥é™ä¸‹å¿ƒæ¥åšäº›å…¶å®ƒäº‹æƒ…ã€‚\u003c/p\u003e\n\u003cp\u003eä¹‹å‰å’Œé¾™èŠ¯3A5000ä¸»æœºä¸€èµ·é€è¿‡æ¥çš„è¿˜æœ‰ä¸€å—é¾™èŠ¯2K500çš„è¿·ä½ å¼€å‘æ¿ï¼Œæ•´ä¸ªæ¿å­ä¸åˆ°å·´æŒå¤§å°ã€‚ä¹‹å‰åªæ˜¯ç®€å•åšäº†ä¸Šç”µå¯åŠ¨ï¼Œè¿™æ¬¡æ‹¿åˆ°äº†æ¯”è¾ƒå®Œæ•´çš„å¼€å‘èµ„æ–™ï¼Œå¯ä»¥å°è¯•ä¸ºå¼€å‘æ¿ç¼–å†™ä¸€äº›ç¨‹åºäº†ã€‚\u003c/p\u003e\n\u003cp\u003eç”±äºæš‚æ—¶æ²¡æœ‰å±å¹•ï¼Œåªèƒ½å…ˆè¯•ç€åšä¸€äº›å…¶å®ƒçš„äº‹æƒ…ï¼Œå¦‚é€šä¿¡å’ŒIOæ§åˆ¶ï¼Œå…¶ä¸­æœ€ç®€å•ï¼Œæœ€åŸºç¡€çš„å°±æ˜¯LEDç¯çš„æ§åˆ¶ã€‚ç„¶åæˆ‘å°±å‘ç°ï¼Œè¿™ä¸ªæ¿å­å±…ç„¶æœ‰ä¸€é¢—å¯ä»¥è°ƒèŠ‚äº®åº¦çš„LEDç¯ï¼æ²¡é”™ï¼Œä¹‹å‰åšçš„LEDæ§åˆ¶éƒ½åªèƒ½è¿›è¡Œå¼€å…³æ“ä½œï¼Œè€Œå¯ä»¥è°ƒèŠ‚äº®åº¦ï¼Œæ„å‘³ç€å¯ä»¥åšå‡ºæ›´å¤šçš„æ˜¾ç¤ºæ•ˆæœï¼Œè¿™æ¬¡æˆ‘å°±åšäº†ä¸€ä¸ªå‘¼å¸ç¯çš„æ•ˆæœã€‚\u003c/p\u003e\n\u003cp\u003eç„¶åï¼Œæˆ‘ä¹Ÿç®€å•äº†è§£äº†ä¸€ä¸‹è¿™ç§äº®åº¦è°ƒèŠ‚çš„åŸç†ï¼Œå®é™…ä¸Šå°±æ˜¯é€šè¿‡è°ƒèŠ‚PWMè¾“å‡ºçš„å ç©ºæ¯”ï¼Œæ”¹å˜ä¸€ä¸ªå‘¨æœŸå†…è¾“å‡ºçš„é«˜ä½ç”µå¹³æ‰€å çš„æ¯”ä¾‹ï¼Œå®ç°æ§åˆ¶LEDç¯äº®åº¦çš„æ•ˆæœã€‚ç”±äºå¼•è„šè¾“å‡ºçš„ç”µå‹æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡æ”¹å˜ç”µå¹³æ¥æ§åˆ¶äº®åº¦ï¼Œè€Œæ”¹å˜é«˜ä½ç”µå¹³çš„å ç©ºæ¯”åˆ™æ˜¯å¦ä¸€ç§æ€è·¯ï¼ŒåµŒå…¥å¼è®¾å¤‡çš„å±å¹•èƒŒå…‰äº®åº¦è°ƒèŠ‚ä¹Ÿæ˜¯åŸºäºåŒæ ·çš„åŸç†ã€‚\u003c/p\u003e\n\u003ch2 id=\"å¼€å‘æ¿ä¸Šç”µå¯åŠ¨è¿æ¥ä¸²å£ç»ˆç«¯\"\u003eå¼€å‘æ¿ä¸Šç”µå¯åŠ¨ã€è¿æ¥ä¸²å£ç»ˆç«¯\u003c/h2\u003e\n\u003cp\u003eç”±äºæš‚æ—¶æ²¡æœ‰å±å¹•ï¼Œæƒ³è¦å’Œå¼€å‘æ¿è¿›è¡Œäº¤äº’å°±åªèƒ½é€šè¿‡ç»ˆç«¯çš„æ–¹å¼ï¼Œé€šå¸¸å¼€å‘æ¿éƒ½ä¼šæœ‰è°ƒè¯•ä¸²å£ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ä¸²å£ç»ˆç«¯ç™»å½•è®¾å¤‡ï¼Œé…ç½®å¥½ç½‘å£IPåœ°å€åï¼Œå†é€šè¿‡ç½‘ç»œè¿æ¥ç™»å½•è®¾å¤‡ã€‚\u003c/p\u003e\n\u003cp\u003eä¸²å£çš„è¿æ¥æ–¹å¼å¦‚ä¸‹å›¾ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://cdn.jsdelivr.net/gh/kira-96/Picture@main/blog/images/Snipaste_2023-02-25_11-59-37.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå°†ç»¿ã€ç™½ã€é»‘ä¸‰è‰²çº¿ä»¥å›¾ä¸­æ–¹å¼æ¥å¥½ï¼ˆçº¢çº¿ä¸ç”¨æ¥ï¼‰ï¼ŒUSBç«¯æ’å…¥åˆ°ç”µè„‘ï¼Œåº”è¯¥ä¸éœ€è¦è£…é©±åŠ¨ï¼Œç”µè„‘å¯ä»¥ç›´æ¥è¯†åˆ«å‡ºä¸²å£è®¾å¤‡ã€‚\u003c/p\u003e\n\u003cp\u003eæ‰“å¼€ä¸²å£ç»ˆç«¯å·¥å…·ï¼Œæ¯”å¦‚Windows MobaXtermï¼Œlinux minicomç­‰ï¼Œæˆ‘æ¯”è¾ƒå–œæ¬¢ç”¨puttyã€‚\u003c/p\u003e\n\u003cp\u003eé…ç½®å¥½ç«¯å£ï¼Œè®¾ç½®\u003cbr\u003e\næ³¢ç‰¹ç‡ï¼š115200\u003cbr\u003e\næ•°æ®ä½ï¼š8ä½\u003cbr\u003e\nåœæ­¢ä½ï¼š1ä½\u003cbr\u003e\næ ¡éªŒï¼šæ— \u003cbr\u003e\nç¡¬ä»¶æµæ§ï¼šæ— \u003c/p\u003e\n\u003cp\u003eç„¶åç»™å¼€å‘æ¿æ¥é€šç”µæºï¼Œå°±å¯ä»¥çœ‹åˆ°è°ƒè¯•è¾“å‡ºä¿¡æ¯äº†ã€‚\u003c/p\u003e\n\u003cp\u003eæŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°è¿è¡Œçš„æ˜¯å®‰è£…äº†\u003ca href=\"https://mirrors.tuna.tsinghua.edu.cn/kernel/projects/rt/\"\u003e\u003ccode\u003ePREEMPT_RT\u003c/code\u003e\u003c/a\u003eè¡¥ä¸çš„å®æ—¶æ“ä½œç³»ç»Ÿã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"sh\"\u003esh\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eroot@LS-GD ~\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"c1\"\u003e# uname -a\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eLinux LS-GD 5.10.0.lsgd-g434b00a6badf \u003cspan class=\"c1\"\u003e#1 PREEMPT Wed Sep 14 12:57:58 CST 2022 loongarch64 GNU/Linux\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eroot@LS-GD ~\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"c1\"\u003e# \u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003ch2 id=\"é…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ\"\u003eé…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒ\u003c/h2\u003e\n\u003cp\u003e2K500å¼€å‘æ¿æ˜¯loongarch64æ¶æ„çš„åµŒå…¥å¼æ¿å¡ã€‚ä¸‹è½½å¥½å¯¹åº”çš„äº¤å‰ç¼–è¯‘å·¥å…·é“¾åï¼Œè§£å‹åˆ°ç³»ç»Ÿ\u003ccode\u003e/opt/\u003c/code\u003eç›®å½•ä¸‹ã€‚æŒ‰æ‰‹å†Œæ¥å°±å¥½~\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"sh\"\u003esh\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo tar -xf toolchain-loongarch64-linux-gnu-gcc8-host-x86_64-2022-07-18.tar.xz -C /opt/\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eç„¶åæˆ‘ä»¬éœ€è¦å°†äº¤å‰ç¼–è¯‘å™¨æ·»åŠ åˆ°ç³»ç»Ÿè·¯å¾„ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ¥ä¸‹æ¥ä½¿ç”¨ã€‚\u003c/p\u003e\n\u003cp\u003eè¿™é‡Œæˆ‘ç›´æ¥å°†é…ç½®å†™æˆè„šæœ¬ï¼Œæ–¹ä¾¿ä¸‹æ¬¡ä½¿ç”¨ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"sh\"\u003esh\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /opt/toolchain-loongarch64-linux-gnu-gcc8-host-x86_64-2022-07-18\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# åˆ›å»ºè„šæœ¬\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo touch environment-setup-loongarch64-linux-gnu\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# æ·»åŠ å¯æ‰§è¡Œæƒé™\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo chmod +x environment-setup-loongarch64-linux-gnu\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ä¿®æ”¹è„šæœ¬å†…å®¹\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ sudo vi environment-setup-loongarch64-linux-gnu\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# å†…å®¹å¦‚ä¸‹~\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"sh\"\u003esh\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# environment-setup-loongarch64-linux-gnu\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eCC_PREFIX\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/opt/toolchain-loongarch64-linux-gnu-gcc8-host-x86_64-2022-07-18\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003ePATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$CC_PREFIX\u003c/span\u003e/bin:\u003cspan class=\"nv\"\u003e$PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eLD_LIBRARY_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$CC_PREFIX\u003c/span\u003e/lib:\u003cspan class=\"nv\"\u003e$LD_LIBRARY_PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eLD_LIBRARY_PATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$CC_PREFIX\u003c/span\u003e/loongarch64-linux-gnu/lib64:\u003cspan class=\"nv\"\u003e$LD_LIBRARY_PATH\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eARCH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eloongarch\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eCROSS_COMPILE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eloongarch64-linux-gnu-\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eæ¥ä¸‹æ¥æµ‹è¯•ä¸€ä¸‹äº¤å‰ç¼–è¯‘ç¯å¢ƒ\u003c/p\u003e","title":"é¾™èŠ¯2K500å¼€å‘æ¿ä¸Šå®ç°çš„å‘¼å¸ç¯æ•ˆæœ"},{"content":"ä½¿ç”¨weston-screenshooter\nä½†å¿…é¡»å¯ç”¨westonæ¡Œé¢--debugé€‰é¡¹ï¼Œå¦åˆ™ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š\nshell \u0026#9660; 1 2 3 [root@RK356X:/]# weston-screenshooter [02:41:05.145] libwayland: error in client communication (pid 776) weston_screenshooter@5: error 0: screenshooter failed: permission denied. Debug protocol must be enabled ä»¥RK3568å¼€å‘æ¿ï¼Œbuildrootç³»ç»Ÿä¸ºä¾‹ï¼Œä¿®æ”¹/etc/init.d/S50launcherï¼Œæ‰¾åˆ°westonæ‰€åœ¨è¡Œï¼Œæ·»åŠ --debugé€‰é¡¹ã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 ...... # Uncomment to disable mirror mode # unset WESTON_DRM_MIRROR export XDG_RUNTIME_DIR=${XDG_RUNTIME_DIR:-/var/run} export QT_QPA_PLATFORM=${QT_QPA_PLATFORM:-wayland} weston --tty=2 --debug --idle-time=0\u0026amp; { # Wait for weston ready while [ ! -e ${XDG_RUNTIME_DIR}/wayland-0 ]; do sleep .1 done /usr/bin/QLauncher \u0026amp; }\u0026amp; ...... forlinxå¼€å‘æ¿ä½¿ç”¨çš„yoctoç³»ç»Ÿä¹Ÿç±»ä¼¼ï¼Œä¿®æ”¹/lib/systemd/system/weston.serviceï¼Œåœ¨westonåæ·»åŠ --debugé€‰é¡¹ã€‚\nshell \u0026#9660; 1 2 3 $ vi /lib/systemd/system/weston.service # ä¿®æ”¹å¦‚ä¸‹ # ExecStart=/usr/bin/weston --debug --log=${XDG_RUNTIME_DIR}/weston.log $OPTARGS ç„¶åé‡å¯ç³»ç»Ÿï¼Œä¹‹åå°±å¯ä»¥ä½¿ç”¨weston-screenshooteræˆªå–å±å¹•äº†ã€‚\né“¾æ¥\nwayland-project/weston weston.inié…ç½®æ–‡ä»¶ ","permalink":"https://kira-96.github.io/notes/weston-screenshot/","summary":"\u003cp\u003eä½¿ç”¨\u003ccode\u003eweston-screenshooter\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eä½†å¿…é¡»å¯ç”¨westonæ¡Œé¢\u003ccode\u003e--debug\u003c/code\u003eé€‰é¡¹ï¼Œå¦åˆ™ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eroot@RK356X:/\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"c1\"\u003e# weston-screenshooter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e02:41:05.145\u003cspan class=\"o\"\u003e]\u003c/span\u003e libwayland: error in client communication \u003cspan class=\"o\"\u003e(\u003c/span\u003epid 776\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eweston_screenshooter@5: error 0: screenshooter failed: permission denied. Debug protocol must be enabled\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eä»¥RK3568å¼€å‘æ¿ï¼Œbuildrootç³»ç»Ÿä¸ºä¾‹ï¼Œä¿®æ”¹\u003ccode\u003e/etc/init.d/S50launcher\u003c/code\u003eï¼Œæ‰¾åˆ°westonæ‰€åœ¨è¡Œï¼Œæ·»åŠ \u003ccode\u003e--debug\u003c/code\u003eé€‰é¡¹ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e......\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Uncomment to disable mirror mode\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# unset WESTON_DRM_MIRROR\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eXDG_RUNTIME_DIR\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eXDG_RUNTIME_DIR\u003c/span\u003e\u003cspan class=\"k\"\u003e:-\u003c/span\u003e\u003cspan class=\"p\"\u003e/var/run\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eQT_QPA_PLATFORM\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eQT_QPA_PLATFORM\u003c/span\u003e\u003cspan class=\"k\"\u003e:-\u003c/span\u003e\u003cspan class=\"nv\"\u003ewayland\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eweston --tty\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e --debug --idle-time\u003cspan class=\"o\"\u003e=\u003c/span\u003e0\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# Wait for weston ready\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003e ! -e \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eXDG_RUNTIME_DIR\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e/wayland-0 \u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        sleep .1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    /usr/bin/QLauncher \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e......\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eforlinxå¼€å‘æ¿ä½¿ç”¨çš„yoctoç³»ç»Ÿä¹Ÿç±»ä¼¼ï¼Œä¿®æ”¹\u003ccode\u003e/lib/systemd/system/weston.service\u003c/code\u003eï¼Œåœ¨westonåæ·»åŠ \u003ccode\u003e--debug\u003c/code\u003eé€‰é¡¹ã€‚\u003c/p\u003e","title":"westonæ¡Œé¢ç³»ç»Ÿæˆªå±æ–¹æ³•"},{"content":"å‰è¨€ ä¹‹å‰å°è¯•è¿‡åœ¨é¾™èŠ¯3A4000ä¸Šç¼–è¯‘è¿è¡ŒEPICSï¼Œç”±äº3A4000è¿˜æ˜¯mips64æŒ‡ä»¤é›†ï¼Œè€Œ3A5000åˆ™æ˜¯é¾™èŠ¯çš„è‡ªä¸»æŒ‡ä»¤é›†loongarch64ï¼Œé€‚é…èµ·æ¥æ­¥éª¤ä¹Ÿä¼šæœ‰æ‰€ä¸åŒã€‚\nè¿™æ¬¡ä½¿ç”¨çš„æ˜¯é¾™åšç‰¹é¾™èŠ¯3A5000ç”µè„‘ä¸»æœºã€‚\nè™½ç„¶EPICSå®˜æ–¹å¹¶æ²¡æœ‰é€‚é…loongarchå’Œmips64ï¼Œæ— æ³•åšåˆ°å¼€ç®±å³ç”¨ï¼Œä½†åªè¦æœ‰gccã€g++ã€makeã€perlè¿™äº›å·¥å…·ï¼Œç†è®ºä¸Šå°±èƒ½ç¼–è¯‘è¿è¡ŒEPICSï¼Œåœ¨å¼€å§‹ç¼–è¯‘å‰ï¼Œç¡®ä¿ä½ çš„è®¾å¤‡ä¸Šå·²ç»è£…å¥½äº†è¿™äº›å·¥å…·ã€‚\nå…³äºå¦‚ä½•ç§°å‘¼ã€Œé¾™æ¶æ„ã€ï¼Œé¾™èŠ¯ç¤¾åŒºä¹Ÿæœ‰ä¸€äº›è®¨è®ºã€‚æœ€åˆæˆ‘ç›´æ¥ä½¿ç”¨loongarch64ï¼Œåæ¥ä¹Ÿä½¿ç”¨è¿‡la64ä½œä¸ºç®€å†™ï¼Œç›´åˆ°æˆ‘çœ‹åˆ°å¦‚ä½•ç§°å‘¼é¾™æ¶æ„ï¼Ÿï¼Œæˆ‘è§‰å¾—æœ‰å¿…è¦å’Œç¤¾åŒºä¿æŒä¸€è‡´ï¼Œåç»­ç»Ÿä¸€ä½¿ç”¨ loong64 ä½œä¸ºæ¶æ„æ ‡è¯†ã€‚\nä¸‹è½½ base è¿™é‡Œæˆ‘ä»¬å°±ä»¥ç›®å‰æœ€æ–°ç‰ˆæœ¬7.0.7ä¸ºä¾‹ï¼Œå…¶å®ƒç‰ˆæœ¬çš„Baseä¹Ÿç±»ä¼¼ã€‚\nshell \u0026#9660; 1 2 3 $ cd ~/ä¸‹è½½/ $ wget https://epics.anl.gov/download/base/base-7.0.7.tar.gz $ tar -xzvf base-7.0.7.tar.gz ä½ å¯ä»¥åœ¨ä½ è§‰å¾—åˆé€‚çš„ä½ç½®ç¼–è¯‘å®‰è£…Baseï¼Œè¿™é‡ŒæŒ‰æˆ‘ä»¬çš„ä¹ æƒ¯ï¼Œæ”¾åœ¨/usr/local/epicsç›®å½•ä¸‹ã€‚\nshell \u0026#9660; 1 2 $ mkdir /usr/local/epics $ mv base-7.0.7 /usr/local/epics/ ç¼–è¯‘ æŒ‰ç…§ä¸€èˆ¬æ­¥éª¤ï¼Œç°åœ¨å°±å¯ä»¥å¼€å§‹ç¼–è¯‘äº†ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆç»“æœã€‚\nshell \u0026#9660; 1 2 3 $ cd /usr/local/epics/base-7.0.7/ # æ‰§è¡Œ `make` å‘½ä»¤ $ make ä¸å‡ºæ‰€æ–™ï¼Œæœç„¶å¤±è´¥äº†ï¼Œè¾“å‡ºçš„é”™è¯¯å’Œåœ¨3A4000ä¸Šç¼–è¯‘æ—¶çš„é”™è¯¯ä¹Ÿæœ‰ä¸€äº›ä¸åŒã€‚\nä¸‹é¢æ˜¯åœ¨3A4000ä¸Šç¼–è¯‘æ—¶è¾“å‡ºçš„é”™è¯¯ï¼š\nä¸‹é¢ä¸€è¡ŒæŠ¥é”™æ˜¯å·®ä¸å¤šçš„ï¼Œåœ¨loongarch64ä¸Šç¼–è¯‘å´å¤šäº†ä¸Šé¢ä¸€è¡ŒæŠ¥é”™ï¼Œæ„æ€å°±æ˜¯æ²¡æœ‰è¯†åˆ«å‡ºloongarch64æ¶æ„ã€‚\nä½†æ˜¯å…ˆä¸è¦æ…Œï¼Œè¿™é‡ŒåŒæ—¶ä¹Ÿç»™å‡ºäº†æŠ¥é”™çš„ä½ç½®ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹EpicsHostArch.plé‡Œå†™äº†äº›ä»€ä¹ˆã€‚\nshell \u0026#9660; 1 $ vi ./src/tools/EpicsHostArch.pl å®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªperlè„šæœ¬ï¼Œç”¨æ¥åˆ¤æ–­å½“å‰çš„ç³»ç»Ÿå’Œcpuæ¶æ„ï¼Œè€Œloongarch64æ˜¾ç„¶æ²¡æœ‰åšé€‚é…ï¼Œæ‰€ä»¥å°±å‡ºç°äº†ä¸Šé¢é”™è¯¯ã€‚\n\u0026ldquo;Architecture \u0026rsquo;loongarch64-linux-gnu-thread-multi\u0026rsquo; not recognized\u0026rdquo;\næ—¢ç„¶è¯†åˆ«ä¸äº†loongarch64ï¼Œé‚£æˆ‘ä»¬å°±æ‰‹åŠ¨æ·»åŠ ä¸€è¡Œï¼Œè®©å®ƒå¯ä»¥è¯†åˆ«å°±è¡Œäº†ï¼Œå³ä½¿çœ‹ä¸å¤ªæ‡‚ä¸Šé¢çš„è„šæœ¬ä¹Ÿæ²¡å…³ç³»ï¼Œçœ‹ä¸ªåŠæ‡‚å°±è¡Œäº†ã€‚\nperl \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 sub HostArch { my $arch = $Config{archname}; for ($arch) { return \u0026#39;linux-x86_64\u0026#39; if m/^x86_64-linux/; return \u0026#39;linux-x86\u0026#39; if m/^i[3-6]86-linux/; return \u0026#39;linux-arm\u0026#39; if m/^arm-linux/; return \u0026#39;linux-aarch64\u0026#39; if m/^aarch64-linux/; return \u0026#39;linux-ppc64\u0026#39; if m/^powerpc64-linux/; return \u0026#39;linux-loong64\u0026#39; if m/^loongarch64-linux/; return \u0026#39;windows-x64\u0026#39; if m/^MSWin32-x64/; return \u0026#39;win32-x86\u0026#39; if m/^MSWin32-x86/; return \u0026#34;cygwin-x86_64\u0026#34; if m/^x86_64-cygwin/; return \u0026#34;cygwin-x86\u0026#34; if m/^i[3-6]86-cygwin/; return \u0026#39;solaris-sparc\u0026#39; if m/^sun4-solaris/; return \u0026#39;solaris-x86\u0026#39; if m/^i86pc-solaris/; my ($kernel, $hostname, $release, $version, $cpu) = uname; if (m/^darwin/) { for ($cpu) { return \u0026#39;darwin-x86\u0026#39; if m/^x86_64/; return \u0026#39;darwin-aarch64\u0026#39; if m/^arm64/; } die \u0026#34;$0: macOS CPU type \u0026#39;$cpu\u0026#39; not recognized\\n\u0026#34;; } die \u0026#34;$0: Architecture \u0026#39;$arch\u0026#39; not recognized\\n\u0026#34;; } } æˆ‘ä»¬åœ¨ä¸Šé¢ä½ç½®æ·»åŠ ä¸€è¡Œå†…å®¹ï¼Œæ¥è®©å®ƒå¯ä»¥è¯†åˆ«loongarch64æ¶æ„ã€‚\ndiff \u0026#9660; 1 2 3 4 return \u0026#39;linux-aarch64\u0026#39; if m/^aarch64-linux/; return \u0026#39;linux-ppc64\u0026#39; if m/^powerpc64-linux/; + return \u0026#39;linux-loong64\u0026#39; if m/^loongarch64-linux/; return \u0026#39;windows-x64\u0026#39; if m/^MSWin32-x64/; æ­¤æ—¶æˆ‘ä»¬å†æ‰§è¡Œä¸€ä¸‹makeå‘½ä»¤ã€‚\nå¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨å·²ç»å¯ä»¥è¯†åˆ«å‡ºloongarch64-linuxäº†ï¼ŒæŠ¥é”™å’Œåœ¨3A4000ä¸Šç¼–è¯‘æ—¶ä¹ŸåŸºæœ¬ä¸€æ ·äº†ã€‚\nä»¥ä¸‹æ­¥éª¤åŒæ ·é€‚ç”¨äºåœ¨3A4000ï¼ˆmips64ï¼‰ä¸Šç¼–è¯‘EPICSï¼Œåªéœ€è¦å°†loong64å…¨éƒ¨æ›¿æ¢ä¸ºmips64\nå‰©ä¸‹çš„æŠ¥é”™å°±æ˜¯ï¼Œæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„ç¼–è¯‘é…ç½®é¡¹ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥ä»¿ç…§å·²ç»åšäº†é€‚é…çš„æ¶æ„æ¥æ”¹å†™ï¼Œç›´æ¥æŒ‰ç…§ä¸‹é¢æ­¥éª¤æ¥å°±å¯ä»¥äº†ã€‚\næ·»åŠ  CONFIG.Common.linux-loong64 shell \u0026#9660; 1 2 3 4 $ cd configure/os/ # æ·»åŠ  CONFIG.Common.linux-loong64 $ cp CONFIG.Common.linux-aarch64 CONFIG.Common.linux-loong64 $ vi CONFIG.Common.linux-loong64 ä¿®æ”¹æˆå¦‚ä¸‹å†…å®¹ï¼š\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 # CONFIG.Common.linux-loong64 # # Definitions for linux-loong64 target builds # Override these settings in CONFIG_SITE.Common.linux-loong64 #------------------------------------------------------- # Include definitions common to all Linux targets include $(CONFIG)/os/CONFIG.Common.linuxCommon ARCH_CLASS = loongarch ARCH_DEP_CFLAGS = $(GNU_ARCH_CFLAGS) $(GNU_TUNE_CFLAGS) ARCH_DEP_CFLAGS += $(GNU_DEP_CFLAGS) æ·»åŠ  CONFIG.linux-loong64.Common shell \u0026#9660; 1 2 3 # æ·»åŠ  CONFIG.linux-loong64.Common $ cp CONFIG.linux-aarch64.Common CONFIG.linux-loong64.Common $ vi CONFIG.linux-loong64.Common ä¿®æ”¹æˆå¦‚ä¸‹å†…å®¹(å†…å®¹æ²¡æœ‰å˜åŒ–ï¼Œå¯ä»¥ä¸ä¿®æ”¹)ï¼š\nshell \u0026#9660; 1 2 3 4 5 6 7 8 # CONFIG.linux-loong64.Common # # Definitions for linux-loong64 host builds # Sites may override these definitions in CONFIG_SITE.linux-loong64.Common #------------------------------------------------------- # Include definitions common to unix hosts include $(CONFIG)/os/CONFIG.UnixCommon.Common æ·»åŠ  CONFIG.linux-loong64.linux-loong64 shell \u0026#9660; 1 2 3 # æ·»åŠ  CONFIG.linux-loong64.linux-loong64 $ cp CONFIG.linux-aarch64.linux-aarch64 CONFIG.linux-loong64.linux-loong64 $ vi CONFIG.linux-loong64.linux-loong64 ä¿®æ”¹æˆå¦‚ä¸‹å†…å®¹(å†…å®¹æ²¡æœ‰å˜åŒ–ï¼Œå¯ä»¥ä¸ä¿®æ”¹)ï¼š\nshell \u0026#9660; 1 2 3 4 5 6 7 8 # CONFIG.linux-loong64.linux-loong64 # # Definitions for native linux-loong64 builds # Override these definitions in CONFIG_SITE.linux-loong64.linux-loong64 #------------------------------------------------------- # Include common gnu compiler definitions include $(CONFIG)/CONFIG.gnuCommon æ·»åŠ  CONFIG_SITE.Common.linux-loong64 shell \u0026#9660; 1 2 3 # æ·»åŠ  CONFIG_SITE.Common.linux-loong64 $ cp CONFIG_SITE.Common.linux-aarch64 CONFIG_SITE.Common.linux-loong64 $ vi CONFIG_SITE.Common.linux-loong64 ä¿®æ”¹æˆå¦‚ä¸‹å†…å®¹ã€‚\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 # CONFIG_SITE.Common.linux-loong64 # # Site Specific definitions for all linux-loong64 targets #------------------------------------------------------- # NOTE for SHARED_LIBRARIES: In most cases if this is set to YES the # shared libraries will be found automatically. However if the .so # files are installed at a different path to their compile-time path # then in order to be found at runtime do one of these: # a) LD_LIBRARY_PATH must include the full absolute pathname to # $(INSTALL_LOCATION)/lib/$(EPICS_HOST_ARCH) when invoking base # executables. # b) Add the runtime path to SHRLIB_DEPLIB_DIRS and PROD_DEPLIB_DIRS, which # will add the named directory to the list contained in the executables. # c) Add the runtime path to /etc/ld.so.conf and run ldconfig # to inform the system of the shared library location. # Depending on your version of Linux you\u0026#39;ll want one of the following # lines to enable command-line editing and history in iocsh. If you\u0026#39;re # not sure which, start with the top one and work downwards until the # build doesn\u0026#39;t fail to link the readline library. If none of them work, # comment them all out to build without readline support. # No other libraries needed (recent Fedora, Ubuntu etc.): #COMMANDLINE_LIBRARY = READLINE # Needs -lncurses (RHEL 5 etc.): #COMMANDLINE_LIBRARY = READLINE_NCURSES # Needs -lcurses (older versions) #COMMANDLINE_LIBRARY = READLINE_CURSES # Readline is broken or you don\u0026#39;t want use it: #COMMANDLINE_LIBRARY = EPICS # WARNING: Variables that are set in $(CONFIG)/CONFIG.gnuCommon cannot be # overridden in this file for native builds, e.g. variables such as # OPT_CFLAGS_YES, WARN_CFLAGS, SHRLIB_LDFLAGS # They must be set in CONFIG_SITE.linux-loong64.linux-loong64 or for # cross-builds in CONFIG_SITE.\u0026lt;host-arch\u0026gt;.linux-loong64 instead. # Tune GNU compiler output for a specific cpu-type # (e.g. loongarch64, la264, la364, la464 etc.) GNU_ARCH_CFLAGS = -march=loongarch64 GNU_TUNE_CFLAGS = -mtune=loongarch64 # Enable soft-float feature (e.g. none, 32, 64) GNU_DEP_CFLAGS = -mfpu=none æ·»åŠ  CONFIG_SITE.linux-loong64.linux-loong64 shell \u0026#9660; 1 2 3 # æ·»åŠ  CONFIG_SITE.linux-loong64.linux-loong64 $ cp CONFIG_SITE.linux-aarch64.linux-aarch64 CONFIG_SITE.linux-loong64.linux-loong64 $ vi CONFIG_SITE.linux-loong64.linux-loong64 ä¿®æ”¹æˆå¦‚ä¸‹å†…å®¹ï¼š\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 # CONFIG_SITE.linux-loong64.linux-loong64 # # Site specific definitions for native linux-loong64 builds #------------------------------------------------------- # It makes sense to include debugging symbols even in optimized builds # in case you want to attach gdb to the process or examine a core-dump. # This does cost disk space, but not memory as debug symbols are not # loaded into RAM when the binary is loaded. #OPT_CFLAGS_YES += -g #OPT_CXXFLAGS_YES += -g è¿™é‡Œæ˜¯å¯¹ç¼–è¯‘å™¨çš„ä¼˜åŒ–é€‰é¡¹ï¼Œæš‚æ—¶ä¸çŸ¥é“æ€ä¹ˆæ”¹ï¼Œæˆ‘å°±ç›´æ¥æ³¨é‡Šæ‰äº†ã€‚\né‡æ–°ç¼–è¯‘ åˆ°è¿™é‡Œå°±å…¨éƒ¨æ”¹å¥½äº†ï¼Œå…¶å®æœ€ä¸»è¦ä¿®æ”¹çš„å°±æ˜¯ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚ä¸‹é¢å°±å¯ä»¥å°è¯•ç¼–è¯‘äº†ï¼Œè¿™æ¬¡åº”è¯¥æ²¡é—®é¢˜äº†ã€‚\nshell \u0026#9660; 1 2 3 $ cd /usr/local/epics/base-7.0.7/ # æ‰§è¡Œ `make` å‘½ä»¤ $ make -j8 æ¥ä¸‹æ¥å°±é™é™ç­‰å¾…ç¼–è¯‘å®Œæˆã€‚\nç¼–è¯‘å®ŒåæŸ¥çœ‹ç¼–è¯‘è¾“å‡ºç›®å½•bin/linux-loong64/ï¼ˆæˆªå›¾æ¯”è¾ƒæ—§ï¼‰ã€‚\næ·»åŠ åˆ°PATH ä¸ºäº†æ–¹ä¾¿ä»¥åä½¿ç”¨ï¼Œæˆ‘ä»¬å°†ç¼–è¯‘è¾“å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶ç›®å½•æ·»åŠ åˆ°PATHã€‚\nshell \u0026#9660; 1 2 3 4 5 $ cd ~ $ mkdir .epics $ cd .epics/ $ touch env $ vi env ç¼–è¾‘ env å¦‚ä¸‹\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 #!/bin/sh # EPICS base shell setup export EPICS_BASE=\u0026#34;/usr/local/epics/base-7.0.7\u0026#34; export EPICS_HOST_ARCH=linux-loong64 # affix colons on either side of $PATH to simplify matching case \u0026#34;:${PATH}:\u0026#34; in *:\u0026#34;${EPICS_BASE}/bin/${EPICS_HOST_ARCH}\u0026#34;:*) ;; *) # Prepending path in case a system-installed epics needs to be overridden export PATH=\u0026#34;${EPICS_BASE}/bin/${EPICS_HOST_ARCH}:$PATH\u0026#34; ;; esac ç„¶åä¿®æ”¹ .bashrc\nshell \u0026#9660; 1 2 $ cd ~ $ vi .bashrc åœ¨æ–‡ä»¶æœ€åæ·»åŠ ä¸€è¡Œ\nshell \u0026#9660; 1 . \u0026#34;$HOME/.epics/env\u0026#34; æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼Œä½¿æ·»åŠ PATHç”Ÿæ•ˆ\nshell \u0026#9660; 1 $ . .bashrc è¿è¡ŒEPICS IOC åšå®Œä¸Šé¢çš„æ­¥éª¤ï¼ŒEPICS baseçš„é…ç½®å°±å®Œæˆäº†ï¼Œæˆ‘ä»¬æ¥å°è¯•è¿è¡Œä¸€ä¸‹ã€‚\nåœ¨ç»ˆç«¯æ‰§è¡ŒsoftIocã€‚\nè¿è¡Œæ­£å¸¸ï¼Œå¤§åŠŸå‘Šæˆï¼\nåªè¦baseå¯ä»¥æˆåŠŸè¿è¡Œï¼Œå…¶å®ƒçš„ä¸€äº›æ¨¡å—åº”è¯¥ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œåç»­æˆ‘ä¼šç»§ç»­å°è¯•åœ¨é¾™èŠ¯ä¸Šå®‰è£…EPICSå…¶å®ƒçš„æ¨¡å—ã€‚\né“¾æ¥ EPICS - Experimental Physics and Industrial Control System (anl.gov) epics-base - (launchpad.net) / epics-base/epics-base / EPICS Base (anl.gov) ","permalink":"https://kira-96.github.io/posts/%E9%BE%99%E8%8A%AF3a5000loongarch64%E4%B8%8A%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8Cepics/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eä¹‹å‰å°è¯•è¿‡åœ¨é¾™èŠ¯3A4000ä¸Šç¼–è¯‘è¿è¡ŒEPICSï¼Œç”±äº3A4000è¿˜æ˜¯\u003ccode\u003emips64\u003c/code\u003eæŒ‡ä»¤é›†ï¼Œè€Œ3A5000åˆ™æ˜¯é¾™èŠ¯çš„è‡ªä¸»æŒ‡ä»¤é›†\u003ccode\u003eloongarch64\u003c/code\u003eï¼Œé€‚é…èµ·æ¥æ­¥éª¤ä¹Ÿä¼šæœ‰æ‰€ä¸åŒã€‚\u003c/p\u003e\n\u003cp\u003eè¿™æ¬¡ä½¿ç”¨çš„æ˜¯é¾™åšç‰¹é¾™èŠ¯3A5000ç”µè„‘ä¸»æœºã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Loongson-3A5000-HV\" loading=\"lazy\" src=\"https://cdn.jsdelivr.net/gh/kira-96/Picture@main/blog/images/2023-02-01_12-58-17.png\"\u003e\u003c/p\u003e\n\u003cp\u003eè™½ç„¶EPICSå®˜æ–¹å¹¶æ²¡æœ‰é€‚é…\u003ccode\u003eloongarch\u003c/code\u003eå’Œ\u003ccode\u003emips64\u003c/code\u003eï¼Œæ— æ³•åšåˆ°å¼€ç®±å³ç”¨ï¼Œä½†åªè¦æœ‰gccã€g++ã€makeã€perlè¿™äº›å·¥å…·ï¼Œç†è®ºä¸Šå°±èƒ½ç¼–è¯‘è¿è¡ŒEPICSï¼Œåœ¨å¼€å§‹ç¼–è¯‘å‰ï¼Œç¡®ä¿ä½ çš„è®¾å¤‡ä¸Šå·²ç»è£…å¥½äº†è¿™äº›å·¥å…·ã€‚\u003c/p\u003e\n\u003cp\u003eå…³äºå¦‚ä½•ç§°å‘¼ã€Œé¾™æ¶æ„ã€ï¼Œé¾™èŠ¯ç¤¾åŒºä¹Ÿæœ‰ä¸€äº›è®¨è®ºã€‚æœ€åˆæˆ‘ç›´æ¥ä½¿ç”¨\u003ccode\u003eloongarch64\u003c/code\u003eï¼Œåæ¥ä¹Ÿä½¿ç”¨è¿‡\u003ccode\u003ela64\u003c/code\u003eä½œä¸ºç®€å†™ï¼Œç›´åˆ°æˆ‘çœ‹åˆ°\u003ca href=\"https://areweloongyet.com/docs/loong-or-loongarch/\"\u003eå¦‚ä½•ç§°å‘¼é¾™æ¶æ„ï¼Ÿ\u003c/a\u003eï¼Œæˆ‘è§‰å¾—æœ‰å¿…è¦å’Œç¤¾åŒºä¿æŒä¸€è‡´ï¼Œåç»­ç»Ÿä¸€ä½¿ç”¨ \u003cstrong\u003e\u003ccode\u003eloong64\u003c/code\u003e\u003c/strong\u003e ä½œä¸ºæ¶æ„æ ‡è¯†ã€‚\u003c/p\u003e\n\u003ch2 id=\"ä¸‹è½½-base\"\u003eä¸‹è½½ base\u003c/h2\u003e\n\u003cp\u003eè¿™é‡Œæˆ‘ä»¬å°±ä»¥ç›®å‰æœ€æ–°ç‰ˆæœ¬7.0.7ä¸ºä¾‹ï¼Œå…¶å®ƒç‰ˆæœ¬çš„Baseä¹Ÿç±»ä¼¼ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e ~/ä¸‹è½½/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ wget https://epics.anl.gov/download/base/base-7.0.7.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ tar -xzvf base-7.0.7.tar.gz\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eä½ å¯ä»¥åœ¨ä½ è§‰å¾—åˆé€‚çš„ä½ç½®ç¼–è¯‘å®‰è£…Baseï¼Œè¿™é‡ŒæŒ‰æˆ‘ä»¬çš„ä¹ æƒ¯ï¼Œæ”¾åœ¨\u003ccode\u003e/usr/local/epics\u003c/code\u003eç›®å½•ä¸‹ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ mkdir /usr/local/epics\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ mv base-7.0.7 /usr/local/epics/\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003ch1 id=\"ç¼–è¯‘\"\u003eç¼–è¯‘\u003c/h1\u003e\n\u003cp\u003eæŒ‰ç…§ä¸€èˆ¬æ­¥éª¤ï¼Œç°åœ¨å°±å¯ä»¥å¼€å§‹ç¼–è¯‘äº†ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆç»“æœã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003ecd\u003c/span\u003e /usr/local/epics/base-7.0.7/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# æ‰§è¡Œ `make` å‘½ä»¤\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ make\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003e\u003cimg alt=\"3A5000ç¼–è¯‘é”™è¯¯\" loading=\"lazy\" src=\"https://cdn.jsdelivr.net/gh/kira-96/Picture@main/blog/images/2023-02-01_13-04-33.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä¸å‡ºæ‰€æ–™ï¼Œæœç„¶å¤±è´¥äº†ï¼Œè¾“å‡ºçš„é”™è¯¯å’Œåœ¨3A4000ä¸Šç¼–è¯‘æ—¶çš„é”™è¯¯ä¹Ÿæœ‰ä¸€äº›ä¸åŒã€‚\u003c/p\u003e\n\u003cp\u003eä¸‹é¢æ˜¯åœ¨3A4000ä¸Šç¼–è¯‘æ—¶è¾“å‡ºçš„é”™è¯¯ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"3A4000ç¼–è¯‘é”™è¯¯\" loading=\"lazy\" src=\"https://cdn.jsdelivr.net/gh/kira-96/Picture@main/blog/images/localhost-usr-local-epics-base-7.0.7.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä¸‹é¢ä¸€è¡ŒæŠ¥é”™æ˜¯å·®ä¸å¤šçš„ï¼Œåœ¨\u003ccode\u003eloongarch64\u003c/code\u003eä¸Šç¼–è¯‘å´å¤šäº†ä¸Šé¢ä¸€è¡ŒæŠ¥é”™ï¼Œæ„æ€å°±æ˜¯æ²¡æœ‰è¯†åˆ«å‡º\u003ccode\u003eloongarch64\u003c/code\u003eæ¶æ„ã€‚\u003c/p\u003e\n\u003cp\u003eä½†æ˜¯å…ˆä¸è¦æ…Œï¼Œè¿™é‡ŒåŒæ—¶ä¹Ÿç»™å‡ºäº†æŠ¥é”™çš„ä½ç½®ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹\u003ccode\u003eEpicsHostArch.pl\u003c/code\u003eé‡Œå†™äº†äº›ä»€ä¹ˆã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ vi ./src/tools/EpicsHostArch.pl\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eå®ƒå…¶å®å°±æ˜¯ä¸€ä¸ª\u003ccode\u003eperl\u003c/code\u003eè„šæœ¬ï¼Œç”¨æ¥åˆ¤æ–­å½“å‰çš„ç³»ç»Ÿå’Œcpuæ¶æ„ï¼Œè€Œ\u003ccode\u003eloongarch64\u003c/code\u003eæ˜¾ç„¶æ²¡æœ‰åšé€‚é…ï¼Œæ‰€ä»¥å°±å‡ºç°äº†ä¸Šé¢é”™è¯¯ã€‚\u003c/p\u003e\n\n\n\n\u003cblockquote\u003e\n    \u003cp\u003e\u0026ldquo;Architecture \u0026rsquo;loongarch64-linux-gnu-thread-multi\u0026rsquo; not recognized\u0026rdquo;\u003c/p\u003e\n\n\u003c/blockquote\u003e\n\n\u003cp\u003eæ—¢ç„¶è¯†åˆ«ä¸äº†\u003ccode\u003eloongarch64\u003c/code\u003eï¼Œé‚£æˆ‘ä»¬å°±æ‰‹åŠ¨æ·»åŠ ä¸€è¡Œï¼Œè®©å®ƒå¯ä»¥è¯†åˆ«å°±è¡Œäº†ï¼Œå³ä½¿çœ‹ä¸å¤ªæ‡‚ä¸Šé¢çš„è„šæœ¬ä¹Ÿæ²¡å…³ç³»ï¼Œçœ‹ä¸ªåŠæ‡‚å°±è¡Œäº†ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"perl\"\u003eperl\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-perl\" data-lang=\"perl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003esub\u003c/span\u003e \u003cspan class=\"nf\"\u003eHostArch\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$arch\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$Config\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003earchname\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$arch\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;linux-x86_64\u0026#39;\u003c/span\u003e   \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^x86_64-linux/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;linux-x86\u0026#39;\u003c/span\u003e      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^i[3-6]86-linux/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;linux-arm\u0026#39;\u003c/span\u003e      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^arm-linux/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;linux-aarch64\u0026#39;\u003c/span\u003e  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^aarch64-linux/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;linux-ppc64\u0026#39;\u003c/span\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^powerpc64-linux/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;linux-loong64\u0026#39;\u003c/span\u003e  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^loongarch64-linux/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;windows-x64\u0026#39;\u003c/span\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^MSWin32-x64/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;win32-x86\u0026#39;\u003c/span\u003e      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^MSWin32-x86/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;cygwin-x86_64\u0026#34;\u003c/span\u003e  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^x86_64-cygwin/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;cygwin-x86\u0026#34;\u003c/span\u003e     \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^i[3-6]86-cygwin/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;solaris-sparc\u0026#39;\u003c/span\u003e  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^sun4-solaris/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;solaris-x86\u0026#39;\u003c/span\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^i86pc-solaris/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003emy\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$kernel\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$hostname\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$release\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$version\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$cpu\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003euname\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"sr\"\u003em/^darwin/\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$cpu\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;darwin-x86\u0026#39;\u003c/span\u003e     \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^x86_64/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#39;darwin-aarch64\u0026#39;\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"sr\"\u003em/^arm64/\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003edie\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;$0: macOS CPU type \u0026#39;$cpu\u0026#39; not recognized\\n\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003edie\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;$0: Architecture \u0026#39;$arch\u0026#39; not recognized\\n\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eæˆ‘ä»¬åœ¨ä¸Šé¢ä½ç½®æ·»åŠ ä¸€è¡Œå†…å®¹ï¼Œæ¥è®©å®ƒå¯ä»¥è¯†åˆ«\u003ccode\u003eloongarch64\u003c/code\u003eæ¶æ„ã€‚\u003c/p\u003e","title":"é¾™èŠ¯3A5000(LoongArch64)ä¸Šç¼–è¯‘è¿è¡ŒEPICS"},{"content":"å‰è¨€ ç”±äºæ¢äº†æ–°çš„å·¥ä½œï¼Œæˆ‘çš„å·¥ä½œæ–¹å‘ä¹Ÿæœ‰äº†å¾ˆå¤§çš„å˜åŒ–ï¼Œä¹‹å‰åŸºæœ¬ä¸Šæ˜¯å•çº¯çš„å†™ä»£ç ï¼Œç°åœ¨åˆ™ç»å¸¸éœ€è¦å’Œç¡¬ä»¶è®¾å¤‡äº¤äº’ï¼Œå¼€å‘å¹³å°ä¹Ÿè½¬åˆ°äº†Linux+Qtã€‚ç¡¬ä»¶è®¾å¤‡çš„æ§åˆ¶ï¼Œå…¶ä¸­æœ€åŸºæœ¬çš„å°±æ˜¯LEDç¯ä»¥åŠä¸€äº›å¼€å…³ç»§ç”µå™¨çš„æ“ä½œï¼Œå…¶æœ¬è´¨å°±æ˜¯GPIOçš„æ“ä½œã€‚è€ƒè™‘åˆ°ç³»ç»Ÿçš„ç²¾ç®€å’Œæˆæœ¬æ§åˆ¶ï¼Œæœ€å¥½æ˜¯å¯ä»¥ç›´æ¥é€šè¿‡Linuxç³»ç»Ÿå»æ§åˆ¶ï¼Œå½“ç„¶ä¹Ÿæœ‰å…¶å®ƒæ›¿ä»£æ–¹æ¡ˆï¼Œæ¯”å¦‚ä½¿ç”¨æ”¯æŒModbusåè®®çš„IOæ¨¡å—ã€‚å…³äºModbusçš„ä½¿ç”¨ï¼Œåé¢æœ‰ç©ºå†è®²ï¼Œè¿™é‡Œå°±è®°å½•ä¸€ä¸‹æœ€ç®€å•çš„Linuxç³»ç»Ÿä¸‹çš„GPIOæ§åˆ¶ï¼Œç”¨æˆ·ç©ºé—´ä¸‹çš„GPIOæ–‡ä»¶ç³»ç»Ÿæ¥å£ã€‚\nåœ¨æ­¤ä¹‹å‰ï¼Œæœ‰å¿…è¦å†äº†è§£ä¸€ä¸‹GPIOçš„æ¦‚å¿µã€‚\nâ€œé€šç”¨è¾“å…¥/è¾“å‡ºâ€ï¼ˆGPIOï¼‰æ˜¯ä¸€ç§çµæ´»çš„è½¯ä»¶æ§åˆ¶æ•°å­—ä¿¡å·ã€‚å®ƒä»¬ç”±å¤šç§èŠ¯ç‰‡æä¾›ï¼Œå¯¹äºä½¿ç”¨åµŒå…¥å¼å’Œå®šåˆ¶ç¡¬ä»¶çš„Linuxå¼€å‘äººå‘˜æ¥è¯´å¾ˆç†Ÿæ‚‰ã€‚æ¯ä¸ªGPIOä»£è¡¨ä¸€ä¸ªè¿æ¥åˆ°ç‰¹å®šå¼•è„šçš„ä½ï¼Œå³çƒæ …é˜µåˆ—ï¼ˆBGAï¼‰å°è£…ä¸Šçš„â€œçƒâ€ã€‚ç”µè·¯æ¿ç¤ºæ„å›¾æ˜¾ç¤ºäº†å“ªäº›å¤–éƒ¨ç¡¬ä»¶è¿æ¥åˆ°å“ªäº›GPIOã€‚é©±åŠ¨ç¨‹åºå¯ä»¥é€šç”¨åœ°ç¼–å†™ï¼Œä»¥ä¾¿æ¿è®¾ç½®ä»£ç å°†è¿™æ ·çš„å¼•è„šé…ç½®æ•°æ®ä¼ é€’ç»™é©±åŠ¨ç¨‹åºã€‚\nA â€œGeneral Purpose Input/Outputâ€ (GPIO) is a flexible software-controlled digital signal. They are provided from many kinds of chip, and are familiar to Linux developers working with embedded and custom hardware. Each GPIO represents a bit connected to a particular pin, or â€œballâ€ on Ball Grid Array (BGA) packages. Board schematics show which external hardware connects to which GPIOs. Drivers can be written generically, so that board setup code passes such pin configuration data to drivers.\nåœ¨å•ç‰‡æœºä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ§åˆ¶GPIOï¼Œä½†åœ¨åµŒå…¥å¼Linuxä¸Šåˆ™ä¸ä¸€æ ·ï¼Œé€šå¸¸GPIOå¯¹äºç”¨æˆ·æ¥è¯´æ˜¯ä¸å¯è§çš„ï¼Œä¸è¿‡Linuxç³»ç»Ÿä¹Ÿæä¾›äº†ç›¸åº”çš„æ¥å£ä¾›ç”¨æˆ·æ§åˆ¶GPIOï¼Œæ¯ä¸ªéä¸“ç”¨çš„å¼•è„šéƒ½å¯ä»¥ç”¨ä½œGPIOã€‚\né…ç½®IOå¤šè·¯å¤ç”¨å™¨ï¼ˆIOMUXCï¼‰ å°†éœ€è¦å¤ç”¨çš„IOæ·»åŠ åˆ°pinctrl_hogèŠ‚ç‚¹ï¼Œä¾‹ï¼š\nc \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 /* kernel/arch/arm64/boot/dts/freescale/OK8MP-C.dts */ \u0026amp;iomuxc { pinctrl-names = \u0026#34;default\u0026#34;; pinctrl-0 = \u0026lt;\u0026amp;pinctrl_hog\u0026gt;; pinctrl_hog: hoggrp { fsl,pins = \u0026lt; MX8MP_IOMUXC_HDMI_DDC_SCL__HDMIMIX_HDMI_SCL\t0x400001c3 MX8MP_IOMUXC_HDMI_DDC_SDA__HDMIMIX_HDMI_SDA\t0x400001c3 MX8MP_IOMUXC_HDMI_HPD__HDMIMIX_HDMI_HPD\t0x40000019 MX8MP_IOMUXC_HDMI_CEC__HDMIMIX_HDMI_CEC\t0x40000019 /* GPIO */ MX8MP_IOMUXC_GPIO1_IO07__GPIO1_IO07\t0x159 MX8MP_IOMUXC_GPIO1_IO09__GPIO1_IO09\t0x159 MX8MP_IOMUXC_GPIO1_IO12__GPIO1_IO12\t0x159 MX8MP_IOMUXC_ECSPI2_MOSI__GPIO5_IO11\t0x159 MX8MP_IOMUXC_ECSPI2_MISO__GPIO5_IO12\t0x159 MX8MP_IOMUXC_ECSPI2_SS0__GPIO5_IO13\t0x159 \u0026gt;; }; } å…·ä½“çš„GPIOåå­—è¦å‚ç…§xxxx-pinfunc.hé‡Œé¢çš„å®šä¹‰ï¼Œé…ç½®ä¸ºGPIOæ—¶ï¼Œä¸€å®šè¦ä½¿ç”¨IOMUXC_xxxx_xxxx__GPIOn_IOxxçš„å®å®šä¹‰ã€‚\nç„¶åæ˜¯åé¢çš„ä¸Šä¸‹æ‹‰é…ç½®ï¼Œå…·ä½“çš„è®¡ç®—æ–¹æ³•å’Œå‚æ•°æ„ä¹‰å¦‚ä¸‹ï¼š\nc \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 PAD_CTL_HYS (1 \u0026lt;\u0026lt; 16) /* Hysteresis æ»åä½¿èƒ½*/ PAD_CTL_PUS_100K_DOWN (0 \u0026lt;\u0026lt; 14) /* 100KOhm Pull Down */ PAD_CTL_PUS_47K_UP (1 \u0026lt;\u0026lt; 14) /* 47KOhm Pull Up */ PAD_CTL_PUS_100K_UP (2 \u0026lt;\u0026lt; 14) /* 100KOhm Pull Up */ PAD_CTL_PUS_22K_UP (3 \u0026lt;\u0026lt; 14) /* 22KOhm Pull Up */ PAD_CTL_PUE (1 \u0026lt;\u0026lt; 13) /* Pull / Keep Enable */ PAD_CTL_PKE (1 \u0026lt;\u0026lt; 12) /* Pull / Keep Select 0: Keeper 1: Pull */ PAD_CTL_ODE (1 \u0026lt;\u0026lt; 11) /* Open Drain Enable æ¼æå¼€è·¯ */ PAD_CTL_SPEED_LOW (1 \u0026lt;\u0026lt; 6) /* å¸¦å®½é…ç½® */ PAD_CTL_SPEED_MED (2 \u0026lt;\u0026lt; 6) PAD_CTL_SPEED_HIGH (3 \u0026lt;\u0026lt; 6) PAD_CTL_DSE_DISABLE (0 \u0026lt;\u0026lt; 3) /* Drive Strength Field é©±åŠ¨èƒ½åŠ› */ PAD_CTL_DSE_240ohm (1 \u0026lt;\u0026lt; 3) PAD_CTL_DSE_120ohm (2 \u0026lt;\u0026lt; 3) PAD_CTL_DSE_80ohm (3 \u0026lt;\u0026lt; 3) PAD_CTL_DSE_60ohm (4 \u0026lt;\u0026lt; 3) PAD_CTL_DSE_48ohm (5 \u0026lt;\u0026lt; 3) PAD_CTL_DSE_40ohm (6 \u0026lt;\u0026lt; 3) PAD_CTL_DSE_34ohm (7 \u0026lt;\u0026lt; 3) PAD_CTL_SRE_FAST (1 \u0026lt;\u0026lt; 0) /* Slew Rate Field å‹æ‘†ç‡ */ PAD_CTL_SRE_SLOW (0 \u0026lt;\u0026lt; 0) æ³¨æ„ï¼šä¸è¦ç›´æ¥è®¾ç½®ä¸º0ï¼Œæ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚å¯ä»¥ä½¿ç”¨0x80000000ï¼Œå®ƒè¡¨ç¤ºâ€œæˆ‘ä¸çŸ¥é“ï¼Œä¿æŒé»˜è®¤å€¼â€ã€‚\nç”¨æˆ·ç©ºé—´ä¸‹çš„GPIOè¯»å†™æ“ä½œ ç”¨æˆ·ç©ºé—´ä¸‹çš„GPIOæ–‡ä»¶ç³»ç»Ÿæ¥å£åœ¨/sys/class/gpio/ç›®å½•ä¸‹ã€‚\næ³¨æ„ï¼šä»¥ä¸‹æ“ä½œéƒ½éœ€è¦rootæƒé™ï¼\nä½¿èƒ½GPIO åœ¨æ­¤ä¹‹å‰ï¼Œéœ€è¦å…ˆçŸ¥é“GPIOå¯¹åº”çš„ç¼–å·æ•°å€¼ï¼Œè®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š\nGPIOn_IOx = (n - 1) Ã— 32 + x\nä¾‹ï¼šGPIO5_IO13 = (5 - 1) Ã— 32 + 13 = 141\næ‰§è¡Œå‘½ä»¤\nsh \u0026#9660; 1 2 3 # echo N \u0026gt; /sys/class/gpio/export # Nä¸ºGPIOå¯¹åº”çš„ç¼–å·ï¼Œä¾‹ï¼š echo 141 \u0026gt; /sys/class/gpio/export å¦‚æœéœ€è¦å–æ¶ˆä½¿èƒ½GPIOï¼Œåˆ™æ‰§è¡Œå‘½ä»¤\nsh \u0026#9660; 1 2 3 # echo N \u0026gt; /sys/class/gpio/unexport # Nä¸ºGPIOå¯¹åº”çš„ç¼–å·ï¼Œä¾‹ï¼š echo 141 \u0026gt; /sys/class/gpio/unexport GPIOé…ç½® ä½¿èƒ½GPIOä¹‹åï¼Œ/sys/class/gpio/ç›®å½•ä¸‹å°±å¤šå‡ºæ¥äº†ç›¸åº”çš„GPIOèŠ‚ç‚¹ç›®å½•ã€‚ä¾‹ï¼šgpio141\nGPIOèŠ‚ç‚¹æœ‰ä»¥ä¸‹å±æ€§å¯ä»¥é…ç½®ï¼š\n/sys/class/gpio/gpioN/\ndirection\nè¯»å–ä¸ºinæˆ–è€…outã€‚é€šå¸¸å¯ä»¥å†™å…¥æ­¤å€¼ã€‚å†™å…¥outé»˜è®¤è¾“å‡ºä¸ºä½ã€‚ä¸ºäº†ç¡®ä¿æ“ä½œæ— è¯¯ï¼Œå¯ä»¥å†™å…¥å€¼â€œlowâ€å’Œâ€œhighâ€å°†GPIOé…ç½®ä¸ºå…·æœ‰è¯¥åˆå§‹å€¼çš„è¾“å‡ºã€‚\nè¯·æ³¨æ„ï¼Œå¦‚æœå†…æ ¸ä¸æ”¯æŒæ›´æ”¹GPIOçš„æ–¹å‘ï¼Œæˆ–è€…è¯¥å±æ€§æ˜¯ç”±å†…æ ¸ä»£ç å¯¼å‡ºçš„ï¼Œè€Œå†…æ ¸ä»£ç æ²¡æœ‰æ˜ç¡®å…è®¸ç”¨æˆ·ç©ºé—´é‡æ–°é…ç½®è¯¥GPIOæ–¹å‘ï¼Œåˆ™è¯¥å±æ€§å°†ä¸å­˜åœ¨ã€‚\nvalue\nè¯»å–ä¸º0ï¼ˆlowï¼‰æˆ–1ï¼ˆhighï¼‰ã€‚å¦‚æœGPIOè¢«é…ç½®ä¸ºè¾“å‡ºï¼Œåˆ™å¯ä»¥å†™å…¥è¯¥å€¼ï¼›ä»»ä½•éé›¶å€¼éƒ½è¢«è§†ä¸ºé«˜ã€‚\nå¦‚æœå¼•è„šå¯ä»¥é…ç½®ä¸ºä¸­æ–­ç”Ÿæˆï¼Œå¹¶ä¸”å®ƒå·²ç»é…ç½®ä¸ºç”Ÿæˆä¸­æ–­ï¼ˆè¯·å‚é˜…â€œedgeâ€çš„æè¿°ï¼‰ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥å¯¹è¯¥æ–‡ä»¶è¿›è¡Œè½®è¯¢ï¼ˆpollï¼‰ï¼Œæ¯å½“è§¦å‘ä¸­æ–­æ—¶ï¼Œè½®è¯¢ï¼ˆpollï¼‰å°†è¿”å›ã€‚å¦‚æœä½¿ç”¨pollï¼Œè¯·è®¾ç½®äº‹ä»¶ä¸ºPOLLPRIå’ŒPOLLERRã€‚å¦‚æœä½¿ç”¨selectï¼Œåˆ™å°†æ–‡ä»¶æè¿°ç¬¦è®¾ç½®ä¸ºexceptfdsã€‚è½®è¯¢è¿”å›åï¼Œè¦ä¹ˆlseekåˆ°sysfsæ–‡ä»¶çš„å¼€å¤´å¹¶è¯»å–æ–°å€¼ï¼Œè¦ä¹ˆå…³é—­æ–‡ä»¶å¹¶é‡æ–°æ‰“å¼€ä»¥è¯»å–å€¼ã€‚\nedge\nè¯»å–ä¸ºnoneã€risingã€fallingæˆ–è€…bothã€‚ç¼–å†™è¿™äº›å­—ç¬¦ä¸²ä»¥é€‰æ‹©å°†å¯¹â€œvalueâ€æ–‡ä»¶è¿”å›è¿›è¡Œè½®è¯¢çš„ä¿¡å·è¾¹ç¼˜ã€‚\nä»…å½“å¼•è„šå¯ä»¥é…ç½®ä¸ºä¸­æ–­ç”Ÿæˆè¾“å…¥å¼•è„šæ—¶ï¼Œæ­¤å±æ€§æ‰å­˜åœ¨ã€‚\nactive_low\nè¯»å–ä¸º0ï¼ˆå‡ï¼‰æˆ–1ï¼ˆçœŸï¼‰ã€‚å†™å…¥ä»»ä½•éé›¶å€¼ä»¥åè½¬è¯»å–å’Œå†™å…¥çš„å€¼å±æ€§ã€‚ç°æœ‰å’Œåç»­è½®è¯¢æ”¯æŒé€šè¿‡è¾¹ç¼˜å±æ€§é…ç½®â€œrisingâ€å’Œâ€œfallingâ€è¾¹ç¼˜å°†éµå¾ªæ­¤è®¾ç½®ã€‚\nä¾‹ï¼š\nå°†GPIOé…ç½®ä¸ºè¾“å‡º\nsh \u0026#9660; 1 echo out \u0026gt; /sys/class/gpio/gpio{N}/direction å°†GPIOé…ç½®ä¸ºè¾“å…¥ï¼Œä¸Šå‡æ²¿è§¦å‘ä¸­æ–­\nsh \u0026#9660; 1 2 echo in \u0026gt; /sys/class/gpio/gpio{N}/direction echo rising \u0026gt; /sys/class/gpio/gpio{N}/edge GPIOè¯»å†™ GPIOé…ç½®ä¸ºè¾“å…¥ï¼ˆinï¼‰æ—¶ï¼Œåªèƒ½è¯»å–è¾“å…¥å€¼ï¼Œä¸èƒ½å†™å…¥\nGPIOé…ç½®ä¸ºè¾“å‡ºï¼ˆoutï¼‰æ—¶ï¼Œå¯ä»¥è¯»å–å½“å‰å€¼å’Œå†™å…¥æ–°å€¼\nsh \u0026#9660; 1 2 3 4 5 # è¯»å–æ—¶ cat /sys/class/gpio/gpio{N}/value # å†™å…¥æ—¶ echo 0 \u0026gt; /sys/class/gpio/gpio{N}/value echo 1 \u0026gt; /sys/class/gpio/gpio{N}/value ç¨‹åºæ§åˆ¶GPIO ç¤ºä¾‹è¯»å–ï¼š\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 int readGpio(unsigned short io) { QFile file(QString(\u0026#34;/sys/class/gpio/gpio%1/value\u0026#34;).arg(io)); if (!file.open(QIODevice::ReadOnly)) return 0; QByteArray ba = file.readAll(); file.close(); return QString(ba).toInt(); } ç¤ºä¾‹å†™å…¥ï¼š\ncpp \u0026#9660; 1 2 3 4 5 6 bool writeGpio(unsigned short io, unsigned char value) { char buf[128]; sprintf(buf, \u0026#34;echo %d \u0026gt; /sys/class/gpio/gpio%d/value\u0026#34;, value, io); return ::system(buf) == 0; } å‚è€ƒ\nLegacy GPIO Interfaces GPIO Sysfs Interface for Userspace Definitive GPIO guide ","permalink":"https://kira-96.github.io/posts/linux-gpio%E6%93%8D%E4%BD%9C%E5%85%B6%E4%B8%80/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eç”±äºæ¢äº†æ–°çš„å·¥ä½œï¼Œæˆ‘çš„å·¥ä½œæ–¹å‘ä¹Ÿæœ‰äº†å¾ˆå¤§çš„å˜åŒ–ï¼Œä¹‹å‰åŸºæœ¬ä¸Šæ˜¯å•çº¯çš„å†™ä»£ç ï¼Œç°åœ¨åˆ™ç»å¸¸éœ€è¦å’Œç¡¬ä»¶è®¾å¤‡äº¤äº’ï¼Œå¼€å‘å¹³å°ä¹Ÿè½¬åˆ°äº†Linux+Qtã€‚ç¡¬ä»¶è®¾å¤‡çš„æ§åˆ¶ï¼Œå…¶ä¸­æœ€åŸºæœ¬çš„å°±æ˜¯LEDç¯ä»¥åŠä¸€äº›å¼€å…³ç»§ç”µå™¨çš„æ“ä½œï¼Œå…¶æœ¬è´¨å°±æ˜¯GPIOçš„æ“ä½œã€‚è€ƒè™‘åˆ°ç³»ç»Ÿçš„ç²¾ç®€å’Œæˆæœ¬æ§åˆ¶ï¼Œæœ€å¥½æ˜¯å¯ä»¥ç›´æ¥é€šè¿‡Linuxç³»ç»Ÿå»æ§åˆ¶ï¼Œå½“ç„¶ä¹Ÿæœ‰å…¶å®ƒæ›¿ä»£æ–¹æ¡ˆï¼Œæ¯”å¦‚ä½¿ç”¨æ”¯æŒModbusåè®®çš„IOæ¨¡å—ã€‚å…³äºModbusçš„ä½¿ç”¨ï¼Œåé¢æœ‰ç©ºå†è®²ï¼Œè¿™é‡Œå°±è®°å½•ä¸€ä¸‹æœ€ç®€å•çš„Linuxç³»ç»Ÿä¸‹çš„GPIOæ§åˆ¶ï¼Œ\u003cstrong\u003eç”¨æˆ·ç©ºé—´ä¸‹çš„GPIOæ–‡ä»¶ç³»ç»Ÿæ¥å£\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨æ­¤ä¹‹å‰ï¼Œæœ‰å¿…è¦å†äº†è§£ä¸€ä¸‹GPIOçš„æ¦‚å¿µã€‚\u003c/p\u003e\n\u003cp\u003eâ€œé€šç”¨è¾“å…¥/è¾“å‡ºâ€ï¼ˆGPIOï¼‰æ˜¯ä¸€ç§çµæ´»çš„è½¯ä»¶æ§åˆ¶æ•°å­—ä¿¡å·ã€‚å®ƒä»¬ç”±å¤šç§èŠ¯ç‰‡æä¾›ï¼Œå¯¹äºä½¿ç”¨åµŒå…¥å¼å’Œå®šåˆ¶ç¡¬ä»¶çš„Linuxå¼€å‘äººå‘˜æ¥è¯´å¾ˆç†Ÿæ‚‰ã€‚æ¯ä¸ªGPIOä»£è¡¨ä¸€ä¸ªè¿æ¥åˆ°ç‰¹å®šå¼•è„šçš„ä½ï¼Œå³çƒæ …é˜µåˆ—ï¼ˆBGAï¼‰å°è£…ä¸Šçš„â€œçƒâ€ã€‚ç”µè·¯æ¿ç¤ºæ„å›¾æ˜¾ç¤ºäº†å“ªäº›å¤–éƒ¨ç¡¬ä»¶è¿æ¥åˆ°å“ªäº›GPIOã€‚é©±åŠ¨ç¨‹åºå¯ä»¥é€šç”¨åœ°ç¼–å†™ï¼Œä»¥ä¾¿æ¿è®¾ç½®ä»£ç å°†è¿™æ ·çš„å¼•è„šé…ç½®æ•°æ®ä¼ é€’ç»™é©±åŠ¨ç¨‹åºã€‚\u003c/p\u003e\n\n\n\n\u003cblockquote\u003e\n    \u003cp\u003eA â€œGeneral Purpose Input/Outputâ€ (GPIO) is a flexible software-controlled digital signal. They are provided from many kinds of chip, and are familiar to Linux developers working with embedded and custom hardware. Each GPIO represents a bit connected to a particular pin, or â€œballâ€ on Ball Grid Array (BGA) packages. Board schematics show which external hardware connects to which GPIOs. Drivers can be written generically, so that board setup code passes such pin configuration data to drivers.\u003c/p\u003e","title":"Linux GPIO æ“ä½œå…¶ä¸€"},{"content":"é—®é¢˜æè¿° åœ¨ä½¿ç”¨ WSL æ›´æ–°è½¯ä»¶åŒ…çš„æ—¶å€™ç»å¸¸ä¼šé‡åˆ°è¿™æ ·ä¸€ä¸ªæŠ¥é”™\nshell \u0026#9660; 1 /sbin/ldconfig.real: /usr/lib/wsl/lib/libcuda.so.1 is not a symbolic link æ„æ€æ˜¯è¯´ /usr/lib/wsl/lib/libcuda.so.1 ä¸æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ã€‚\né—®é¢˜åˆ†æ é€šè¿‡åå­—å¯ä»¥åˆ¤æ–­è¿™åº”è¯¥æ˜¯nVidiaæ˜¾å¡é©±åŠ¨ç›¸å…³çš„åº“ï¼Œè¿›å…¥ /usr/lib/wsl/lib/ ç›®å½•ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ libcuda.soã€libcuda.so.1ã€libcuda.so.1.1 ä¸‰ä¸ªæ–‡ä»¶ï¼Œéƒ½æ˜¯æ–‡ä»¶å½¢å¼ï¼Œè€Œé€šè¿‡æŠ¥é”™æˆ‘ä»¬çŸ¥é“ libcuda.soã€libcuda.so.1 åº”è¯¥æ˜¯ç¬¦å·é“¾æ¥æ–‡ä»¶ã€‚\nå®ƒä»¬å…³ç³»åº”è¯¥æ˜¯ï¼š\nlibcuda.so -\u0026gt; libcuda.so.1 -\u0026gt; libcuda.so.1.1\nçŸ¥é“åŸå› å°±å¥½è§£å†³äº†ï¼ŒæŠŠ libcuda.soã€libcuda.so.1 åˆ æ‰ï¼Œå†é‡æ–°åˆ›å»ºç¬¦å·é“¾æ¥å°±å¯ä»¥äº†ã€‚\nshell \u0026#9660; 1 2 ubuntu@dell:/usr/lib/wsl/lib$ sudo rm libcuda.so rm: æ— æ³•åˆ é™¤ \u0026#39;libcuda.so\u0026#39;: åªè¯»æ–‡ä»¶ç³»ç»Ÿ å¾ˆé—æ†¾ï¼Œè¿™æ ·æ˜¯ä¸è¡Œçš„ã€‚æœ€åç»è¿‡å¤šæ–¹æŸ¥æ‰¾ï¼Œç»ˆäºæ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆã€‚\nè§£å†³æ–¹æ³• è§£å†³æ–¹æ³•å°±æ˜¯ä¸Šé¢çš„æ–¹æ³•ï¼Œä½†ä¸æ˜¯åœ¨ WSL ä¸­æ“ä½œã€‚\nä½¿ç”¨ç®¡ç†å‘˜æƒé™æ‰§è¡Œ cmd å‘½ä»¤:\npowershell \u0026#9660; 1 2 3 4 5 C:\u0026gt;cd C:\\Windows\\System32\\lxss\\lib C:\\Windows\\System32\\lxss\\lib\u0026gt;del /s /q \u0026#34;libcuda.so\u0026#34; C:\\Windows\\System32\\lxss\\lib\u0026gt;del /s /q \u0026#34;libcuda.so.1\u0026#34; C:\\Windows\\System32\\lxss\\lib\u0026gt;mklink libcuda.so.1 libcuda.so.1.1 C:\\Windows\\System32\\lxss\\lib\u0026gt;mklink libcuda.so libcuda.so.1 æˆ–è€…åœ¨Powershellä¸­æ‰§è¡Œï¼š\npowershell \u0026#9660; 1 2 3 4 5 6 cd C:\\Windows\\System32\\lxss\\lib rm libcuda.so rm libcuda.so.1 wsl -e /bin/bash ln -s libcuda.so.1.1 libcuda.so.1 ln -s libcuda.so.1.1 libcuda.so ç„¶ååœ¨ wsl ä¸­æ‰§è¡Œ:\nshell \u0026#9660; 1 $ sudo ldconfig å‚è€ƒ\nldconfig: /usr/lib/wsl/lib/libcuda.so.1 is not a symbolic link libcuda.so.1 is not a symbolic link #5548 ","permalink":"https://kira-96.github.io/posts/wsl-libcuda.so.1-is-not-a-symbolic-link-%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/","summary":"\u003ch2 id=\"é—®é¢˜æè¿°\"\u003eé—®é¢˜æè¿°\u003c/h2\u003e\n\u003cp\u003eåœ¨ä½¿ç”¨ WSL æ›´æ–°è½¯ä»¶åŒ…çš„æ—¶å€™ç»å¸¸ä¼šé‡åˆ°è¿™æ ·ä¸€ä¸ªæŠ¥é”™\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"shell\"\u003eshell\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/sbin/ldconfig.real: /usr/lib/wsl/lib/libcuda.so.1 is not a symbolic link\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eæ„æ€æ˜¯è¯´ \u003ccode\u003e/usr/lib/wsl/lib/libcuda.so.1\u003c/code\u003e ä¸æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ã€‚\u003c/p\u003e\n\u003ch2 id=\"é—®é¢˜åˆ†æ\"\u003eé—®é¢˜åˆ†æ\u003c/h2\u003e\n\u003cp\u003eé€šè¿‡åå­—å¯ä»¥åˆ¤æ–­è¿™åº”è¯¥æ˜¯nVidiaæ˜¾å¡é©±åŠ¨ç›¸å…³çš„åº“ï¼Œè¿›å…¥ \u003ccode\u003e/usr/lib/wsl/lib/\u003c/code\u003e ç›®å½•ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ \u003ccode\u003elibcuda.so\u003c/code\u003eã€\u003ccode\u003elibcuda.so.1\u003c/code\u003eã€\u003ccode\u003elibcuda.so.1.1\u003c/code\u003e ä¸‰ä¸ªæ–‡ä»¶ï¼Œéƒ½æ˜¯æ–‡ä»¶å½¢å¼ï¼Œè€Œé€šè¿‡æŠ¥é”™æˆ‘ä»¬çŸ¥é“ \u003ccode\u003elibcuda.so\u003c/code\u003eã€\u003ccode\u003elibcuda.so.1\u003c/code\u003e åº”è¯¥æ˜¯ç¬¦å·é“¾æ¥æ–‡ä»¶ã€‚\u003c/p\u003e","title":"WSL libcuda.so.1 is not a symbolic link çš„è§£å†³æ–¹æ³•"},{"content":"å‰è¨€ ç”±äºè¿™åŠå¹´æ¥ä¸€ç›´åœ¨åšåµŒå…¥å¼Linuxç³»ç»Ÿè½¯ä»¶å¼€å‘å·¥ä½œï¼Œæ‰€ä»¥ç»å¸¸å’ŒåµŒå…¥å¼è®¾å¤‡æ‰“äº¤é“ï¼Œæœ€æ—©æ¥è§¦çš„åµŒå…¥å¼Linuxåº”è¯¥å°±æ˜¯æ ‘è“æ´¾äº†ï¼Œè€Œæˆ‘çš„æ ‘è“æ´¾ä¸€èˆ¬ä¹Ÿä¸æ¥å±å¹•ï¼ŒåŸºæœ¬ä¸Šéƒ½ä½¿ç”¨VNCè¿œç¨‹è¿æ¥ï¼Œæ‰€ä»¥å°±æƒ³ç€èƒ½ä¸èƒ½æŠŠVNCä¹Ÿç§»æ¤åˆ°åµŒå…¥å¼è®¾å¤‡ä¸Šï¼Œæœ€åæ‰¾åˆ°äº†x11vncã€‚\nVNCï¼ˆè™šæ‹Ÿç½‘ç»œè®¡ç®—ï¼‰æ˜¯ä¸€ç§éå¸¸æœ‰ç”¨çš„ç½‘ç»œå›¾å½¢åè®®ï¼ˆåº”ç”¨ç¨‹åºåœ¨ä¸€å°è®¡ç®—æœºä¸Šè¿è¡Œï¼Œä½†åœ¨å¦ä¸€å°è®¡ç®—æœºä¸Šæ˜¾ç¤ºå…¶çª—å£ï¼‰ï¼Œä½†ä¸Xä¸åŒï¼ŒæŸ¥çœ‹ç«¯éå¸¸ç®€å•ï¼Œä¸ä¿æŒä»»ä½•çŠ¶æ€ã€‚å®ƒæ˜¯ä¸€ç§è¿œç¨‹å¸§ç¼“å†²åŒºï¼ˆRFBï¼‰åè®®ã€‚\nx11vncå…è®¸ç”¨æˆ·é€šè¿‡ä»»ä½•VNC viewerè¿œç¨‹æŸ¥çœ‹å¹¶ä¸real Xæ˜¾ç¤ºå™¨ï¼ˆå³ä¸ç‰©ç†ç›‘è§†å™¨ã€é”®ç›˜å’Œé¼ æ ‡ç›¸å¯¹åº”çš„æ˜¾ç¤ºå™¨ï¼‰äº¤äº’ã€‚\nå‡†å¤‡å·¥ä½œ éœ€è¦å…ˆç”¨gitå…‹éš†ä¸‹é¢ä¸¤ä¸ªä»“åº“ï¼Œlibvncserverå’Œx11vncã€‚ x11vncæ˜¯åŸºäºlibvncserverçš„æœåŠ¡ç«¯ç¨‹åºã€‚\nGitHub - LibVNC/libvncserver: LibVNCServer/LibVNCClient are cross-platform C libraries that allow you to easily implement VNC server or client functionality in your program. GitHub - LibVNC/x11vnc: a VNC server for real X displays ç¼–è¯‘ libvncserver ç¼–è¯‘x11vncéœ€è¦libvncserverï¼ŒlibvncserveræŒ‰ç…§ README ç¼–è¯‘å³å¯\nshell \u0026#9660; 1 2 3 4 mkdir build cd build cmake .. cmake --build . ç¼–è¯‘å®Œæˆåå°†buildæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆçš„.soæ–‡ä»¶å¤åˆ¶åˆ° sysroot\nä¾‹ï¼š\nshell \u0026#9660; 1 2 3 4 5 6 7 # å¤åˆ¶ .so æ–‡ä»¶ $ sudo cp ./libvncclient.so* /opt/fsl-imx-x11/4.1.15-2.0.0/sysroots/cortexa7hf-neon-poky-linux-gnueabi/usr/lib/ # å¤åˆ¶ pkgconfig æ–‡ä»¶ $ sudo cp ./libvnc*.pc /opt/fsl-imx-x11/4.1.15-2.0.0/sysroots/cortexa7hf-neon-poky-linux-gnueabi/usr/lib/pkgconfig/ # å¤åˆ¶å¤´æ–‡ä»¶ $ sudo cp -r ../rfb /opt/fsl-imx-x11/4.1.15-2.0.0/sysroots/cortexa7hf-neon-poky-linux-gnueabi/usr/include/ $ sudo cp ./rfb/rfbconfig.h /opt/fsl-imx-x11/4.1.15-2.0.0/sysroots/cortexa7hf-neon-poky-linux-gnueabi/usr/include/rfb/ ç¼–è¯‘ x11vnc x11vnc éœ€è¦ä½¿ç”¨ autoconf å’Œ automake ç”Ÿæˆ configure å’Œ makefile\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 $ cd x11vnc-master # ä½¿ç”¨aclocalå·¥å…·ç”Ÿæˆaclocal.m4 $ aclocal # ä½¿ç”¨autoconfå·¥å…·ç”Ÿæˆconfigureæ–‡ä»¶ $ autoconf # ä½¿ç”¨autoheaderå·¥å…·ç”Ÿæˆconfig.h.inæ–‡ä»¶ $ autoheader # ä½¿ç”¨automakeç”ŸæˆMakefile.inæ–‡ä»¶ $ automake --add-missing # configure é…ç½®äº¤å‰ç¼–è¯‘ï¼Œå¦‚æœlibvncserveræ²¡æœ‰æ­£ç¡®ç¼–è¯‘å®‰è£…ï¼Œè¿™é‡Œä¼šæç¤ºæ‰¾ä¸åˆ°libvncserver $ ./configure CC=arm-poky-linux-gnueabi-gcc AR=arm-poky-linux-gnueabi-ar AS=arm-poky-linux-gnueabi-as LD=arm-poky-linux-gnueabi-ld --host=arm-poky-linux --prefix=/home/ubuntu/ CFLAGS=\u0026#34;-march=armv7ve -mfpu=neon -mfloat-abi=hard -mcpu=cortex-a7 --sysroot=/opt/fsl-imx-x11/4.1.15-2.0.0/sysroots/cortexa7hf-neon-poky-linux-gnueabi\u0026#34; # ç¼–è¯‘å®‰è£… $ make install å®‰è£…å®Œæˆååœ¨ /home/ubuntu/ ï¼ˆconfigure æ­¥éª¤è®¾ç½®çš„ \u0026ndash;prefixï¼‰ç›®å½•ä¸‹å‡ºç°äº†binå’Œ shareä¸¤ä¸ªç›®å½•ï¼Œbinç›®å½•ä¸‹çš„å°±æ˜¯ x11vnc çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚\nå®‰è£…è¿è¡Œ å°† libvncserver ç¼–è¯‘å¾—åˆ°çš„ *.so æ–‡ä»¶å’Œ x11vnc å¯æ‰§è¡Œæ–‡ä»¶å¤åˆ¶åˆ°å¼€å‘æ¿å³å¯ã€‚\nshell \u0026#9660; 1 2 3 4 # å¤åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ $ scp -r /home/ubuntu/bin root@192.168.10.7:~/ # å¤åˆ¶ libvncserver $ scp /opt/fsl-imx-x11/4.1.15-2.0.0/sysroots/cortexa7hf-neon-poky-linux-gnueabi/usr/lib/libvnc*.so.0.9.13 root@192.168.10.7:/usr/lib/ sshç™»å½•å¼€å‘æ¿\nshell \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 # åˆ›å»ºç¬¦å·é“¾æ¥ root@imx6ulevk:~# ln -s /usr/lib/libvncclient.so.0.9.13 /usr/lib/libvncclient.so.1 root@imx6ulevk:~# ln -s /usr/lib/libvncclient.so.1 /usr/lib/libvncclient.so root@imx6ulevk:~# ln -s /usr/lib/libvncserver.so.0.9.13 /usr/lib/libvncserver.so.1 root@imx6ulevk:~# ln -s /usr/lib/libvncserver.so.1 /usr/lib/libvncserver.so # é‡å‘½åæ–‡ä»¶å¤¹ root@imx6ulevk:~# mv ~/bin ~/x11vnc root@imx6ulevk:~# cd ~/x11vnc root@imx6ulevk:~# chmod +x ./x11vnc # è¿è¡Œ x11vnc # x11vnc -display :0 root@imx6ulevk:~# ./x11vnc ç„¶ååœ¨ç”µè„‘ä¸Šå¯åŠ¨ VNC Viewer, è¾“å…¥å¼€å‘æ¿çš„ipåœ°å€å°±å¯ä»¥é€šè¿‡è¿œç¨‹æ¡Œé¢è®¿é—®è®¾å¤‡äº†ã€‚\nå®é™…è¿è¡Œæ•ˆæœå¦‚å›¾\nå‚è€ƒ\nautoconf / automakeå·¥å…·ä½¿ç”¨ä»‹ç» ç»™imx6åµŒå…¥å¼å¹³å°ç§»æ¤x11vncæ­å»ºè¿œç¨‹æ§åˆ¶ç¯å¢ƒ ","permalink":"https://kira-96.github.io/posts/%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E9%80%82%E7%94%A8%E4%BA%8E-imx6ul-%E7%9A%84-x11vnc/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eç”±äºè¿™åŠå¹´æ¥ä¸€ç›´åœ¨åšåµŒå…¥å¼Linuxç³»ç»Ÿè½¯ä»¶å¼€å‘å·¥ä½œï¼Œæ‰€ä»¥ç»å¸¸å’ŒåµŒå…¥å¼è®¾å¤‡æ‰“äº¤é“ï¼Œæœ€æ—©æ¥è§¦çš„åµŒå…¥å¼Linuxåº”è¯¥å°±æ˜¯æ ‘è“æ´¾äº†ï¼Œè€Œæˆ‘çš„æ ‘è“æ´¾ä¸€èˆ¬ä¹Ÿä¸æ¥å±å¹•ï¼ŒåŸºæœ¬ä¸Šéƒ½ä½¿ç”¨VNCè¿œç¨‹è¿æ¥ï¼Œæ‰€ä»¥å°±æƒ³ç€èƒ½ä¸èƒ½æŠŠVNCä¹Ÿç§»æ¤åˆ°åµŒå…¥å¼è®¾å¤‡ä¸Šï¼Œæœ€åæ‰¾åˆ°äº†\u003ccode\u003ex11vnc\u003c/code\u003eã€‚\u003c/p\u003e","title":"äº¤å‰ç¼–è¯‘é€‚ç”¨äº iMX6UL çš„ x11vnc"},{"content":"å¼€å§‹ä¸€ä»½æ–°å·¥ä½œ å¥½ä¹…æ²¡æœ‰æ›´æ–°åšå®¢äº†ï¼Œæœ€è¿‘å‡ ä¸ªæœˆéƒ½åœ¨å¿™æ–°å·¥ä½œçš„äº‹æƒ…ï¼Œè™½ç„¶åªæ˜¯çŸ­çŸ­3ä¸ªæœˆï¼Œä½†å›æƒ³èµ·æ¥å·²ç»æ˜¯å¾ˆä¹…ä¹‹å‰äº†ã€‚ä»4æœˆä»½é¢è¯•ï¼Œç„¶åä½“æ£€ï¼Œæäº¤å„ç§ææ–™è¯æ˜ï¼Œåˆ°5æœˆä»½å·¥ä½œäº¤æ¥ï¼Œ6æœˆä»½æ­£å¼ç¦»èŒè¿›å…¥æ–°å•ä½ï¼Œæ¬å®¶ç­‰ç­‰ï¼Œè¿™å‡ ä¸ªæœˆçœŸæ˜¯å¿™çš„æœ‰ç‚¹å–˜ä¸è¿‡æ°”ã€‚å³ä½¿åˆ°äº†æ–°çš„å•ä½ï¼Œä¹Ÿæ²¡æœ‰é—²ä¸‹æ¥çš„æ—¶é—´ï¼Œæ¥äº†ä¹‹åå°±è¦ä¸Šæ‰‹åšé¡¹ç›®ï¼Œåˆ°è¿™å‘¨ä¸ºæ­¢ï¼Œé¡¹ç›®æ€»ç®—åˆæ­¥å®Œæˆï¼Œè¿™æ‰æœ‰æ—¶é—´æ¥è‡ªæˆ‘æ•´ç†ä¸€ä¸‹ã€‚å³ä½¿5æœˆä»½ä¹°äº†PS5æ¸¸æˆæœºä¹Ÿæ²¡æ€ä¹ˆæœ‰æ—¶é—´ç©ï¼Œæ²¡ä»€ä¹ˆæ¸¸æˆæ˜¯ä¸€æ–¹é¢ï¼Œå¿™ä¹Ÿæ˜¯ä¸€æ–¹é¢ã€‚\nä¸ºä»€ä¹ˆè¦æ¢å·¥ä½œ å…¶å®è¿™ä¸ªé—®é¢˜æˆ‘ä¹Ÿä¸€ç›´åœ¨æ€è€ƒï¼ŒåŒ…æ‹¬åœ¨åˆ°äº†æ–°å•ä½ä¹‹åï¼Œçœ‹åˆ°åˆ°æ‰‹å°‘å¾—å¯æ€œçš„å·¥èµ„ï¼Œæˆ‘ä¹Ÿåœ¨é—®è‡ªå·±ï¼Œä¸ºä»€ä¹ˆè¦æ¢å·¥ä½œï¼Ÿ\næ€»çš„æ¥è¯´ï¼Œä¸Šä¸€å®¶å…¬å¸ç»™æˆ‘çš„å°è±¡è¿˜æ˜¯æŒºä¸é”™çš„ï¼Œå¤§å­¦æ¯•ä¸šåï¼Œå½“æ—¶æ²¡æœ‰æ‰¾åˆ°ä¸€ä»½å¥½çš„å·¥ä½œï¼Œæ˜¯å®ƒæ¥çº³äº†æˆ‘ï¼Œè¿™ä¸‰å¹´æ¥ï¼Œæˆ‘ä¹Ÿåœ¨å…¬å¸å­¦åˆ°äº†å¾ˆå¤šï¼Œå’ŒåŒäº‹ç›¸å¤„ä¹Ÿè¿˜éƒ½ä¸é”™ï¼Œæ‰€ä»¥å†³å®šä»é‚£é‡Œç¦»å¼€ï¼Œæˆ‘ä¹Ÿæ˜¯ä¸‹äº†å¾ˆå¤§çš„å†³å¿ƒã€‚\næœ€ä¸»è¦çš„åŸå› è¿˜æ˜¯æˆ‘æ¸´æœ›åšä¸€äº›æ›´æœ‰åˆ›é€ æ€§çš„å†…å®¹ï¼Œè€Œä¸æ˜¯æ•´å¤©çš„ä¿®ä¿®è¡¥è¡¥ï¼Œè™½ç„¶ä¿®bugä¹Ÿæ˜¯ç¨‹åºå‘˜çš„ä¸€é¡¹é‡è¦å·¥ä½œï¼Œä½†æ¯å¤©éƒ½é¢å¯¹ç€ç›¸åŒçš„å†…å®¹ï¼Œéš¾å…ä¼šè®©äººå¿ƒç”ŸåŒå€¦ã€‚å¾ˆå¤šæ—¶å€™æˆ‘éƒ½ä¼šæƒ³ï¼Œè‡ªå·±æ˜¯ä¸æ˜¯ä¼šä¸€ç›´è¿™æ ·å¾…ä¸‹å»ï¼Œåœ¨åŒä¸€å®¶å…¬å¸ä¸€ç›´å·¥ä½œï¼Œç›´åˆ°é€€ä¼‘ï¼Œè¿™å¯èƒ½æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä½†æˆ‘ä¸æƒ³åšä¸€ä¸ªæ•´å¤©é—²ç€çš„äººï¼Œæ€§æ ¼ä½¿ç„¶ï¼Œæˆ‘è¿™ä¸€ç”Ÿå¯èƒ½æ³¨å®šæ˜¯å¿™ç¢Œçš„ï¼Œæˆ‘æ¸´æœ›æ¥è§¦å’Œå­¦ä¹ æ–°çš„çŸ¥è¯†ï¼Œè€Œä¸æ˜¯ä¸€ç›´å¾…åœ¨å®‰ä¹çªé‡Œï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©èµ°å‡ºå»ï¼Œè§è¯†ä¸€ä¸‹æ›´å¹¿é˜”çš„å¤©åœ°ã€‚\nå…³äºæ–°å·¥ä½œ æ–°å·¥ä½œåœ¨ä¸Šæµ·ï¼Œä¸€ä¸ªç ”ç©¶æ‰€é‡Œï¼Œé™¤äº†å·¥èµ„ï¼Œå…¶å®ƒéƒ½è¿˜å¯ä»¥ï¼Œä½†å‡ºæ¥æ‰“å·¥ï¼Œå·¥èµ„ä¸æ‰æ˜¯æœ€é‡è¦çš„å—ï¼Ÿç›®å‰å·¥ä½œäº†åˆšå¥½ä¸€ä¸ªæœˆï¼Œå·¥èµ„åˆ°æ‰‹4kå¤šï¼Œæ®è¯´è¿˜æ˜¯ä¸¤ä¸ªæœˆçš„ï¼Œè¿™è®©æˆ‘çœŸçš„éš¾ä»¥æ¥å—ï¼Œè¦ä¸æ˜¯è‡ªå·±è¿˜æœ‰ç‚¹å­˜æ¬¾ï¼Œæ—¥å­çœŸæ˜¯æ²¡æ³•æ··äº†ã€‚\nä»¥ä¸Šæ˜¯åæ§½ï¼Œ6æœˆä»½ä»ä¸Šä¸€å®¶å…¬å¸ç¦»èŒï¼Œä¼‘æ¯äº†ä¸€å¤©å°±åˆ°æ–°å•ä½æŠ¥åˆ°ï¼Œç¬¬äºŒä¸ªæ˜ŸæœŸå°±ç›´æ¥ä¸Šæ‰‹åšé¡¹ç›®ï¼Œå¯ä»¥è¯´æ˜¯èµ¶å¾—å¾ˆç´§äº†ã€‚è€Œå…³äºå·¥ä½œçš„å†…å®¹ï¼Œç›®å‰æ˜¯åœ¨åšåµŒå…¥å¼Linuxæ–¹å‘çš„è½¯ä»¶ï¼Œä¹‹å‰æ²¡æœ‰åšè¿‡Linuxå¹³å°çš„è½¯ä»¶å¼€å‘ï¼Œä¸€ç›´éƒ½æ˜¯Windowså¹³å°ï¼Œä½†ç”±äºæœ‰äº†ä¸€äº›å·¥ä½œç»éªŒï¼Œæ‰€ä»¥ä¸Šæ‰‹å…¶å®å¾ˆå¿«ï¼Œæ€»ä¹‹å°±æ˜¯ä¸€è¾¹å­¦ä¹ ä¸€è¾¹åšé¡¹ç›®ï¼Œç»“åˆè‡ªå·±ä»¥å‰çš„å¼€å‘ç»éªŒï¼Œå…¶å®åŠ¨æ‰‹åšèµ·æ¥å¹¶ä¸éš¾ã€‚ä¸­é—´ä¹Ÿæœ‰é‡åˆ°ä¸€äº›é—®é¢˜ï¼Œå› ä¸ºæ˜¯åšåµŒå…¥å¼å¼€å‘ï¼Œæ‰€ä»¥éš¾å…ä¼šæ¶‰åŠåˆ°å¦‚ä½•æ§åˆ¶èŠ¯ç‰‡ç®¡è„šè¾“å‡ºï¼Œé€šè¿‡ç®¡è„šè¾“å‡ºæ¥æ§åˆ¶å¤–å›´è®¾å¤‡ï¼Œè¿™äº›æ¶‰åŠåˆ°ç¡¬ä»¶é¢†åŸŸçš„å†…å®¹æˆ‘å…¶å®å¹¶ä¸åœ¨è¡Œï¼Œè™½ç„¶å¤§å­¦æ—¶å€™å­¦è¿‡å•ç‰‡æœºç›¸å…³çš„è¯¾ç¨‹ï¼Œä½†åœ¨Linuxç³»ç»Ÿä¸­æ§åˆ¶èŠ¯ç‰‡å’Œç›´æ¥ç¼–ç¨‹æ§åˆ¶èŠ¯ç‰‡å¼•è„šè¿˜æ˜¯æœ‰å¾ˆå¤§çš„ä¸åŒçš„ï¼Œæ‰€ä»¥è‡ªå·±ä¹Ÿåœ¨å‘¨æœ«æŠ½æ—¶é—´å­¦ä¹ ç›¸å…³çš„å†…å®¹ã€‚\næ€»çš„æ¥è¯´ï¼Œè¿™ä¸€ä¸ªæœˆæ¥å­¦åˆ°çš„æ–°ä¸œè¥¿è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œæ¯å¤©éƒ½å¿™ç¢Œç€å­¦ä¹ å’Œå·¥ä½œï¼Œè¿˜æ˜¯å¾ˆå……å®çš„ï¼ŒåŒæ—¶æ–°çš„å·¥ä½œç¯å¢ƒï¼Œä¹Ÿè®©æˆ‘æ¥è§¦åˆ°äº†æ›´å¤šé¢†åŸŸçš„äººï¼Œè¿™åˆä½•å°ä¸æ˜¯ä¸€ç§è¿›æ­¥å‘¢ï¼Ÿ\nä½†æ˜¯ï¼Œæ–°å·¥ä½œæ˜¯çœŸçš„ç´¯ï¼Œè¿™ä¸€ä¸ªæœˆçš„é¡¹ç›®åšä¸‹æ¥ï¼Œæ„Ÿè§‰è‡ªå·±æœ‰ç‚¹åƒä¸æ¶ˆï¼Œè™½ç„¶æœ‰å®‰æ’ç»„å‘˜ä¸€èµ·å·¥ä½œï¼Œä½†æˆ‘å¯¹ä»–ä»¬çš„å·¥ä½œæˆæœå¹¶ä¸æ»¡æ„ï¼Œä»¥åæœ‰å¿…è¦è¿›è¡Œä¸€äº›æŒ‡å¯¼ï¼Œæ€»æ˜¯ä¸€ä¸ªäººåšä¼šå¾ˆç´¯å¾ˆç´¯ï¼Œè€Œä¸”ç°åœ¨é¡¹ç›®ä¹Ÿæ¯”è¾ƒå¤šï¼Œäººæ‰‹ä¹Ÿä¸å¤Ÿã€‚\nä¸ªäººæ„Ÿè§‰åœ¨æ–°å•ä½è¿˜æ˜¯æœ‰å¾ˆå¤§çš„å‘å±•ç©ºé—´çš„ï¼Œå› ä¸ºè¿™é‡Œä½¿ç”¨çš„æŠ€æœ¯éƒ½ç›¸å¯¹è¦è½åï¼Œè‡ªå·±å¯ä»¥å‘æŒ¥ä»¥å‰å­¦åˆ°çš„ä¸€äº›é¡¹ç›®ç®¡ç†çš„ç»éªŒï¼Œç§¯æ”’æ›´å¤šçš„ç»éªŒï¼Œå¯¹äºæŠ€æœ¯äººå‘˜æ¥è¯´æ‰æ˜¯æˆé•¿ã€‚\næœ€å ç”±äºå·¥ä½œçš„æ–¹å‘æ¢äº†ï¼Œæ‰€ä»¥ä»¥åå¯èƒ½ä¼šå†™ä¸€äº›åµŒå…¥å¼å¼€å‘ç›¸å…³çš„å†…å®¹ï¼Œè¿˜æœ‰Qtä¹‹ç±»çš„ä¸€äº›å­¦ä¹ ç»éªŒï¼Œæ€»ä¹‹ï¼Œéšå­¦éšè®°ï¼Œä¸å®šæœŸæ›´æ–°ã€‚\n","permalink":"https://kira-96.github.io/posts/%E5%BC%80%E5%A7%8B%E4%B8%80%E4%BB%BD%E6%96%B0%E5%B7%A5%E4%BD%9C/","summary":"\u003ch2 id=\"å¼€å§‹ä¸€ä»½æ–°å·¥ä½œ\"\u003eå¼€å§‹ä¸€ä»½æ–°å·¥ä½œ\u003c/h2\u003e\n\u003cp\u003eå¥½ä¹…æ²¡æœ‰æ›´æ–°åšå®¢äº†ï¼Œæœ€è¿‘å‡ ä¸ªæœˆéƒ½åœ¨å¿™æ–°å·¥ä½œçš„äº‹æƒ…ï¼Œè™½ç„¶åªæ˜¯çŸ­çŸ­3ä¸ªæœˆï¼Œä½†å›æƒ³èµ·æ¥å·²ç»æ˜¯å¾ˆä¹…ä¹‹å‰äº†ã€‚ä»4æœˆä»½é¢è¯•ï¼Œç„¶åä½“æ£€ï¼Œæäº¤å„ç§ææ–™è¯æ˜ï¼Œåˆ°5æœˆä»½å·¥ä½œäº¤æ¥ï¼Œ6æœˆä»½æ­£å¼ç¦»èŒè¿›å…¥æ–°å•ä½ï¼Œæ¬å®¶ç­‰ç­‰ï¼Œè¿™å‡ ä¸ªæœˆçœŸæ˜¯å¿™çš„æœ‰ç‚¹å–˜ä¸è¿‡æ°”ã€‚å³ä½¿åˆ°äº†æ–°çš„å•ä½ï¼Œä¹Ÿæ²¡æœ‰é—²ä¸‹æ¥çš„æ—¶é—´ï¼Œæ¥äº†ä¹‹åå°±è¦ä¸Šæ‰‹åšé¡¹ç›®ï¼Œåˆ°è¿™å‘¨ä¸ºæ­¢ï¼Œé¡¹ç›®æ€»ç®—åˆæ­¥å®Œæˆï¼Œè¿™æ‰æœ‰æ—¶é—´æ¥è‡ªæˆ‘æ•´ç†ä¸€ä¸‹ã€‚å³ä½¿5æœˆä»½ä¹°äº†PS5æ¸¸æˆæœºä¹Ÿæ²¡æ€ä¹ˆæœ‰æ—¶é—´ç©ï¼Œæ²¡ä»€ä¹ˆæ¸¸æˆæ˜¯ä¸€æ–¹é¢ï¼Œå¿™ä¹Ÿæ˜¯ä¸€æ–¹é¢ã€‚\u003c/p\u003e","title":"å¼€å§‹ä¸€ä»½æ–°å·¥ä½œ"},{"content":"è®¡ç®—åˆ‡ç‰‡é—´è·çš„æ–¹æ³•ï¼š\nå¯¹äºCTæ‰«æå‡ºçš„æ–­å±‚å›¾åƒï¼Œæ²¡æœ‰å­˜å‚¨Spacing Between Slicesä¿¡æ¯ï¼Œä½†å¯ä»¥åˆ©ç”¨ä½ç½®ä¿¡æ¯è®¡ç®—å¾—åˆ°ã€‚\néœ€è¦å…ˆè¯»å–ç›¸é‚»ä¸¤å±‚åˆ‡ç‰‡çš„ä½ç½®ä¿¡æ¯ï¼Œå‡è®¾ä¸ºpos1å’Œpos2ï¼Œç„¶åè®¡ç®—ä¸¤ä¸ªä½ç½®çš„è·ç¦»å³ä¸ºåˆ‡ç‰‡é—´è·ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 // double pos1[3], pos2[3]; double spacing = sqrt( (pos1[0] - pos2[0]) * (pos1[0] - pos2[0]) + (pos1[1] - pos2[1]) * (pos1[1] - pos2[1]) + (pos1[2] - pos2[2]) * (pos1[2] - pos2[2])); ","permalink":"https://kira-96.github.io/notes/calculate-spacing-between-slices/","summary":"\u003cp\u003eè®¡ç®—åˆ‡ç‰‡é—´è·çš„æ–¹æ³•ï¼š\u003c/p\u003e\n\u003cp\u003eå¯¹äºCTæ‰«æå‡ºçš„æ–­å±‚å›¾åƒï¼Œæ²¡æœ‰å­˜å‚¨\u003cstrong\u003eSpacing Between Slices\u003c/strong\u003eä¿¡æ¯ï¼Œä½†å¯ä»¥åˆ©ç”¨ä½ç½®ä¿¡æ¯è®¡ç®—å¾—åˆ°ã€‚\u003c/p\u003e\n\u003cp\u003eéœ€è¦å…ˆè¯»å–ç›¸é‚»ä¸¤å±‚åˆ‡ç‰‡çš„ä½ç½®ä¿¡æ¯ï¼Œå‡è®¾ä¸º\u003ccode\u003epos1\u003c/code\u003eå’Œ\u003ccode\u003epos2\u003c/code\u003eï¼Œç„¶åè®¡ç®—ä¸¤ä¸ªä½ç½®çš„è·ç¦»å³ä¸ºåˆ‡ç‰‡é—´è·ã€‚\u003c/p\u003e","title":"Calculate Spacing Between Slices"},{"content":"å‰è¨€ The Medical Imaging Interaction Toolkit (MITK)æ˜¯ä¸€ä¸ªå…è´¹çš„å¼€æºè½¯ä»¶ï¼Œç”¨äºå¼€å‘äº¤äº’å¼åŒ»å­¦å½±åƒå¤„ç†è½¯ä»¶ã€‚æœ€è¿‘çªç„¶å®‰æ’æˆ‘åšç›¸å…³çš„ä¸€äº›å·¥ä½œï¼Œé¦–å…ˆå°±è¦ä»ç¼–è¯‘å¼€å§‹ï¼Œå½“ç„¶å®˜ç½‘ä¹Ÿæœ‰ç¼–è¯‘å¥½çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½ä½¿ç”¨ã€‚æœ¬æ¥åœ¨Windowsä¸Šç¼–è¯‘è¿™ç§å¼€æºçš„è½¯ä»¶å°±å¾ˆéº»çƒ¦ï¼Œåœ¨åŠ ä¸Šgithubä¸Šçš„ä¸œè¥¿ä¸‹è½½å·¨æ…¢ï¼Œå¸¸å¸¸å‡ºé”™ï¼ŒæŠ˜è…¾äº†å¥½ä¹…æ‰ç¼–è¯‘å®Œæˆï¼Œè¿™é‡Œå°±è®°å½•ä¸€ä¸‹è¸©è¿‡çš„é‚£äº›å‘ã€‚\nå‡†å¤‡å·¥ä½œ Visual Studio 2017 CMake (\u0026gt;=3.19) Qt 5.12.10 (\u0026gt;=5.12.9) Python3 Git OpenSSL å®‰è£…åŒ… Doxygen MITK MITK-Diffusion æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯Visual Studio 2017ç‰ˆæœ¬ï¼Œ2019åº”è¯¥ä¹Ÿå¯ä»¥ã€‚\nQtéœ€è¦å®‰è£…5.12.9ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œå®˜æ–¹ç¼–è¯‘ä¼¼ä¹ç”¨çš„5.12.10ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œä¹Ÿé€‰æ‹©5.12.10ç‰ˆæœ¬ï¼Œå®‰è£…è¿‡ç¨‹ä¸­å°½é‡æŠŠæ‰€æœ‰ç»„ä»¶éƒ½é€‰ä¸Šï¼Œå› ä¸ºç¼–è¯‘æ—¶ä¼šä½¿ç”¨åˆ°å¾ˆå¤šç»„ä»¶ã€‚\nCMakeï¼ŒPythonï¼ŒOpenSSLéƒ½é€‰æ‹©64ä½ç‰ˆæœ¬å®‰è£…ã€‚\næœ€åå°±æ˜¯ç”¨gitå…‹éš†ä¸‹MITKå’ŒMITK-Diffusionçš„ä»“åº“ã€‚\nç”±äºMITKåœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­ä¼šä¸‹è½½ä¸€äº›ç¬¬ä¸‰æ–¹çš„è½¯ä»¶åŒ…ï¼Œæ‰€ä»¥è¦èƒ½å…‹éš†githubä¸Šçš„ä»“åº“æ‰è¡Œï¼Œæœ€å¥½æœ‰æ¢¯å­ï¼Œæˆ‘å°±æ˜¯è¿™é‡Œå¡äº†å¾ˆä¹…ã€‚\nCMake ç›¸å…³é…ç½® åœ¨MITKä»“åº“ç›®å½•ä¸‹æ–°å»ºbuildæ–‡ä»¶å¤¹ï¼ˆåå­—å¯ä»¥éšæ„ï¼‰ï¼Œç„¶åæ‰“å¼€cmake GUIå·¥å…·ï¼Œå¡«å†™source codeå’Œbuildæ–‡ä»¶å¤¹è·¯å¾„ ç‚¹å‡»ConfigureæŒ‰é’®ï¼Œç¬¬ä¸€æ¬¡ä¼šå¼¹å‡ºå¯¹è¯æ¡†é€‰æ‹©ç¼–è¯‘å™¨ï¼Œæ ¹æ®éœ€è¦é…ç½®å³å¯ï¼Œè¿™é‡Œé€‰æ‹©msvc-2017ï¼Œx64 æ­¤æ—¶ä¼šå‡ºç°é”™è¯¯æç¤ºï¼Œæ‰¾ä¸åˆ°Qtï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½®ä¸€ä¸‹Qt5çš„è·¯å¾„ï¼Œæ‰¾åˆ°Qt5_DIRé¡¹ï¼Œåœ¨Valueä¸­å¡«å†™è·¯å¾„ï¼Œä¾‹ï¼šD:/Qt/Qt5.12.10/msvc2017_64/lib/cmake/Qt5ï¼Œå†æ¬¡ç‚¹å‡»ConfigureæŒ‰é’® æ£€æŸ¥æ˜¯å¦æ‰€æœ‰çš„å®‰è£…è·¯å¾„éƒ½æ­£ç¡®è¢«æ£€æµ‹åˆ°ï¼ˆQtï¼ŒOpenSSLï¼‰ï¼Œç¡®ä¿æ²¡æœ‰é€‰é¡¹æ˜¯çº¢è‰² å¦‚æœåªéœ€è¦ç¼–è¯‘MITKï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è·³åˆ°ç¬¬9æ­¥ æ‰¾åˆ°MITK_EXTENSION_DIRSé€‰é¡¹ï¼Œåœ¨Valueä¸­å¡«å†™MITK-Diffusionä»“åº“çš„è·¯å¾„ï¼Œå†æ¬¡ç‚¹å‡»ConfigureæŒ‰é’® æ‰¾åˆ°MITK_BUILD_CONFIGURATIONé€‰é¡¹ï¼ŒValueè®¾ç½®ä¸ºDiffusionReleaseï¼Œå†æ¬¡ç‚¹å‡»ConfigureæŒ‰é’® æ­¤æ—¶ä¸‹æ–¹è¾“å‡ºä¼šæŠ¥é”™ï¼Œæç¤ºæ‰¾ä¸åˆ°NumPyï¼Œéœ€è¦å…ˆå®‰è£…pythonåº“NumPyï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œpip3 install --user NumPyï¼Œå®Œæˆåå†æ¬¡ç‚¹å‡»ConfigureæŒ‰é’®ï¼Œç¡®ä¿æ²¡æœ‰é”™è¯¯ï¼Œæ²¡æœ‰é€‰é¡¹æ˜¯çº¢è‰² ç‚¹å‡»GenerateæŒ‰é’®ï¼Œä¸‹æ–¹è¾“å‡ºGenerating doneä¹‹åï¼Œç‚¹å‡»Open ProjectæŒ‰é’® é™„ä¸Šæˆ‘çš„é…ç½®ï¼š\nç¼–è¯‘ ç›´æ¥ç¼–è¯‘ALL_BUILDé¡¹ç›®å³å¯ï¼Œä½†æ­¤æ—¶ç¼–è¯‘å¯èƒ½ä¼šæœ‰ä¸€å †è«åå¥‡å¦™çš„é”™è¯¯ï¼Œå¯ä»¥å…ˆåˆ°MITKä»“åº“ç›®å½•ä¸‹æ‰¾åˆ°CMakeExternalsç›®å½•ï¼Œç„¶åå°†é‡Œé¢æ‰€æœ‰çš„æ–‡ä»¶æ¢è¡Œç¬¦æ”¹ä¸ºWindowsä¸‹çš„æ¢è¡Œç¬¦ï¼ˆCRLFï¼‰ï¼Œå¯ä»¥ä½¿ç”¨VS Codeæˆ–è€…Notepad++ç­‰å·¥å…·ï¼Œè¿‡ç¨‹ä¼šæœ‰ç‚¹æ¯ç‡¥ã€‚\nç¡®ä¿ç½‘ç»œå¯ç”¨ï¼Œæœ€å¥½æœ‰å›½å¤–æœ‹å‹å¸®å¿™ï¼Œå› ä¸ºç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šä¸‹è½½å¾ˆå¤šgithubä¸Šçš„ä»“åº“ï¼Œæ²¡æœ‰å›½å¤–æœ‹å‹å¸®å¿™å¾ˆå®¹æ˜“å‡ºé”™ã€‚ç¼–è¯‘ALL_BUILDé¡¹ç›®ï¼Œç¬¬ä¸€æ¬¡ç¼–è¯‘ä¼šéå¸¸æ…¢ï¼Œé€šå¸¸éœ€è¦å‡ ä¸ªå°æ—¶ï¼Œå»ºè®®å…ˆå»å¿™ç‚¹å…¶å®ƒäº‹æƒ…ã€‚\nç¼–è¯‘è¿‡ç¨‹ä¸­ç»å¸¸ä¼šé‡åˆ°è­¦å‘Šè¢«è§†ä¸ºé”™è¯¯ï¼Œæ²¡æœ‰ç”Ÿæˆobjectï¼Œå¯¼è‡´ç¼–è¯‘å‡ºé”™ï¼ŒåŒå‡»é”™è¯¯ï¼Œæ‰“å¼€é”™è¯¯æ–‡ä»¶ï¼Œç„¶åå†æ‰¾åˆ°é”™è¯¯æ–‡ä»¶çš„ä½ç½®ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œé€‰æ‹©æ–‡ä»¶â†’å¦å­˜ä¸ºï¼Œé€‰æ‹©ä¿å­˜ç¼–ç ä¸ºUnicodeï¼Œå†æ¬¡ç¼–è¯‘ã€‚\nåœ¨ç¼–è¯‘MITK-Diffusionçš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›ç±»å‹è½¬æ¢çš„æŠ¥é”™ï¼Œå¦‚æ— æ³•å°†itk::Pointè½¬æ¢ä¸ºmitk::PointSet::PointTypeç­‰ï¼Œå¯èƒ½ä¸€äº›ç¼–è¯‘å™¨èƒ½é€šè¿‡ï¼Œä½†msvcä¼šæŠ¥é”™ï¼Œåªéœ€è¦ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼Œå°†å‡ºé”™çš„å‚æ•°å¼ºåˆ¶è½¬æ¢æˆå¯¹åº”ç±»å‹å³å¯ï¼Œå¦‚ï¼šmitk::PointSet::PointType(itkPoint)ã€‚\né‡å¤3ã€4è‹¥å¹²æ¬¡ï¼Œç›´åˆ°ç¼–è¯‘æˆåŠŸã€‚\nç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶åœ¨build/MITK-build/binç›®å½•ä¸‹ã€‚\n","permalink":"https://kira-96.github.io/posts/build-mitk-on-windows/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.mitk.org/\"\u003eThe Medical Imaging Interaction Toolkit (MITK)\u003c/a\u003eæ˜¯ä¸€ä¸ªå…è´¹çš„å¼€æºè½¯ä»¶ï¼Œç”¨äºå¼€å‘äº¤äº’å¼åŒ»å­¦å½±åƒå¤„ç†è½¯ä»¶ã€‚æœ€è¿‘çªç„¶å®‰æ’æˆ‘åšç›¸å…³çš„ä¸€äº›å·¥ä½œï¼Œé¦–å…ˆå°±è¦ä»ç¼–è¯‘å¼€å§‹ï¼Œå½“ç„¶å®˜ç½‘ä¹Ÿæœ‰ç¼–è¯‘å¥½çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½ä½¿ç”¨ã€‚æœ¬æ¥åœ¨Windowsä¸Šç¼–è¯‘è¿™ç§å¼€æºçš„è½¯ä»¶å°±å¾ˆéº»çƒ¦ï¼Œåœ¨åŠ ä¸Šgithubä¸Šçš„ä¸œè¥¿ä¸‹è½½å·¨æ…¢ï¼Œå¸¸å¸¸å‡ºé”™ï¼ŒæŠ˜è…¾äº†å¥½ä¹…æ‰ç¼–è¯‘å®Œæˆï¼Œè¿™é‡Œå°±è®°å½•ä¸€ä¸‹è¸©è¿‡çš„é‚£äº›å‘ã€‚\u003c/p\u003e","title":"åœ¨ Windows ä¸Šç¼–è¯‘ MITK"},{"content":"å‰è¨€ ä»Šå¤©å¶ç„¶çœ‹åˆ°ä¸€ä¸ªæ–°çš„å¼€æºçš„gitæœåŠ¡è½¯ä»¶Giteaï¼Œä¸€çœ‹åˆ°ç•Œé¢ï¼Œç¬é—´å°±çˆ±äº†ï¼Œå› ä¸ºä¹‹å‰æˆ‘è‡ªå·±ç”¨çš„æ˜¯gitblitï¼Œç•Œé¢æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯ç”¨æ¥ç®¡ç†å…¬å¸çš„ä¸€äº›å°é¡¹ç›®ã€‚ä»Šå¤©çœ‹åˆ°Giteaä¹‹åï¼Œå°±å†³å®šè¿ç§»åˆ°è¿‡å»ï¼Œç®€å•æŠ˜è…¾äº†ä¸€ä¸‹ï¼Œé…ç½®èµ·æ¥æ¯”gitblitè¦ç®€å•ä¸€äº›ï¼Œä½†ç•Œé¢å´æ›´åŠ æ¼‚äº®äº†ï¼Œæ€»ä½“ä¸Šçœ‹èµ·æ¥æ¯”è¾ƒåƒgithubï¼Œå¹¶ä¸”è¿˜æ”¯æŒä¸»é¢˜ç³»ç»Ÿï¼Œå¾ˆåˆæˆ‘çš„èƒƒå£ã€‚\nä¸‹è½½äºŒè¿›åˆ¶åŒ… é¦–å…ˆå»ä¸‹è½½å¯¹åº”ç³»ç»Ÿçš„äºŒè¿›åˆ¶åŒ…ï¼Œå¯ä»¥å»githubæˆ–è€…å®˜ç½‘ä¸‹è½½æœ€æ–°çš„å‘å¸ƒç‰ˆæœ¬ã€‚\næˆ‘æ˜¯åœ¨windowsä¸‹é…ç½®çš„ï¼Œæ‰€ä»¥é€‰æ‹©ä¸‹è½½windowsç‰ˆçš„å¯æ‰§è¡Œç¨‹åºã€‚\nå¼€å¯æœåŠ¡ ä¸‹è½½åä¸éœ€è¦å®‰è£…ï¼Œç›´æ¥å°±èƒ½è¿è¡Œï¼Œä½†ç›´æ¥è¿è¡Œçš„è¯ä¼šæœ‰ä¸€ä¸ªæ§åˆ¶å°æ˜¾ç¤ºåœ¨æ¡Œé¢ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘å°†ç¨‹åºä½œä¸ºä¸€ä¸ªç³»ç»ŸæœåŠ¡åœ¨åå°è¿è¡Œã€‚\nç”±äºä¸éœ€è¦å®‰è£…ï¼Œå¯ä»¥ç›´æ¥å°†ä¸‹è½½çš„å¯æ‰§è¡Œç¨‹åºæ”¾åœ¨è‡ªå·±æƒ³è¦å®‰è£…çš„ç›®å½•ï¼Œeg: D:\\gitea\\gitea.exe\nä»¥ç®¡ç†å‘˜æ–¹å¼æ‰“å¼€cmdæˆ–è€…powershellï¼Œæ‰§è¡Œå‘½ä»¤ï¼š\nsh \u0026#9660; 1 sc create gitea start= auto binPath= \u0026#34;\\\u0026#34;D:\\gitea\\gitea.exe\\\u0026#34; web --config \\\u0026#34;D:\\gitea\\custom\\conf\\app.ini\\\u0026#34;\u0026#34; æ‰“å¼€ç³»ç»Ÿçš„æœåŠ¡ç®¡ç†ç•Œé¢ï¼Œæ‰¾åˆ°giteaï¼Œæ­¤æ—¶æ˜¯å·²åœæ­¢çŠ¶æ€ï¼ŒæŒ‰ä¸‹é¼ æ ‡å³é”®ï¼Œåœ¨å¼¹å‡ºçš„èœå•é€‰æ‹©å¼€å§‹ï¼Œç„¶åå¯ä»¥çœ‹åˆ°çŠ¶æ€å˜ä¸ºæ­£åœ¨å¯åŠ¨ã€‚\næ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:3000ï¼Œåº”è¯¥å°±èƒ½çœ‹åˆ°Giteaçš„ç•Œé¢äº†ï¼Œç‚¹å‡»é¡µé¢ä¸Šçš„æ¢ç´¢ï¼ˆexploreï¼‰ï¼Œè¿˜éœ€è¦è¿›è¡Œä¸€äº›é…ç½®æ‰èƒ½æ­£å¸¸è¿è¡Œï¼Œæ•°æ®åº“å¯ä»¥ç›´æ¥ä½¿ç”¨sqliteï¼Œè¿™æ ·å°±ä¸éœ€è¦å†å®‰è£…å…¶å®ƒçš„æ•°æ®åº“äº†ï¼Œç„¶åå°±æ˜¯ä¸€äº›ç›®å½•é…ç½®ï¼Œæ ¹æ®éœ€è¦é€‰æ‹©ç›®å½•å°±è¡Œã€‚\næœ€åå¯ä»¥åˆ›å»ºç®¡ç†å‘˜è´¦å·ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨è®¾ç½®ï¼Œå®Œæˆå®‰è£…åç¬¬ä¸€ä¸ªæ³¨å†Œçš„è´¦å·ä¼šè‡ªåŠ¨æˆä¸ºç®¡ç†å‘˜ã€‚\nåˆ°è¿™é‡Œå®‰è£…å’Œé…ç½®å°±å®Œæˆäº†ï¼Œæ­¤æ—¶å†çœ‹æœåŠ¡ä¸­çš„giteaçš„çŠ¶æ€ï¼Œå·²ç»å˜ä¸ºæ­£åœ¨è¿è¡Œã€‚\nè¿ç§»ä»“åº“åˆ° Gitea Gitea è‡ªå¸¦è¿ç§»å¤–éƒ¨ä»“åº“çš„åŠŸèƒ½ï¼Œä½†æˆ‘ä¸€ç›´å¯¼å…¥å¤±è´¥ï¼Œæç¤ºæ²¡æœ‰å¯¼å…¥æœ¬åœ°ä»“åº“çš„æƒé™ã€‚åæ¥åªèƒ½å°†æœ¬åœ°çš„ä»“åº“æ¨é€åˆ°Giteaï¼Œä¸è¿‡æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚\né¦–å…ˆåœ¨Giteaä¸­æ–°å»ºä¸€ä¸ªåŒåçš„ä»“åº“ï¼Œå¤åˆ¶ä»“åº“çš„gité“¾æ¥ã€‚\nä¿®æ”¹æœ¬åœ°ä»“åº“çš„origin\nsh \u0026#9660; 1 $ git remote origin set-url http://localhost:3000/user/myrepo.git æˆ–è€…ç›´æ¥ä¿®æ”¹.git/configæ–‡ä»¶ä¸­çš„origin urlã€‚\næ¨é€æœ¬åœ°ä»“åº“åˆ°Gitea\nsh \u0026#9660; 1 $ git push origin main é™é™ç­‰å¾…æ¨é€å®Œæˆï¼Œç„¶ååˆ·æ–°giteaçš„ä»“åº“é¡µé¢ï¼Œå°±å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„æäº¤è®°å½•äº†ã€‚\nå¯ç”¨ SSH ç¼–è¾‘ D:\\gitea\\custom\\conf\\app.iniï¼Œåœ¨[server]éƒ¨åˆ†æ–°å¢ä¸€é¡¹é…ç½®\nini \u0026#9660; 1 2 [server] START_SSH_SERVER = true ä¿å­˜åï¼Œåœ¨æœåŠ¡ä¸­é‡å¯ gitea å³å¯ã€‚\nåœ¨giteaçš„è´¦å·ç®¡ç†ä¸­æ–°å¢SSHå¯†é’¥ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨sshçš„æ–¹å¼ç®¡ç†è´¦æˆ·æ‰€æ‹¥æœ‰çš„ä»“åº“äº†ã€‚\næœ€å æ€»çš„æ¥çœ‹ï¼ŒGiteaçš„é…ç½®ååˆ†ç®€å•ï¼ŒåŸºæœ¬ä¸Šä¸‹è½½åå°±å¯ä»¥ä½¿ç”¨ï¼Œæ²¡æœ‰å…¶å®ƒçš„ä¾èµ–ï¼Œgitblitåˆ™éœ€è¦å®‰è£…javaè¿è¡Œç¯å¢ƒï¼Œç•Œé¢ååˆ†æ¼‚äº®ï¼ŒåŠŸèƒ½ä¹Ÿæ¯”è¾ƒå®Œå–„ï¼Œè‡ªç”¨å®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚\n","permalink":"https://kira-96.github.io/posts/install-gitea/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eä»Šå¤©å¶ç„¶çœ‹åˆ°ä¸€ä¸ªæ–°çš„å¼€æºçš„gitæœåŠ¡è½¯ä»¶\u003ca href=\"https://gitea.io/\"\u003eGitea\u003c/a\u003eï¼Œä¸€çœ‹åˆ°ç•Œé¢ï¼Œç¬é—´å°±çˆ±äº†ï¼Œå› ä¸ºä¹‹å‰æˆ‘è‡ªå·±ç”¨çš„æ˜¯\u003ca href=\"http://gitblit.github.io/gitblit/\"\u003egitblit\u003c/a\u003eï¼Œç•Œé¢æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯ç”¨æ¥ç®¡ç†å…¬å¸çš„ä¸€äº›å°é¡¹ç›®ã€‚ä»Šå¤©çœ‹åˆ°Giteaä¹‹åï¼Œå°±å†³å®šè¿ç§»åˆ°è¿‡å»ï¼Œç®€å•æŠ˜è…¾äº†ä¸€ä¸‹ï¼Œé…ç½®èµ·æ¥æ¯”gitblitè¦ç®€å•ä¸€äº›ï¼Œä½†ç•Œé¢å´æ›´åŠ æ¼‚äº®äº†ï¼Œæ€»ä½“ä¸Šçœ‹èµ·æ¥æ¯”è¾ƒåƒgithubï¼Œå¹¶ä¸”è¿˜æ”¯æŒä¸»é¢˜ç³»ç»Ÿï¼Œå¾ˆåˆæˆ‘çš„èƒƒå£ã€‚\u003c/p\u003e\n\u003ch2 id=\"ä¸‹è½½äºŒè¿›åˆ¶åŒ…\"\u003eä¸‹è½½äºŒè¿›åˆ¶åŒ…\u003c/h2\u003e\n\u003cp\u003eé¦–å…ˆå»ä¸‹è½½å¯¹åº”ç³»ç»Ÿçš„äºŒè¿›åˆ¶åŒ…ï¼Œå¯ä»¥å»\u003ca href=\"https://github.com/go-gitea/gitea/releases\"\u003egithub\u003c/a\u003eæˆ–è€…\u003ca href=\"https://dl.gitea.io/gitea\"\u003eå®˜ç½‘\u003c/a\u003eä¸‹è½½æœ€æ–°çš„å‘å¸ƒç‰ˆæœ¬ã€‚\u003c/p\u003e\n\u003cp\u003eæˆ‘æ˜¯åœ¨windowsä¸‹é…ç½®çš„ï¼Œæ‰€ä»¥é€‰æ‹©ä¸‹è½½windowsç‰ˆçš„å¯æ‰§è¡Œç¨‹åºã€‚\u003c/p\u003e","title":"Gitea å®‰è£…ä½¿ç”¨"},{"content":"é¦–å…ˆéœ€è¦å®‰è£…Docker\nå®‰è£…å®Œæˆåï¼Œæ‹‰å–ä»¥ä¸‹3ä¸ªä»“åº“\nbash \u0026#9660; 1 2 3 $ docker pull dcm4che/slapd-dcm4chee:2.4.56-23.1 $ docker pull dcm4che/postgres-dcm4chee:13.1-23 $ docker pull dcm4che/dcm4chee-arc-psql:5.23.1 æ‹‰å–å®Œæˆåï¼Œå°±å¯ä»¥å¯åŠ¨æœåŠ¡äº†ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ä½¿ç”¨Dockerå‘½ä»¤è¡Œä¾æ¬¡å¯åŠ¨ä¸Šé¢3ä¸ªæœåŠ¡ï¼Œä¸è¿‡æ¯”è¾ƒéº»çƒ¦ï¼Œä¹Ÿå®¹æ˜“å‡ºé”™ï¼Œå¦ä¸€ç§æ˜¯ç›´æ¥ä½¿ç”¨Docker Copmoseï¼Œç›¸å¯¹æ¥è¯´è¦ç®€å•å¾ˆå¤šã€‚è¿™é‡Œå°±ç›´æ¥ä½¿ç”¨ Docker Composeçš„æ–¹å¼ã€‚\nåˆ›å»ºä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶ï¼š\ndocker-compose.yml\nyaml \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 version: \u0026#34;3\u0026#34; services: ldap: image: dcm4che/slapd-dcm4chee:2.4.56-23.1 logging: driver: json-file options: max-size: \u0026#34;10m\u0026#34; ports: - \u0026#34;389:389\u0026#34; env_file: docker-compose.env volumes: - /var/local/dcm4chee-arc/ldap:/var/lib/openldap/openldap-data - /var/local/dcm4chee-arc/slapd.d:/etc/openldap/slapd.d db: image: dcm4che/postgres-dcm4chee:13.1-23 logging: driver: json-file options: max-size: \u0026#34;10m\u0026#34; ports: - \u0026#34;5432:5432\u0026#34; env_file: docker-compose.env volumes: - /etc/localtime:/etc/localtime:ro - /etc/timezone:/etc/timezone:ro - /var/local/dcm4chee-arc/db:/var/lib/postgresql/data arc: image: dcm4che/dcm4chee-arc-psql:5.23.1 logging: driver: json-file options: max-size: \u0026#34;10m\u0026#34; ports: - \u0026#34;8080:8080\u0026#34; - \u0026#34;8443:8443\u0026#34; - \u0026#34;9990:9990\u0026#34; - \u0026#34;9993:9993\u0026#34; - \u0026#34;11112:11112\u0026#34; - \u0026#34;2762:2762\u0026#34; - \u0026#34;2575:2575\u0026#34; - \u0026#34;12575:12575\u0026#34; env_file: docker-compose.env environment: WILDFLY_CHOWN: /opt/wildfly/standalone /storage WILDFLY_WAIT_FOR: ldap:389 db:5432 depends_on: - ldap - db volumes: - /etc/localtime:/etc/localtime:ro - /etc/timezone:/etc/timezone:ro - /var/local/dcm4chee-arc/wildfly:/opt/wildfly/standalone - /var/local/dcm4chee-arc/storage:/storage docker-compose.env\nini \u0026#9660; 1 2 3 4 5 TZ=Asia/Shanghai STORAGE_DIR=/storage/fs1 POSTGRES_DB=pacsdb POSTGRES_USER=pacs POSTGRES_PASSWORD=pacs å…¶ä¸­TZæ˜¯ç”¨æ¥è®¾ç½®æ—¶åŒºçš„ã€‚\nå¯åŠ¨\nbash \u0026#9660; 1 $ docker-compose -p dcm4chee up -d åœæ­¢\nbash \u0026#9660; 1 $ docker-compose -p dcm4chee stop é‡æ–°å¯åŠ¨\nbash \u0026#9660; 1 $ docker-compose -p dcm4chee start åˆ é™¤\nbash \u0026#9660; 1 $ docker-compose -p dcm4chee down å‚è€ƒ\nRun minimum set of archive services on a single host\n","permalink":"https://kira-96.github.io/notes/running-dcm4chee-arc-light-on-docker/","summary":"\u003cp\u003eé¦–å…ˆéœ€è¦\u003ca href=\"https://docs.docker.com/get-docker/\"\u003eå®‰è£…Docker\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eå®‰è£…å®Œæˆåï¼Œæ‹‰å–ä»¥ä¸‹3ä¸ªä»“åº“\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"bash\"\u003ebash\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ docker pull dcm4che/slapd-dcm4chee:2.4.56-23.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ docker pull dcm4che/postgres-dcm4chee:13.1-23\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ docker pull dcm4che/dcm4chee-arc-psql:5.23.1\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eæ‹‰å–å®Œæˆåï¼Œå°±å¯ä»¥å¯åŠ¨æœåŠ¡äº†ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ä½¿ç”¨Dockerå‘½ä»¤è¡Œä¾æ¬¡å¯åŠ¨ä¸Šé¢3ä¸ªæœåŠ¡ï¼Œä¸è¿‡æ¯”è¾ƒéº»çƒ¦ï¼Œä¹Ÿå®¹æ˜“å‡ºé”™ï¼Œå¦ä¸€ç§æ˜¯ç›´æ¥ä½¿ç”¨Docker Copmoseï¼Œç›¸å¯¹æ¥è¯´è¦ç®€å•å¾ˆå¤šã€‚è¿™é‡Œå°±ç›´æ¥ä½¿ç”¨ Docker Composeçš„æ–¹å¼ã€‚\u003c/p\u003e","title":"Running Dcm4chee Arc Light on Docker"},{"content":"GDI+ç»˜åˆ¶æ¤­åœ†æ—¶åªæ”¯æŒè¾“å…¥ä¸€ä¸ªçŸ©å½¢èŒƒå›´ï¼Œæ— æ³•ç»˜åˆ¶å€¾æ–œçš„æ¤­åœ†ã€‚\nç»˜åˆ¶æ¤­åœ†çš„ APIï¼š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 // æ‘˜è¦: ç»˜åˆ¶è¾¹ç•Œ System.Drawing.RectangleF å®šä¹‰çš„æ¤­åœ†ã€‚ // å‚æ•°: // pen: System.Drawing.Penï¼Œå®ƒç¡®å®šæ›²çº¿çš„é¢œè‰²ã€å®½åº¦å’Œæ ·å¼ã€‚ // rect: System.Drawing.RectangleF ç»“æ„ï¼Œå®ƒå®šä¹‰æ¤­åœ†çš„è¾¹ç•Œã€‚ // å¼‚å¸¸: // T:System.ArgumentNullException: pen ä¸º nullã€‚ public void DrawEllipse(Pen pen, RectangleF rect); // // æ‘˜è¦: ç»˜åˆ¶ä¸€ä¸ªç”±è¾¹æ¡†ï¼ˆè¯¥è¾¹æ¡†ç”±ä¸€å¯¹åæ ‡ã€é«˜åº¦å’Œå®½åº¦æŒ‡å®šï¼‰å®šä¹‰çš„æ¤­åœ†ã€‚ // å‚æ•°: // pen: System.Drawing.Penï¼Œå®ƒç¡®å®šæ›²çº¿çš„é¢œè‰²ã€å®½åº¦å’Œæ ·å¼ã€‚ // x: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å·¦ä¸Šè§’çš„ X åæ ‡ã€‚ // y: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å·¦ä¸Šè§’çš„ Y åæ ‡ã€‚ // width: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å®½åº¦ã€‚ // height: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„é«˜åº¦ã€‚ // å¼‚å¸¸: // T:System.ArgumentNullException: pen ä¸º nullã€‚ public void DrawEllipse(Pen pen, float x, float y, float width, float height); // // æ‘˜è¦: ç»˜åˆ¶è¾¹ç•Œ System.Drawing.Rectangle ç»“æ„æŒ‡å®šçš„æ¤­åœ†ã€‚ // å‚æ•°: // pen: System.Drawing.Penï¼Œå®ƒç¡®å®šæ›²çº¿çš„é¢œè‰²ã€å®½åº¦å’Œæ ·å¼ã€‚ // rect: System.Drawing.Rectangle ç»“æ„ï¼Œå®ƒå®šä¹‰æ¤­åœ†çš„è¾¹ç•Œã€‚ // å¼‚å¸¸: // T:System.ArgumentNullException: pen ä¸º nullã€‚ public void DrawEllipse(Pen pen, Rectangle rect); // // æ‘˜è¦: ç»˜åˆ¶ä¸€ä¸ªç”±è¾¹æ¡†å®šä¹‰çš„æ¤­åœ†ï¼Œè¯¥è¾¹æ¡†ç”±çŸ©å½¢çš„å·¦ä¸Šè§’åæ ‡ã€é«˜åº¦å’Œå®½åº¦æŒ‡å®šã€‚ // å‚æ•°: // pen: System.Drawing.Penï¼Œå®ƒç¡®å®šæ›²çº¿çš„é¢œè‰²ã€å®½åº¦å’Œæ ·å¼ã€‚ // x: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å·¦ä¸Šè§’çš„ X åæ ‡ã€‚ // y: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å·¦ä¸Šè§’çš„ Y åæ ‡ã€‚ // width: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å®½åº¦ã€‚ // height: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„é«˜åº¦ã€‚ // å¼‚å¸¸: // T:System.ArgumentNullException: pen ä¸º nullã€‚ public void DrawEllipse(Pen pen, int x, int y, int width, int height); å¯ä»¥çœ‹åˆ°ï¼Œç»˜åˆ¶æ¤­åœ†çš„APIï¼Œéƒ½åªæ”¯æŒè¾“å…¥ä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼Œé•¿å’Œå®½éƒ½åªèƒ½æ˜¯æ°´å¹³æˆ–è€…ç«–ç›´çš„ï¼Œå› æ­¤ï¼Œç»˜åˆ¶å‡ºæ¤­åœ†çš„é•¿è½´å’ŒçŸ­è½´ä¹Ÿæ˜¯æ°´å¹³æˆ–ç«–ç›´çš„ï¼Œè€Œæ— æ³•ç»˜åˆ¶ä¸€ä¸ªæ—‹è½¬è¿‡çš„æ¤­åœ†ï¼Œå¦‚ä¸‹å›¾ï¼š\nç»™å®šæ¤­åœ†çš„4ä¸ªé¡¶ç‚¹ï¼Œç»˜åˆ¶å‡ºæ¤­åœ†ã€‚è™½ç„¶ä¸èƒ½ç›´æ¥è°ƒç”¨APIç»˜åˆ¶æ¤­åœ†ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ç»˜åˆ¶4æ¡è¿ç»­çš„è´å¡å°”æ›²çº¿æ¥é—­åˆæˆä¸€ä¸ªæ¤­åœ†ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 // // æ‘˜è¦: ç”¨ System.Drawing.PointF ç»“æ„æ•°ç»„ç»˜åˆ¶ä¸€ç³»åˆ—è´å¡å°”æ ·æ¡ã€‚ // å‚æ•°: // pen: System.Drawing.Penï¼Œå®ƒç¡®å®šæ›²çº¿çš„é¢œè‰²ã€å®½åº¦å’Œæ ·å¼ã€‚ // points: System.Drawing.PointF ç»“æ„çš„æ•°ç»„ï¼Œè¿™äº›ç»“æ„è¡¨ç¤ºç¡®å®šæ›²çº¿çš„ç‚¹ã€‚ // æ­¤æ•°ç»„ä¸­çš„ç‚¹æ•°åº”ä¸º 3 çš„å€æ•°åŠ  1ï¼Œå¦‚ 4ã€7 æˆ– 10ã€‚ // // å¼‚å¸¸: // T:System.ArgumentNullException: pen ä¸º nullã€‚- æˆ– -points ä¸º nullã€‚ public void DrawBeziers(Pen pen, PointF[] points); ä½¿ç”¨è¿™ç§æ–¹æ³•å®é™…ä¸Šåªéœ€è¦çŸ¥é“æ¤­åœ†çš„ä¸­å¿ƒç‚¹ï¼Œä¸¤ä¸ªè½´çš„é•¿åº¦ä»¥åŠæ—‹è½¬è§’åº¦å³å¯ï¼Œè€Œè¿™äº›éƒ½å¯ä»¥é€šè¿‡4ä¸ªé¡¶ç‚¹è®¡ç®—å¾—åˆ°ã€‚\næ ¹æ®ä»¥ä¸Šçš„ä¿¡æ¯ï¼Œä¾æ¬¡è®¡ç®—å‡ºè¿ç»­è´å¡å°”æ›²çº¿çš„13ä¸ªæ§åˆ¶ç‚¹ï¼Œç„¶åè°ƒç”¨DrawBeziersç»˜åˆ¶æ¤­åœ†ã€‚\nå„ä¸ªç‚¹çš„ä½ç½®å¦‚å›¾ï¼š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 /** * C# */ // MAGICAL CONSTANT to map ellipse to beziers // 2/3*(sqrt(2)-1) const double Ellipse2Beziers = 0.2761423749154; // GDI Bitmap using var bitmap = new System.Drawing.Bitmap(width, height); using var graphics = System.Drawing.Graphics.FromImage(bitmap); // æ¤­åœ†çš„4ä¸ªé¡¶ç‚¹ PointF[] ellipse = new PointF[4] { point1, point2, point3, point4 }; // ä¸¤ä¸ªè½´çš„é•¿åº¦ double r1 = ellipse[2].DistanceTo(ellipse[3]); double r2 = ellipse[0].DistanceTo(ellipse[1]); // æ—‹è½¬è§’åº¦ double angle = -SysMath.Atan2(ellipse[2].Y - ellipse[3].Y, ellipse[2].X - ellipse[3].X); double sin = SysMath.Sin(angle); double cos = SysMath.Cos(angle); // è´å¡å°”æ›²çº¿æ§åˆ¶ç‚¹ç›¸å¯¹äºä¸­å¿ƒç‚¹çš„åç§»é•¿åº¦ SizeF offset = new SizeF((float)(r1 * Ellipse2Beziers), (float)(r2 * Ellipse2Beziers)); // æ¤­åœ†ä¸­å¿ƒç‚¹ PointF center = new PointF((ellipse[0].X + ellipse[1].X) / 2f, (ellipse[0].Y + ellipse[1].Y) / 2f); // è´å¡å°”æ›²çº¿çš„æ§åˆ¶ç‚¹ PointF[] beziers = new PointF[13] { new PointF((float)(center.X - r1 / 2.0), center.Y), new PointF((float)(center.X - r1 / 2.0), center.Y - offset.Height), new PointF(center.X - offset.Width, (float)(center.Y - r2 / 2.0)), new PointF(center.X, (float)(center.Y - r2 / 2.0)), new PointF(center.X + offset.Width, (float)(center.Y - r2 / 2.0)), new PointF((float)(center.X + r1 / 2.0), center.Y - offset.Height), new PointF((float)(center.X + r1 / 2.0), center.Y), new PointF((float)(center.X + r1 / 2.0), center.Y + offset.Height), new PointF(center.X + offset.Width, (float)(center.Y + r2 / 2.0)), new PointF(center.X, (float)(center.Y + r2 / 2.0)), new PointF(center.X - offset.Width, (float)(center.Y + r2 / 2.0)), new PointF((float)(center.X - r1 / 2.0), center.Y + offset.Height), new PointF((float)(center.X - r1 / 2.0), center.Y) }; // æ—‹è½¬å˜æ¢ double offsetX = center.X - center.X * cos - center.Y * sin; double offsetY = center.Y + center.X * sin - center.Y * cos; for (int j = 0; j \u0026lt; beziers.Length; j++) { beziers[j] = new PointF( (float)(beziers[j].X * cos + beziers[j].Y * sin + offsetX), (float)(beziers[j].Y * cos - beziers[j].X * sin + offsetY)); } // ç»˜åˆ¶æ›²çº¿ graphics.DrawBeziers(new Pen(Brushes.White, 1f)/* Pen */, beziers); é€šè¿‡ä¸Šé¢ä»£ç å°±å¯ä»¥å®Œç¾çš„ç»˜åˆ¶å‡ºä¸€ä¸ªæ—‹è½¬ä»»æ„è§’åº¦çš„æ¤­åœ†äº†ã€‚\nå‚è€ƒ\nMFCä¸Šå¦‚ä½•ç»˜åˆ¶ä¸€ä¸ªå¯ä»¥æ—‹è½¬çš„æ¤­åœ†\nDrawing Rotated and Skewed Ellipses\n","permalink":"https://kira-96.github.io/notes/draw-rotate-ellipse-with-gdi/","summary":"\u003cp\u003eGDI+ç»˜åˆ¶æ¤­åœ†æ—¶åªæ”¯æŒè¾“å…¥ä¸€ä¸ªçŸ©å½¢èŒƒå›´ï¼Œæ— æ³•ç»˜åˆ¶å€¾æ–œçš„æ¤­åœ†ã€‚\u003c/p\u003e\n\u003cp\u003eç»˜åˆ¶æ¤­åœ†çš„ APIï¼š\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"csharp\"\u003ecsharp\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e13\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e14\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e15\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e16\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e17\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e18\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e19\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e20\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e21\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e22\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e23\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e24\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e25\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e26\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e27\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e28\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e29\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e30\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e31\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e32\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e33\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e34\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e35\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e36\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e37\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csharp\" data-lang=\"csharp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// æ‘˜è¦: ç»˜åˆ¶è¾¹ç•Œ System.Drawing.RectangleF å®šä¹‰çš„æ¤­åœ†ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// å‚æ•°:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   pen: System.Drawing.Penï¼Œå®ƒç¡®å®šæ›²çº¿çš„é¢œè‰²ã€å®½åº¦å’Œæ ·å¼ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   rect: System.Drawing.RectangleF ç»“æ„ï¼Œå®ƒå®šä¹‰æ¤­åœ†çš„è¾¹ç•Œã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// å¼‚å¸¸:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   T:System.ArgumentNullException: pen ä¸º nullã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eDrawEllipse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePen\u003c/span\u003e \u003cspan class=\"n\"\u003epen\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRectangleF\u003c/span\u003e \u003cspan class=\"n\"\u003erect\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// æ‘˜è¦: ç»˜åˆ¶ä¸€ä¸ªç”±è¾¹æ¡†ï¼ˆè¯¥è¾¹æ¡†ç”±ä¸€å¯¹åæ ‡ã€é«˜åº¦å’Œå®½åº¦æŒ‡å®šï¼‰å®šä¹‰çš„æ¤­åœ†ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// å‚æ•°:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   pen: System.Drawing.Penï¼Œå®ƒç¡®å®šæ›²çº¿çš„é¢œè‰²ã€å®½åº¦å’Œæ ·å¼ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   x: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å·¦ä¸Šè§’çš„ X åæ ‡ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   y: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å·¦ä¸Šè§’çš„ Y åæ ‡ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   width: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å®½åº¦ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   height: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„é«˜åº¦ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// å¼‚å¸¸:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   T:System.ArgumentNullException: pen ä¸º nullã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eDrawEllipse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePen\u003c/span\u003e \u003cspan class=\"n\"\u003epen\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003efloat\u003c/span\u003e \u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// æ‘˜è¦: ç»˜åˆ¶è¾¹ç•Œ System.Drawing.Rectangle ç»“æ„æŒ‡å®šçš„æ¤­åœ†ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// å‚æ•°:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   pen: System.Drawing.Penï¼Œå®ƒç¡®å®šæ›²çº¿çš„é¢œè‰²ã€å®½åº¦å’Œæ ·å¼ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   rect: System.Drawing.Rectangle ç»“æ„ï¼Œå®ƒå®šä¹‰æ¤­åœ†çš„è¾¹ç•Œã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// å¼‚å¸¸:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   T:System.ArgumentNullException: pen ä¸º nullã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eDrawEllipse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePen\u003c/span\u003e \u003cspan class=\"n\"\u003epen\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eRectangle\u003c/span\u003e \u003cspan class=\"n\"\u003erect\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// æ‘˜è¦: ç»˜åˆ¶ä¸€ä¸ªç”±è¾¹æ¡†å®šä¹‰çš„æ¤­åœ†ï¼Œè¯¥è¾¹æ¡†ç”±çŸ©å½¢çš„å·¦ä¸Šè§’åæ ‡ã€é«˜åº¦å’Œå®½åº¦æŒ‡å®šã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// å‚æ•°:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   pen: System.Drawing.Penï¼Œå®ƒç¡®å®šæ›²çº¿çš„é¢œè‰²ã€å®½åº¦å’Œæ ·å¼ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   x: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å·¦ä¸Šè§’çš„ X åæ ‡ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   y: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å·¦ä¸Šè§’çš„ Y åæ ‡ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   width: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„å®½åº¦ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   height: å®šä¹‰æ¤­åœ†çš„è¾¹æ¡†çš„é«˜åº¦ã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// å¼‚å¸¸:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//   T:System.ArgumentNullException: pen ä¸º nullã€‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eDrawEllipse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ePen\u003c/span\u003e \u003cspan class=\"n\"\u003epen\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ex\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ey\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ewidth\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eheight\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eå¯ä»¥çœ‹åˆ°ï¼Œç»˜åˆ¶æ¤­åœ†çš„APIï¼Œéƒ½åªæ”¯æŒè¾“å…¥ä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼Œé•¿å’Œå®½éƒ½åªèƒ½æ˜¯æ°´å¹³æˆ–è€…ç«–ç›´çš„ï¼Œå› æ­¤ï¼Œç»˜åˆ¶å‡ºæ¤­åœ†çš„é•¿è½´å’ŒçŸ­è½´ä¹Ÿæ˜¯æ°´å¹³æˆ–ç«–ç›´çš„ï¼Œè€Œæ— æ³•ç»˜åˆ¶ä¸€ä¸ªæ—‹è½¬è¿‡çš„æ¤­åœ†ï¼Œå¦‚ä¸‹å›¾ï¼š\u003c/p\u003e","title":"GDI+ç»˜åˆ¶æ—‹è½¬çš„æ¤­åœ†"},{"content":"è§„åˆ™\nç§æœ‰ Tag (gggg, xxxx)\nGroup number (gggg) å¿…é¡»ä¸ºå¥‡æ•° (odd)ï¼Œå¹¶ä¸” (0001, xxxx)ï¼Œ(0003, xxxx)ï¼Œ(0005, xxxx)ï¼Œ(0007, xxxx)ï¼Œ(FFFF, xxxx) ä¸å…è®¸ä½¿ç”¨ã€‚\n(gggg, 0000) were Group Length Elements, which have been retired.ï¼ˆå·²å¼ƒç”¨ï¼‰\n(gggg, 0001-000F)ï¼Œ(gggg, 0100-0FFF) ä¸å…è®¸ä½¿ç”¨ã€‚\n(gggg, 0010-00FF) ä¾›ç§æœ‰tagåˆ›å»ºè€…ï¼ˆPrivate Creatorï¼‰ä½¿ç”¨ï¼Œç”¨äºåœ¨è¯¥groupä¸­æ’å…¥ä¸€ä¸ªæœªä½¿ç”¨çš„æ ‡è¯†ç ï¼ˆidentification codeï¼‰ï¼Œç§æœ‰æ ‡è¯†ç çš„VRåº”è¯¥ä¸ºLO (Long String)ï¼ŒVMåº”è¯¥ä¸º1ã€‚\n(gggg, 1000-FFFF) ä¸º Data Elementã€‚\nPrivate Creator å’Œ Data Element çš„å¯¹åº”å…³ç³»ä¸ºï¼š\nä¾‹ï¼š\nData Element (0029, 1000-10FF) çš„ Private Creator æ˜¯ (0029, 0010)\nData Element (0029, 1100-11FF) çš„ Private Creator æ˜¯ (0029, 0011)\nData Element (0029, 1200-12FF) çš„ Private Creator æ˜¯ (0029, 0012)\nâ€¦â€¦\nData Element (0029, FF00-FFFF) çš„ Private Creator æ˜¯ (0029, 00FF)\næ ‡å‡†\nhttp://dicom.nema.org/medical/dicom/current/output/chtml/part05/sect_7.8.html\n","permalink":"https://kira-96.github.io/notes/private-dicom-element/","summary":"\u003cp\u003e\u003cstrong\u003eè§„åˆ™\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eç§æœ‰ Tag (gggg, xxxx)\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eGroup number (gggg) å¿…é¡»ä¸ºå¥‡æ•° (odd)ï¼Œå¹¶ä¸” (0001, xxxx)ï¼Œ(0003, xxxx)ï¼Œ(0005, xxxx)ï¼Œ(0007, xxxx)ï¼Œ(FFFF, xxxx) ä¸å…è®¸ä½¿ç”¨ã€‚\u003c/p\u003e","title":"Private Dicom Element"},{"content":"è¯´æ˜ è¿™é‡Œæ˜¯ä¸ªäººå·¥ä½œæ—¶å¸¸ç”¨çš„ä¸€äº›gitå‘½ä»¤ï¼Œç°åœ¨è¶Šæ¥è¶Šå¤šäº†ï¼Œå°æœ¬æœ¬éƒ½å¿«è®°ä¸ä¸‹äº†ï¼Œè¿™é‡Œç¨å¾®åšä¸€ä¸‹æ•´ç†ã€‚\nå·¥å…·ä¸‹è½½ é¦–å…ˆæ˜¯gitçš„ä¸‹è½½åœ°å€ï¼š\nå®˜ç½‘ï¼šhttps://git-scm.com/ taobaoé•œåƒï¼šhttps://npm.taobao.org/mirrors/git-for-windows/ ç”±äºå®˜ç½‘çš„ä¸‹è½½é€Ÿåº¦å¾ˆæ…¢ï¼Œæ¨èä½¿ç”¨taobaoé•œåƒçš„ä¸‹è½½åœ°å€ã€‚\nè®¾ç½®ç”¨æˆ·åå’Œé‚®ç®± å…¨å±€é…ç½®\nbash \u0026#9660; 1 2 $ git config --global user.name [name] $ git config --global user.email [email] é…ç½®å½“å‰ä»“åº“\nbash \u0026#9660; 1 2 $ git config user.name [name] $ git config user.email [email] æŸ¥çœ‹ç”¨æˆ·åå’Œé‚®ç®±\nbash \u0026#9660; 1 2 $ git config user.name $ git config user.email ç”ŸæˆSSHå¯†é’¥ bash \u0026#9660; 1 $ ssh-keygen -t rsa -C \u0026#34;[email]\u0026#34; æ‰§è¡Œå®Œæ¯•å’Œç”¨æˆ·ç›®å½•ä¸‹å°±ä¼šç”Ÿæˆä¸€ä¸ª**.ssh**æ–‡ä»¶å¤¹ã€‚\næ‹‰å–è¿œç¨‹ä»£ç åº“ å¯ä»¥ç›´æ¥cloneè¿œç¨‹ä»£ç ä»“åº“ï¼ˆæ¨èï¼‰\nbash \u0026#9660; 1 $ git clone https://github.com/libgit2/libgit2 mylibgit å…ˆåˆå§‹åŒ–ä»“åº“ï¼Œå†æ‹‰å–ä»£ç \nbash \u0026#9660; 1 2 3 4 5 $ cd ./mylibgit $ git init $ git remote add origin git@github.com:libgit2/libgit2.git $ git pull origin master $ git push -u origin master æäº¤ä»£ç å˜æ›´ æŸ¥çœ‹å·¥ä½œåŒºå˜æ›´\nbash \u0026#9660; 1 $ git status æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº\nbash \u0026#9660; 1 $ git add README.md æ·»åŠ æ‰€æœ‰å˜æ›´æ–‡ä»¶åˆ°æš‚å­˜åŒº\nbash \u0026#9660; 1 $ git add . æäº¤åˆ°æœ¬åœ°ä»“åº“\nbash \u0026#9660; 1 $ git commit -m \u0026#39;Update README\u0026#39; æ¨é€åˆ°è¿œç¨‹ä»£ç ä»“åº“ï¼ˆmainæ˜¯åˆ†æ”¯ï¼‰\nbash \u0026#9660; 1 $ git push origin main ç‰ˆæœ¬åˆ‡æ¢ æŸ¥çœ‹ç‰ˆæœ¬/æäº¤è®°å½•\nbash \u0026#9660; 1 $ git log æŸ¥çœ‹ç‰ˆæœ¬/æäº¤ç®€ä»‹\nbash \u0026#9660; 1 $ git log --pertty=oneline æ’¤é”€æäº¤ï¼Œä¿ç•™ä»£ç å˜æ›´ æ’¤é”€ä¸Šæ¬¡æäº¤\nbash \u0026#9660; 1 $ git reset --soft HEAD^ æ’¤é”€å‰næ¬¡æäº¤\nbash \u0026#9660; 1 $ git reset --soft HEAD~n å›é€€åˆ°æŸæ¬¡æäº¤è®°å½•\nbash \u0026#9660; 1 $ git reset --soft commit-id ç‰ˆæœ¬å›é€€ï¼Œä¸ä¿ç•™ä»£ç å˜æ›´ å›é€€åˆ°å½“å‰æœ€æ–°æäº¤\nbash \u0026#9660; 1 $ git reset --hard HEAD å›é€€åˆ°ä¸Šä¸€ç‰ˆæœ¬\nbash \u0026#9660; 1 $ git reset --hard HEAD^ å›é€€åˆ°ä¹‹å‰çš„ç¬¬nä¸ªç‰ˆæœ¬\nbash \u0026#9660; 1 $ git reset --hard HEAD~n å›é€€åˆ°æŸä¸ªç‰ˆæœ¬/é‡æ–°åˆ‡æ¢å›æœªæ¥ç‰ˆæœ¬\nbash \u0026#9660; 1 $ git reset --hard commit-id å¼ºåˆ¶æ¨é€ï¼šåœ¨å·²ç»æ¨é€åˆ°è¿œç¨‹çš„è®°å½•åˆè¢«ä¿®æ”¹çš„æƒ…å†µä¸‹\nbash \u0026#9660; 1 $ git push origin main --force bash \u0026#9660; 1 $ git push -f origin main åˆ†æ”¯ç®¡ç† æŸ¥çœ‹å½“å‰ä»“åº“åˆ†æ”¯\nbash \u0026#9660; 1 $ git branch æŸ¥çœ‹å½“å‰ä»“åº“ä»¥åŠè¿œç¨‹ä»“åº“æ‰€æœ‰åˆ†æ”¯\nbash \u0026#9660; 1 $ git branch -a åœ¨å½“å‰åˆ†æ”¯çš„åŸºç¡€ä¸Šåˆ›å»ºæ–°åˆ†æ”¯\nbash \u0026#9660; 1 $ git checkout -b åˆ†æ”¯å åˆ é™¤å·²åˆå¹¶çš„æœ¬åœ°åˆ†æ”¯\nbash \u0026#9660; 1 $ git branch -d åˆ†æ”¯å åˆ é™¤æœªåˆå¹¶çš„æœ¬åœ°åˆ†æ”¯\nbash \u0026#9660; 1 $ git branch -D åˆ†æ”¯å åˆ é™¤è¿œç¨‹ä»“åº“åˆ†æ”¯\nbash \u0026#9660; 1 $ git push origin -d åˆ†æ”¯å æˆ–\nbash \u0026#9660; 1 $ git push origin :åˆ†æ”¯å åˆ é™¤è¿œç¨‹å·²ç»åˆ é™¤çš„åˆ†æ”¯\nbash \u0026#9660; 1 $ git remote prune origin æ ‡ç­¾-tag tagå’Œåˆ†æ”¯æ“ä½œç±»ä¼¼\næŸ¥çœ‹tag\nbash \u0026#9660; 1 $ git tag ç»™å½“å‰ç‰ˆæœ¬æ·»åŠ tag\nbash \u0026#9660; 1 $ git tag æ ‡ç­¾å ç»™æŸä¸€ç‰ˆæœ¬æ·»åŠ tag\nbash \u0026#9660; 1 $ git tag æ ‡ç­¾å commit-id åˆ é™¤æ ‡ç­¾\nbash \u0026#9660; 1 $ git tag -d æ ‡ç­¾å åˆ é™¤è¿œç¨‹æ ‡ç­¾\nbash \u0026#9660; 1 $ git push origin -d æ ‡ç­¾å æ¨é€æ ‡ç­¾åˆ°è¿œç¨‹ä»“åº“\nbash \u0026#9660; 1 $ git push origin æ ‡ç­¾å å­æ¨¡å—ï¼ˆsubmoduleï¼‰ å½“å‰ä»“åº“æ·»åŠ å­æ¨¡å—\nbash \u0026#9660; 1 $ git submodule add \u0026lt;url\u0026gt; \u0026lt;path\u0026gt; æ‹‰å–ä»“åº“åæ‹‰å–å­æ¨¡å—\nbash \u0026#9660; 1 2 $ git submodule init $ git submodule update bash \u0026#9660; 1 $ git submodule update --init æˆ–\nbash \u0026#9660; 1 $ git clone --recurse-submodules æ›´æ–°å­æ¨¡å—\nbash \u0026#9660; 1 $ git submodule update --remote \u0026lt;submodule\u0026gt; åˆ é™¤å­æ¨¡å—\nbash \u0026#9660; 1 2 $ git submodule deinit \u0026lt;submodule\u0026gt; $ git rm --cached \u0026lt;submodule\u0026gt; ä¿æŒforkä¹‹åçš„ä»“åº“å’Œä¸Šæ¸¸åŒæ­¥ é‡åˆ°ä¸€äº›å¥½çš„ä»£ç ä»“åº“ï¼Œæœ‰æ—¶å€™ä¼šforkä¸€ä»½åˆ°è‡ªå·±çš„è´¦å·ï¼Œä½†ä¸€æ—¦åŸæ¥çš„ä»£ç ä»“åº“æœ‰äº†æ–°çš„æäº¤ï¼Œå¦‚ä½•ä¿æŒè‡ªå·±çš„ä»“åº“å’Œæºä»“åº“ä»£ç åŒæ­¥å‘¢ï¼Ÿ\nä¸€ç§æ–¹å¼æ˜¯é€šè¿‡è¿œç¨‹ä»“åº“å‘forkä¹‹åçš„ä»“åº“æäº¤ä¸€ä¸ªPRï¼Œä½†è¿™æ ·ä¼šå¯¼è‡´æäº¤è®°å½•ä¸ä¸€è‡´ï¼Œéå¸¸EPï¼Œåœ¨ç½‘ä¸Šæœç½—äº†å¥½ä¹…ï¼Œç»ˆäºæ‰¾åˆ°ä¸€ä¸ªå®Œç¾çš„æ–¹æ³•ã€‚\né¦–å…ˆéœ€è¦å°†forkä¹‹åçš„ä»“åº“cloneåˆ°æœ¬åœ°ã€‚\nç„¶åè®¾ç½®æœ¬åœ°ä»“åº“çš„ä¸Šæ¸¸ä»“åº“åœ°å€ä¸ºæºä»“åº“\nbash \u0026#9660; 1 $ git remote add upstream git@github.com:kira-96/myblog.git åŒæ­¥ä¸Šæ¸¸ä»“åº“å˜æ›´\nbash \u0026#9660; 1 2 3 $ git fetch upstream $ git checkout main $ git merge upstream/main æ¨é€åˆ°è¿œç¨‹ä»“åº“\nbash \u0026#9660; 1 $ git push origin main å‚è€ƒ\ngitæ€ç»´å¯¼å›¾ ä¿æŒforkä¹‹åçš„é¡¹ç›®å’Œä¸Šæ¸¸åŒæ­¥ ","permalink":"https://kira-96.github.io/posts/%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E7%9A%84git%E5%91%BD%E4%BB%A4/","summary":"\u003ch2 id=\"è¯´æ˜\"\u003eè¯´æ˜\u003c/h2\u003e\n\u003cp\u003eè¿™é‡Œæ˜¯ä¸ªäººå·¥ä½œæ—¶å¸¸ç”¨çš„ä¸€äº›gitå‘½ä»¤ï¼Œç°åœ¨è¶Šæ¥è¶Šå¤šäº†ï¼Œå°æœ¬æœ¬éƒ½å¿«è®°ä¸ä¸‹äº†ï¼Œè¿™é‡Œç¨å¾®åšä¸€ä¸‹æ•´ç†ã€‚\u003c/p\u003e\n\u003ch2 id=\"å·¥å…·ä¸‹è½½\"\u003eå·¥å…·ä¸‹è½½\u003c/h2\u003e\n\u003cp\u003eé¦–å…ˆæ˜¯gitçš„ä¸‹è½½åœ°å€ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå®˜ç½‘ï¼š\u003ca href=\"https://git-scm.com/\"\u003ehttps://git-scm.com/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003etaobaoé•œåƒï¼š\u003ca href=\"https://npm.taobao.org/mirrors/git-for-windows/\"\u003ehttps://npm.taobao.org/mirrors/git-for-windows/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eç”±äºå®˜ç½‘çš„ä¸‹è½½é€Ÿåº¦å¾ˆæ…¢ï¼Œæ¨èä½¿ç”¨taobaoé•œåƒçš„ä¸‹è½½åœ°å€ã€‚\u003c/p\u003e","title":"ä¸€äº›å¸¸ç”¨çš„gitå‘½ä»¤"},{"content":" é£Ÿç”¨æ–¹æ³• Step 1\nå°†ChineseSimplified.islæ”¾åˆ°Inno Setupå®‰è£…ç›®å½•ä¸‹çš„\u0026quot;Languages\u0026quot;æ–‡ä»¶å¤¹é‡Œé¢\nStep 2\nå¦‚æœä½ æ˜¯é€šè¿‡æ–°å»ºè„šæœ¬çš„æ–¹å¼åˆ›å»ºè„šæœ¬ï¼Œåœ¨Languagesé€‰é¡¹å‹¾é€‰Chinese Simplifiedå³å¯ï¼š\nå¦‚æœä½ éœ€è¦åœ¨ç°æœ‰è„šæœ¬ä¸­æ·»åŠ ç®€ä½“ä¸­æ–‡æ”¯æŒ ç›´æ¥åœ¨ä½ çš„è„šæœ¬çš„[Languages]éƒ¨åˆ†æ·»åŠ ä¸‹é¢ä¸€è¡Œå³å¯\nyaml \u0026#9660; 1 Name: \u0026#34;chinesesimplified\u0026#34;; MessagesFile: \u0026#34;compiler:Languages\\ChineseSimplified.isl\u0026#34; ç¤ºä¾‹ï¼š\nyaml \u0026#9660; 1 2 3 [Languages] Name: \u0026#34;english\u0026#34;; MessagesFile: \u0026#34;compiler:Default.isl\u0026#34; Name: \u0026#34;chinesesimplified\u0026#34;; MessagesFile: \u0026#34;compiler:Languages\\ChineseSimplified.isl\u0026#34; æ³¨æ„ï¼šæ­¤ç¿»è¯‘ç‰ˆæœ¬æ”¯æŒ Inno Setup 6.1.0+ çš„è½¯ä»¶ï¼ŒInno Setup 5 çš„ç¿»è¯‘æ–‡ä»¶åœ¨è¿™é‡Œ\næŸ¥çœ‹6.1.0+å’Œ6.0.0+çš„åŒºåˆ«\næŸ¥çœ‹6.0.3+å’Œ6.0.0+çš„åŒºåˆ«\né“¾æ¥ Inno Setup issrc ","permalink":"https://kira-96.github.io/Inno-Setup-Chinese-Simplified-Translation/","summary":"\u003cp\u003e\u003ca href=\"https://github.com/kira-96/Inno-Setup-Chinese-Simplified-Translation/issues\"\u003e\u003cimg alt=\"GitHub issues\" loading=\"lazy\" src=\"https://img.shields.io/github/issues/kira-96/Inno-Setup-Chinese-Simplified-Translation\"\u003e\u003c/a\u003e\n\u003ca href=\"https://github.com/kira-96/Inno-Setup-Chinese-Simplified-Translation/network\"\u003e\u003cimg alt=\"GitHub forks\" loading=\"lazy\" src=\"https://img.shields.io/github/forks/kira-96/Inno-Setup-Chinese-Simplified-Translation\"\u003e\u003c/a\u003e\n\u003ca href=\"https://github.com/kira-96/Inno-Setup-Chinese-Simplified-Translation/stargazers\"\u003e\u003cimg alt=\"GitHub stars\" loading=\"lazy\" src=\"https://img.shields.io/github/stars/kira-96/Inno-Setup-Chinese-Simplified-Translation\"\u003e\u003c/a\u003e\n\u003ca href=\"https://github.com/kira-96/Inno-Setup-Chinese-Simplified-Translation\"\u003e\u003cimg alt=\"GitHub license\" loading=\"lazy\" src=\"https://img.shields.io/github/license/kira-96/Inno-Setup-Chinese-Simplified-Translation\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"é£Ÿç”¨æ–¹æ³•\"\u003eé£Ÿç”¨æ–¹æ³•\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eStep 1\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eå°†\u003cstrong\u003eChineseSimplified.isl\u003c/strong\u003eæ”¾åˆ°\u003cstrong\u003eInno Setupå®‰è£…ç›®å½•\u003c/strong\u003eä¸‹çš„\u0026quot;Languages\u0026quot;æ–‡ä»¶å¤¹é‡Œé¢\u003c/p\u003e","title":"Inno Setup ç®€ä½“ä¸­æ–‡è¯­è¨€åŒ…"},{"content":"ç®€ä»‹ Prismæ˜¯ä¸€ä¸ªç”¨äºWPFã€Xamarin Formsã€WinUIç­‰çš„MVVMæ¡†æ¶ï¼Œåˆšåˆšå­¦ä¹ ï¼Œè¿™é‡Œåªæ˜¯ä¸ªäººæ€»ç»“çš„ä¸€äº›çŸ¥è¯†ç‚¹ç¬”è®°ã€‚\nIoC IContainerProvider\ncsharp \u0026#9660; 1 2 3 4 protected override Window CreateShell() { return Container.Resolve\u0026lt;MainWindow\u0026gt;(); } csharp \u0026#9660; 1 2 3 4 5 6 public void OnInitialized(IContainerProvider containerProvider) { var regionManager = containerProvider.Resolve\u0026lt;IRegionManager\u0026gt;(); var viewA = containerProvider.Resolve\u0026lt;ViewA\u0026gt;(); ... } IContainerRegistry\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 // App.xaml.cs protected override void RegisterTypes(IContainerRegistry containerRegistry) { containerRegistry.Register\u0026lt;IApplicationCommands, ApplicationCommands\u0026gt;(); containerRegistry.RegisterDialog\u0026lt;NotificationDialog, NotificationDialogViewModel\u0026gt;(); containerRegistry.RegisterForNavigation\u0026lt;Page1\u0026gt;(); containerRegistry.RegisterForNavigation\u0026lt;Page2\u0026gt;(); ... } Module IModule\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 public class SimpleModule : IModule { public void OnInitialized(IContainerProvider containerProvider) { } public void RegisterTypes(IContainerRegistry containerRegistry) { } } ä½¿ç”¨App.configåŠ è½½æ¨¡å—\nxml \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 \u0026lt;!-- App.config --\u0026gt; \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;configSections\u0026gt; \u0026lt;section name=\u0026#34;modules\u0026#34; type=\u0026#34;Prism.Modularity.ModulesConfigurationSection, Prism.Wpf\u0026#34; /\u0026gt; \u0026lt;/configSections\u0026gt; \u0026lt;startup\u0026gt; \u0026lt;/startup\u0026gt; \u0026lt;modules\u0026gt; \u0026lt;module assemblyFile=\u0026#34;Simple.dll\u0026#34; moduleType=\u0026#34;Simple.SimpleModule, Simple, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\u0026#34; moduleName=\u0026#34;SimpleModule\u0026#34; startupLoaded=\u0026#34;True\u0026#34; /\u0026gt; \u0026lt;/modules\u0026gt; \u0026lt;/configuration\u0026gt; csharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 // App.xaml.cs public partial class App : PrismApplication { ... protected override IModuleCatalog CreateModuleCatalog() { return new ConfigurationModuleCatalog(); } ... } ç›´æ¥å¼•ç”¨åŠ è½½æ¨¡å—\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 // App.xaml.cs public partial class App : PrismApplication { ... protected override void ConfigureModuleCatalog(IModuleCatalog moduleCatalog) { moduleCatalog.AddModule\u0026lt;SimpleModule\u0026gt;(); } ... } æŒ‡å®šæ¨¡å—æ–‡ä»¶å¤¹\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 // App.xaml.cs public partial class App : PrismApplication { ... protected override IModuleCatalog CreateModuleCatalog() { return new DirectoryModuleCatalog() { ModulePath = @\u0026#34;.\\Modules\u0026#34; }; } ... } ä½¿ç”¨ModuleCatalogåŠ è½½æ¨¡å—\nxml \u0026#9660; 1 2 3 4 5 6 7 8 \u0026lt;m:ModuleCatalog xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; xmlns:m=\u0026#34;clr-namespace:Prism.Modularity;assembly=Prism.Wpf\u0026#34;\u0026gt; \u0026lt;m:ModuleInfo ModuleName=\u0026#34;Simple\u0026#34; ModuleType=\u0026#34;Simple.SimpleModule, Simple, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\u0026#34; /\u0026gt; \u0026lt;/m:ModuleCatalog\u0026gt; csharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 // App.xaml.cs public partial class App : PrismApplication { ... protected override IModuleCatalog CreateModuleCatalog() { return ModuleCatalog.CreateFromXaml(new Uri(\u0026#34;/Modules;component/ModuleCatalog.xaml\u0026#34;, UriKind.Relative)); } ... } Command DelegateCommand\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 public DelegateCommand ExecuteDelegateCommand { get; } public DelegateCommand\u0026lt;string\u0026gt; ExecuteGenericDelegateCommand { get; } public DelegateCommand DelegateCommandObservesProperty { get; } public DelegateCommand DelegateCommandObservesCanExecute { get; } ExecuteDelegateCommand = new DelegateCommand(Execute, CanExecute); DelegateCommandObservesProperty = new DelegateCommand(Execute, CanExecute).ObservesProperty(() =\u0026gt; IsEnabled); DelegateCommandObservesCanExecute = new DelegateCommand(Execute).ObservesCanExecute(() =\u0026gt; IsEnabled); ExecuteGenericDelegateCommand = new DelegateCommand\u0026lt;string\u0026gt;(ExecuteGeneric).ObservesCanExecute(() =\u0026gt; IsEnabled); CompositeCommand\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 public CompositeCommand SampleCommand { get; } = new CompositeCommand(true); ... DelegateCommand UpdateCommand = new DelegateCommand(Update).ObservesCanExecute(() =\u0026gt; CanUpdate); SampleCommand.RegisterCommand(UpdateCommand); ... private void OnIsActiveChanged() { UpdateCommand.IsActive = IsActive; IsActiveChanged?.Invoke(this, new EventArgs()); } Event To Command\nxml \u0026#9660; 1 2 3 4 5 6 \u0026lt;i:Interaction.Triggers\u0026gt; \u0026lt;i:EventTrigger EventName=\u0026#34;SelectionChanged\u0026#34;\u0026gt; \u0026lt;prism:InvokeCommandAction Command=\u0026#34;{Binding PersonSelectedCommand}\u0026#34; CommandParameter=\u0026#34;{Binding ElementName=ListOfPerson, Path=SelectedItem}\u0026#34; /\u0026gt; \u0026lt;/i:EventTrigger\u0026gt; \u0026lt;/i:Interaction.Triggers\u0026gt; BindableBase csharp \u0026#9660; 1 2 3 4 public class ViewAViewModel : BindableBase, IActiveAware { ... } ViewModelLocator AutoWireViewModel\nxml \u0026#9660; 1 2 3 4 \u0026lt;Window x:Class=\u0026#34;Demo.Views.MainWindow\u0026#34; ... xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34;\u0026gt; æ›´æ”¹å‘½åçº¦å®š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 // App.xaml.cs public partial class App : PrismApplication { ... protected override void ConfigureViewModelLocator() { base.ConfigureViewModelLocator(); ViewModelLocationProvider.SetDefaultViewTypeToViewModelTypeResolver((viewType) =\u0026gt; { var viewName = viewType.FullName.Replace(\u0026#34;.ViewModels.\u0026#34;, \u0026#34;.CustomNamespace.\u0026#34;); var viewAssemblyName = viewType.GetTypeInfo().Assembly.FullName; var viewModelName = $\u0026#34;{viewName}ViewModel, {viewAssemblyName}\u0026#34;; return Type.GetType(viewModelName); }); } ... } è‡ªå®šä¹‰ViewModelæ³¨å†Œ\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 // App.xaml.cs public partial class App : PrismApplication { ... protected override void ConfigureViewModelLocator() { base.ConfigureViewModelLocator(); // type / type ViewModelLocationProvider.Register(typeof(MainWindow).ToString(), typeof(CustomViewModel)); // type / factory ViewModelLocationProvider.Register(typeof(MainWindow).ToString(), () =\u0026gt; Container.Resolve\u0026lt;CustomViewModel\u0026gt;()); // generic factory ViewModelLocationProvider.Register\u0026lt;MainWindow\u0026gt;(() =\u0026gt; Container.Resolve\u0026lt;CustomViewModel\u0026gt;()); // generic type ViewModelLocationProvider.Register\u0026lt;MainWindow, CustomViewModel\u0026gt;(); } ... } EventAggregator IEventAggragator\ncsharp \u0026#9660; 1 2 3 4 public interface IEventAggregator { TEventType GetEvent\u0026lt;TEventType\u0026gt;() where TEventType : EventBase; } åˆ›å»ºæ¶ˆæ¯äº‹ä»¶ç±»\ncsharp \u0026#9660; 1 2 3 public class SimpleMessageEvent : PubSubEvent\u0026lt;string\u0026gt; { } è®¢é˜…äº‹ä»¶\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 private readonly IEventAggregator eventAggregator; public MainPageViewModel(IEventAggregator ea) { eventAggregator = ea; ea.GetEvent\u0026lt;SimpleMessageEvent\u0026gt;().Subscribe(ShowMessage); // Subscribing on the UI Thread // ea.GetEvent\u0026lt;SimpleMessageEvent\u0026gt;().Subscribe(ShowMessage, ThreadOption.UIThread); } public void ShowMessage(string payload) { // TODO } å‘å¸ƒæ¶ˆæ¯\ncsharp \u0026#9660; 1 eventAggregator.GetEvent\u0026lt;SimpleMessageEvent\u0026gt;().Publish(\u0026#34;Hello!\u0026#34;); ç­›é€‰è®¢é˜…\ncsharp \u0026#9660; 1 ea.GetEvent\u0026lt;SimpleMessageEvent\u0026gt;().Subscribe(ShowMessage, ThreadOption.UIThread, keepSubscriberReferenceAlive, x =\u0026gt; x.Contains(\u0026#34; \u0026#34;)); å–æ¶ˆè®¢é˜…\ncsharp \u0026#9660; 1 eventAggregator.GetEvent\u0026lt;SimpleMessageEvent\u0026gt;().Unsubscribe(ShowMessage); RegionManager xml \u0026#9660; 1 2 3 4 5 6 7 8 9 \u0026lt;Window x:Class=\u0026#34;Regions.Views.MainWindow\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; Title=\u0026#34;Shell\u0026#34;\u0026gt; \u0026lt;Grid\u0026gt; \u0026lt;ContentControl prism:RegionManager.RegionName=\u0026#34;ContentRegion\u0026#34; /\u0026gt; \u0026lt;/Grid\u0026gt; \u0026lt;/Window\u0026gt; csharp \u0026#9660; 1 2 3 // IContainerProvider containerProvider var regionManager = containerProvider.Resolve\u0026lt;IRegionManager\u0026gt;(); regionManager.RegisterViewWithRegion(\u0026#34;ContentRegion\u0026#34;, typeof(ViewA)); csharp \u0026#9660; 1 2 3 4 5 6 7 // IContainerProvider containerProvider var regionManager = containerProvider.Resolve\u0026lt;IRegionManager\u0026gt;(); var region = regionManager.Regions[\u0026#34;ContentRegion\u0026#34;]; region.Add(containerProvider.Resolve\u0026lt;ViewA\u0026gt;()); region.Add(containerProvider.Resolve\u0026lt;ViewB\u0026gt;()); region.Add(containerProvider.Resolve\u0026lt;ViewC\u0026gt;()); RegionNavigation csharp \u0026#9660; 1 2 // IRegionManager regionManager regionManager.RequestNavigate(regionName: \u0026#34;NavigateRegion\u0026#34;, source: \u0026#34;Page1\u0026#34;); Navigation Callback\ncsharp \u0026#9660; 1 2 3 4 5 6 7 // IRegionManager regionManager regionManager.RequestNavigate(regionName: \u0026#34;NavigateRegion\u0026#34;, source: \u0026#34;Page1\u0026#34;, navigationCallback: NavigationComplete); private void NavigationComplete(NavigationResult result) { dialogService.ShowDialog(\u0026#34;NotificationDialog\u0026#34;, new DialogParameters($\u0026#34;message=Navigate to {result.Context.Uri} complete.\u0026#34;), null); } Navigation Parameters\ncsharp \u0026#9660; 1 2 3 4 5 6 var parameters = new NavigationParameters { { \u0026#34;content\u0026#34;, \u0026#34;Hello!\u0026#34; } }; // IRegionManager regionManager regionManager.RequestNavigate(regionName: \u0026#34;NavigateRegion\u0026#34;, source: \u0026#34;Page1\u0026#34;, navigationParameters: parameters); INavigationAware\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 public class Page1ViewModel : BindableBase, INavigationAware { ... public bool IsNavigationTarget(NavigationContext navigationContext) { return true; } public void OnNavigatedFrom(NavigationContext navigationContext) { } public void OnNavigatedTo(NavigationContext navigationContext) { if (navigationContext.Parameters[\u0026#34;content\u0026#34;] is string content) { // TODO } } ... } IConfirmNavigationRequest\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 public class Page1ViewModel : BindableBase, IConfirmNavigationRequest { ... public void ConfirmNavigationRequest(NavigationContext navigationContext, Action\u0026lt;bool\u0026gt; continuationCallback) { bool result = true; ButtonResult buttonResult = ButtonResult.None; dialogService.ShowDialog(\u0026#34;NotificationDialog\u0026#34;, new DialogParameters($\u0026#34;message=Do you to navigate?\u0026#34;), res =\u0026gt; { buttonResult = res.Result; }); if (buttonResult != ButtonResult.OK) result = false; continuationCallback(result); } ... } IRegionMemberLifetime\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 public class Page1ViewModel : BindableBase, INavigationAware, IRegionMemberLifetime { public bool KeepAlive { get { return false; } } public bool IsNavigationTarget(NavigationContext navigationContext) { return false; } public void OnNavigatedFrom(NavigationContext navigationContext) { } public void OnNavigatedTo(NavigationContext navigationContext) { } } Navigation Journal\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 public class Page1ViewModel : BindableBase, INavigationAware { private IRegionNavigationJournal journal; public DelegateCommand GoForwardCommand { get; } public DelegateCommand GoBackCommand { get; } public Page1ViewModel() { GoForwardCommand = new DelegateCommand(GoForward, CanGoForward); GoBackCommand = new DelegateCommand(GoBack); } ... public bool IsNavigationTarget(NavigationContext navigationContext) { return true; } public void OnNavigatedFrom(NavigationContext navigationContext) { } public void OnNavigatedTo(NavigationContext navigationContext) { journal = navigationContext.NavigationService.Journal; GoForwardCommand.RaiseCanExecuteChanged(); } ... private bool CanGoForward() { return journal != null \u0026amp;\u0026amp; journal.CanGoForward; } private void GoForward() { journal?.GoForward(); } private void GoBack() { journal?.GoBack(); } } DialogService See DOC. Dialog Service\ncsharp \u0026#9660; 1 2 3 4 5 6 // DialogServiceModule.cs public void RegisterTypes(IContainerRegistry containerRegistry) { containerRegistry.RegisterDialog\u0026lt;NotificationDialog, NotificationDialogViewModel\u0026gt;(); // containerRegistry.RegisterDialogWindow\u0026lt;MyRibbonWindow\u0026gt;(); } csharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 // viewmodel private readonly IDialogService dialogService; public MainViewModel(IDialogService dialogService) { this.dialogService = dialogService; } private void NavigationComplete(NavigationResult result) { // Show Dialog with parameters. dialogService.ShowDialog(\u0026#34;NotificationDialog\u0026#34;, new DialogParameters($\u0026#34;message=Navigate to {result.Context.Uri} complete.\u0026#34;), null); } å‚è€ƒ Documentation Prism-Samples-Wpf ","permalink":"https://kira-96.github.io/posts/prism-note/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/PrismLibrary/Prism\"\u003ePrism\u003c/a\u003eæ˜¯ä¸€ä¸ªç”¨äºWPFã€Xamarin Formsã€WinUIç­‰çš„MVVMæ¡†æ¶ï¼Œåˆšåˆšå­¦ä¹ ï¼Œè¿™é‡Œåªæ˜¯ä¸ªäººæ€»ç»“çš„ä¸€äº›çŸ¥è¯†ç‚¹ç¬”è®°ã€‚\u003c/p\u003e\n\u003ch2 id=\"ioc\"\u003eIoC\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ccode\u003eIContainerProvider\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"csharp\"\u003ecsharp\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csharp\" data-lang=\"csharp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003eprotected\u003c/span\u003e \u003cspan class=\"kd\"\u003eoverride\u003c/span\u003e \u003cspan class=\"n\"\u003eWindow\u003c/span\u003e \u003cspan class=\"n\"\u003eCreateShell\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eContainer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResolve\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eMainWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"csharp\"\u003ecsharp\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csharp\" data-lang=\"csharp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eOnInitialized\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIContainerProvider\u003c/span\u003e \u003cspan class=\"n\"\u003econtainerProvider\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eregionManager\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtainerProvider\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResolve\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eIRegionManager\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003evar\u003c/span\u003e \u003cspan class=\"n\"\u003eviewA\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtainerProvider\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eResolve\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eViewA\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ccode\u003eIContainerRegistry\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"csharp\"\u003ecsharp\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e9\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csharp\" data-lang=\"csharp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// App.xaml.cs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003eprotected\u003c/span\u003e \u003cspan class=\"kd\"\u003eoverride\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eRegisterTypes\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eIContainerRegistry\u003c/span\u003e \u003cspan class=\"n\"\u003econtainerRegistry\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003econtainerRegistry\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRegister\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eIApplicationCommands\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eApplicationCommands\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003econtainerRegistry\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRegisterDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eNotificationDialog\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eNotificationDialogViewModel\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003econtainerRegistry\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRegisterForNavigation\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003ePage1\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003econtainerRegistry\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eRegisterForNavigation\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003ePage2\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003ch2 id=\"module\"\u003eModule\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ccode\u003eIModule\u003c/code\u003e\u003c/strong\u003e\u003c/p\u003e","title":"Prism note"},{"content":"ç®€ä»‹ Inno Setupæ˜¯ä¸€ä¸ªå…è´¹çš„å®‰è£…åŒ…ç”Ÿæˆè½¯ä»¶ï¼Œå®Œå…¨å¼€æºå…è´¹ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿéå¸¸æ–¹ä¾¿ï¼Œæ–‡æ¡£ä¹Ÿååˆ†å…¨é¢ã€‚ä¸å…¶å®ƒåŒç±»è½¯ä»¶ç›¸æ¯”ååˆ†çš„å°å·§ä¾¿æºï¼ŒåŠŸèƒ½ä¹Ÿååˆ†å…¨é¢ã€‚\nè¿‘æœŸInno Setupçš„6.1.0ç‰ˆæœ¬ä¹Ÿå³å°†å‘å¸ƒï¼Œä¹Ÿå¸¦æ¥äº†æ›´å¤šçš„æ–°åŠŸèƒ½ã€‚ç”±äºæ­£å¼ç‰ˆæœ¬è¿˜æ²¡æœ‰å‘å¸ƒï¼Œè¿™é‡Œå°±ä½¿ç”¨çš„å…ˆè¡Œç‰ˆæœ¬ã€‚\nä¸‹è½½é¡µé¢ Inno Setup 6.1ç‰ˆæœ¬æ–°å¢äº†å®‰è£…è¿‡ç¨‹ä¸­çš„ä¸‹è½½é¡µé¢ï¼Œåœ¨æ‰€æœ‰é€‰é¡¹å‡†å¤‡å®Œæ¯•ï¼Œæ­£å¼å¼€å§‹å®‰è£…ä¹‹å‰å¯ä»¥ä¸‹è½½éœ€è¦çš„æ–‡ä»¶ã€‚å®˜æ–¹ä¹Ÿç»™å‡ºäº†ä¸‹è½½ç¤ºä¾‹çš„ä»£ç  CodeDownloadFiles.issã€‚\npascal \u0026#9660; [Code] var DownloadPage: TDownloadWizardPage; function OnDownloadProgress(const Url, FileName: String; const Progress, ProgressMax: Int64): Boolean; begin if Progress = ProgressMax then Log(Format(\u0026#39;Successfully downloaded file to {tmp}: %s\u0026#39;, [FileName])); Result := True; end; procedure InitializeWizard; begin DownloadPage := CreateDownloadPage(SetupMessage(msgWizardPreparing), SetupMessage(msgPreparingDesc), @OnDownloadProgress); end; function NextButtonClick(CurPageID: Integer): Boolean; begin if CurPageID = wpReady then begin DownloadPage.Clear; DownloadPage.Add(\u0026#39;https://files.jrsoftware.org/is/6/innosetup-6.1.0-dev.exe\u0026#39;, \u0026#39;innosetup-6.1.0-dev.exe\u0026#39;, \u0026#39;\u0026#39;); DownloadPage.Add(\u0026#39;https://jrsoftware.org/download.php/iscrypt.dll\u0026#39;, \u0026#39;ISCrypt.dll\u0026#39;, \u0026#39;2f6294f9aa09f59a574b5dcd33be54e16b39377984f3d5658cda44950fa0f8fc\u0026#39;); DownloadPage.Show; try try DownloadPage.Download; Result := True; except SuppressibleMsgBox(AddPeriod(GetExceptionMessage), mbCriticalError, MB_OK, IDOK); Result := False; end; finally DownloadPage.Hide; end; end else Result := True; end; ä¸Šé¢ä»£ç åœ¨åˆå§‹åŒ–æ—¶åˆ›å»ºäº†ä¸€ä¸ªä¸‹è½½é¡µé¢ï¼Œå¹¶åœ¨wpReadyä¹‹åæ˜¾ç¤ºã€‚\nCreateDownloadPageçš„åŸå‹ï¼š\npascal \u0026#9660; function CreateDownloadPage(const ACaption, ADescription: String; const OnDownloadProgress: TOnDownloadProgress): TDownloadWizardPage; åˆ›å»ºä¸€ä¸ªä¸‹è½½é¡µé¢ç”¨äºä¸‹è½½æ–‡ä»¶å¹¶æ˜¾ç¤ºè¿›åº¦ã€‚\nå‰ä¸¤ä¸ªå‚æ•°æŒ‡å®šé¡µé¢çš„æ ‡é¢˜å’Œé¡µé¢æè¿°ï¼Œç¬¬3ä¸ªå‚æ•°æ˜¯åœ¨ä¸‹è½½è¿›åº¦æ›´æ–°åçš„å›è°ƒå‡½æ•°TOnDownloadProgressï¼Œå¯ä»¥æŒ‡å®šä¸ºnilï¼ˆç©ºï¼‰ã€‚\npascal \u0026#9660; TOnDownloadProgress = function(const Url, FileName: string; const Progress, ProgressMax: Int64): Boolean; CreateDownloadPageè¿”å›TDownloadWizardPageç±»å‹ï¼š\npascal \u0026#9660; TDownloadWizardPage = class(TOutputProgressWizardPage) property AbortButton: TNewButton; read; procedure Add(const Url, BaseName, RequiredSHA256OfFile: String); procedure Clear; function Download: Int64; end; å¯ä»¥çœ‹åˆ°ï¼ŒTDownloadWizardPageæœ‰ä¸€ä¸ªAddçš„æ–¹æ³•ï¼Œç”¨äºæ–°å¢ä¸€ä¸ªä¸‹è½½ä»»åŠ¡ï¼Œå®ƒæœ‰3ä¸ªå‚æ•°ï¼š\nUrlï¼šä¸‹è½½é“¾æ¥ï¼ŒBaseNameï¼šä¸‹è½½åçš„æ–‡ä»¶åç§°\nRequiredSHA256OfFileï¼šæ–‡ä»¶çš„å“ˆå¸Œå€¼ï¼Œç”¨äºæ ¡éªŒä¸‹è½½æ–‡ä»¶ï¼Œå€¼ä¸ºç©ºæ—¶ï¼Œåˆ™å¿½ç•¥æ ¡éªŒ\nClearæ–¹æ³•æ¸…ç©ºä¸‹è½½ä»»åŠ¡åˆ—è¡¨ï¼ŒDownloadæ–¹æ³•å¼€å§‹ä¸‹è½½ä»»åŠ¡ã€‚\nå…·ä½“çš„ä½¿ç”¨å¯ä»¥çœ‹ä¸Šé¢çš„NextButtonClickå‡½æ•°é‡Œçš„å†™æ³•ã€‚\nå¦ä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨DownloadTemporaryFileå‡½æ•°ï¼š\npascal \u0026#9660; function DownloadTemporaryFile(const Url, FileName, RequiredSHA256OfFile: String; const OnDownloadProgress: TOnDownloadProgress): Int64; pascal \u0026#9660; [Code] function OnDownloadProgress(const Url, Filename: string; const Progress, ProgressMax: Int64): Boolean; begin if ProgressMax \u0026lt;\u0026gt; 0 then Log(Format(\u0026#39; %d of %d bytes done.\u0026#39;, [Progress, ProgressMax])) else Log(Format(\u0026#39; %d bytes done.\u0026#39;, [Progress])); Result := True; end; function InitializeSetup: Boolean; begin try DownloadTemporaryFile(\u0026#39;https://jrsoftware.org/download.php/is.exe\u0026#39;, \u0026#39;innosetup-latest.exe\u0026#39;, \u0026#39;\u0026#39;, @OnDownloadProgress); DownloadTemporaryFile(\u0026#39;https://jrsoftware.org/download.php/iscrypt.dll\u0026#39;, \u0026#39;ISCrypt.dll\u0026#39;, \u0026#39;2f6294f9aa09f59a574b5dcd33be54e16b39377984f3d5658cda44950fa0f8fc\u0026#39;, @OnDownloadProgress); Result := True; except Log(GetExceptionMessage); Result := False; end; end; ä½¿ç”¨èµ·æ¥å’Œå‰ä¸€ç§æ–¹æ³•æœ‰æ‰€ä¸åŒï¼Œä½†å¤§è‡´éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚\næ¶ˆæ¯æ¡†è®¾è®¡å™¨ è½¯ä»¶çš„å·¥å…·èœå•ï¼ˆToolsï¼‰ä¸­æ–°å¢äº†æ¶ˆæ¯æ¡†è®¾è®¡å™¨ï¼ˆMessageBox Designerï¼‰å·¥å…·ã€‚\nå·¥å…·æä¾›äº†ä¸¤ç§æ¶ˆæ¯æ¡†ï¼ŒMessage Boxå’ŒTask Dialog Message Boxï¼Œå·¥å…·å¯ä»¥è®¾ç½®å¯¹è¯æ¡†çš„å›¾æ ‡ï¼ŒæŒ‰é’®å’Œé»˜è®¤é€‰é¡¹ç­‰ã€‚\nå°†é¼ æ ‡æŒ‡é’ˆæ”¾åœ¨éœ€è¦æ’å…¥å¯¹è¯æ¡†çš„ä»£ç ä½ç½®ï¼Œæ‰“å¼€MessageBox Designerï¼Œå®Œæˆé€‰é¡¹åç‚¹å‡»OKå³å¯ï¼Œç„¶åå°±å¯ä»¥çœ‹åˆ°å…ˆå‰é¼ æ ‡æ‰€åœ¨çš„ä½ç½®æ’å…¥äº†ä¸€æ®µMessageBoxä»£ç ã€‚\nini \u0026#9660; 1 2 3 [CustomMessages] DownloadComplete=ä¸‹è½½å®Œæˆ DownloadCompleteMessage=ä¸‹è½½å·²å®Œæˆã€‚ pascal \u0026#9660; // Display a message box SuppressibleTaskDialogMsgBox(CustomMessage(\u0026#39;DownloadComplete\u0026#39;), CustomMessage(\u0026#39;DownloadCompleteMessage\u0026#39;), mbInformation, MB_OK, [\u0026#39;OK\u0026#39;], 0, IDOK); é“¾æ¥ Inno Setup 6 Revision History Inno Setup ç®€ä½“ä¸­æ–‡ç¿»è¯‘ ","permalink":"https://kira-96.github.io/posts/inno-setup-6.1.0-%E6%96%B0%E5%A2%9E%E7%9A%84%E5%8A%9F%E8%83%BD%E4%BD%93%E9%AA%8C/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://jrsoftware.org/isinfo.php\"\u003eInno Setup\u003c/a\u003eæ˜¯ä¸€ä¸ªå…è´¹çš„å®‰è£…åŒ…ç”Ÿæˆè½¯ä»¶ï¼Œå®Œå…¨å¼€æºå…è´¹ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿéå¸¸æ–¹ä¾¿ï¼Œæ–‡æ¡£ä¹Ÿååˆ†å…¨é¢ã€‚ä¸å…¶å®ƒåŒç±»è½¯ä»¶ç›¸æ¯”ååˆ†çš„å°å·§ä¾¿æºï¼ŒåŠŸèƒ½ä¹Ÿååˆ†å…¨é¢ã€‚\u003c/p\u003e","title":"Inno Setup 6.1.0 æ–°å¢çš„åŠŸèƒ½ä½“éªŒ"},{"content":"ç®€ä»‹ åœ¨ç¼–ç çš„æ—¶å€™éš¾å…ä¼šé‡åˆ°ä¸åŒç¼–ç¨‹è¯­è¨€ä¹‹é—´çš„æ¥å£è°ƒç”¨ï¼Œå…¶ä¸­æœ€é€šç”¨çš„å°±æ˜¯Cçš„åŠ¨æ€é“¾æ¥åº“ï¼Œå‡ ä¹æ‰€æœ‰è¯­è¨€éƒ½å¯ä»¥è°ƒç”¨Cçš„æ¥å£å‡½æ•°ã€‚é‚£ä¹ˆè¿™ç§å…³ç³»èƒ½å¦åè¿‡æ¥å‘¢ï¼Ÿç”¨Cè°ƒç”¨å…¶å®ƒçš„å‡½æ•°æ¥å£ï¼Œå½“ç„¶ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåªéœ€è¦å°†å‡½æ•°æŒ‡é’ˆä½œä¸ºå‚æ•°ä¼ é€’è¿›å»å°±å¯ä»¥äº†ã€‚\nC#ä¸­ä½¿ç”¨Delegateæ¥è¡¨ç¤ºå‡½æ•°æŒ‡é’ˆã€‚\nå‡†å¤‡å·¥ä½œ é¦–å…ˆæ–°å»ºä¸€ä¸ªC++çš„åŠ¨æ€åº“ï¼Œéšä¾¿å®šä¹‰ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆç±»å‹ï¼Œä»¥åŠä¸€ä¸ªå¯¼å‡ºå‡½æ•°ã€‚å¤§è‡´å†…å®¹å¦‚ä¸‹ï¼š\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 #include \u0026#34;pch.h\u0026#34; #include \u0026lt;iostream\u0026gt; using namespace std; #ifdef DYNLIB_EXPORTS #define DLL_API extern \u0026#34;C\u0026#34; __declspec(dllexport) #else #define DLL_API extern \u0026#34;C\u0026#34; __declspec(dllimport) #endif typedef struct { int Left; int Top; int Right; int Bottom; } MyRect, * MyRectPtr; // å‡½æ•°æŒ‡é’ˆ typedef VOID(CALLBACK* PRINTCALLBACK)(MyRectPtr); BOOL APIENTRY DllMain( HMODULE hModule, DWORD ul_reason_for_call, LPVOID lpReserved ) { switch (ul_reason_for_call) { case DLL_PROCESS_ATTACH: case DLL_THREAD_ATTACH: case DLL_THREAD_DETACH: case DLL_PROCESS_DETACH: break; } return TRUE; } // å¯¼å‡ºå‡½æ•°ï¼Œä½¿ç”¨ä¸Šé¢å®šä¹‰çš„å‡½æ•°æŒ‡é’ˆç±»å‹ä½œä¸ºå‚æ•° DLL_API VOID Print(MyRectPtr pRect, PRINTCALLBACK callback) { if (callback == NULL) { cout \u0026lt;\u0026lt; \u0026#39;\\t\u0026#39; \u0026lt;\u0026lt; pRect-\u0026gt;Top \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; pRect-\u0026gt;Left \u0026lt;\u0026lt; \u0026#34;\\t\\t\u0026#34; \u0026lt;\u0026lt; pRect-\u0026gt;Right \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; \u0026#39;\\t\u0026#39; \u0026lt;\u0026lt; pRect-\u0026gt;Bottom \u0026lt;\u0026lt; endl; } else { callback(pRect); } } å‡†å¤‡å¥½äº†C++çš„éƒ¨åˆ†ï¼Œå†æ¥å†™C#éƒ¨åˆ†çš„ä»£ç ï¼š\né¦–å…ˆå®šä¹‰ä¸€ä¸ªå’ŒC++éƒ¨åˆ†ç›¸åŒçš„MyRectç»“æ„ä½“å’Œå‡½æ•°æŒ‡é’ˆç±»å‹delegate\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 // å¯¹åº”C++éƒ¨åˆ†çš„MyRect [StructLayout(LayoutKind.Sequential)] struct MyRect { public int Left; public int Top; public int Right; public int Bottom; } // å¯¹åº”C++éƒ¨åˆ†çš„ PRINTCALLBACK [UnmanagedFunctionPointer(CallingConvention.StdCall)] delegate void PrintRect(ref MyRect myRect); è¿™æ ·å‡†å¤‡å·¥ä½œå°±åšå®Œäº†ï¼Œä¸€å®šè¦ä¿è¯C++éƒ¨åˆ†å’ŒC#éƒ¨åˆ†å®šä¹‰çš„æ•°æ®ç±»å‹å’Œæ¥å£ä¸€è‡´ï¼Œä¸ç„¶è°ƒç”¨æ—¶ä¼šå‡ºé—®é¢˜çš„ã€‚\nè°ƒç”¨ å¯¼å…¥C++åŠ¨æ€åº“çš„å‡½æ•°å…¥å£\ncsharp \u0026#9660; 1 2 [DllImport(\u0026#34;DynLib.dll\u0026#34;, EntryPoint = \u0026#34;#1\u0026#34;, CallingConvention = CallingConvention.Cdecl)] public static extern void PrintInCpp(ref MyRect pRect, PrintRect callback); ç„¶åå®šä¹‰å¥½C#è¿™è¾¹çš„delegateå®ä¾‹ï¼Œå°±å®Œæˆäº†ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 static void Print(ref MyRect myRect) { Console.WriteLine(\u0026#34;C# Print func called.\u0026#34;); Console.WriteLine(\u0026#34;[({0},{1}),({2},{3})]\u0026#34;, myRect.Left, myRect.Top, myRect.Right, myRect.Bottom); } static void Main() { var rect = new MyRect() { Left = 100, Top = 100, Right = 220, Bottom = 200 }; PrintInCpp(ref rect, null); // callbackä¸ºnull PrintInCpp(ref rect, new PrintRect(Print)); Console.WriteLine(\u0026#34;Press any key exit...\u0026#34;); Console.ReadKey(true); } è¿™é‡Œè°ƒç”¨äº†ä¸¤æ¬¡æ¥å£å‡½æ•°ï¼Œä¸ºäº†æ–¹ä¾¿çœ‹å‡ºåŒºåˆ«ï¼Œåœ¨callbackå‚æ•°ä¸ºNULLæ—¶ï¼Œä¼šç”±c++æ‰“å°ç»“æœï¼Œå¦åˆ™c++ä¼šè°ƒç”¨å¤–éƒ¨çš„å‡½æ•°æ¥å£ã€‚\nè¾“å‡ºç»“æœï¼š\nbash \u0026#9660; 1 2 3 4 5 6 7 ./delegatefunc 100 100 220 200 C# Print func called. [(100,100),(220,200)] Press any key exit... ","permalink":"https://kira-96.github.io/posts/%E4%BC%A0%E9%80%92%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88%E5%88%B0c__/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003cp\u003eåœ¨ç¼–ç çš„æ—¶å€™éš¾å…ä¼šé‡åˆ°ä¸åŒç¼–ç¨‹è¯­è¨€ä¹‹é—´çš„æ¥å£è°ƒç”¨ï¼Œå…¶ä¸­æœ€é€šç”¨çš„å°±æ˜¯\u003ccode\u003eC\u003c/code\u003eçš„åŠ¨æ€é“¾æ¥åº“ï¼Œå‡ ä¹æ‰€æœ‰è¯­è¨€éƒ½å¯ä»¥è°ƒç”¨\u003ccode\u003eC\u003c/code\u003eçš„æ¥å£å‡½æ•°ã€‚é‚£ä¹ˆè¿™ç§å…³ç³»èƒ½å¦åè¿‡æ¥å‘¢ï¼Ÿç”¨\u003ccode\u003eC\u003c/code\u003eè°ƒç”¨å…¶å®ƒçš„å‡½æ•°æ¥å£ï¼Œå½“ç„¶ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåªéœ€è¦å°†å‡½æ•°æŒ‡é’ˆä½œä¸ºå‚æ•°ä¼ é€’è¿›å»å°±å¯ä»¥äº†ã€‚\u003c/p\u003e","title":"C#ä¼ é€’å‡½æ•°æŒ‡é’ˆåˆ°C++"},{"content":"å¸¸ç”¨å›¾åƒåƒç´ ç›¸å…³çš„ä¸€äº›Tag Tag VR Keyword (0028,0002) US Samples Per Pixel (0028,0004) CS Photometric Interpretation (0028,0006) US Planar Configuration (0028,0010) US Rows (0028,0011) US Columns (0028,0100) US Bits Allocated (0028,0101) US Bits Stored (0028,0102) US High Bit (0028,0103) US Pixel Representation (7FE0,0010) OB/OW Pixel Data ç›¸å…³Tagè¯´æ˜ Sample Per Pixel Samples per Pixel (0028,0002) is the number of separate planes in this image. One and three image planes are defined. Other numbers of image planes are allowed, but their meaning is not defined by this Standard.\nFor monochrome (gray scale) and palette color images, the number of planes is 1. For RGB and other three vector color models, the value of this Attribute is 3.\nSamples Per Pixel æŒ‡æ­¤å›¾åƒä¸­å¹³é¢çš„ä¸ªæ•°ã€‚å¯¹äºç°åº¦å›¾åƒï¼Œå®ƒçš„å€¼ä¸º1ï¼Œå¯¹äºRGBç­‰å½©è‰²å›¾åƒï¼Œå®ƒçš„å€¼ä¸º3ã€‚ å¬èµ·æ¥å¯èƒ½æ¯”è¾ƒæ‹—å£ï¼Œç®€å•è§£é‡Šä¸€ä¸‹ï¼Œå¯¹äºç°åº¦çš„å›¾åƒï¼Œå®ƒåªæœ‰ä¸€ä¸ªç°åº¦å€¼ï¼Œæ‰€ä»¥æ˜¯1ï¼Œè€Œå½©è‰²çš„å›¾åƒé€šå¸¸æ˜¯ç”±RGBä¸‰ä¸ªé€šé“æ··åˆè€Œæˆï¼Œå®ƒçš„å€¼ä¸º3ã€‚\nPhotometric Interpretation æŒ‡å®šè§£æå›¾åƒåƒç´ çš„æ ¼å¼ã€‚ä¸ªäººæ¯”è¾ƒä¹ æƒ¯å«å®ƒå›¾åƒç±»å‹ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸ªtagåˆ¤æ–­å›¾åƒæ˜¯ç°åº¦è¿˜æ˜¯å½©è‰²å›¾åƒã€‚\nMONOCHROME1\nç°åº¦å›¾ï¼Œæœ€å°å€¼æ˜¾ç¤ºä¸ºç™½è‰²ï¼Œåƒç´ å€¼è¶Šå¤§å°±è¶Šé»‘ã€‚\nMONOCHROME2\nç°åº¦å›¾ï¼Œæœ€å°å€¼æ˜¾ç¤ºä¸ºé»‘è‰²ï¼Œåƒç´ å€¼è¶Šå¤§å°±è¶Šäº®ã€‚è¿™åº”è¯¥æ˜¯æœ€å¸¸ç”¨çš„æ ¼å¼äº†ã€‚\nPALETTE COLOR\nè‡ªå¸¦è°ƒè‰²æ¿çš„å›¾åƒï¼Œæ˜¾ç¤ºå‡ºæ¥æ˜¯å½©è‰²çš„ï¼Œæ‰€ä»¥å±äºå½©å›¾ã€‚å½“ä½¿ç”¨å®ƒæ—¶ï¼ŒSamples Per Pixelçš„å€¼å¿…é¡»ä¸º1ã€‚å¹¶ä¸”å¿…é¡»è¦æœ‰RGBä¸‰ç§é¢œè‰²çš„è°ƒè‰²æ¿æŸ¥æ‰¾è¡¨ï¼Œå®ƒçš„åƒç´ å€¼(Pixel Data)ç”¨äºæŸ¥æ‰¾è¡¨ã€‚\nThe pixel value is used as an index into each of the Red, Blue, and Green Palette Color Lookup Tables (0028,1101-1103\u0026amp;1201-1203).\nRGB\nå½©è‰²å›¾åƒï¼Œæ¯ä¸ªåƒç´ ç”±RGBä¸‰ç§é¢œè‰²ç»„æˆï¼ŒSamples Per Pixelå€¼å¿…é¡»ä¸º3ã€‚\nYBR_FULL\né€šè¿‡è‰²åº¦ä¿¡å·æ¥è¡¨ç¤ºé¢œè‰²çš„æ ¼å¼ï¼Œæ¯ä¸ªåƒç´ ç”±ä¸€ä¸ªäº®åº¦Y(luminance)å’Œä¸¤ä¸ªè‰²åº¦Cb(è“è‰²)ã€Cr(çº¢è‰²)ç»„æˆã€‚Samples Per Pixelå€¼ä¸º3ã€‚ $$Y=+0.2990R+0.5870G+0.1140B$$ $$Cb=-0.1687R-0.3313G+0.5000B+128$$ $$Cr=+0.5000R-0.4187G-0.0813B+128$$\nYBR_FULL_422\nç±»ä¼¼äºYBR_FULLï¼Œé€šè¿‡è‰²åº¦ä¿¡å·æ¥è¡¨ç¤ºé¢œè‰²çš„æ ¼å¼ï¼Œæ¯ä¸ªåƒç´ ç‚¹éƒ½æœ‰å¯¹åº”çš„äº®åº¦Y(luminance)ï¼Œæ¯ä¸¤ä¸ªåƒç´ ç‚¹é‡‡é›†ä¸€æ¬¡è‰²åº¦ä¿¡å·ï¼Œç¼ºå°‘çš„è‰²åº¦ä¿¡æ¯é€šè¿‡å†…æ’è¡¥ç‚¹çš„æ–¹å¼è¿ç®—å¾—åˆ°ã€‚ Samples Per Pixelçš„å€¼åº”è¯¥ä¸º3ï¼ŒPlanar Configurationçš„å€¼å¿…é¡»æ˜¯0ï¼Œåƒç´ å­˜å‚¨çš„æ ¼å¼ä¸ºï¼šY, Y, Cb, Cr, ...\nYBR_PARTIAL_422(Retired)\nç±»ä¼¼äºYBR_FULL_422ï¼Œé€šè¿‡è‰²åº¦ä¿¡å·æ¥è¡¨ç¤ºé¢œè‰²çš„æ ¼å¼ï¼Œä¸è¿‡äº®åº¦å’Œè‰²åº¦çš„è®¡ç®—æ–¹å¼å’ŒYBR_FULLçš„è®¡ç®—æ–¹å¼ä¸åŒã€‚ $$Y=+0.2568R+0.5041G+0.0979B+16$$ $$Cb=-0.1482R-0.2910G+0.4392B+128$$ $$Cr=+0.4392R-0.3678G-0.0714B+128$$\nYBR_PARTIAL_420\nç±»ä¼¼äºYBR_PARTIAL_422ï¼Œé€šè¿‡è‰²åº¦ä¿¡å·æ¥è¡¨ç¤ºé¢œè‰²çš„æ ¼å¼ï¼Œä¸åŒçš„æ˜¯ï¼Œç”¨4:2:2çš„é‡‡æ ·æ–¹å¼æ—¶ï¼Œè¡Œæ–¹å‘çš„è‰²åº¦ä¿¡æ¯ä¼šè¢«ä¸¢æ‰ä¸€åŠï¼Œè€Œ4:2:0çš„é‡‡æ ·æ–¹å¼ï¼Œä¸ä»…ä¼šæŠŠè¡Œæ–¹å‘çš„è‰²åº¦ä¿¡æ¯ä¸¢æ‰ä¸€åŠï¼Œåˆ—æ–¹å‘çš„è‰²åº¦ä¿¡æ¯ä¹Ÿä¼šè¢«ä¸¢æ‰ä¸€åŠã€‚è‰²åº¦çš„é‡‡æ ·ï¼ˆCb,Crï¼‰åªæœ‰äº®åº¦Y(luminance)çš„ 1/4ã€‚ Samples Per Pixelçš„å€¼åº”è¯¥ä¸º3ï¼ŒPlanar Configurationçš„å€¼å¿…é¡»æ˜¯0ã€‚\nYBR_ICT\nIrreversible Color Transformation.(ä¸å¯é€†é¢œè‰²å˜æ¢)\nYCbCrçš„è®¡ç®—æ–¹å¼å’ŒYBR_FULLä¸€æ ·ã€‚Yä¸º0æ—¶è¡¨ç¤ºé»‘è‰²ï¼ŒCbï¼ŒCréƒ½ä¸º0æ—¶è¡¨ç¤ºæ²¡æœ‰é¢œè‰²ã€‚ JPEG 2000æœ‰æŸå‹ç¼©çš„å½©è‰²å›¾åƒã€‚Samples Per Pixelçš„å€¼åº”è¯¥ä¸º3ï¼ŒPlanar Configurationçš„å€¼å¿…é¡»æ˜¯0ã€‚\nYBR_RCT\nReversible Color Transformation.(å¯é€†é¢œè‰²å˜æ¢)\nJPEG 2000æ— æŸå‹ç¼©çš„å½©è‰²å›¾åƒã€‚Samples Per Pixelçš„å€¼åº”è¯¥ä¸º3ã€‚ ä»RGBè½¬æ¢åˆ°YBR_RCT $$Y=floor(\\frac{R+2G+B}{4})$$ $$Cb=B-G$$ $$Cr=R-G$$ ä»YBR_RCTè½¬æ¢åˆ°RGB $$R=Cr+G$$ $$G=Y-floor(\\frac{Cb+Cr}{4})$$ $$B=Cb+G$$\nä¸å†ä½¿ç”¨çš„æ ¼å¼\nHSVã€ARGBã€CMYK\nPlanar Configuration æŒ‡å®šé¢œè‰²æ˜¯æŒ‰ç…§åƒç´ æ¥æ’åˆ—çš„æˆ–æ˜¯æŒ‰å¹³é¢ï¼ˆplaneï¼‰æ¥æ’åˆ—çš„ã€‚å½“Samples Per Pixelå¤§äº1æ—¶åº”è®¾å®šæ­¤å€¼ã€‚ å½“å€¼ä¸º0æ—¶è¡¨ç¤ºé¢œè‰²æŒ‰åƒç´ æ’åˆ—ã€‚å¯¹äºRGBå›¾åƒï¼Œåƒç´ çš„æ ¼å¼ä¸ºï¼šR1,G1,B1,R2,G2,B2,... å½“å€¼ä¸º1æ—¶è¡¨ç¤ºé¢œè‰²æŒ‰å¹³é¢æ’åˆ—ã€‚å¯¹äºRGBå›¾åƒï¼Œåƒç´ çš„æ ¼å¼ä¸ºï¼šR1,R2,R3,...Rn,G1,G2,G3,...Gn,B1,B2,B3,...Bn\nRows å›¾åƒçš„è¡Œæ•°é‡ï¼Œå³å›¾åƒçš„é«˜(Height)ã€‚\nColumns å›¾åƒçš„åˆ—æ•°é‡ï¼Œå³å›¾åƒçš„å®½(Width)ã€‚\nBits Allocated, Bits Stored, High Bit, Pixel Representation Bits AllocatedæŒ‡å®šæ¯ä¸ªåƒç´ åˆ†é…å¤šå°‘ä½(bit)ã€‚å€¼åº”å½“ä¸º1æˆ–è€…8çš„å€æ•°ã€‚è€Œå¯¹äºå›¾åƒåƒç´ ï¼ŒBits Allocatedçš„å€¼é€šå¸¸ä¸º8æˆ–è€…16ï¼Œå®é™…ä¸Šå¯ä»¥ç†è§£ä¸ºæ¯ä¸ªåƒç´ åˆ†é…å¤šå°‘å­—èŠ‚ï¼Œå› ä¸ºæ˜¯8çš„å€æ•°ã€‚\nBits StoredæŒ‡å®šå­˜å‚¨æ¯ä¸ªåƒç´ å ç”¨äº†å¤šå°‘ä½(bit)ï¼Œå€¼ä¸èƒ½å¤§äºBits Allocatedã€‚\nHigh Bitåˆ™æŒ‡å®šäº†åƒç´ çš„æœ€é«˜ä½ï¼Œé€šå¸¸åº”è¯¥æ˜¯Bits Stored - 1ã€‚\nPixel RepresentationæŒ‡å®šäº†åƒç´ æ•°æ®çš„ç±»å‹ã€‚å€¼åªèƒ½ä¸º0æˆ–è€…1ï¼Œå¯¹äºå½©è‰²å›¾åƒï¼Œå€¼åªèƒ½ä¸º0ã€‚ å€¼ä¸º0æ—¶ï¼Œè¡¨ç¤ºåƒç´ ä¸ºæ— ç¬¦å·æ•´å‹ï¼ˆunsigned integerï¼‰ã€‚ å€¼ä¸º1æ—¶ï¼Œè¡¨ç¤ºåƒç´ ä¸º2çš„è¡¥ç ï¼Œå…¶å®å°±æ˜¯æœ‰ç¬¦å·æ•´å‹ï¼Œå³å…è®¸å­˜åœ¨è´Ÿæ•°ã€‚ è¿™é‡Œä¸€å®šè¦æ³¨æ„ï¼Œå¦‚æœä¸èƒ½æ­£ç¡®å¤„ç†è´Ÿæ•°ï¼Œå…¨éƒ¨æŒ‰ç…§æ— ç¬¦å·æ•´å‹æ¥è®¡ç®—çš„è¯ï¼Œå°±ä¼šé‡åˆ°ç¬¦å·ä½çš„é—®é¢˜ï¼Œå³ä¸€ä¸ªè´Ÿæ•°ä¼šå˜æˆä¸€ä¸ªå¾ˆå¤§çš„æ­£æ•°ï¼Œå›¾åƒä¸ŠåŸæœ¬æ˜¯é»‘è‰²çš„åŒºåŸŸä¼šå˜å¾—å¾ˆäº®ã€‚\nPixel Data å›¾åƒåƒç´ ã€‚ä¸€å †äºŒè¿›åˆ¶æ•°å­—ï¼Œé€šå¸¸ä¼šå­˜æ”¾åœ¨Dicomæ–‡ä»¶æœ€åçš„ä½ç½®ã€‚\næœ€å å…¶å®ï¼Œåœ¨å†™è¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œä¸€äº›ä¸œè¥¿æˆ‘éƒ½è¿˜æ˜¯ä¸€çŸ¥åŠè§£çš„ï¼Œåœ¨å†™çš„è¿‡ç¨‹ä¸­æˆ‘ä¹Ÿæ˜¯ä¸æ–­çš„åœ¨æŸ¥é˜…èµ„æ–™å’Œæºç ã€‚å…¶ä¸­ä¸€äº›ä¸œè¥¿éš¾å…ä¼šæºæ‚äº†è‡ªå·±çš„ç†è§£ï¼Œå¦‚æœæœ‰é”™è¯¯çš„åœ°æ–¹æ¬¢è¿æŒ‡æ­£ã€‚\nå‚è€ƒ\nDICOM Standard Browser é¢œè‰²ç©ºé—´ ","permalink":"https://kira-96.github.io/posts/dicom%E5%9B%BE%E5%83%8F%E5%83%8F%E7%B4%A0%E7%9B%B8%E5%85%B3tag%E8%AF%B4%E6%98%8E/","summary":"\u003ch2 id=\"å¸¸ç”¨å›¾åƒåƒç´ ç›¸å…³çš„ä¸€äº›tag\"\u003eå¸¸ç”¨å›¾åƒåƒç´ ç›¸å…³çš„ä¸€äº›Tag\u003c/h2\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: center\"\u003eTag\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003eVR\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003eKeyword\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e(0028,0002)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eUS\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eSamples Per Pixel\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e(0028,0004)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eCS\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003ePhotometric Interpretation\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e(0028,0006)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eUS\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003ePlanar Configuration\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e(0028,0010)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eUS\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eRows\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e(0028,0011)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eUS\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eColumns\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e(0028,0100)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eUS\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eBits Allocated\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e(0028,0101)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eUS\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eBits Stored\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e(0028,0102)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eUS\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eHigh Bit\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e(0028,0103)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eUS\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003ePixel Representation\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e(7FE0,0010)\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eOB/OW\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003ePixel Data\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"ç›¸å…³tagè¯´æ˜\"\u003eç›¸å…³Tagè¯´æ˜\u003c/h2\u003e\n\u003ch3 id=\"sample-per-pixel\"\u003eSample Per Pixel\u003c/h3\u003e\n\n\n\n\u003cblockquote\u003e\n    \u003cp\u003eSamples per Pixel (0028,0002) is the number of separate planes in this image. One and three image planes are defined. Other numbers of image planes are allowed, but their meaning is not defined by this Standard.\u003c/p\u003e","title":"DICOMå›¾åƒåƒç´ ç›¸å…³Tagè¯´æ˜"},{"content":"æ–‡æ¡£ The Rust Programming Language Second edition\nRust ç¨‹åºè®¾è®¡è¯­è¨€ï¼ˆç¬¬äºŒç‰ˆï¼‰ç®€ä½“ä¸­æ–‡ç‰ˆ\nRust by Example\né€šè¿‡ä¾‹å­å­¦ Rust\nAsync programming in Rust with async-std\nasync-std ä¸­æ–‡æ–‡æ¡£\nå…¶å®ƒ Rust Language Cheat Sheet\nRust Fundamentals\nRustè¯­è¨€ä¸­æ–‡ç¤¾åŒº\n","permalink":"https://kira-96.github.io/posts/rust-%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90%E6%94%B6%E9%9B%86/","summary":"\u003ch2 id=\"æ–‡æ¡£\"\u003eæ–‡æ¡£\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://doc.rust-lang.org/book/second-edition/index.html\"\u003eThe Rust Programming Language Second edition\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://legacy.gitbook.com/book/kaisery/trpl-zh-cn/details\"\u003eRust ç¨‹åºè®¾è®¡è¯­è¨€ï¼ˆç¬¬äºŒç‰ˆï¼‰ç®€ä½“ä¸­æ–‡ç‰ˆ\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://doc.rust-lang.org/rust-by-example/\"\u003eRust by Example\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://rustwiki.org/zh-CN/rust-by-example/\"\u003eé€šè¿‡ä¾‹å­å­¦ Rust\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://book.async.rs/\"\u003eAsync programming in Rust with async-std\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://learnku.com/docs/rust-async-std\"\u003easync-std ä¸­æ–‡æ–‡æ¡£\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"å…¶å®ƒ\"\u003eå…¶å®ƒ\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://cheats.rs/\"\u003eRust Language Cheat Sheet\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.hackertouch.com/rust-fundamentals.html\"\u003eRust Fundamentals\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://rustcc.cn/\"\u003eRustè¯­è¨€ä¸­æ–‡ç¤¾åŒº\u003c/a\u003e\u003c/p\u003e","title":"Rust å­¦ä¹ èµ„æºæ”¶é›†"},{"content":"å‰è¨€ ç”±äºæˆ‘æ˜¯ä»äº‹åŒ»ç–—è¡Œä¸šè½¯ä»¶å¼€å‘çš„ï¼Œæ‰€ä»¥å¿…ä¸å¯å°‘çš„ä¼šå’Œå›¾åƒæ‰“äº¤é“ï¼Œæœ€è¿‘åˆšåˆšå¥½åœ¨åšä¸€ä¸ªå›¾åƒæ—‹è½¬ç›¸å…³çš„åŠŸèƒ½ï¼Œå€Ÿæ­¤åˆå¤ä¹ ï¼ˆé¢„ä¹ ï¼‰äº†ä¸€ä¸‹çº¿æ€§ä»£æ•°ï¼Œè¶ç€æ²¡å¿˜èµ¶ç´§åšä¸€ä¸‹ç¬”è®°ã€‚\nDICOM ä¸­ä¸æ–¹ä½è®¡ç®—æœ‰å…³çš„ Tag åœ¨å¼€å§‹ä¹‹å‰ï¼Œæœ‰å¿…è¦å…ˆäº†è§£ä¸€ä¸‹DICOMä¸­ä¸å›¾åƒæ–¹ä½è®¡ç®—æœ‰å…³çš„å‡ ä¸ªTagï¼Œä¸»è¦æœ‰3ä¸ªã€‚\nTag Keyword (0020,0032) Image Position (Patient) (0020,0037) Image Orientation (Patient) å…¶ä¸­Image PositionæŒ‡çš„æ˜¯å›¾åƒå·¦ä¸Šè§’çš„åƒç´ åœ¨æ‚£è€…åæ ‡ç³»ä¸­çš„ä½ç½®ã€‚ Image Orientationç”±6ä¸ªæ•°å­—ç»„æˆï¼Œåˆ†åˆ«æ˜¯å›¾åƒçš„è¡Œ(Row)æ–¹å‘å’Œåˆ—(Column)æ–¹å‘çš„å•ä½å‘é‡ä¸x/y/zåæ ‡è½´å¤¹è§’çš„ä½™å¼¦å€¼(cosine)ã€‚\næœ‰äº†ä¸Šé¢ä¸¤ä¸ªTagçš„å€¼ï¼Œå°±å¯ä»¥è®¡ç®—å‡ºå›¾åƒåœ¨ç©ºé—´åæ ‡ç³»ä¸­çš„ä½ç½®å’Œæ–¹ä½äº†ã€‚\nè®¡ç®—æ³•å‘é‡ ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†å›¾åƒå¹³é¢ä¸Šä¸¤ä¸ªå‚ç›´çš„å‘é‡ï¼Œè¡Œå’Œåˆ—æ–¹å‘çš„å‘é‡ï¼Œä½¿ç”¨è¡Œåˆ—å¼å°±èƒ½è®¡ç®—å‡ºå›¾åƒæ‰€åœ¨å¹³é¢çš„æ³•å‘é‡äº†ã€‚\n$$u Ã— v = \\left[\\begin{matrix} i \u0026amp; j \u0026amp; k \\\\ u_1 \u0026amp; u_2 \u0026amp; u_3 \\\\ v_1 \u0026amp; v_2 \u0026amp; v_3 \\end{matrix}\\right]$$\nå…·ä½“æ€ä¹ˆç®—ï¼Œå¯ä»¥çœ‹è¿™é‡Œï¼Œè®²å¾—å¾ˆè¯¦ç»†ã€‚\nä»£ç ï¼š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 double[] vector1 = new[] {orientation[0], orientation[1], orientation[2]}; double[] vector2 = new[] {orientation[3], orientation[4], orientation[5]}; double[] normal = new double[] { 0, 0, 0 }; normal[0] = vector1[1] * vector2[2] - vector1[2] * vector2[1]; normal[1] = vector1[2] * vector2[0] - vector1[0] * vector2[2]; normal[2] = vector1[0] * vector2[1] - vector1[1] * vector2[0]; var temp = Math.Sqrt(normal[0] * normal[0] + normal[1] * normal[1] + normal[2] * normal[2]); normal[0] /= temp; normal[1] /= temp; normal[2] /= temp; å…¶ä¸­orientationå°±æ˜¯Image Orientationä¸­çš„6ä¸ªå€¼ã€‚è®¡ç®—å¾—åˆ°çš„normalå°±æ˜¯å›¾åƒæ‰€åœ¨å¹³é¢çš„æ³•å‘é‡çš„å•ä½å‘é‡ã€‚\nå›¾åƒæ–¹ä½çŸ©é˜µ åœ¨3Då›¾å½¢å˜æ¢ä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯4ç»´çŸ©é˜µï¼ŒæŠŠå›¾åƒçš„ä½ç½®ä¿¡æ¯ä¹Ÿæ”¾åˆ°çŸ©é˜µä¸­ï¼Œå¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œä½ç½®å˜æ¢çš„è®¡ç®—ã€‚\nè¿™é‡Œåˆ†åˆ«ç”¨uï¼Œvï¼Œwè¡¨ç¤ºå›¾åƒçš„è¡Œ/åˆ—/æ³•çº¿æ–¹å‘å‘é‡ï¼ŒSä»£è¡¨å›¾åƒä½ç½®ã€‚\n$$u=(u_1,u_2,u_3)$$ $$v=(v_1,v_2,v_3)$$ $$w=(w_1,w_2,w_3)$$ $$S=(s_x,s_y,s_z)$$\n4ç»´çŸ©é˜µåˆ™è¡¨ç¤ºä¸º\n$$matrix=\\left[\\begin{matrix} u_1 \u0026amp; v_1 \u0026amp; w_1 \u0026amp; s_x \\\\ u_2 \u0026amp; v_2 \u0026amp; w_2 \u0026amp; s_y \\\\ u_3 \u0026amp; v_3 \u0026amp; w_3 \u0026amp; s_z \\\\ 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 1 \\end{matrix}\\right]$$\nå›¾åƒæ—‹è½¬ å…ˆæ¥çœ‹ç‰¹æ®Šæƒ…å†µä¸‹çš„æ—‹è½¬ï¼Œå³çŸ©é˜µç»•åæ ‡è½´çš„æ—‹è½¬ã€‚Tä¸ºå˜æ¢çŸ©é˜µã€‚\nç»•Xè½´æ—‹è½¬\n$$T=\\left[\\begin{matrix} 1 \u0026amp; 0 \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; cos\\theta \u0026amp; -sin\\theta \u0026amp; 0 \\\\ 0 \u0026amp; sin\\theta \u0026amp; cos\\theta \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 1 \\end{matrix}\\right]$$\nç»•Yè½´æ—‹è½¬\n$$T=\\left[\\begin{matrix} cos\\theta \u0026amp; 0 \u0026amp; sin\\theta \u0026amp; 0 \\\\ 0 \u0026amp; 1 \u0026amp; 0 \u0026amp; 0 \\\\ -sin\\theta \u0026amp; 0 \u0026amp; cos\\theta \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 1 \\end{matrix}\\right]$$\nç»•Zè½´æ—‹è½¬\n$$T=\\left[\\begin{matrix} cos\\theta \u0026amp; -sin\\theta \u0026amp; 0 \u0026amp; 0 \\\\ sin\\theta \u0026amp; cos\\theta \u0026amp; 0 \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; 1 \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 1 \\end{matrix}\\right]$$\nç›´æ¥ç”¨$matrix \\times T$å°±å¯ä»¥å¾—åˆ°æ—‹è½¬åçš„çŸ©é˜µäº†ã€‚\nä½†æ˜¯å›¾åƒæ—‹è½¬å¹¶ä¸ä¸€å®šæ˜¯ç»•åæ ‡è½´æ—‹è½¬ï¼Œè¿™é‡Œè¯´å›¾åƒæ—‹è½¬æŒ‡çš„æ˜¯åœ¨å›¾åƒæ‰€åœ¨å¹³é¢ä¸Šçš„æ—‹è½¬ï¼Œå³å›¾åƒçŸ©é˜µç»•æ³•çº¿æ—‹è½¬ä¸€å®šè§’åº¦ï¼Œä¸å­˜åœ¨å…¶å®ƒæƒ…å†µï¼Œæ‰€ä»¥éœ€è¦ä¸€ç§æ›´åŠ é€šç”¨çš„è®¡ç®—æ–¹æ³•ã€‚è§’åº¦çš„æ­£è´ŸæŒ‰å³æ‰‹å®šåˆ™å†³å®šã€‚\nç»æµ‹è¯•ï¼Œä¸‹é¢çš„æ–¹æ³•å¹¶ä¸é€šç”¨ï¼Œä¸‹é¢çš„æ—‹è½¬çŸ©é˜µé€‚ç”¨äºç‚¹ä½ç½®çš„å˜æ¢ï¼Œä¸é€‚ç”¨äºDICOMä¸­çš„æ–¹ä½å˜æ¢\nè¿™é‡Œç›´æ¥ç»™å‡ºç»“æœï¼Œå›¾åƒçŸ©é˜µç»•å‘é‡$(u,v,w)$æ—‹è½¬$\\theta$çš„å˜æ¢çŸ©é˜µTã€‚\n$$T=\\left[\\begin{matrix} u^2+(1-u^2)cos\\theta \u0026amp; u v(1-cos\\theta)-w sin\\theta \u0026amp; u w(1-cos\\theta)+v sin\\theta \u0026amp; 0 \\\\ u v(1-cos\\theta)+w sin\\theta \u0026amp; v^2+(1-v^2)cos\\theta \u0026amp; v w(1-cos\\theta)-u sin\\theta \u0026amp; 0 \\\\ u w(1-cos\\theta)-v sin\\theta \u0026amp; v w(1-cos\\theta)+u sin\\theta \u0026amp; w^2+(1-w^2)cos\\theta \u0026amp; 0 \\\\ 0 \u0026amp; 0 \u0026amp; 0 \u0026amp; 1 \\end{matrix}\\right]$$\nä»£ç ç¤ºä¾‹ï¼š\nè¿™é‡Œç”¨åˆ°äº†MatrixDï¼Œä¸»è¦æ˜¯ç”¨äºçŸ©é˜µçš„è¿ç®—ã€‚\nè¿™é‡Œå…¶å®æ˜¯æˆ‘æƒ³çš„å¤æ‚äº†ï¼ŒDICOMå›¾åƒæ—‹è½¬çš„æœ¬è´¨å°±æ˜¯ä¸¤ä¸ªæ–¹å‘å‘é‡çš„æ—‹è½¬ï¼Œåªéœ€è¦å°†ä¸¤ä¸ªæ–¹å‘å‘é‡ç»•æ³•å‘é‡æ—‹è½¬å³å¯ã€‚è€Œè¿™ä¸€åˆ‡fo-dicoméƒ½å·²ç»ä¸ºæˆ‘ä»¬åšå¥½äº†ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 Vector3D forward = new Vector3D(new[] { orientation[0], orientation[1], orientation[2] }); Vector3D down = new Vector3D(new[] { orientation[3], orientation[4], orientation[5] }); Orientation3D orientation3D = new Orientation3D(forward, down); // æ—‹è½¬ï¼Œé¡ºæ—¶é’ˆä¸ºæ­£ï¼Œé€†æ—¶é’ˆä¸ºè´Ÿ orientation3D.Pitch(angle * Math.PI / 180.0); // orientation3D.Forward // orientation3D.Down å®ç°èµ·æ¥å¾ˆç®€å•ï¼Œæµè§ˆPitchçš„æºç å°±ä¼šå‘ç°ï¼Œå…¶å®å°±æ˜¯å°†ä¸¤ä¸ªå‘é‡ç»•Rightå‘é‡ï¼ˆå³æ³•å‘é‡ï¼‰æ—‹è½¬ï¼Œå¾—åˆ°æ–°çš„Forwardå’ŒDownå°±æ˜¯æ—‹è½¬åå›¾åƒçš„æ–¹ä½ä¿¡æ¯ã€‚\nè¿™é‡Œå€Ÿä¸€å¼ å›¾æ¥è¯´æ˜é—®é¢˜ï¼š\nåœ¨åˆ›å»ºOrientation3Dæ—¶çš„å‚æ•°Forwardå’ŒDownå°±æ˜¯å›¾åƒçš„è¡Œæ–¹å‘å’Œåˆ—æ–¹å‘çš„æ–¹å‘å‘é‡ï¼ŒPitchæ–¹æ³•å°†Forwardå’ŒDownå‘é‡æ—‹è½¬ä¸€ä¸ªè§’åº¦ï¼Œå¾—åˆ°çš„å°±æ˜¯æ—‹è½¬åå›¾åƒçš„è¡Œå’Œåˆ—çš„æ–¹å‘å‘é‡ã€‚\nå›¾åƒç¿»è½¬ ç¿»è½¬åçš„æ–¹ä½è®¡ç®—åˆ™æ¯”è¾ƒç®€å•ï¼Œå¦‚æœæ˜¯æ°´å¹³ç¿»è½¬ï¼Œåªéœ€è¦å°†æ°´å¹³(Row)æ–¹å‘çš„å‘é‡åå‘å³å¯ï¼Œç«–ç›´ç¿»è½¬å°†ç«–ç›´(Column)æ–¹å‘çš„å‘é‡åå‘å³å¯ã€‚\nå‘é‡åå‘åªéœ€è¦å°† (u,v,w) 3ä¸ªå€¼å‰é¢æ·»åŠ è´Ÿå·å³å¯ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 // æ°´å¹³ç¿»è½¬ var newOrientation = new double[6] { -orientation[0], -orientation[1], -orientation[2], orientation[3], orientation[4], orientation[5] }; // ç«–ç›´ç¿»è½¬ var newOrientation = new double[6] { orientation[0], orientation[1], orientation[2], -orientation[3], -orientation[4], -orientation[5] }; ä¸è¿‡ï¼Œåƒè¿™ä¹ˆå¥‡è‘©çš„åŠŸèƒ½åº”è¯¥ä¸ä¼šæœ‰äººå»ç”¨å§ã€‚\næ³¨æ„\nå¯¹å›¾åƒçŸ©é˜µè¿›è¡Œæ—‹è½¬æˆ–è€…ç¿»è½¬æ“ä½œä¹‹åï¼Œç”±äºå›¾åƒå·¦ä¸Šè§’çš„åƒç´ å·²ç»å‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥åŸæœ‰çš„ä½ç½®ä¿¡æ¯ä¹Ÿå·²ç»æ”¹å˜ï¼Œéœ€è¦é‡æ–°è®¡ç®—æ‰èƒ½ä¿è¯å›¾åƒåœ¨ç©ºé—´ä¸­å¤„äºæ­£ç¡®çš„ä½ç½®ã€‚å¯¹äºå›¾åƒç¿»è½¬æ¥è¯´æˆ–è®¸èƒ½å¤Ÿè½»æ˜“è®¡ç®—å‡ºæ¥ï¼Œä¸è¿‡æ—‹è½¬ä¹‹åçš„å›¾åƒå´æ¯”è¾ƒéš¾è®¡ç®—äº†ã€‚\næœ€åï¼Œé™„ä¸Šä¸€æ®µè®¡ç®—å›¾åƒæ–¹ä½çš„ä»£ç ï¼š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 // [R] Right - æ²¿ç€Xæ–¹å‘é€’å‡ // [L] Left - æ²¿ç€Xæ–¹å‘é€’å¢ // [A] Anterior - æ²¿ç€Yæ–¹å‘é€’å‡ // [P] Posterior - æ²¿ç€Yæ–¹å‘é€’å¢ // [F] Feet - æ²¿ç€Zæ–¹å‘é€’å‡ // [H] Head - æ²¿ç€Zæ–¹å‘é€’å¢ static string ComputeOrientation(Vector3D vector) { char x = vector.X \u0026lt; 0 ? \u0026#39;R\u0026#39; : \u0026#39;L\u0026#39;; char y = vector.Y \u0026lt; 0 ? \u0026#39;A\u0026#39; : \u0026#39;P\u0026#39;; char z = vector.Z \u0026lt; 0 ? \u0026#39;F\u0026#39; : \u0026#39;H\u0026#39;; double x1 = Math.Abs(vector.X); double y1 = Math.Abs(vector.Y); double z1 = Math.Abs(vector.Z); string result = \u0026#34;\u0026#34;; for (int i = 0; i \u0026lt; 3; i++) { if (x1 \u0026gt; 0.0001 \u0026amp;\u0026amp; x1 \u0026gt; y1 \u0026amp;\u0026amp; x1 \u0026gt; z1) { result += x; x1 = 0; } else if (y1 \u0026gt; 0.0001 \u0026amp;\u0026amp; y1 \u0026gt; x1 \u0026amp;\u0026amp; y1 \u0026gt; z1) { result += y; y1 = 0; } else if (z1 \u0026gt; 0.0001 \u0026amp;\u0026amp; z1 \u0026gt; x1 \u0026amp;\u0026amp; z1 \u0026gt; y1) { result += z; z1 = 0; } else { break; } } return result; } è¿™é‡Œç”¨åˆ°äº†Vector3Dï¼Œè¡¨ç¤ºä¸€ä¸ª3ç»´å‘é‡ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„ä»£æ›¿ã€‚\nå‚è€ƒ\nçŸ¥ä¹ï¼šå¦‚ä½•ç†è§£çº¿æ€§ä»£æ•°ï¼Ÿ\nè¡Œåˆ—å¼ï¼Œå¿«é€Ÿæ±‚å‡ºæ³•å‘é‡\nMRIçš„DICOMå›¾åƒæ–¹ä½ç®—æ³•çš„ç ”ç©¶\nä¸‰ç»´ç©ºé—´å‡ ä½•å˜æ¢çŸ©é˜µ\nå›¾å½¢å­¦ ä½ç§»ï¼Œæ—‹è½¬ï¼Œç¼©æ”¾çŸ©é˜µå˜æ¢\nDICOMä¸­å‡ ä¸ªåˆ¤æ–­å›¾åƒæ–¹å‘çš„tag\nDICOM Standard Browser\n","permalink":"https://kira-96.github.io/posts/%E4%B8%89%E7%BB%B4%E5%9B%BE%E5%BD%A2%E7%9F%A9%E9%98%B5%E5%8F%98%E6%8D%A2/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eç”±äºæˆ‘æ˜¯ä»äº‹åŒ»ç–—è¡Œä¸šè½¯ä»¶å¼€å‘çš„ï¼Œæ‰€ä»¥å¿…ä¸å¯å°‘çš„ä¼šå’Œå›¾åƒæ‰“äº¤é“ï¼Œæœ€è¿‘åˆšåˆšå¥½åœ¨åšä¸€ä¸ªå›¾åƒæ—‹è½¬ç›¸å…³çš„åŠŸèƒ½ï¼Œå€Ÿæ­¤åˆå¤ä¹ ï¼ˆé¢„ä¹ ï¼‰äº†ä¸€ä¸‹çº¿æ€§ä»£æ•°ï¼Œè¶ç€æ²¡å¿˜èµ¶ç´§åšä¸€ä¸‹ç¬”è®°ã€‚\u003c/p\u003e","title":"ä¸‰ç»´å›¾å½¢çŸ©é˜µå˜æ¢"},{"content":"å‰è¨€ ç”±äºæˆ‘å¾ˆå°‘ç”¨MFCï¼Œåªæœ‰å·¥ä½œä¸Šéœ€è¦çš„æ—¶å€™æ‰ä¼šç”¨åˆ°ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæ˜¯ä¸ªæ–°æ‰‹ï¼Œé‡åˆ°é—®é¢˜éœ€è¦åˆ°ç½‘ä¸Šæ‰¾å¾ˆä¹…èµ„æ–™ã€‚è¿™é‡Œåªæ˜¯è®°å½•ä¸€äº›ç‰¹æ®Šæƒ…æ™¯ä¸‹ä¼šç”¨åˆ°çš„æŠ€å·§ï¼Œæ–¹ä¾¿ä»¥åæŸ¥æ‰¾ã€‚\néšè—çª—å£ä»»åŠ¡æ å›¾æ ‡ è¿™ä¸ªé—®é¢˜æˆ‘åœ¨ç½‘ä¸Šæ‰¾äº†å¾ˆä¹…ï¼Œå¤§è‡´æœ‰ä¸¤ç§æ–¹æ¡ˆï¼š\nä¿®æ”¹çª—å£çš„æ‰©å±•æ ·å¼\ncpp \u0026#9660; 1 ModifyStyleEx(WS_EX_APPWINDOW,WS_EX_TOOLWINDOW); ä½†æ˜¯è¿™æ ·åšä¼šå¯¼è‡´æ•´ä¸ªçª—å£çš„æ ·å¼ä¼šå˜å¾—å¾ˆéš¾çœ‹ã€‚\nå°†ä¸€ä¸ªéšè—çª—å£è®¾ç½®æˆä¸»çª—å£çš„çˆ¶çª—å£\nè¿™æ ·åšæ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”ä»»åŠ¡è§†å›¾ä¸‹ä¹Ÿä¸èƒ½å†çœ‹åˆ°çª—å£ï¼Œæ˜¾ç„¶ä¸æ˜¯æˆ‘æƒ³è¦çš„æ•ˆæœã€‚\næœ€åç»ˆäºæ‰¾åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒå®Œç¾çš„è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡COMçš„æ–¹å¼ç§»é™¤ä»»åŠ¡æ åˆ—è¡¨ä¸­çš„å›¾æ ‡ã€‚\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 // æ˜¾ç¤º/éšè—ä»»åŠ¡æ å›¾æ ‡(COMæ–¹å¼) bool ShowInTaskbar(HWND hWnd, bool isShow) { CoInitialize(nullptr); ITaskbarList* pTaskbarList; HRESULT hr = CoCreateInstance(CLSID_TaskbarList, nullptr, CLSCTX_INPROC_SERVER, IID_ITaskbarList, (void**)\u0026amp;pTaskbarList); if (SUCCEEDED(hr)) { pTaskbarList-\u0026gt;HrInit(); if (isShow) { pTaskbarList-\u0026gt;AddTab(hWnd); } else { pTaskbarList-\u0026gt;DeleteTab(hWnd); } CoUninitialize(); return true; } CoUninitialize(); return false; } ç¨‹åºå¯åŠ¨æ—¶é»˜è®¤éšè—çª—å£ ä¸€ç§æ¯”è¾ƒç®€å•çš„æ–¹æ³•æ˜¯åœ¨ç¨‹åºå¯åŠ¨æ—¶å°†çª—å£ç§»åŠ¨åˆ°å±å¹•å¤–çš„ä¸å¯è§åŒºåŸŸã€‚ å¦‚æœç›´æ¥åœ¨OnInitDialogä¸­è®¾ç½®ShowWindow(SW_HIDE)æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºæ­¤æ—¶çª—å£è¿˜æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œè‡ªç„¶ä¹Ÿæ— æ³•éšè—ã€‚\nè¿™é‡Œçš„æ€è·¯æ˜¯åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™å…ˆå°†çª—å£ç§»åŠ¨åˆ°å±å¹•å¤–ï¼Œç„¶åé€šè¿‡å¦ä¸€ä¸ªçº¿ç¨‹å°†çª—å£éšè—èµ·æ¥ï¼Œè¿™æ ·åšè™½ç„¶ç¨‹åºå¯åŠ¨åçª—å£è¿˜æ˜¯ä¼šä¸€é—ªå³é€ï¼Œä½†ç”±äºæ˜¯åœ¨å±å¹•ä¹‹å¤–ï¼Œå®é™…ä¸Šå¹¶ä¸èƒ½çœ‹åˆ°ï¼Œç„¶ååœ¨çª—å£éœ€è¦æ˜¾ç¤ºçš„æ—¶å€™è°ƒç”¨ShowWindow(SW_SHOW)å³å¯ã€‚\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 // CxxxDlg.h å¤´æ–‡ä»¶ #include \u0026lt;future\u0026gt; class CxxxDlg : public CDialogEx { ... ... ... private: std::future\u0026lt;int\u0026gt; hideTask; // åå°éšè—çª—å£çº¿ç¨‹ } cpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 BOOL CxxxDlg::OnInitDialog() { ... CRect rcClient; GetWindowRect(\u0026amp;rcClient); // å°†çª—å£ç§»åŠ¨åˆ°å±å¹•å¤– MoveWindow(-rcClient.Width(), rcClient.top, rcClient.Width(), rcClient.Height()); // æ–°å»ºçº¿ç¨‹ï¼Œå»¶æ—¶1såéšè—çª—å£ hideTask = std::async( std::launch::async, [\u0026amp;] { std::this_thread::sleep_for(std::chrono::seconds(1)); // ShowWindow(SW_HIDE); ShowWindowAsync(m_hWnd, SW_HIDE); std::this_thread::sleep_for(std::chrono::seconds(1)); // å»¶æ—¶1sï¼Œå¾…çª—å£å®Œå…¨éšè—åå†å°†çª—å£å±…ä¸­ CenterWindow(); return 0; }); ... return TRUE; // é™¤éå°†ç„¦ç‚¹è®¾ç½®åˆ°æ§ä»¶ï¼Œå¦åˆ™è¿”å› TRUE } ç‚¹å‡»å…³é—­æ—¶éšè—çª—å£ æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›åœ¨ç‚¹å‡»ä¸»çª—å£çš„å…³é—­æŒ‰é’®ä¹‹åå°†çª—å£éšè—æˆ–è€…æœ€å°åŒ–ï¼Œè€Œä¸æ˜¯é€€å‡ºç¨‹åºã€‚è¿™æ—¶åªéœ€è¦æ‹¦æˆªæ‰çª—å£çš„å…³é—­æ¶ˆæ¯å³å¯ã€‚\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 // CxxxDlg.h å¤´æ–‡ä»¶ class CxxxDlg : public CDialogEx { ... protected: afx_msg void OnSysCommand(UINT nID, LPARAM lParam); ... } void CxxxDlg::OnSysCommand(UINT nID, LPARAM lParam) { ///////////////////////////////////// // è¿™é‡Œæ•è·çª—å£çš„å…³é—­æ¶ˆæ¯ // ä¸ç›´æ¥å…³é—­çª—å£ï¼Œè€Œæ˜¯éšè—èµ·æ¥ if (nID == SC_CLOSE) { ShowWindowAsync(m_hWnd, SW_HIDE); } ///////////////////////////////////// else { CDialogEx::OnSysCommand(nID, lParam); } } è¿™æ ·å°±å¯ä»¥æ‹¦æˆªæ‰çª—å£çš„å…³é—­æ¶ˆæ¯äº†ï¼Œè¿™æ ·ä¸ä»…ä»…æ˜¯ç‚¹å‡»å…³é—­æŒ‰é’®æ—¶ä¼šéšè—çª—å£ï¼Œé€šè¿‡çª—å£èœå•å…³é—­çª—å£æˆ–æ˜¯ä½¿ç”¨Alt+F4éƒ½ä¸èƒ½çœŸæ­£å…³é—­çª—å£ã€‚é‚£ä¹ˆæˆ‘æ€æ ·æ‰èƒ½é€€å‡ºç¨‹åºå‘¢ï¼Œæ€»ä¸èƒ½ç”¨ä»»åŠ¡ç®¡ç†å™¨å§ã€‚\nå…¶å®å¾ˆç®€å•ï¼Œåœ¨éœ€è¦é€€å‡ºç¨‹åºçš„æ—¶å€™å‘çª—å£å‘é€WM_CLOSEæ¶ˆæ¯å³å¯ã€‚\ncpp \u0026#9660; 1 SendMessage(WM_CLOSE); CFileDialogå¯¼è‡´CDialogExâ€œå¤±å»ç„¦ç‚¹â€çš„è§£å†³æ–¹æ³• ç»§æ‰¿è‡ªCDialogExçš„çª—å£åœ¨ä½¿ç”¨CFileDialogä¹‹åä¼šå¯¼è‡´çª—å£æ ‡é¢˜æ å˜æˆç°è‰²ï¼Œå¾ˆåƒæ˜¯çª—å£å¤±å»äº†ç„¦ç‚¹ï¼Œæ­¤æ—¶çª—å£ä»ç„¶èƒ½å¤Ÿæ­£å¸¸æ“ä½œï¼Œä½†å³ä½¿é¼ æ ‡ç‚¹å‡»åœ¨çª—å£ä¸Šçª—å£çš„æ ‡é¢˜æ ä¾æ—§æ˜¯ç°è‰²ï¼Œæ— æ³•æ¢å¤åˆ°çª—å£æ¿€æ´»çŠ¶æ€çš„é¢œè‰²ï¼Œå³ä½¿å°†çª—å£å±æ€§è®¾ç½®ä¸ºWS_EX_TOPMOSTï¼ˆç½®é¡¶ï¼‰ä¾æ—§æ˜¯è¿™æ ·ï¼Œå¿…é¡»ç‚¹å‡»çª—å£å¤–çš„å…¶å®ƒåŒºåŸŸæˆ–è€…ä½¿ç”¨Tabåˆ‡æ¢ä¸€ä¸‹æ‰èƒ½æ¢å¤æ­£å¸¸ã€‚\nè€Œç»§æ‰¿è‡ªCDialogçš„çª—å£åˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†çª—å£çš„åŸºç±»æ”¹æˆCDialogæ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚å¯¹äºæˆ‘è¿™æ ·çš„å¼ºè¿«ç—‡æ¥è¯´æ˜¯æ— æ³•å¿å—çš„ï¼Œæ‰€ä»¥ç”¨å°½åƒæ–¹ç™¾è®¡ç»ˆäºæ‰¾åˆ°äº†ä¸€ä¸ªå¯è¡Œçš„è§£å†³æ–¹æ¡ˆã€‚\nç»è¿‡å°è¯•ï¼Œå•çº¯è®©çª—å£è·å–ç„¦ç‚¹æˆ–è€…å°†çª—å£æ”¾åˆ°å‰å°çš„æ–¹æ³•éƒ½æ˜¯æ— æ•ˆçš„ã€‚\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 CFileDialog dlg( TRUE, _T(\u0026#34;ini\u0026#34;), nullptr, OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT, _T(\u0026#34;ini(*.ini)|*.ini|TEXT(*.txt)|*.txt|\u0026#34;), this); auto dlgResult = dlg.DoModal(); // æ— æ•ˆçš„æ–¹æ³• this-\u0026gt;SetFocus(); this-\u0026gt;SetForegroundWindow(); ... æ‰€ä»¥åªèƒ½æ›²çº¿æ•‘å›½ï¼Œæ—¢ç„¶é€šè¿‡æ‰‹åŠ¨åˆ‡æ¢çš„æ–¹å¼å¯ä»¥æ¢å¤åˆ°æ­£å¸¸çŠ¶æ€ï¼Œä¸å¦¨å…ˆåˆ‡æ¢åˆ°å…¶å®ƒçª—å£å†åˆ‡æ¢å›æ¥ã€‚\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 CFileDialog dlg( TRUE, _T(\u0026#34;ini\u0026#34;), nullptr, OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT, _T(\u0026#34;ini(*.ini)|*.ini|TEXT(*.txt)|*.txt|\u0026#34;), this); auto dlgResult = dlg.DoModal(); // å…ˆå°†ç„¦ç‚¹æ”¾åˆ°æ¡Œé¢ï¼Œå†åˆ‡æ¢å›æœ¬çª—å£ ::SetForegroundWindow(::GetDesktopWindow()); this-\u0026gt;SetForegroundWindow(); ... å®Œç¾è§£å†³äº†é—®é¢˜ã€‚\nçª—å£å¯ç”¨è§†è§‰æ ·å¼ å¯ç”¨è§†è§‰æ ·å¼ä¹‹åï¼Œå¯ä»¥è®©ç¨‹åºçœ‹èµ·æ¥æ›´åŠ ç°ä»£åŒ–ä¸€äº›ï¼Œåªæ”¯æŒWindow XPä»¥åçš„ç³»ç»Ÿã€‚ å¯ä»¥é€šè¿‡ä¸ºç¨‹åºæ·»åŠ æ¸…å•æ–‡ä»¶æ¥å®ç°ï¼Œä¸è¿‡æ¯”è¾ƒéº»çƒ¦ã€‚åœ¨VC++ 2005ä¹‹åï¼Œç›´æ¥æ·»åŠ ç¼–è¯‘å™¨æŒ‡ä»¤åˆ°ä»£ç ä¸­å°±å¯ä»¥äº†ã€‚\nåœ¨é¢„ç¼–è¯‘å¤´æ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢ä»£ç å³å¯ã€‚\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 #if defined _M_IX86 #pragma comment(linker,\u0026#34;/manifestdependency:\\\u0026#34;type=\u0026#39;win32\u0026#39; name=\u0026#39;Microsoft.Windows.Common-Controls\u0026#39; version=\u0026#39;6.0.0.0\u0026#39; processorArchitecture=\u0026#39;x86\u0026#39; publicKeyToken=\u0026#39;6595b64144ccf1df\u0026#39; language=\u0026#39;*\u0026#39;\\\u0026#34;\u0026#34;) #elif defined _M_IA64 #pragma comment(linker,\u0026#34;/manifestdependency:\\\u0026#34;type=\u0026#39;win32\u0026#39; name=\u0026#39;Microsoft.Windows.Common-Controls\u0026#39; version=\u0026#39;6.0.0.0\u0026#39; processorArchitecture=\u0026#39;ia64\u0026#39; publicKeyToken=\u0026#39;6595b64144ccf1df\u0026#39; language=\u0026#39;*\u0026#39;\\\u0026#34;\u0026#34;) #elif defined _M_X64 #pragma comment(linker,\u0026#34;/manifestdependency:\\\u0026#34;type=\u0026#39;win32\u0026#39; name=\u0026#39;Microsoft.Windows.Common-Controls\u0026#39; version=\u0026#39;6.0.0.0\u0026#39; processorArchitecture=\u0026#39;amd64\u0026#39; publicKeyToken=\u0026#39;6595b64144ccf1df\u0026#39; language=\u0026#39;*\u0026#39;\\\u0026#34;\u0026#34;) #else #pragma comment(linker,\u0026#34;/manifestdependency:\\\u0026#34;type=\u0026#39;win32\u0026#39; name=\u0026#39;Microsoft.Windows.Common-Controls\u0026#39; version=\u0026#39;6.0.0.0\u0026#39; processorArchitecture=\u0026#39;*\u0026#39; publicKeyToken=\u0026#39;6595b64144ccf1df\u0026#39; language=\u0026#39;*\u0026#39;\\\u0026#34;\u0026#34;) #endif ä»»åŠ¡æ æ˜¾ç¤ºè¿›åº¦ ä¸ºçª—å£çš„ä»»åŠ¡æ å›¾æ ‡æ·»åŠ è¿›åº¦æ˜¾ç¤ºï¼Œä¹Ÿå¯ä»¥ä¸ºä»»åŠ¡æ æ·»åŠ æŒ‰é’®ã€‚\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 ITaskbarList3* pTaskbar; // åˆå§‹åŒ–COMç»„ä»¶ CoInitialize(NULL); CoCreateInstance(CLSID_TaskbarList, NULL, CLSCTX_INPROC_SERVER, IID_PPV_ARGS(\u0026amp;pTaskbar)); // TBPF_NOPROGRESS\t= 0, // æ­£å¸¸çŠ¶æ€ï¼Œä¸æ˜¾ç¤ºè¿›åº¦ // TBPF_INDETERMINATE\t= 0x1, // å¿™ç¢ŒçŠ¶æ€ï¼Œä¸æ˜¾ç¤ºè¿›åº¦ // TBPF_NORMAL\t= 0x2, // æ­£å¸¸çŠ¶æ€ï¼Œæ˜¾ç¤ºè¿›åº¦ï¼ˆç»¿è‰²ï¼‰ // TBPF_ERROR\t= 0x4, // é”™è¯¯çŠ¶æ€ï¼Œæ˜¾ç¤ºè¿›åº¦ï¼ˆçº¢è‰²ï¼‰ // TBPF_PAUSED\t= 0x8 // åœæ­¢çŠ¶æ€ï¼Œæ˜¾ç¤ºè¿›åº¦ï¼ˆé»„è‰²ï¼‰ pTaskbar-\u0026gt;SetProgressState(GetSafeHwnd(), TBPF_NORMAL); pTaskbar-\u0026gt;SetProgressValue(GetSafeHwnd(), 60, 100); // è®¾ç½®æç¤ºä¿¡æ¯ pTaskbar-\u0026gt;SetThumbnailTooltip(GetSafeHwnd(), TEXT(\u0026#34;Tooltip\u0026#34;)); // è®¾ç½®è¦†ç›–å›¾æ ‡ HICON hIcon = AfxGetApp()-\u0026gt;LoadIcon(IDI_ICON_ERR); pTaskbar-\u0026gt;SetOverlayIcon(GetSafeHwnd(), hIcon, _T(\u0026#34;Error\u0026#34;)); // æ·»åŠ ä»»åŠ¡æ æŒ‰é’® THUMBBUTTONMASK dwMask = THB_ICON | THB_TOOLTIP; THUMBBUTTON buttons[3]; buttons[0].iId = 0; buttons[0].dwMask = dwMask; buttons[0].hIcon = hIcon; memcpy(buttons[0].szTip, TEXT(\u0026#34;Tooltip\u0026#34;), sizeof(buttons[0].szTip)); // ... pTaskbar-\u0026gt;ThumbBarAddButtons(GetSafeHwnd(), 3, buttons); // æœ€åé‡Šæ”¾COMç»„ä»¶ CoUninitialize(); æœªå®Œå¾…ç»­ï¼ŒæŒç»­æ›´æ–°ä¸­\u0026hellip; å‚è€ƒ\nMFCç®€å•çš„å¯åŠ¨æ—¶éšè—ç•Œé¢æ–¹å¼(ä»…å¯åŠ¨æ—¶éšè—)\nEnabling Visual Styles\n","permalink":"https://kira-96.github.io/posts/%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%9C%AC%E6%B2%A1%E4%BB%80%E4%B9%88%E7%94%A8%E7%9A%84mfc%E6%8A%80%E5%B7%A7/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eç”±äºæˆ‘å¾ˆå°‘ç”¨MFCï¼Œåªæœ‰å·¥ä½œä¸Šéœ€è¦çš„æ—¶å€™æ‰ä¼šç”¨åˆ°ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæ˜¯ä¸ªæ–°æ‰‹ï¼Œé‡åˆ°é—®é¢˜éœ€è¦åˆ°ç½‘ä¸Šæ‰¾å¾ˆä¹…èµ„æ–™ã€‚è¿™é‡Œåªæ˜¯è®°å½•ä¸€äº›ç‰¹æ®Šæƒ…æ™¯ä¸‹ä¼šç”¨åˆ°çš„æŠ€å·§ï¼Œæ–¹ä¾¿ä»¥åæŸ¥æ‰¾ã€‚\u003c/p\u003e","title":"ä¸€äº›åŸºæœ¬æ²¡ä»€ä¹ˆç”¨çš„MFCæŠ€å·§"},{"content":"å‰è¨€ æœ€è¿‘å…¬å¸çš„ç³»ç»Ÿä¹Ÿå¼€å§‹é™†ç»­å‘ Windows 10 è¿ç§»äº†ï¼Œæˆ‘çš„åŠå…¬ç”µè„‘ä¹Ÿç»ˆäºæ¢ä¸Šäº†æ–°ç³»ç»Ÿã€‚ä¸ºäº†é€‚åº”æ–°çš„å¼€å‘ç¯å¢ƒï¼Œæœ‰æ—¶å€™éœ€è¦è·å–ä¸€äº›ç³»ç»Ÿç›¸å…³çš„ä¿¡æ¯ï¼Œè¿™é‡Œå°±ç¨å¾®æ€»ç»“ä¸€ä¸‹ã€‚\nè¿™ç¯‡æ–‡ç« å¹¶ä¸åªæ˜¯å†™å¦‚ä½•è·å–Win10ç³»ç»Ÿä¸»é¢˜è‰²ï¼Œä¹Ÿä¼šåŒ…å«ä¸€äº›å…¶å®ƒçš„å†…å®¹ï¼Œä¸»è¦æ˜¯ç”¨C++å’ŒC#è¯­è¨€ï¼Œå¯èƒ½ä¼šæŒç»­æ›´æ–°ã€‚\næ£€æµ‹æ˜¯å¦ä¸º Windows10 ç³»ç»Ÿ C++ æ–¹å¼\nåœ¨Win10ä¸Šå·²ç»ä¸èƒ½ç›´æ¥é€šè¿‡GetVersionæˆ–GetVersionExçš„æ–¹å¼è·å–ç³»ç»Ÿä¿¡æ¯ï¼Œå•çº¯ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°ç¼–è¯‘æ—¶ä¼šæŠ¥é”™ã€‚ è¿™é‡Œæä¾›å¦å¤–ä¸€ç§æ–¹å¼ï¼š\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 bool IsWindows10() { typedef void(__stdcall*NTPROC)(DWORD*, DWORD*, DWORD*); HMODULE inst = LoadLibrary(\u0026#34;ntdll.dll\u0026#34;); NTPROC ntProc = reinterpret_cast\u0026lt;NTPROC\u0026gt;(GetProcAddress(inst, \u0026#34;RtlGetNtVersionNumbers\u0026#34;)); DWORD dwMajor, dwMinor, dwBuildNumber; ntProc(\u0026amp;dwMajor, \u0026amp;dwMinor, \u0026amp;dwBuildNumber); FreeLibrary(inst); return dwMajor == 10; } å½“ç„¶ä¸Šé¢çš„æ–¹æ³•ä¹Ÿé€‚ç”¨äºC#ï¼Œä½†è¿™é‡Œä½¿ç”¨C#çš„æ–¹æ³•æ¥æ£€æµ‹ç³»ç»Ÿç‰ˆæœ¬ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 /// \u0026lt;summary\u0026gt; /// Gets if the Operating System is Windows 10 /// \u0026lt;/summary\u0026gt; /// \u0026lt;returns\u0026gt;True if Windows 10\u0026lt;/returns\u0026gt; public static bool IsWindows10 { get { // IMPORTANT: Windows 8.1. and Windows 10 will ONLY admit their real version if your program\u0026#39;s manifest // claims to be compatible. Otherwise they claim to be Windows 8. See the first comment on: // https://msdn.microsoft.com/en-us/library/windows/desktop/ms724833%28v=vs.85%29.aspx // Get Operating system information OperatingSystem os = Environment.OSVersion; // Get the Operating system version information Version vi = os.Version; // Pre-NT versions of Windows are PlatformID.Win32Windows. We\u0026#39;re not interested in those. if (os.Platform == PlatformID.Win32NT) { if (vi.Major == 10) { return true; } } return false; } } ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ—¶éœ€è¦æ³¨æ„ï¼Œé¦–å…ˆè¦ä¸ºä½ çš„ç¨‹åºæ·»åŠ æ¸…å•æ–‡ä»¶(app.manifest)ï¼Œå¹¶ä¸”å–æ¶ˆå¯¹Windows 10ç³»ç»Ÿå…¼å®¹çš„æ³¨é‡Šã€‚ å¦‚ï¼š\nxml \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 ... \u0026lt;compatibility xmlns=\u0026#34;urn:schemas-microsoft-com:compatibility.v1\u0026#34;\u0026gt; \u0026lt;application\u0026gt; \u0026lt;!-- è®¾è®¡æ­¤åº”ç”¨ç¨‹åºä¸å…¶ä¸€èµ·å·¥ä½œä¸”å·²é’ˆå¯¹æ­¤åº”ç”¨ç¨‹åºè¿›è¡Œæµ‹è¯•çš„ Windows ç‰ˆæœ¬çš„åˆ—è¡¨ã€‚å–æ¶ˆè¯„è®ºé€‚å½“çš„å…ƒç´ ï¼Œ Windows å°†è‡ªåŠ¨é€‰æ‹©æœ€å…¼å®¹çš„ç¯å¢ƒã€‚ --\u0026gt; \u0026lt;!-- Windows Vista --\u0026gt; \u0026lt;!--\u0026lt;supportedOS Id=\u0026#34;{e2011457-1546-43c5-a5fe-008deee3d3f0}\u0026#34; /\u0026gt;--\u0026gt; \u0026lt;!-- Windows 7 --\u0026gt; \u0026lt;supportedOS Id=\u0026#34;{35138b9a-5d96-4fbd-8e2d-a2440225f93a}\u0026#34; /\u0026gt; \u0026lt;!-- Windows 8 --\u0026gt; \u0026lt;!--\u0026lt;supportedOS Id=\u0026#34;{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}\u0026#34; /\u0026gt;--\u0026gt; \u0026lt;!-- Windows 8.1 --\u0026gt; \u0026lt;!--\u0026lt;supportedOS Id=\u0026#34;{1f676c76-80e1-4239-95bb-83d0f6d0da78}\u0026#34; /\u0026gt;--\u0026gt; \u0026lt;!-- Windows 10 --\u0026gt; \u0026lt;supportedOS Id=\u0026#34;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}\u0026#34; /\u0026gt; \u0026lt;/application\u0026gt; \u0026lt;/compatibility\u0026gt; ... æ˜¯å¦ä¸º Win7 ä»¥ä¸‹ç‰ˆæœ¬\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 public static bool IsWindows7OrLower { get { Version v = Environment.OSVersion.Version; int versionMajor = v.Major; int versionMinor = v.Minor; double version = versionMajor + (double)versionMinor / 10; return version \u0026lt;= 6.1; } } è·å– Window 10 ä¸»é¢˜è‰²(Accent Color) åœ¨UWPä¸­å¯ä»¥è½»æ˜“çš„è·å–SystemAccentColorã€‚ä½†éšç€Win10ç§»åŠ¨ç«¯çš„å¤±åˆ©ï¼ŒUWPåŸºæœ¬å·²è¢«å¾®è½¯å®£å‘Šæ­»äº¡ã€‚ è¿™é‡Œå°±è®²ä¸€ä¸‹å¦‚ä½•é€šè¿‡å…¶å®ƒæ–¹å¼è¯»å–åˆ°ç³»ç»Ÿçš„ä¸»é¢˜è‰²ã€‚\nåœ¨Win10ä¸Šï¼Œå½“ç³»ç»Ÿçš„ä¸»é¢˜è‰²å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç³»ç»Ÿä¼šç»™æ‰€æœ‰çª—å£éƒ½å‘é€ä¸»é¢˜è‰²å˜æ›´çš„æ¶ˆæ¯\ncpp \u0026#9660; 1 #define WM_DWMCOLORIZATIONCOLORCHANGED 0x0320 cpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 LRESULT CxxxDlg::OnColorizationColorChanged(WPARAM wParam, LPARAM lParam) { DWORD color = 0; BOOL opaque = FALSE; HRESULT hr = DwmGetColorizationColor(\u0026amp;color, \u0026amp;opaque); if (SUCCEEDED(hr)) { // Update the application to use the new color. } return 0; } ä½†æˆ‘ä½¿ç”¨ä¹‹åå‘ç°ï¼Œå¹¶ä¸èƒ½æ­£ç¡®çš„è·å–åˆ°ç³»ç»Ÿçš„ä¸»é¢˜é¢œè‰²ï¼Œè€Œæ˜¯DWMé¢œè‰²ã€‚ æ‰€ä»¥è¿™é‡Œä½¿ç”¨äº†å¦ä¸€ç§æ–¹å¼ï¼Œé€šè¿‡è¯»å–æ³¨å†Œè¡¨çš„æ–¹å¼è·å–ç³»ç»Ÿä¸»é¢˜è‰²ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 // \\HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\DWM\\AccentColor public static Color GetSystemAccentColor() { using (RegistryKey dwm = Registry.CurrentUser.OpenSubKey(@\u0026#34;Software\\Microsoft\\Windows\\DWM\u0026#34;, false)) { if (dwm.GetValueNames().Contains(\u0026#34;AccentColor\u0026#34;)) { // è¿™é‡Œä¸è¦å°è¯•è½¬æ¢æˆuintï¼Œå› ä¸ºæœ‰å¯èƒ½ç¬¦å·ä½ä¸º 1ï¼ˆè´Ÿæ•°ï¼‰,ä¼šå¯¼è‡´å¼ºåˆ¶è½¬æ¢é”™è¯¯ // ç›´æ¥è¿›è¡Œä¸‹é¢çš„ä½æ“ä½œå³å¯ int accentColor = (int)dwm.GetValue(\u0026#34;AccentColor\u0026#34;); // æ³¨æ„ï¼šè¯»å–åˆ°çš„é¢œè‰²ä¸º AABBGGRR return Color.FromArgb( (byte)((accentColor \u0026gt;\u0026gt; 24) \u0026amp; 0xFF), (byte)(accentColor \u0026amp; 0xFF), (byte)((accentColor \u0026gt;\u0026gt; 8) \u0026amp; 0xFF), (byte)((accentColor \u0026gt;\u0026gt; 16) \u0026amp; 0xFF)); } } return SystemParameters.WindowGlassColor; // è¿‘ä¼¼çš„ç³»ç»Ÿä¸»é¢˜è‰² } ä»¥ä¸Šçš„æ–¹å¼æ˜¯é€šè¿‡è¯»å–æ³¨å†Œè¡¨çš„æ–¹å¼ï¼Œæ‰€ä»¥ç†è®ºä¸Šä»»ä½•è¯­è¨€éƒ½æ˜¯é€šç”¨çš„ï¼Œå†ç»“åˆWM_DWMCOLORIZATIONCOLORCHANGEDæ¶ˆæ¯ï¼Œå°±å¯ä»¥å®Œç¾åšåˆ°ç¨‹åºè·Ÿéšç³»ç»Ÿä¸»é¢˜è‰²ã€‚\nåŒæ ·çš„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¯»å–æ³¨å†Œè¡¨çš„æ–¹å¼è·å–åˆ°DWMé¢œè‰²ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 // \\HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\DWM\\ColorizationColor public static Color GetColorizationColor() { using (RegistryKey dwm = Registry.CurrentUser.OpenSubKey(@\u0026#34;Software\\Microsoft\\Windows\\DWM\u0026#34;, false)) { if (dwm.GetValueNames().Contains(\u0026#34;ColorizationColor\u0026#34;)) { int accentColor = (int)dwm.GetValue(\u0026#34;ColorizationColor\u0026#34;); // æ³¨æ„ï¼šè¯»å–åˆ°çš„é¢œè‰²ä¸º AARRGGBB return Color.FromArgb( (byte)((accentColor \u0026gt;\u0026gt; 24) \u0026amp; 0xFF), (byte)((accentColor \u0026gt;\u0026gt; 16) \u0026amp; 0xFF), (byte)((accentColor \u0026gt;\u0026gt; 8) \u0026amp; 0xFF), (byte)(accentColor \u0026amp; 0xFF)); } } return SystemParameters.WindowGlassColor; } äº®è‰²ä¸»é¢˜è¿˜æ˜¯æš—è‰²ä¸»é¢˜ csharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 // \\HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize\\AppsUseLightTheme // åº”ç”¨æ˜¯äº®è‰²è¿˜æ˜¯æš—è‰² public static bool AppsUseLightTheme() { using (RegistryKey personalize = Registry.CurrentUser.OpenSubKey(@\u0026#34;Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize\u0026#34;, false)) { if (personalize.GetValueNames().Contains(\u0026#34;AppsUseLightTheme\u0026#34;)) { return (int)personalize.GetValue(\u0026#34;AppsUseLightTheme\u0026#34;) == 1; } } return true; } å¯¹äºè¾ƒé«˜ç‰ˆæœ¬çš„Win10ï¼Œç³»ç»Ÿä¹Ÿå¯ä»¥è®¾ç½®äº®è‰²/æš—è‰²æ¨¡å¼ï¼Œæˆ‘ä½¿ç”¨çš„ç‰ˆæœ¬æš‚ä¸”ä¸æ”¯æŒã€‚\néœ€è¦è¯»å–æ³¨å†Œè¡¨çš„è·¯å¾„ä¸º\\HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize\\SystemUsesLightThemeã€‚ è¯»å–æ–¹å¼åº”è¯¥å’Œä¸Šé¢å·®åˆ«ä¸å¤§ã€‚\nä¸»é¢˜è‰²æ˜¯å¦åº”ç”¨åˆ°çª—å£æ ‡é¢˜æ å’Œè¾¹æ¡† å¦‚æœæ²¡æœ‰åœ¨ç³»ç»Ÿä¸ªæ€§åŒ–è®¾ç½®ä¸­è®¾ç½®å°†ä¸»é¢˜è‰²åº”ç”¨åˆ°çª—å£æ ‡é¢˜æ å’Œè¾¹æ¡†æ—¶ï¼ŒWin10çª—å£çš„æ ‡é¢˜æ å’Œè¾¹æ¡†ä¼šå§‹ç»ˆä¸ºç™½è‰²ï¼ˆå¯¹åº”äº®è‰²æ¨¡å¼ï¼‰æˆ–é»‘è‰²ï¼ˆå¯¹åº”æš—è‰²æ¨¡å¼ï¼‰ã€‚ è®¾ç½®äº†å°†ä¸»é¢˜è‰²åº”ç”¨åˆ°çª—å£æ ‡é¢˜æ å’Œè¾¹æ¡†åï¼Œçª—å£çš„æ ‡é¢˜æ ä¼šè·Ÿéšç³»ç»Ÿä¸»é¢˜è‰²çš„å˜åŒ–è€Œå˜åŒ–ã€‚ é‚£ä¹ˆæˆ‘ä»¬æ€æ ·çŸ¥é“ç”¨æˆ·æ˜¯æ€æ ·è®¾ç½®çš„å‘¢ï¼Ÿä¾æ—§æ˜¯é€šè¿‡è¯»å–æ³¨å†Œè¡¨çš„æ–¹å¼ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // \\HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\DWM\\ColorPrevalence public static bool IsWindowPrevalenceAccentColor() { using (RegistryKey dwm = Registry.CurrentUser.OpenSubKey(@\u0026#34;Software\\Microsoft\\Windows\\DWM\u0026#34;, false)) { if (dwm.GetValueNames().Contains(\u0026#34;ColorPrevalence\u0026#34;)) { int colorPrevalence = (int)dwm.GetValue(\u0026#34;ColorPrevalence\u0026#34;); return colorPrevalence == 1; } } return false; } cpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 // c++ è¯»å–æ³¨å†Œè¡¨ bool IsWindowPrevalenceAccentColor() { LPCTSTR dwm = _T(\u0026#34;Software\\\\Microsoft\\\\Windows\\\\DWM\u0026#34;); HKEY hDwmKey; if (ERROR_SUCCESS != RegOpenKeyEx(HKEY_CURRENT_USER, dwm, 0, KEY_READ, \u0026amp;hDwmKey)) { return false; } DWORD type = REG_DWORD; DWORD value = 0; DWORD cbData = 4; if (ERROR_SUCCESS != RegQueryValueEx(hDwmKey, _T(\u0026#34;ColorPrevalence\u0026#34;), nullptr, \u0026amp;type, (LPBYTE)\u0026amp;value, \u0026amp;cbData)) { RegCloseKey(hDwmKey); return false; } RegCloseKey(hDwmKey); return value == 1; } æ ¹æ®èƒŒæ™¯è‰²è®¡ç®—å‰æ™¯è‰² è¿˜æœ‰ä¸€ä¸ªé—ç•™çš„é—®é¢˜å°±æ˜¯ï¼Œçª—å£çš„æ ‡é¢˜æ é¢œè‰²è·Ÿéšç³»ç»Ÿä¸»é¢˜è‰²å˜åŒ–æ—¶ï¼Œæ ‡é¢˜æ–‡å­—çš„é¢œè‰²ä¹Ÿä¼šåŠ¨æ€å˜æ¢æˆç™½è‰²æˆ–è€…é»‘è‰²ï¼Œè‡³äºä»€ä¹ˆæƒ…å†µä¸‹æ˜¯ç™½è‰²ï¼Œä»€ä¹ˆæ—¶å€™æ˜¯é»‘è‰²ï¼Œæš‚æ—¶è¿˜æ²¡ç ”ç©¶å‡ºæ¥ã€‚\næœ€ååœ¨ç½‘ä¸Šæ‰¾åˆ°äº†ä¸€äº›ç®—æ³•ï¼Œé€šè¿‡èƒŒæ™¯çš„é¢œè‰²è®¡ç®—å‡ºå‰æ™¯è‰²ï¼Œæ•ˆæœè¿˜æ˜¯å¾ˆç†æƒ³çš„ã€‚\næ–¹æ³•1ï¼š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 /// \u0026lt;summary\u0026gt; /// æ ¹æ®èƒŒæ™¯è‰²è®¡ç®—å‰æ™¯è‰²(ç™½/é»‘) /// https://github.com/loilo/windows-titlebar-color/blob/master/WindowsAccentColors.js#L53 /// \u0026lt;/summary\u0026gt; /// \u0026lt;param name=\u0026#34;background\u0026#34;\u0026gt;èƒŒæ™¯é¢œè‰²\u0026lt;/param\u0026gt; /// \u0026lt;returns\u0026gt;å‰æ™¯é¢œè‰²(ç™½/é»‘)\u0026lt;/returns\u0026gt; public static Color GetForegroundColor(Color background) { return (background.R * 2 + background.G * 5 + background.B) \u0026lt;= 1024 /* 8*128 */ ? Colors.White : Colors.Black; } æ–¹æ³•2ï¼š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 /// \u0026lt;summary\u0026gt; /// è®¡ç®—èƒ½åœ¨ä»»ä½•èƒŒæ™¯è‰²ä¸Šæ¸…æ™°æ˜¾ç¤ºçš„å‰æ™¯è‰² /// https://www.cnblogs.com/walterlv/p/10236517.html /// \u0026lt;/summary\u0026gt; /// \u0026lt;param name=\u0026#34;background\u0026#34;\u0026gt;èƒŒæ™¯é¢œè‰²\u0026lt;/param\u0026gt; /// \u0026lt;returns\u0026gt;å‰æ™¯é¢œè‰²(é»‘/ç™½)\u0026lt;/returns\u0026gt; public static Color GetReverseForegroundColor(Color background) { double grayLevel = (0.299 * background.R + 0.587 * background.G + 0.114 * background.B) / 255; return grayLevel \u0026gt; 0.5 ? Colors.Black : Colors.White; } æŒç»­æ›´æ–°ä¸­\u0026hellip;\nå‚è€ƒ\nC++ è·å–å¹¶åˆ¤æ–­æ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼Œè§£å†³Win10ã€ Windows Server 2012 R2 è¯»å–å¤±è´¥çš„æ–¹æ¡ˆ\nwpf/winformè·å–windows10ç³»ç»Ÿé¢œè‰²å’Œä¸»é¢˜è‰²\nWM_DWMCOLORIZATIONCOLORCHANGED message\nDwmGetColorizationColor function\nåˆ†äº«ä¸€ä¸ªç®—æ³•ï¼Œè®¡ç®—èƒ½åœ¨ä»»ä½•èƒŒæ™¯è‰²ä¸Šæ¸…æ™°æ˜¾ç¤ºçš„å‰æ™¯è‰²\n","permalink":"https://kira-96.github.io/posts/%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96windows10%E4%B8%BB%E9%A2%98%E9%A2%9C%E8%89%B2/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eæœ€è¿‘å…¬å¸çš„ç³»ç»Ÿä¹Ÿå¼€å§‹é™†ç»­å‘ Windows 10 è¿ç§»äº†ï¼Œæˆ‘çš„åŠå…¬ç”µè„‘ä¹Ÿç»ˆäºæ¢ä¸Šäº†æ–°ç³»ç»Ÿã€‚ä¸ºäº†é€‚åº”æ–°çš„å¼€å‘ç¯å¢ƒï¼Œæœ‰æ—¶å€™éœ€è¦è·å–ä¸€äº›ç³»ç»Ÿç›¸å…³çš„ä¿¡æ¯ï¼Œè¿™é‡Œå°±ç¨å¾®æ€»ç»“ä¸€ä¸‹ã€‚\u003c/p\u003e","title":"å¦‚ä½•è·å–Windows10ä¸»é¢˜é¢œè‰²"},{"content":"å‰è¨€ ç»å¸¸çœ‹åˆ°å…¶å®ƒç¨‹åºåœ¨æœ€å°åŒ–æˆ–è€…çª—å£éšè—åä¾æ—§ä¼šåœ¨é€šçŸ¥æ æ˜¾ç¤ºä¸€ä¸ªæ‰˜ç›˜å›¾æ ‡ï¼Œåƒå¾®ä¿¡ã€QQä¹‹ç±»çš„ï¼Œå³ä½¿ä¸»çª—å£ä¸æ˜¾ç¤ºï¼Œç¨‹åºå¹¶ä¸ä¼šé€€å‡ºï¼Œä¾æ—§å¯ä»¥é€šè¿‡æ‰˜ç›˜å›¾æ ‡è¿›è¡Œæ“ä½œã€‚ é‚£ä¹ˆæ€æ ·ä¸ºè‡ªå·±çš„ç¨‹åºæ·»åŠ ä¸€ä¸ªæ‰˜ç›˜å›¾æ ‡å‘¢ï¼Ÿè¿™æ¬¡å°±æ¥è®²ä¸€è®²ã€‚\nå®ç°ï¼ˆC#ï¼‰ é¦–å…ˆï¼Œä¸ºé¡¹ç›®æ·»åŠ å¼•ç”¨System.Windows.Formsã€‚\nè¿™é‡Œä»¥WPFä¸ºä¾‹ï¼š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 // ä¸»çª—å£çš„åå°ä»£ç  // MainWindow.xaml.cs using System.Windows; using System.Windows.Forms; public partial class MainWindow : Window { private NotifyIcon notifyIcon; // æ‰˜ç›˜å›¾æ ‡ // æ‰˜ç›˜èœå• private System.Windows.Controls.ContextMenu trayIconContextMenu; public MainWindow() { InitializeComponent(); InitializeTrayIcon(); } private void InitializeTrayIcon() { notifyIcon = new NotifyIcon() { Visible = true, Text = System.Reflection.Assembly.GetExecutingAssembly().GetName().Name, // ä½¿ç”¨åµŒå…¥çš„èµ„æº Icon = new System.Drawing.Icon( System.Reflection.Assembly.GetExecutingAssembly().GetManifestResourceStream(\u0026#34;AppNamespace.icon.ico\u0026#34;), System.Windows.Forms.SystemInformation.SmallIconSize) }; notifyIcon.MouseClick += TrayIconMouseClick; // notifyIcon.MouseDoubleClick += TrayIconMouseDoubleClick; trayIconContextMenu = (System.Windows.Controls.ContextMenu)FindResource(\u0026#34;TrayIconContextMenu\u0026#34;); } private void Window_Deactivated(object s, System.EventArgs e) { trayIconContextMenu.IsOpen = false; } private void TrayIconMouseClick(object s, MouseEventArgs e) { if (e.Button == MouseButtons.Right) { // Open the Notify icon context menu trayIconContextMenu.IsOpen = true; // Required to close the Tray icon when Deactivated is called // See: http://copycodetheory.blogspot.be/2012/07/notify-icon-in-wpf-applications.html Activate(); } } } éœ€è¦æ³¨æ„çš„æ˜¯NotifyIconçš„Iconå±æ€§å¿…é¡»è®¾ç½®ï¼Œå¦åˆ™å°±ä¸èƒ½æ˜¾ç¤ºæ‰˜ç›˜å›¾æ ‡ã€‚è€Œä¸”å›¾æ ‡å¿…é¡»æ˜¯.icoæ ¼å¼ï¼Œå…¶å®ƒæ ¼å¼pngï¼Œjpgç­‰éƒ½æ˜¯ä¸è¡Œçš„ã€‚ æˆ‘è¿™é‡Œæ˜¯ä½¿ç”¨çš„åµŒå…¥çš„èµ„æºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ–‡ä»¶è·¯å¾„çš„æ–¹å¼ï¼š\ncsharp \u0026#9660; 1 Icon = new System.Drawing.Icon(\u0026#34;icon.ico\u0026#34;); ä¸Šé¢ä»£ç ä¹Ÿæ²¡æœ‰ä½¿ç”¨NotifyIconçš„ContextMenuå±æ€§ï¼Œè€Œæ˜¯ä½¿ç”¨çš„WPFä¸­çš„ContextMenuï¼Œç›´æ¥åœ¨é¼ æ ‡å³é”®å•å‡»æ‰˜ç›˜å›¾æ ‡çš„æ—¶å€™å°†trayIconContextMenuæ˜¾ç¤ºå‡ºæ¥ã€‚\nä¸‹é¢æ˜¯trayIconContextMenuçš„å®šä¹‰ï¼š\nxml \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026lt;!-- MainWindow.xaml --\u0026gt; \u0026lt;Window.Resources\u0026gt; \u0026lt;ContextMenu x:Key=\u0026#34;TrayIconContextMenu\u0026#34; Placement=\u0026#34;MousePoint\u0026#34;\u0026gt; \u0026lt;MenuItem Header=\u0026#34;Show Window\u0026#34; ToolTip=\u0026#34;show main window\u0026#34; Click=\u0026#34;MenuItemShowClick\u0026#34;\u0026gt; \u0026lt;MenuItem.Icon\u0026gt; \u0026lt;Image Source=\u0026#34;pack://application:,,,/Icons/window.png\u0026#34; /\u0026gt; \u0026lt;/MenuItem.Icon\u0026gt; \u0026lt;/MenuItem\u0026gt; \u0026lt;Separator /\u0026gt; \u0026lt;MenuItem Header=\u0026#34;Exit\u0026#34; ToolTip=\u0026#34;exit\u0026#34; Click=\u0026#34;MenuItemExitClick\u0026#34;\u0026gt; \u0026lt;MenuItem.Icon\u0026gt; \u0026lt;Image Source=\u0026#34;pack://application:,,,/Icons/exit.png\u0026#34; /\u0026gt; \u0026lt;/MenuItem.Icon\u0026gt; \u0026lt;/MenuItem\u0026gt; \u0026lt;/ContextMenu\u0026gt; \u0026lt;/Window.Resources\u0026gt; é€šè¿‡ä¸Šé¢çš„ä»£ç å°±å¯ä»¥ä¸ºåº”ç”¨ç¨‹åºæ·»åŠ ä¸€ä¸ªç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡äº†ã€‚\nç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯å¯ä»¥åœ¨é€šçŸ¥æ æ˜¾ç¤ºé€šçŸ¥ã€‚\ncsharp \u0026#9660; 1 notifyIcon.ShowBalloonTip(0, \u0026#34;æ¶ˆæ¯\u0026#34;, \u0026#34;ç¨‹åºæ­£åœ¨è¿è¡Œ\u0026#34;, ToolTipIcon.Info); ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ˜¾ç¤ºè¶…æ—¶ï¼Œä¸è¿‡ç°åœ¨å·²ç»æ²¡ç”¨äº†ã€‚\ntimeout: æ°”çƒçŠ¶æç¤ºåº”æ˜¾ç¤ºçš„æ—¶é—´æ®µï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚ä» Windows Vista å¼€å§‹ï¼Œæ­¤å‚æ•°å·²è¢«å¦å†³ã€‚ é€šçŸ¥æ˜¾ç¤ºæ—¶é—´ç°åœ¨åŸºäºç³»ç»Ÿçš„è¾…åŠ©åŠŸèƒ½è®¾ç½®ã€‚\nBalloonTipåœ¨Win7ä¸Šæ˜¾ç¤ºä¸ºæ°”çƒçŠ¶æç¤ºï¼Œåœ¨Win10ä¸Šæ˜¾ç¤ºä¸ºToasté€šçŸ¥ã€‚\nå…¶å®ƒ ç»è¿‡æœ¬äººæµ‹è¯•ï¼ŒNotifyIconåœ¨æ§åˆ¶å°ç¨‹åºä¸Šä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œé—æ†¾çš„æ˜¯ä¸€éƒ¨åˆ†åŠŸèƒ½ä¸èƒ½æ­£å¸¸ä½¿ç”¨ã€‚ BalloonTipå¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚ä½†èœå•æ˜¯æ— æ³•ä½¿ç”¨çš„ï¼Œå› ä¸ºä¸èƒ½è§¦å‘é¼ æ ‡äº‹ä»¶ã€‚\n","permalink":"https://kira-96.github.io/posts/%E4%B8%BA%E7%A8%8B%E5%BA%8F%E6%B7%BB%E5%8A%A0%E9%80%9A%E7%9F%A5%E6%A0%8F%E5%9B%BE%E6%A0%87/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eç»å¸¸çœ‹åˆ°å…¶å®ƒç¨‹åºåœ¨æœ€å°åŒ–æˆ–è€…çª—å£éšè—åä¾æ—§ä¼šåœ¨é€šçŸ¥æ æ˜¾ç¤ºä¸€ä¸ªæ‰˜ç›˜å›¾æ ‡ï¼Œåƒå¾®ä¿¡ã€QQä¹‹ç±»çš„ï¼Œå³ä½¿ä¸»çª—å£ä¸æ˜¾ç¤ºï¼Œç¨‹åºå¹¶ä¸ä¼šé€€å‡ºï¼Œä¾æ—§å¯ä»¥é€šè¿‡æ‰˜ç›˜å›¾æ ‡è¿›è¡Œæ“ä½œã€‚\né‚£ä¹ˆæ€æ ·ä¸ºè‡ªå·±çš„ç¨‹åºæ·»åŠ ä¸€ä¸ªæ‰˜ç›˜å›¾æ ‡å‘¢ï¼Ÿè¿™æ¬¡å°±æ¥è®²ä¸€è®²ã€‚\u003c/p\u003e","title":"ä¸ºç¨‹åºæ·»åŠ é€šçŸ¥æ å›¾æ ‡"},{"content":"ç®€ä»‹ é€šå¸¸æ¥è¯´ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥å¯åŠ¨ä»»æ„æ•°ç›®çš„å®ä¾‹ï¼Œå‰ææ˜¯ä½ çš„ç”µè„‘å†…å­˜è¶³å¤Ÿå¤§ï¼Œæƒ³å¯åŠ¨å¤šå°‘éƒ½å¯ä»¥ã€‚ä½†æœ‰æ—¶å€™æˆ‘ä»¬åªå¸Œæœ›ç¨‹åºåŒæ—¶åªæœ‰ä¸€ä¸ªå®ä¾‹åœ¨è¿è¡Œï¼Œåº”ç”¨ç¨‹åºä¸ä¼šé‡å¤è¿è¡Œã€‚è¿™å°±æ˜¯åº”ç”¨ç¨‹åºçš„å•ä¾‹æ¨¡å¼ã€‚\nå®ç°ï¼ˆWPFï¼‰ å½“ç„¶ï¼Œå®ç°çš„æ–¹æ³•ä¸æ˜¯å”¯ä¸€çš„ã€‚\nå¯ä»¥åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™æŸ¥æ‰¾åº”ç”¨ç¨‹åºçš„çª—å£åå­—ï¼Œå¦‚æœæŸ¥æ‰¾çš„ç»“æœä¸ä¸ºç©ºï¼Œå°±è¯´æ˜å·²ç»æœ‰ä¸€ä¸ªå®ä¾‹æ­£åœ¨è¿è¡Œï¼Œä½†å¦‚æœä½ çš„ç¨‹åºç¢°å·§å’Œå…¶å®ƒç¨‹åºçš„çª—å£åå­—é‡å¤å°±ä¸å¥½è¯´äº†ã€‚\nä¹Ÿå¯ä»¥åœ¨ç¨‹åºå¯åŠ¨æ—¶è·å–åº”ç”¨ç¨‹åºè¿›ç¨‹çš„åå­—ï¼Œç„¶åå†æŸ¥æ‰¾ç³»ç»Ÿæ‰€æœ‰è¿›ç¨‹ï¼Œçœ‹æ˜¯å¦æœ‰é‡å¤çš„ï¼ŒåŸç†å’Œä¸Šä¸€ç§ç±»ä¼¼ã€‚\nè¿™é‡Œè¦è®²çš„å¹¶ä¸æ˜¯ä¸Šé¢ä¸¤ç§ï¼Œè€Œæ˜¯é€šè¿‡Mutexæ¥å®ç°ï¼Œä½¿ç”¨æ¯”å‰ä¸¤ç§æ›´åŠ ç®€å•å’Œæœ‰æ•ˆã€‚\nSystem.Threading.Mutexå®˜æ–¹è¯´æ˜æ˜¯å¯ç”¨äºè¿›ç¨‹é—´åŒæ­¥çš„åŒæ­¥åŸºå…ƒã€‚ã€‚\nä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œé‡å†™åº”ç”¨ç¨‹åºçš„OnStartupæ–¹æ³•ï¼š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 // App.xaml.cs /// \u0026lt;summary\u0026gt; /// App.xaml çš„äº¤äº’é€»è¾‘ /// \u0026lt;/summary\u0026gt; public partial class App : Application { protected override void OnStartup(StartupEventArgs e) { Mutex mutex = new Mutex(true, \u0026#34;MutexName\u0026#34;, out bool createNew); if (createNew) { base.OnStartup(e); } else { MessageBox.Show(\u0026#34;ç¨‹åºå·²åœ¨è¿è¡Œä¸­ã€‚\u0026#34;, \u0026#34;æç¤º\u0026#34;, MessageBoxButton.OK, MessageBoxImage.Information); Application.Current.Shutdown(); } } } æ³¨æ„Mutexçš„ç¬¬2ä¸ªå‚æ•°ï¼Œå¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²ï¼Œè¶Šå¤æ‚è¶Šå¥½ï¼Œé¿å…å’Œå…¶å®ƒç¨‹åºå†²çªã€‚ å¦‚æœcreateNewä¸ºfalseï¼Œå°±è¯´æ˜å·²ç»æœ‰ä¸€ä¸ªå®ä¾‹æ­£åœ¨è¿è¡Œäº†ï¼Œç›´æ¥é€€å‡ºå½“å‰ç¨‹åºã€‚\næ³¨æ„ï¼šå¿…é¡»ä¿è¯Mutexåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¸è¢«åƒåœ¾å›æ”¶ï¼Œå¦åˆ™å°±å¤±æ•ˆäº†ã€‚\nä¸Šé¢çš„å†™æ³•æ˜¯å¯ä»¥çš„ï¼Œä½†å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯Caliburn.Microæˆ–è€…Styletç­‰æ¡†æ¶ï¼Œç¨‹åºå¯åŠ¨æ—¶éƒ½æ˜¯é€šè¿‡Bootstrapperçš„ï¼Œåœ¨Bootstrapperä¸­çš„å†™æ³•ä¼šæœ‰ä¸€äº›ä¸åŒã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 // ä½¿ç”¨ Stylet public class Bootstrapper : Bootstrapper\u0026lt;ShellViewModel\u0026gt; { /// \u0026lt;summary\u0026gt; /// å¿…é¡»å®šä¹‰åœ¨ç±»å†…éƒ¨ï¼Œä¸€æ—¦è¢«é‡Šæ”¾å°±æ— æ•ˆäº† /// \u0026lt;/summary\u0026gt; private Mutex mutex; protected override void OnStart() { mutex = new Mutex(true, MUTEX_NAME, out bool createNew); if (!createNew) { MessageBox.Show(\u0026#34;ç¨‹åºå·²åœ¨è¿è¡Œä¸­ã€‚\u0026#34;, \u0026#34;æç¤º\u0026#34;, MessageBoxButton.OK, MessageBoxImage.Information); // é€€å‡ºå½“å‰åº”ç”¨ç¨‹åº // å°½é‡ä¸è¦ä½¿ç”¨ // Application.Shutdown(); // å› ä¸ºåœ¨è¿™é‡Œä½¿ç”¨ä¼šè§¦å‘ä¸»çª—å£çš„Closingäº‹ä»¶ System.Environment.Exit(0); } base.OnStart(); } } éœ€è¦æ³¨æ„çš„æ˜¯è¦å°†Mutexå®šä¹‰åœ¨ç±»çš„å†…éƒ¨ï¼Œå¦‚æœå®šä¹‰åœ¨OnStartupå‡½æ•°ä½“å†…ï¼Œé‚£ä¹ˆåœ¨ç¨‹åºè¿è¡Œæ—¶å®ƒå°±å¤±æ•ˆäº†ï¼Œå°±ä¸èƒ½ä½¿ç¨‹åºä»¥å•ä¾‹æ¨¡å¼è¿è¡Œäº†ã€‚\nå¦‚æœä½ æƒ³è¦å†™åœ¨å…¶å®ƒåœ°æ–¹ï¼Œå¯ä»¥å°†Mutexå®šä¹‰ä¸ºstaticï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯å®ƒåœ¨åº”ç”¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šå¤±æ•ˆäº†ã€‚\nè¿˜æœ‰å°±æ˜¯åœ¨è¿™é‡Œå°½é‡ä½¿ç”¨System.Environment.Exit(0)è€Œä¸æ˜¯Application.Current.Shutdown()ï¼Œå› ä¸ºæˆ‘å‘ç°è¿™é‡Œä¼šè§¦å‘ä¸»çª—å£çš„Closingäº‹ä»¶ï¼Œå¦‚æœä½ ä¸å¸Œæœ›è§¦å‘å®ƒï¼Œé‚£ä¹ˆå°±ä½¿ç”¨Environment.Exit(0)ã€‚\nè¡¥å…… å…³äºåº”ç”¨ç¨‹åºå•ä¾‹æ¨¡å¼è¿˜å¯ä»¥é€šè¿‡WindowsFormsApplicationBaseæ¥å®ç°ï¼Œä½†æˆ‘ä¹Ÿæ²¡è¯•è¿‡ã€‚ä½¿ç”¨Mutexå·²ç»è¶³å¤Ÿæ»¡è¶³è¦æ±‚äº†ã€‚\næœ€åå†åŠ ä¸€é¡¹åŠŸèƒ½ï¼Œæˆ‘æƒ³è¦åœ¨å½“å‰ç¨‹åºæ£€æµ‹åˆ°å·²ç»å­˜åœ¨æ­£åœ¨è¿è¡Œçš„å®ä¾‹æ—¶ï¼Œé€€å‡ºå¹¶æ¿€æ´»å·²ç»å­˜åœ¨çš„ç¨‹åºçª—å£ã€‚\nè¿™ä¸€ç‚¹å¯ä»¥é€šè¿‡Windowsçš„APIæ¥å®ç°ï¼Œæ€è·¯å°±æ˜¯æŸ¥æ‰¾åº”ç”¨ç¨‹åºçš„ä¸»çª—å£ï¼Œå¹¶å°†å…¶æ¿€æ´»ã€‚ä»£ç å¦‚ä¸‹ï¼š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 [DllImport(\u0026#34;user32.dll\u0026#34;, EntryPoint = \u0026#34;FindWindow\u0026#34;)] public static extern IntPtr FindWindow(string classname, string windowname); [DllImport(\u0026#34;user32.dll\u0026#34;, EntryPoint = \u0026#34;ShowWindow\u0026#34;)] public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow); [DllImport(\u0026#34;user32.dll\u0026#34;, EntryPoint = \u0026#34;SetForegroundWindow\u0026#34;)] public static extern bool SetForegroundWindow(IntPtr hWnd); public const int SW_NORMAL = 1; public const int SW_RESTORE = 9; public static void FindWindowAndActive(string classname, string windowname) { IntPtr hWnd = FindWindow(classname, windowname); ShowWindow(hWnd, SW_NORMAL); SetForegroundWindow(hWnd); } åœ¨åº”ç”¨ç¨‹åºé€€å‡ºä¹‹å‰è°ƒç”¨FindWindowAndActiveå‡½æ•°å³å¯ã€‚\ncsharp \u0026#9660; 1 2 3 4 ... FindWindowAndActive(null, \u0026#34;Main Window\u0026#34;); // æ¿€æ´»å·²ç»å­˜åœ¨çš„å®ä¾‹çª—å£ System.Environment.Exit(0); // é€€å‡ºå½“å‰åº”ç”¨ç¨‹åº ... ","permalink":"https://kira-96.github.io/posts/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003cp\u003eé€šå¸¸æ¥è¯´ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥å¯åŠ¨ä»»æ„æ•°ç›®çš„å®ä¾‹ï¼Œå‰ææ˜¯ä½ çš„ç”µè„‘å†…å­˜è¶³å¤Ÿå¤§ï¼Œæƒ³å¯åŠ¨å¤šå°‘éƒ½å¯ä»¥ã€‚ä½†æœ‰æ—¶å€™æˆ‘ä»¬åªå¸Œæœ›ç¨‹åºåŒæ—¶åªæœ‰ä¸€ä¸ªå®ä¾‹åœ¨è¿è¡Œï¼Œåº”ç”¨ç¨‹åºä¸ä¼šé‡å¤è¿è¡Œã€‚è¿™å°±æ˜¯åº”ç”¨ç¨‹åºçš„å•ä¾‹æ¨¡å¼ã€‚\u003c/p\u003e","title":"åº”ç”¨ç¨‹åºå•ä¾‹æ¨¡å¼"},{"content":"è™½ç„¶å¹³æ—¶å¾ˆå°‘ä¼šç”¨åˆ°å‘½ä»¤è¡Œå‚æ•°ï¼Œä½†æœ‰æ—¶å€™å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°æ¥ä½¿ç¨‹åºæ‰§è¡Œä¸åŒçš„è¡Œä¸ºã€‚\nåœ¨å†™æ§åˆ¶å°ç¨‹åºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¾—åˆ°ç¨‹åºå‘½ä»¤è¡Œå‚æ•°ã€‚\ncsharp \u0026#9660; 1 2 3 4 static void Main(string[] args) { // args å°±æ˜¯å‘½ä»¤è¡Œå‚æ•° } é‚£ä¹ˆå¦‚æœä¸æ˜¯æ§åˆ¶å°ç¨‹åºå¦‚ä½•è·å–å‘½ä»¤è¡Œå‚æ•°å‘¢ï¼Ÿ\nåœ¨ WPF ä¸­æœ‰ä¸¤ç§æ–¹æ³•è·å–å‘½ä»¤è¡Œå‚æ•°\nç¬¬ä¸€ç§æ–¹æ³•æ˜¯é‡å†™åº”ç”¨çš„OnStartupæ–¹æ³•ï¼Œé€šè¿‡StartupEventArgsæ¥è·å–å‘½ä»¤è¡Œå‚æ•°ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // App.xaml.cs /// \u0026lt;summary\u0026gt; /// App.xaml çš„äº¤äº’é€»è¾‘ /// \u0026lt;/summary\u0026gt; public partial class App : Application { protected override void OnStartup(StartupEventArgs e) { base.OnStartup(e); // è·å–å‘½ä»¤è¡Œå‚æ•° string[] args = e.Args; // do something } } å¦‚æœæ²¡æœ‰å‘½ä»¤è¡Œå‚æ•°ï¼Œé‚£ä¹ˆargså°±ä¸ºnullã€‚\nç¬¬äºŒç§æ–¹æ³•åˆ™æ¯”è¾ƒçµæ´»ï¼Œå¯ä»¥åœ¨ä»»æ„åœ°æ–¹è·å–åˆ°å‘½ä»¤è¡Œå‚æ•°ã€‚\ncsharp \u0026#9660; 1 string[] args = System.Environment.GetCommandLineArgs(); ç›´æ¥ä½¿ç”¨Environmentçš„é™æ€æ–¹æ³•æ¥è·å–å‘½ä»¤è¡Œå‚æ•°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¬¬äºŒç§æ–¹æ³•è·å–åˆ°çš„å‚æ•°å’Œå‰é¢ä¸€ç§æ–¹æ³•ç»“æœä¸åŒã€‚\nç¬¬äºŒç§æ–¹æ³•è·å–çš„ç»“æœä¸ä¼šä¸ºnullï¼Œé€šè¿‡Environmentè·å–åˆ°çš„å‘½ä»¤è¡Œå‚æ•°ç¬¬ä¸€ä¸ªæ˜¯å½“å‰ç¨‹åºçš„è·¯å¾„ï¼Œä»ç¬¬2é¡¹å¼€å§‹æ‰æ˜¯å‘½ä»¤è¡Œå‚æ•°ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚\n","permalink":"https://kira-96.github.io/posts/wpf-%E8%8E%B7%E5%8F%96%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0/","summary":"\u003cp\u003eè™½ç„¶å¹³æ—¶å¾ˆå°‘ä¼šç”¨åˆ°å‘½ä»¤è¡Œå‚æ•°ï¼Œä½†æœ‰æ—¶å€™å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°æ¥ä½¿ç¨‹åºæ‰§è¡Œä¸åŒçš„è¡Œä¸ºã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨å†™æ§åˆ¶å°ç¨‹åºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¾—åˆ°ç¨‹åºå‘½ä»¤è¡Œå‚æ•°ã€‚\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"csharp\"\u003ecsharp\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csharp\" data-lang=\"csharp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"k\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eMain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"n\"\u003eargs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// args å°±æ˜¯å‘½ä»¤è¡Œå‚æ•°\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eé‚£ä¹ˆå¦‚æœä¸æ˜¯æ§åˆ¶å°ç¨‹åºå¦‚ä½•è·å–å‘½ä»¤è¡Œå‚æ•°å‘¢ï¼Ÿ\u003c/p\u003e","title":"WPF è·å–å‘½ä»¤è¡Œå‚æ•°"},{"content":"å‰è¨€ ç”±äºæˆ‘å¹³æ—¶æ˜¯å°†æ ‘è“æ´¾(Respberry Pi)å½“æˆä¸€ä¸ªLinuxç”µè„‘æ¥ä½¿ç”¨ï¼Œå¹³æ—¶éƒ½æ˜¯é€šè¿‡sshè¿æ¥åˆ°æ ‘è“æ´¾æ¥è¿›è¡Œæ“ä½œçš„ï¼Œæ‰€ä»¥ä¸€ç›´éƒ½æ˜¯é€šè¿‡ç»ˆç«¯è¿›è¡Œæ“ä½œçš„ã€‚è€Œæ ‘è“æ´¾ç³»ç»Ÿçš„ç»ˆç«¯åˆä¸­è§„ä¸­è·ï¼Œä¸æ€ä¹ˆå¥½çœ‹ã€‚åˆšå¥½è¿™ä¸¤å¤©æ¥è§¦åˆ°äº†ä¸€ä¸ªååˆ†æ¼‚äº®çš„Power Shellä¸»é¢˜oh-my-poshï¼Œæ‰€ä»¥å°±æƒ³ç€èƒ½ä¸èƒ½å¼„åˆ°æ ‘è“æ´¾ä¸Šã€‚æŠ˜è…¾äº†åŠå¤©ï¼Œç»ˆäºæˆåŠŸäº†ï¼Œè¿‡ç¨‹è¿˜ç®—é¡ºåˆ©ã€‚\nç›®æ ‡ æˆ‘çš„ç›®æ ‡æ˜¯ç¾åŒ–æ ‘è“æ´¾çš„ç»ˆç«¯ï¼Œç”±äºoh-my-poshæ˜¯power shellçš„ä¸»é¢˜ï¼Œæ‰€ä»¥é¦–å…ˆéœ€è¦å®‰è£…power shellï¼Œç„¶åå†é€šè¿‡power shellå®‰è£…oh-my-poshã€‚\nå®‰è£… Power Shell å®‰è£… oh-my-posh å®‰è£… Power Shell Core åˆšå¥½å‰å‡ å¤©Power Shell Core 7å‘å¸ƒäº†ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œå°±å®‰è£…äº†æœ€æ–°çš„ç‰ˆæœ¬ã€‚\nPower Shell å®˜ç½‘æ˜¯è¿™æ ·çš„è¯´æ˜çš„ã€‚\nå½“å‰ä»… Raspbian Stretch æ”¯æŒ PowerShellã€‚ CoreCLR å’Œ PowerShell Core ä»…é€‚ç”¨äº Pi 2 å’Œ Pi 3 è®¾å¤‡ï¼Œå› ä¸ºå…¶ä»–è®¾å¤‡ï¼ˆå¦‚ Pi 0ï¼‰æœ‰ä¸å—æ”¯æŒçš„å¤„ç†å™¨ã€‚\næˆ‘æ˜¯ç”¨çš„æ˜¯æ ‘è“æ´¾ 3B+ï¼Œæµ‹è¯•æ˜¯å¯ä»¥çš„ã€‚\nå…·ä½“çš„æ“ä½œæŒ‰ç…§Power Shellå®˜ç½‘çš„å®‰è£…è¯´æ˜\né¦–å…ˆå®‰è£…Power Shellçš„ä¾èµ–ï¼š\nsh \u0026#9660; 1 2 3 4 5 6 7 8 # Prerequisites # Update package lists sudo apt-get update # Install libunwind8 and libssl1.0 # Regex is used to ensure that we do not install libssl1.0-dev, as it is a variant that is not required sudo apt-get install \u0026#39;^libssl1.0.[0-9]$\u0026#39; libunwind8 -y ç„¶ååˆ°è¿™é‡Œä¸‹è½½æœ€æ–°çš„Power ShelläºŒè¿›åˆ¶åŒ…ã€‚\nè¿™é‡Œéœ€è¦ä¸‹è½½arm32ä½çš„äºŒè¿›åˆ¶åŒ…ã€‚\npowershell-7.0.0-linux-arm32.tar.gz\nä¸‹è½½å®Œæˆåè§£å‹åˆ°ä»»æ„ç›®å½•å³å¯è¿è¡Œã€‚\næˆ–è€…ä½¿ç”¨å®˜ç½‘çš„æ–¹å¼ï¼š\nsh \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 # Download and extract PowerShell # Grab the latest tar.gz wget https://github.com/PowerShell/PowerShell/releases/download/v7.0.0/powershell-7.0.0-linux-arm32.tar.gz # Make folder to put powershell mkdir ~/powershell # Unpack the tar.gz file tar -xvf ./powershell-7.0.0-linux-arm32.tar.gz -C ~/powershell # Start PowerShell ~/powershell/pwsh æœ€åï¼Œå¦‚æœæƒ³è¦åœ¨ä»»æ„ä½ç½®éƒ½èƒ½å¯åŠ¨Power Shellï¼Œéœ€è¦åˆ›å»ºå¯åŠ¨Power Shellçš„è½¯é“¾æ¥ã€‚\nsh \u0026#9660; 1 sudo ln -s ~/path/to/powershell/pwsh /usr/bin/pwsh æˆ–è€…å‚è€ƒå®˜ç½‘çš„æ–¹å¼:\nsh \u0026#9660; 1 2 3 4 5 6 7 # Start PowerShell from bash with sudo to create a symbolic link sudo ~/powershell/pwsh -c New-Item -ItemType SymbolicLink -Path \u0026#34;/usr/bin/pwsh\u0026#34; -Target \u0026#34;\\$PSHOME/pwsh\u0026#34; -Force # alternatively you can run following to create a symbolic link # sudo ln -s ~/powershell/pwsh /usr/bin/pwsh # Now to start PowerShell you can just run \u0026#34;pwsh\u0026#34; ç°åœ¨åªè¦åœ¨ç»ˆç«¯è¾“å…¥pwshå°±å¯ä»¥è¿›å…¥Power Shelläº†ã€‚\nä¸º Power Shell å®‰è£… oh-my-posh å®‰è£…ä¹‹å‰éœ€è¦å…ˆå®‰è£…powerlineå­—ä½“ï¼Œå¦åˆ™ï¼Œoh-my-poshå®‰è£…å®Œæˆåä¼šç”±äºç¼ºå°‘å­—ä½“è€Œæ˜¾ç¤ºä¸æ­£å¸¸ã€‚\nsh \u0026#9660; 1 sudo apt-get install fonts-powerline ç„¶åå°±å¯ä»¥ä¸ºPower Shellå®‰è£…oh-my-poshä¸»é¢˜äº†ã€‚\né¦–å…ˆè¦è¿›å…¥Power Shellï¼Œåœ¨ç»ˆç«¯è¾“å…¥pwshå³å¯ã€‚\nåœ¨Power Shellä¸‹ä¾æ¬¡æ‰§è¡Œä¸‹é¢ä¸¤ä¸ªå‘½ä»¤ï¼š\nsh \u0026#9660; 1 2 Install-Module posh-git -Scope CurrentUser Install-Module oh-my-posh -Scope CurrentUser å®‰è£…è¿‡ç¨‹ä¸­å…¨éƒ¨é€‰ æ˜¯(Y) å°±å¯ä»¥äº†ã€‚\nå®‰è£…å®Œæˆåå°±å¯ä»¥ä½¿ç”¨oh-my-poshäº†ï¼š\nsh \u0026#9660; 1 2 3 4 # Start the default settings Set-Prompt # Alternatively set the desired theme: Set-Theme Agnoster æœ€åéœ€è¦ä¿å­˜Power Shellçš„é…ç½®ï¼Œè¿™æ ·æ¯æ¬¡è¿›å…¥Power Shellå°±æ˜¯æˆ‘ä»¬è®¾å®šçš„ä¸»é¢˜äº†ã€‚\nsh \u0026#9660; 1 2 3 4 5 # åœ¨ Power Shellä¸‹æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼Œå¦‚æœä¸å­˜åœ¨é…ç½®æ–‡ä»¶å°±åˆ›å»ºä¸€ä¸ª if (!(Test-Path -Path $PROFILE )) { New-Item -Type File -Path $PROFILE -Force } # ä½¿ç”¨æ ‘è“æ´¾çš„ç¼–è¾‘å™¨ä¿®æ”¹é…ç½®æ–‡ä»¶ vi $PROFILE åœ¨é…ç½®æ–‡ä»¶ä¸­è¾“å…¥ä¸‹é¢å†…å®¹ï¼š\nsh \u0026#9660; 1 2 3 Import-Module posh-git Import-Module oh-my-posh Set-Theme Paradox ç„¶åå†é‡æ–°è¿›å…¥Power Shellå°±å¯ä»¥çœ‹åˆ°ä¸»é¢˜å·²ç»æˆåŠŸåº”ç”¨äº†ã€‚\noh-my-poshæä¾›äº†å¤šç§ä¸»é¢˜æ•ˆæœï¼Œå¯ä»¥çœ‹è¿™é‡Œï¼Œå¦‚æœéœ€è¦æ›´æ¢ä¸»é¢˜ï¼Œå¯ä»¥ç›´æ¥åœ¨Power Shellä¸­æ‰§è¡Œï¼š\nsh \u0026#9660; 1 Set-Theme mytheme æ•ˆæœ è™½ç„¶ Power Shell å¯åŠ¨æœ‰ä¸€ç‚¹æ…¢ï¼Œä½†æ˜¾ç¤ºæ•ˆæœè¿˜æ˜¯å¾ˆä¸é”™çš„ã€‚\næœ€åæ”¾ä¸Šå®é™…è¿è¡Œçš„æ•ˆæœï¼š\nåœ¨æ ‘è“æ´¾ä¸­æ˜¾ç¤ºæ•ˆæœï¼š\nåœ¨å…¶å®ƒç»ˆç«¯ä¸­çš„æ˜¾ç¤ºæ•ˆæœ(Termius)ï¼š\nå‚è€ƒ\nåœ¨æ ‘è“æ´¾ä¸Šå®‰è£…PowerShellCore å®‰è£…powerline-fonts å®‰è£…oh-my-posh ","permalink":"https://kira-96.github.io/posts/%E5%9C%A8%E6%A0%91%E8%8E%93%E6%B4%BE%E4%B8%8A%E5%AE%89%E8%A3%85-power-shell-%E5%B9%B6%E7%94%A8-oh-my-posh-%E7%BE%8E%E5%8C%96/","summary":"\u003ch2 id=\"å‰è¨€\"\u003eå‰è¨€\u003c/h2\u003e\n\u003cp\u003eç”±äºæˆ‘å¹³æ—¶æ˜¯å°†æ ‘è“æ´¾(Respberry Pi)å½“æˆä¸€ä¸ªLinuxç”µè„‘æ¥ä½¿ç”¨ï¼Œå¹³æ—¶éƒ½æ˜¯é€šè¿‡sshè¿æ¥åˆ°æ ‘è“æ´¾æ¥è¿›è¡Œæ“ä½œçš„ï¼Œæ‰€ä»¥ä¸€ç›´éƒ½æ˜¯é€šè¿‡ç»ˆç«¯è¿›è¡Œæ“ä½œçš„ã€‚è€Œæ ‘è“æ´¾ç³»ç»Ÿçš„ç»ˆç«¯åˆä¸­è§„ä¸­è·ï¼Œä¸æ€ä¹ˆå¥½çœ‹ã€‚åˆšå¥½è¿™ä¸¤å¤©æ¥è§¦åˆ°äº†ä¸€ä¸ªååˆ†æ¼‚äº®çš„Power Shellä¸»é¢˜\u003ca href=\"https://github.com/JanDeDobbeleer/oh-my-posh\"\u003eoh-my-posh\u003c/a\u003eï¼Œæ‰€ä»¥å°±æƒ³ç€èƒ½ä¸èƒ½å¼„åˆ°æ ‘è“æ´¾ä¸Šã€‚æŠ˜è…¾äº†åŠå¤©ï¼Œç»ˆäºæˆåŠŸäº†ï¼Œè¿‡ç¨‹è¿˜ç®—é¡ºåˆ©ã€‚\u003c/p\u003e","title":"åœ¨æ ‘è“æ´¾ä¸Šå®‰è£… Power Shell å¹¶ç”¨ oh-my-posh ç¾åŒ–"},{"content":"ç®€ä»‹ JSONæ˜¯ä¸€ç§å¸¸ç”¨çš„è½»é‡çº§æ•°æ®äº¤æ¢æ ¼å¼ã€‚ä¸XMLç›¸æ¯”ï¼ŒJSONæ— è®ºæ˜¯ä½“ç§¯è¿˜æ˜¯å¯è¯»æ€§éƒ½æ›´å¥½ï¼Œæ‰€ä»¥åœ¨ç½‘ç»œæ•°æ®ä¼ è¾“å’Œåº”ç”¨ç¨‹åºä¸­è¢«å¹¿æ³›çš„åº”ç”¨ã€‚\né‚£ä¹ˆï¼Œ.NETå¹³å°ä½¿ç”¨æœ€å¹¿æ³›çš„JSONåº“æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè‡ªç„¶è¦æ•°Newtonsoft.NETäº†ï¼Œæ‰“å¼€nugetåŒ…ç®¡ç†å™¨ç¬¬ä¸€ä¸ªå°±æ˜¯ï¼Œåœ¨æ‰€æœ‰åŒ…ä¸‹è½½é‡æ’è¡Œä¸­æ’åç¬¬ä¸€ã€‚ä½¿ç”¨ç®€å•ï¼Œæ€§èƒ½å¯é ï¼Œæ–‡æ¡£ä¹Ÿå¾ˆé½å…¨ã€‚\nä½¿ç”¨ ä½¿ç”¨JSONæœ€å¸¸ç”¨çš„å°±æ˜¯å¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚\nå…ˆæ¥çœ‹æœ€åŸºæœ¬çš„ä½¿ç”¨\ncsharp \u0026#9660; 1 2 3 4 5 6 7 // å…ˆå®šä¹‰ä¸€ä¸ªç±» public class TestJsonDeseClass { public Guid MessageGuid { get; set; } public string Message { get; set; } } csharp \u0026#9660; 1 2 3 4 5 6 7 8 TestJsonDeseClass test = new TestJsonDeseClass() { MessageGuid = Guid.NewGuid(), Message = \u0026#34;Test Message\u0026#34; }; string json = JsonConvert.SerializeObject(test); TestJsonDeseClass des = JsonConvert.DeserializeObject\u0026lt;TestJsonDeseClass\u0026gt;(json); åªéœ€è¦å°†ç±»çš„æˆå‘˜å±æ€§è®¾ç½®ä¸ºgetå’Œsetå°±å¯ä»¥äº†ï¼Œååºåˆ—åŒ–çš„æ—¶å€™ï¼ŒJson.NETä¼šè‡ªåŠ¨æ ¹æ®æˆå‘˜çš„åå­—ä¸ºå¯¹è±¡çš„æˆå‘˜èµ‹å€¼ã€‚\né‚£ä¹ˆå¦‚æœä¸æƒ³åºåˆ—åŒ–/ååºåˆ—åŒ–æŸä¸ªæˆå‘˜å˜é‡å‘¢ï¼Ÿ\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 using Newtonsoft.Json; public class TestJsonDeseClass { [JsonIgnore] public Guid MessageGuid { get; set; } public string Message { get; set; } } åªéœ€è¦åœ¨æˆå‘˜å˜é‡çš„å®šä¹‰å‰åŠ ä¸Š[JsonIgnore]çš„å±æ€§ï¼ˆAttributeï¼‰å³å¯ï¼Œåºåˆ—åŒ–/ååºåˆ—åŒ–çš„æ—¶å€™Json.NETä¼šè‡ªåŠ¨å¿½ç•¥è¯¥æˆå‘˜ã€‚\nå¦‚æœJSONå­—ç¬¦ä¸²ä¸­çš„å±æ€§åå­—å’Œå®šä¹‰çš„ç±»ä¸­çš„æˆå‘˜åå­—ä¸ä¸€æ ·æ€ä¹ˆåŠå‘¢ï¼Ÿæ€æ ·æ‰èƒ½æ­£ç¡®çš„ç»™æˆå‘˜å˜é‡èµ‹å€¼å‘¢ï¼Ÿ\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 using Newtonsoft.Json; public class TestJsonDeseClass { [JsonProperty(\u0026#34;Guid\u0026#34;)] public Guid MessageGuid { get; set; } public string Message { get; set; } } åªéœ€è¦åœ¨æˆå‘˜å˜é‡çš„å®šä¹‰å‰åŠ ä¸Š[JsonProperty()]çš„å±æ€§ï¼ˆAttributeï¼‰å³å¯ï¼Œåºåˆ—åŒ–/ååºåˆ—åŒ–çš„æ—¶å€™Json.NETä¼šå°†Jsonå­—ç¬¦ä¸²ä¸­çš„\u0026quot;Guid\u0026quot;å±æ€§èµ‹å€¼ç»™MessageGuidã€‚\né‚£ä¹ˆï¼Œå¦‚æœæƒ³è®©ç±»çš„å±æ€§å€¼åªè¯»çš„getï¼Œä¸æƒ³è®©å¤–éƒ¨èƒ½ä¿®æ”¹æˆå‘˜å˜é‡å‘¢ï¼Œå¦‚ä½•è®¾ç½®å‘¢ï¼Ÿ\nå½“ç„¶è¿™æ ·ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡éœ€è¦æˆ‘ä»¬ç»™ç±»æ·»åŠ æ„é€ æ–¹æ³•ï¼Œåœ¨æ„é€ æ–¹æ³•ä¸­å¯¹æˆå‘˜èµ‹å€¼ï¼Œä¸èƒ½å†ä½¿ç”¨é»˜è®¤çš„æ„é€ æ–¹æ³•ï¼Œå› ä¸ºé»˜è®¤çš„æ„é€ æ–¹æ³•ä¸ä¼šå¯¹æˆå‘˜èµ‹å€¼ï¼Œè€Œå¤–éƒ¨ä¹Ÿæ— æ³•å¯¹æˆå‘˜èµ‹å€¼ã€‚åœ¨æ·»åŠ äº†æ„é€ æ–¹æ³•åï¼ŒJson.NETä¼šè‡ªåŠ¨è°ƒç”¨ç±»çš„æ„é€ æ–¹æ³•ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 using Newtonsoft.Json; public class TestJsonDeseClass { public Guid MessageGuid { get; } public string Message { get; } public TestJsonDeseClass(Guid messageGuid, string message) { MessageGuid = messageGuid; Message = message; } } ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ„é€ æ–¹æ³•çš„å‚æ•°åç§°å¿…é¡»å’Œæˆå‘˜å˜é‡ï¼ˆæˆ–è€…è¯´æ˜¯åºåˆ—åŒ–/ååºåˆ—åŒ–æ—¶çš„å±æ€§ï¼‰åå­—ä¸€è‡´ï¼Œä½†å¯ä»¥ä¸ç”¨åŒºåˆ†å¤§å°å†™ï¼Œæ‰èƒ½æ­£ç¡®å¯¹å±æ€§èµ‹å€¼ã€‚\nå¦‚æœæŠŠä¸Šé¢çš„æ„é€ æ–¹æ³•æ”¹æˆä¸‹é¢è¿™ä¸ªæ ·å­\ncsharp \u0026#9660; 1 2 3 4 5 public TestJsonDeseClass(Guid guid, string message) { MessageGuid = guid; Message = message; } å°±ä¼šå¯¼è‡´ååºåˆ—åŒ–çš„å¯¹è±¡MessageGuidå±æ€§ä¸èƒ½æ­£ç¡®èµ‹å€¼ï¼Œå› ä¸ºJson.NETæ— æ³•ä»jsonå­—ç¬¦ä¸²ä¸­æ‰¾åˆ°åä¸ºguidçš„å±æ€§ï¼Œä½ ä¹Ÿæ²¡å‘Šè¯‰å®ƒè¦æ‹¿åä¸ºMessageGuidçš„å±æ€§ï¼Œè‡ªç„¶å°±ä¼šå‡ºé”™äº†ã€‚\né‚£ä¹ˆï¼Œæœ€åä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘çš„ç±»æœ‰å¤šä¸ªæ„é€ æ–¹æ³•ï¼Œæˆ‘æ€æ ·å‘Šè¯‰Json.NETåº”è¯¥ç”¨å“ªä¸€ä¸ªå‘¢ï¼Ÿ\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 using Newtonsoft.Json; public class TestJsonDeseClass { public Guid MessageGuid { get; } public string Message { get; } public TestJsonDeseClass() { } [JsonConstructor] public TestJsonDeseClass(Guid messageGuid, string message) { MessageGuid = messageGuid; Message = message; } } åªéœ€è¦åœ¨å¯¹åº”çš„æ„é€ æ–¹æ³•å‰é¢åŠ ä¸Š[JsonConstructor]çš„å±æ€§ï¼ˆAttributeï¼‰å³å¯ï¼Œååºåˆ—åŒ–çš„æ—¶å€™Json.NETä¼šå°±ä¼šè°ƒç”¨ç›¸åº”çš„æ„é€ æ–¹æ³•æ¥ç”Ÿæˆå¯¹è±¡äº†ã€‚\nä»¥ä¸Šå°±æ˜¯ä¸€äº›åŸºæœ¬çš„ç”¨æ³•ï¼ŒåŸºæœ¬ä¸Šèƒ½æ»¡è¶³æ­£å¸¸çš„ä½¿ç”¨äº†ã€‚å½“ç„¶è¿˜æœ‰ä¸€äº›æ›´åŠ é«˜çº§å’Œçµæ´»çš„ç”¨æ³•ï¼Œè¿™é‡Œå°±ä¸å¤šè®°å½•äº†ï¼Œéœ€è¦çš„æ—¶å€™å†å»çœ‹æ–‡æ¡£å°±å¯ä»¥äº†ã€‚\nå‚è€ƒ\næ–‡æ¡£\nSamples\n","permalink":"https://kira-96.github.io/posts/newtonsoft.net-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://baike.baidu.com/item/JSON\"\u003eJSON\u003c/a\u003eæ˜¯ä¸€ç§å¸¸ç”¨çš„è½»é‡çº§æ•°æ®äº¤æ¢æ ¼å¼ã€‚ä¸\u003ca href=\"https://baike.baidu.com/item/%E5%8F%AF%E6%89%A9%E5%B1%95%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80/2885849?fromtitle=xml\u0026amp;fromid=86251\u0026amp;fr=aladdin\"\u003eXML\u003c/a\u003eç›¸æ¯”ï¼ŒJSONæ— è®ºæ˜¯ä½“ç§¯è¿˜æ˜¯å¯è¯»æ€§éƒ½æ›´å¥½ï¼Œæ‰€ä»¥åœ¨ç½‘ç»œæ•°æ®ä¼ è¾“å’Œåº”ç”¨ç¨‹åºä¸­è¢«å¹¿æ³›çš„åº”ç”¨ã€‚\u003c/p\u003e\n\u003cp\u003eé‚£ä¹ˆï¼Œ.NETå¹³å°ä½¿ç”¨æœ€å¹¿æ³›çš„JSONåº“æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè‡ªç„¶è¦æ•°\u003ca href=\"https://www.newtonsoft.com/json\"\u003eNewtonsoft.NET\u003c/a\u003eäº†ï¼Œæ‰“å¼€\u003ca href=\"https://www.nuget.org/\"\u003enuget\u003c/a\u003eåŒ…ç®¡ç†å™¨ç¬¬ä¸€ä¸ªå°±æ˜¯ï¼Œåœ¨æ‰€æœ‰åŒ…ä¸‹è½½é‡æ’è¡Œä¸­æ’åç¬¬ä¸€ã€‚ä½¿ç”¨ç®€å•ï¼Œæ€§èƒ½å¯é ï¼Œ\u003ca href=\"https://www.newtonsoft.com/json/help/html/Introduction.htm\"\u003eæ–‡æ¡£\u003c/a\u003eä¹Ÿå¾ˆé½å…¨ã€‚\u003c/p\u003e\n\u003ch2 id=\"ä½¿ç”¨\"\u003eä½¿ç”¨\u003c/h2\u003e\n\u003cp\u003eä½¿ç”¨JSONæœ€å¸¸ç”¨çš„å°±æ˜¯å¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚\u003c/p\u003e\n\u003cp\u003eå…ˆæ¥çœ‹æœ€åŸºæœ¬çš„ä½¿ç”¨\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"csharp\"\u003ecsharp\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csharp\" data-lang=\"csharp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// å…ˆå®šä¹‰ä¸€ä¸ªç±»\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTestJsonDeseClass\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eGuid\u003c/span\u003e \u003cspan class=\"n\"\u003eMessageGuid\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003eMessage\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003eset\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"csharp\"\u003ecsharp\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e8\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csharp\" data-lang=\"csharp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eTestJsonDeseClass\u003c/span\u003e \u003cspan class=\"n\"\u003etest\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eTestJsonDeseClass\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eMessageGuid\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eNewGuid\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eMessage\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Test Message\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003ejson\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eJsonConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eSerializeObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etest\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eTestJsonDeseClass\u003c/span\u003e \u003cspan class=\"n\"\u003edes\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eJsonConvert\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eDeserializeObject\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eTestJsonDeseClass\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;(\u003c/span\u003e\u003cspan class=\"n\"\u003ejson\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eåªéœ€è¦å°†ç±»çš„æˆå‘˜å±æ€§è®¾ç½®ä¸º\u003ccode\u003eget\u003c/code\u003eå’Œ\u003ccode\u003eset\u003c/code\u003eå°±å¯ä»¥äº†ï¼Œååºåˆ—åŒ–çš„æ—¶å€™ï¼ŒJson.NETä¼šè‡ªåŠ¨æ ¹æ®æˆå‘˜çš„åå­—ä¸ºå¯¹è±¡çš„æˆå‘˜èµ‹å€¼ã€‚\u003c/p\u003e","title":"Newtonsoft.NET åŸºæœ¬ä½¿ç”¨"},{"content":"ç®€ä»‹ Styletæ˜¯ä¸€ä¸ªè½»é‡ä¸”åŠŸèƒ½å¼ºå¤§çš„MVVMæ¡†æ¶ã€‚æ”¯æŒ .NET 4.5+ å’Œ .NET Core 3.0+ã€‚\nStyletçš„ä½œè€…ä¹Ÿæ˜¯å—åˆ°Caliburn.Microçš„å¯å‘ï¼Œå¹¶ä¸”åœ¨CMçš„åŸºç¡€ä¸Šåšäº†è®¸å¤šæ”¹è¿›ã€‚æ‰€ä»¥Styletä½¿ç”¨èµ·æ¥æ„Ÿè§‰å’ŒCaliburn.Microå·®åˆ«ä¸æ˜¯å¾ˆå¤§ï¼Œä½†åˆæœ‰ç€ä¸€äº›ä¸åŒã€‚\né¡¹ç›®ç»“æ„ è¿™é‡Œé€‰æ‹©åˆ›å»ºä¸€ä¸ª .NET Core çš„ WPF é¡¹ç›®ã€‚\nè¿™é‡Œé¡¹ç›®ç»“æ„é£æ ¼å’ŒCaliburn.Microç±»ä¼¼ï¼Œç¤ºä¾‹æºä»£ç \n. â”œâ”€â”€ Views â”‚ â””â”€â”€ ... â”œâ”€â”€ ViewModels â”‚ â””â”€â”€ ... â”œâ”€â”€ App.xaml â”œâ”€â”€ Bootstrapper.cs â””â”€â”€ ... è™½ç„¶Styletå®˜æ–¹ç»™å‡ºçš„ä¾‹å­é‡Œé¢Viewå’ŒViewModelæ˜¯æ”¾åœ¨ä¸€èµ·çš„ï¼Œä½†ç»è¿‡å®é™…ä½¿ç”¨åå‘ç°é‡‡ç”¨CMçš„é£æ ¼ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä¾ç…§ä¹ æƒ¯ï¼Œå°†Viewså’ŒViewModelsåˆ†åˆ«æ”¾åœ¨ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­ã€‚\nä½¿ç”¨ Bootstrapper.cs\ncsharp \u0026#9660; 1 2 public class Bootstrapper : Bootstrapper\u0026lt;ShellViewModel\u0026gt; {} è¿™æ ·å°±ç›¸å½“äºæ‰§è¡Œäº†DisplayRootViewFor\u0026lt;ShellViewModel\u0026gt;()ã€‚\nç„¶åå†ä¿®æ”¹App.xamlå¦‚ä¸‹å°±å¯ä»¥è®©ç¨‹åºå¯åŠ¨äº†ã€‚\nApp.xaml\nxml \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;Application x:Class=\u0026#34;WpfSample.App\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; xmlns:s=\u0026#34;https://github.com/canton7/Stylet\u0026#34; xmlns:app=\u0026#34;clr-namespace:WpfSample\u0026#34;\u0026gt; \u0026lt;Application.Resources\u0026gt; \u0026lt;s:ApplicationLoader\u0026gt; \u0026lt;s:ApplicationLoader.Bootstrapper\u0026gt; \u0026lt;app:Bootstrapper /\u0026gt; \u0026lt;/s:ApplicationLoader.Bootstrapper\u0026gt; \u0026lt;/s:ApplicationLoader\u0026gt; \u0026lt;/Application.Resources\u0026gt; \u0026lt;/Application\u0026gt; ç»‘å®š Styletä¼¼ä¹ä¸å†æ”¯æŒCaliburn.Microçš„é€šè¿‡x:Nameæ¥ç»‘å®šçš„æœºåˆ¶ï¼Œå¿…é¡»é€šè¿‡Bindingæ˜¾å¼æŒ‡å®šç»‘å®šå±æ€§çš„æ–¹å¼ã€‚\nxml \u0026#9660; 1 \u0026lt;TextBox Text=\u0026#34;{Binding YourName, UpdateSourceTrigger=PropertyChanged}\u0026#34; /\u0026gt; Actionçš„å†™æ³•åˆ™æœ‰äº†æ›´æ˜æ˜¾çš„å·®å¼‚ã€‚\nxml \u0026#9660; 1 2 3 \u0026lt;Button Content=\u0026#34;Say Hello\u0026#34; xmlns:stylet=\u0026#34;https://github.com/canton7/Stylet\u0026#34; Command=\u0026#34;{stylet:Action SayHello}\u0026#34; /\u0026gt; csharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 // ShellViewModel.cs private string _name; public string YourName { get =\u0026gt; _name; set { SetAndNotify(ref _name, value); NotifyOfPropertyChange(() =\u0026gt; CanSayHello); } } public bool CanSayHello =\u0026gt; !string.IsNullOrEmpty(YourName); public void SayHello() { _logger.Info(\u0026#34;Say Hello {0}\u0026#34;, _name); _windowManager.ShowMessageBox($\u0026#34;Hello {_name}\u0026#34;); } ä¸åŒäºCaliburn.Microçš„å†™æ³•cal:Message.Attach=\u0026quot;[Click]=[OnClick()]\u0026quot;\nStyletå¯ä»¥ç›´æ¥æŒ‡å®šç›¸åº”çš„äº‹ä»¶ï¼Œå¯è¯»æ€§è‡ªç„¶æ˜¯æå‡äº†ä¸å°‘ï¼Œå¹¶ä¸”ä¾æ—§ä¸éœ€è¦åœ¨ViewModelä¸­å†™ICommandï¼Œç›´æ¥å†™å‡½æ•°å³å¯ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡CommandParameterä¼ é€’å‚æ•°ã€‚\nä¸Šé¢æ˜¯é€šè¿‡Commandçš„æ–¹å¼ç»‘å®šï¼Œä½ ä¹Ÿå¯ä»¥ç»‘å®šåˆ°Clickæˆ–è€…å…¶å®ƒçš„äº‹ä»¶ã€‚\nä»¥ä¸‹æ˜¯å®˜æ–¹çš„ç¤ºä¾‹:\nxml \u0026#9660; 1 \u0026lt;Button Click=\u0026#34;{s:Action DoSomething}\u0026#34;\u0026gt;Click me\u0026lt;/Button\u0026gt; csharp \u0026#9660; 1 2 3 4 5 6 7 public void HasNoArguments() { } // This can accept EventArgs, or a subclass of EventArgs public void HasOneSingleArgument(EventArgs e) { } // Again, a subclass of EventArgs is OK public void HasTwoArguments(object sender, EventArgs e) { } å¯ä»¥æ ¹æ®éœ€æ±‚åœ¨ViewModelå¯¹åº”çš„å‡½æ•°ä¸­å®šä¹‰å‚æ•°æˆ–è€…ä¸å®šä¹‰ã€‚\nActionTarget\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 class InnerViewModel { public void DoSomething() { } } class ViewModel { public InnerViewModel InnerViewModel { get; private set; } public ViewModel() { this.InnerViewModel = new InnerViewModel(); } } xml \u0026#9660; 1 \u0026lt;Button s:View.ActionTarget=\u0026#34;{Binding InnerViewModel}\u0026#34; Command=\u0026#34;{s:Action DoSomething}\u0026#34;\u0026gt;Click me\u0026lt;/Button\u0026gt; é€šè¿‡æŒ‡å®šAction.Targetæ¥ç»‘å®šåˆ°å…¶å®ƒçš„ViewModelã€‚\nä¾èµ–æ³¨å…¥ Styletæä¾›äº†ä¸¤ä¸ªç±»ä¾›ViewModelç»§æ‰¿ï¼ŒScreenå’ŒConductorï¼Œè¿™ä¸€ç‚¹å’ŒCaliburn.Microç±»ä¼¼ã€‚æ‰€æœ‰çš„ViewModeléƒ½ä¼šè‡ªåŠ¨ç»‘å®šåˆ°IoCï¼Œä¸éœ€è¦åœ¨Bootstrapperä¸­è¿›è¡Œè®¾ç½®ã€‚\nå¿…è¦æ—¶ä¹Ÿå¯ä»¥é‡å†™Bootstrapperä¸­çš„ConfigureIoCæ¥æ³¨å†Œä¸€äº›å…¶å®ƒçš„æœåŠ¡ã€‚\nè¿™é‡Œæ³¨å†Œäº†ä¸€ä¸ªLogging serviceï¼ŒStyletä¸­æä¾›æœ‰ILoggerçš„æ¥å£ï¼Œä½†ä¸å»ºè®®ä½¿ç”¨ï¼Œå¯ä»¥è‡ªå·±å®ç°ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 protected override void ConfigureIoC(IStyletIoCBuilder builder) { base.ConfigureIoC(builder); builder.Bind\u0026lt;ILogger\u0026gt;().To\u0026lt;Logger\u0026gt;().InSingletonScope().AsWeakBinding(); } Styletæä¾›äº†å¤šç§æ³¨å…¥çš„æ–¹å¼ã€‚\né€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 public NavViewModel( IEventAggregator eventAggregator, FirstTabViewModel tab1, SecondTabViewModel tab2) { this._eventAggregator = eventAggregator; this.Items.Add(tab1); this.Items.Add(tab2); } é€šè¿‡[Inject]è‡ªåŠ¨æ³¨å…¥\nä½¿ç”¨[Inject]æ–¹å¼æ³¨å…¥æ—¶ä¹Ÿå¯ä»¥æŒ‡å®šç›¸åº”çš„Key\ncsharp \u0026#9660; 1 2 3 4 // Logger.cs [Inject(Key = \u0026#34;filelogger\u0026#34;)] public class Logger : ILogger {} csharp \u0026#9660; 1 2 [Inject(Key = \u0026#34;filelogger\u0026#34;)] private ILogger _logger; æŠ½è±¡å·¥å‚\nStyletæä¾›äº†ä¸€ç§æŠ½è±¡å·¥å‚çš„æ¨¡å¼æ¥è·å–ç›¸åº”çš„æœåŠ¡ã€‚\nè¿™é‡Œæˆ‘å®šä¹‰äº†ä¸€ä¸ªIViewModelFactoryçš„æ¥å£\ncsharp \u0026#9660; 1 2 3 4 5 6 7 public interface IViewModelFactory { ShellViewModel GetShellViewModel(); NavViewModel GetNavViewModel(); FirstTabViewModel GetFirstTabViewModel(); SecondTabViewModel GetSecondTabViewModel(); } ç„¶ååœ¨Bootstrapperçš„ConfigureIoCä¸­æ·»åŠ å¦‚ä¸‹ä»£ç \ncsharp \u0026#9660; 1 2 3 4 5 6 7 // Bootstrapper.cs protected override void ConfigureIoC(IStyletIoCBuilder builder) { ... builder.Bind\u0026lt;IViewModelFactory\u0026gt;().ToAbstractFactory(); ... } è¿™æ ·å°±å¯ä»¥é€šè¿‡æ³¨å…¥çš„æ–¹å¼æ¥è·å–åˆ°IViewModelFactoryçš„å®ä¾‹äº†ã€‚\næ³¨æ„è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘å¹¶æ²¡æœ‰æ‰‹åŠ¨å»å®ç°IViewModelFactoryçš„æ¥å£ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 // ShellViewModel.cs [Inject] private IViewModelFactory _viewModelFactory; // è¿™æ—¶å°±å¯ä»¥é€šè¿‡Factoryæ¥è·å–ç›¸åº”çš„ViewModel var vm = _viewModelFactory.GetNavViewModel(); IoC è™½ç„¶å¯ä»¥é€šè¿‡æ³¨å…¥çš„æ–¹å¼æ¥è·å–æœåŠ¡ï¼Œä½†æœ‰æ—¶ä¹Ÿéœ€è¦é€šè¿‡IoC Containeræ¥è·å–ç›¸åº”çš„æœåŠ¡ã€‚Styletä¾ç„¶æœ‰å¤šç§æ–¹å¼æ¥è·å–ã€‚\næ³¨å…¥IoC Container\ncsharp \u0026#9660; 1 2 3 4 5 6 // æ³¨å…¥IoC Conatiner [Inject] private IContainer _container; // é€šè¿‡Containerè·å–ViewModel var vm = _container.Get\u0026lt;NavViewModel\u0026gt;(); Static Service Locator\nç”¨è¿‡Caliburn.Microçš„å¯èƒ½éƒ½çŸ¥é“ï¼ŒCMæä¾›äº†ä¸€ç§éå¸¸å¥½ç”¨çš„è·å–æœåŠ¡çš„æ–¹å¼ã€‚\ncsharp \u0026#9660; 1 var vm = IoC.Get\u0026lt;MyDialogViewModel\u0026gt;(); è€ŒStyletå¹¶æ²¡æœ‰æä¾›è¿™ç§æ–¹å¼ã€‚Styletä½œè€…ç»™å‡ºçš„åŸå› æ˜¯ï¼š\nI don\u0026rsquo;t want to encourage people to write such horrible code.\nä½†æˆ‘å°±æ˜¯å–œæ¬¢ç®€å•ç²—æš´çš„ï¼Œé€šè¿‡IoC.Getçš„æ–¹å¼æ¯”è¾ƒåˆæˆ‘çš„èƒƒå£ã€‚Styletçš„ä½œè€…åŒæ ·ä¹Ÿç»™å‡ºäº†ç›¸åº”çš„æ–¹å¼é“¾æ¥\nä½†ä½œè€…ç»™å‡ºçš„ä»£ç ä¸­GetAllInstanceæ˜¯ä¸èƒ½æ­£ç¡®ä½¿ç”¨çš„ã€‚å¯ä»¥å‚è€ƒæˆ‘çš„ä¿®æ”¹ç‰ˆSimpleIoC\næœ€åå†Bootstrapperä¸­æ·»åŠ ä¸‹é¢ä»£ç å³å¯ã€‚\ncs \u0026#9660; 1 2 3 4 5 6 7 8 protected override void Configure() { base.Configure(); SimpleIoC.GetInstance = this.Container.Get; SimpleIoC.GetAllInstances = this.Container.GetAll; SimpleIoC.BuildUp = this.Container.BuildUp; } ä½¿ç”¨:\ncsharp \u0026#9660; 1 var vm = SimpleIoC.Get\u0026lt;NavViewModel\u0026gt;(); WindowManager csharp \u0026#9660; 1 2 3 4 5 6 public interface IWindowManager { bool? ShowDialog(object viewModel); MessageBoxResult ShowMessageBox(string messageBoxText, string caption = \u0026#34;\u0026#34;, MessageBoxButton buttons = MessageBoxButton.OK, MessageBoxImage icon = MessageBoxImage.None, MessageBoxResult defaultResult = MessageBoxResult.None, MessageBoxResult cancelResult = MessageBoxResult.None, IDictionary\u0026lt;MessageBoxResult, string\u0026gt; buttonLabels = null, FlowDirection? flowDirection = null, TextAlignment? textAlignment = null); void ShowWindow(object viewModel); } Styletçš„IWindowManageræä¾›äº†3ä¸ªæ¥å£å‡½æ•°ï¼Œä¸€ä¸ªMessageBoxï¼Œå…¶å®ƒä¸¤ä¸ªç”¨äºæ˜¾ç¤ºçª—å£ï¼Œå’ŒCaliburn.Microç”¨æ³•ç›¸åŒï¼Œåœ¨ä½¿ç”¨æ—¶æŠŠViewModelä¼ å¦‚å³å¯ã€‚IWindowManagerå¯ä»¥ç›´æ¥é€šè¿‡æ³¨å…¥çš„æ–¹å¼è·å¾—ã€‚\ncsharp \u0026#9660; 1 2 3 4 [Inject] private IWindowManager _windowManager; _windowManager.ShowWindow(_viewModelFactory.GetNavViewModel()); EventAggregator EventAggregatorå’ŒCaliburn.Microä¸­çš„ç”¨æ³•ç›¸åŒã€‚ç»“åˆIHandle\u0026lt;T\u0026gt;ç”¨äºåœ¨ViewModelä¸­ä¼ é€’æ¶ˆæ¯ã€‚\nè®¢é˜…æ¶ˆæ¯ï¼š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // ShellViewModel.cs public class ShellViewModel : Screen, IHandle\u0026lt;TabChangedEvent\u0026gt; { private readonly IEventAggregator _eventAggregator; ... public ShellViewModel(IEventAggregator eventAggregator) { DisplayName = \u0026#34;Hello Stylet!\u0026#34;; _eventAggregator = eventAggregator; _eventAggregator.Subscribe(this); } protected override void OnClose() { _eventAggregator.Unsubscribe(this); base.OnClose(); } public void Handle(TabChangedEvent message) { // TODO } ... } å‘å¸ƒæ¶ˆæ¯ï¼š\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 // AnotherViewModel.cs private readonly IEventAggregator _eventAggregator; public NavViewModel(IEventAggregator eventAggregator) { this._eventAggregator = eventAggregator; } // å‘å¸ƒæ¶ˆæ¯ private Publish() { _eventAggregator.Publish(new TabChangedEvent()); } Styletä¸­çš„EventAggregatoråŒæ—¶æä¾›äº†channelsï¼Œå¯ä»¥åœ¨ä¸åŒçš„ç®¡é“ä¹‹ä¸­è®¢é˜…/å‘å¸ƒæ¶ˆæ¯ã€‚\næ€»ç»“ å¯¹äºä½¿ç”¨è¿‡Caliburn.Microçš„æœ‹å‹æ¥è¯´ï¼ŒStyletéå¸¸å®¹æ˜“ä¸Šæ‰‹ï¼Œå¤§éƒ¨åˆ†çš„ç”¨æ³•åŸºæœ¬ä¸Šéƒ½ä¸€æ ·ï¼ŒåŒæ—¶Styletåˆæä¾›äº†ä¸€äº›æ–°çš„å†…å®¹ã€‚è¿™é‡Œæœ‰äº›ä¸œè¥¿å¹¶æ²¡æœ‰è®²åˆ°ï¼Œå¦‚ViewManagerç­‰ï¼Œä½†Styletå·²ç»è¶³å¤Ÿè®©æˆ‘å…´å¥‹äº†ï¼Œè¿˜æœ‰å°±æ˜¯å®ƒçš„ä½“ç§¯çœŸçš„å¾ˆå°ï¼Œåªæœ‰100å¤šKBï¼Œå¹¶ä¸”åŠŸèƒ½ä¹Ÿè¶³å¤Ÿå¼ºå¤§ï¼Œç”¨èµ·æ¥ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œåé¢æœ‰æœºä¼šå¯ä»¥åœ¨ä¸€äº›å°é¡¹ç›®ä¸­ä½¿ç”¨ã€‚\n","permalink":"https://kira-96.github.io/posts/stylet-%E6%A1%86%E6%9E%B6%E4%BD%93%E9%AA%8C/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/canton7/Stylet\"\u003eStylet\u003c/a\u003eæ˜¯ä¸€ä¸ªè½»é‡ä¸”åŠŸèƒ½å¼ºå¤§çš„\u003cstrong\u003eMVVM\u003c/strong\u003eæ¡†æ¶ã€‚æ”¯æŒ .NET 4.5+ å’Œ .NET Core 3.0+ã€‚\u003c/p\u003e\n\u003cp\u003eStyletçš„ä½œè€…ä¹Ÿæ˜¯å—åˆ°\u003ca href=\"https://github.com/Caliburn-Micro/Caliburn.Micro\"\u003eCaliburn.Micro\u003c/a\u003eçš„å¯å‘ï¼Œå¹¶ä¸”åœ¨CMçš„åŸºç¡€ä¸Šåšäº†è®¸å¤šæ”¹è¿›ã€‚æ‰€ä»¥Styletä½¿ç”¨èµ·æ¥æ„Ÿè§‰å’ŒCaliburn.Microå·®åˆ«ä¸æ˜¯å¾ˆå¤§ï¼Œä½†åˆæœ‰ç€ä¸€äº›ä¸åŒã€‚\u003c/p\u003e\n\u003ch2 id=\"é¡¹ç›®ç»“æ„\"\u003eé¡¹ç›®ç»“æ„\u003c/h2\u003e\n\u003cp\u003eè¿™é‡Œé€‰æ‹©åˆ›å»ºä¸€ä¸ª .NET Core çš„ WPF é¡¹ç›®ã€‚\u003c/p\u003e\n\u003cp\u003eè¿™é‡Œé¡¹ç›®ç»“æ„é£æ ¼å’ŒCaliburn.Microç±»ä¼¼ï¼Œç¤ºä¾‹\u003ca href=\"https://github.com/kira-96/Stylet-Sample\"\u003eæºä»£ç \u003c/a\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e.\nâ”œâ”€â”€ Views\nâ”‚      â””â”€â”€ ...\nâ”œâ”€â”€ ViewModels\nâ”‚      â””â”€â”€ ...\nâ”œâ”€â”€ App.xaml\nâ”œâ”€â”€ Bootstrapper.cs\nâ””â”€â”€ ...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eè™½ç„¶Styletå®˜æ–¹ç»™å‡ºçš„ä¾‹å­é‡Œé¢Viewå’ŒViewModelæ˜¯æ”¾åœ¨ä¸€èµ·çš„ï¼Œä½†ç»è¿‡å®é™…ä½¿ç”¨åå‘ç°é‡‡ç”¨CMçš„é£æ ¼ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä¾ç…§ä¹ æƒ¯ï¼Œå°†Viewså’ŒViewModelsåˆ†åˆ«æ”¾åœ¨ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­ã€‚\u003c/p\u003e","title":"Stylet æ¡†æ¶ä½“éªŒ"},{"content":"è¿™æ®µæ—¶é—´å…¬å¸çš„ä¸€ä¸ªé¡¹ç›®æ‰“ç®—ä½¿ç”¨Named Pipeè¿›è¡Œè¿›ç¨‹é—´çš„é€šè®¯ï¼Œåˆšå¥½èŠ±äº†ç‚¹æ—¶é—´äº†è§£äº†ä¸€ä¸‹ï¼Œè¿™é‡Œåšä¸€ä¸‹ç¬”è®°ã€‚\nNamed Pipeï¼ˆå‘½åç®¡é“ï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯é€šè¿‡åœ¨ä¸¤ä¸ªè¿›ç¨‹é—´æ­å»ºä¸€ä¸ªç®¡é“æ¥è¿›è¡Œé€šè®¯ï¼Œè¿™ç§æ–¹å¼çš„å¥½å¤„åœ¨äºä¸¤è€…å¯ä»¥è¿›è¡Œå…¨åŒå·¥çš„é€šè®¯ï¼ŒæœåŠ¡ç«¯ä¹Ÿå¯ä»¥é€šè¿‡ç®¡é“å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯ï¼Œå¯¹äºä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´çš„é€šè®¯æ¥è¯´å†åˆé€‚ä¸è¿‡äº†ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿç›¸å¯¹æ¯”è¾ƒçµæ´»ã€‚\næœåŠ¡ç«¯ï¼ˆServerï¼‰ Named Pipe å‘½åç©ºé—´\ncsharp \u0026#9660; 1 using System.IO.Pipes; åˆ›å»ºç®¡é“\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 PipeSecurity security = new PipeSecurity(); // ç®¡é“æƒé™ // è®¾ç½®è§„åˆ™ï¼Œåªæœ‰ç”¨æˆ·adminå¯ä»¥å¯¹ç®¡é“è¿›è¡Œè¯»å†™ï¼Œå…¶å®ƒç”¨æˆ·æ— æƒè®¿é—® security.AddAccessRule(new PipeAccessRule(\u0026#34;admin\u0026#34;, PipeAccessRights.ReadWrite, AccessControlType.Allow)); NamedPipeServerStream server = new NamedPipeServerStream( \u0026#34;SimpleServer\u0026#34;, // pipe name PipeDirection.InOut, // æ•°æ®ä¼ è¾“æ–¹å‘ï¼Œè¿™é‡Œä½¿ç”¨åŒå·¥é€šè®¯ 1, // MaxNumberOfServerInstance PipeTransmissionMode.Byte, // å­—èŠ‚æµä¼ è¾“ PipeOptions.Asynchronous | PipeOptions.WriteThrough, 4096, // è¾“å…¥ç¼“å†²å¤§å° 4096, // è¾“å‡ºç¼“å†²å¤§å° security); // ç®¡é“è®¿é—®æƒé™ï¼Œè¿™é‡Œåªåšç¬”è®°ï¼Œé€šå¸¸ä¸éœ€è¦è®¾ç½® ç®¡é“åˆ›å»ºå¥½ä¹‹åè¿˜ä¸èƒ½ç«‹åˆ»å‘é€æ•°æ®ï¼Œå› ä¸ºç®¡é“çš„å¦ä¸€ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰è¿˜æ²¡æœ‰è¿æ¥ï¼Œæ‰€ä»¥æœåŠ¡ç«¯éœ€è¦ç­‰å¾…è¿æ¥ã€‚\ncsharp \u0026#9660; 1 server.WaitForConnection(); // é˜»å¡æ–¹å¼ è¿™é‡Œä½¿ç”¨éé˜»å¡çš„æ–¹å¼ç­‰å¾…è¿æ¥ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨é˜»å¡çš„æ–¹å¼ç­‰å¾…è¿æ¥ï¼Œä¸è¿‡éœ€è¦æ”¾åˆ°ä¸€ä¸ªæ–°çš„çº¿ç¨‹ä¸­ï¼Œé¿å…å°†ä¸»çº¿ç¨‹é˜»å¡ã€‚\ncsharp \u0026#9660; 1 server.BeginWaitForConnection(new AsyncCallback(WaitConnectionCallback), server); // éé˜»å¡æ–¹å¼ csharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 private void WaitConnectionCallback(IAsyncResult asyncResult) { NamedPipeServerStream server = asyncResult.AsyncState as NamedPipeServerStream; server.EndWaitForConnection(asyncResult); StartListen(server); } private void StartListen(NamedPipeServerStream server) { Task.Run(async () =\u0026gt; { int bytesToRead; byte[] buffer; // server.WaitForConnection(); while (true) { try { bytesToRead = 256 * server.ReadByte(); bytesToRead += server.ReadByte(); // æ¼”ç¤º // å°†æ”¶åˆ°çš„æ•°æ®ç«‹é©¬å‘é€å‡ºå» server.WriteByte((byte)(bytesToRead / 256)); server.WriteByte((byte)(bytesToRead % 256)); buffer = new byte[bytesToRead]; server.Read(buffer, 0, bytesToRead); // è¯»å–æ¶ˆæ¯ // æ¼”ç¤º // å°†æ”¶åˆ°çš„æ•°æ®ç«‹é©¬å‘é€å‡ºå» await server.WriteAsync(buffer, 0, bytesToRead); } catch (System.IO.IOException) { // break if another pipe end closed break; } catch (Exception) { break; } // å¤„ç†æ•°æ® string content = Encoding.UTF8.GetString(buffer); Console.WriteLine(content); } server.Disconnect(); // æ–­å¼€è¿æ¥ // é‡æ–°ç­‰å¾…è¿æ¥ server.BeginWaitForConnection(new AsyncCallback(WaitConnectionCallback), server); }); } åœ¨å®¢æˆ·ç«¯è¿æ¥ä¹‹åï¼Œç«‹é©¬å¯åŠ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹å¾ªç¯è¯»å–æ¥è‡ªå®¢æˆ·ç«¯çš„æ¶ˆæ¯ï¼Œè¿™é‡Œçš„æ¶ˆæ¯å‰ä¸¤ä¸ªå­—èŠ‚æŒ‡å®šäº†æ¶ˆæ¯çš„é•¿åº¦ã€‚åŒæ—¶å°†æ”¶åˆ°çš„æ¶ˆæ¯é©¬ä¸Šè¿”å›åˆ°ç®¡é“çš„å¦ä¸€ç«¯ï¼ˆè¿™é‡Œç”¨äºæµ‹è¯•æ˜¯å¦çœŸçš„æ˜¯å…¨åŒå·¥å·¥ä½œï¼‰ã€‚\næœ€åå°†æ¶ˆæ¯çš„è¯»å–æ”¾åˆ°try{ ... } catch(...){ ... }ä¸­ï¼Œå› ä¸ºå¹¶æ²¡æœ‰æ¶ˆæ¯æˆ–è€…äº‹ä»¶é€šçŸ¥æœåŠ¡ç«¯å®¢æˆ·ç«¯å·²ç»æ–­å¼€è¿æ¥ã€‚ä½†å½“å®¢æˆ·ç«¯æ–­å¼€ä¹‹åï¼ŒæœåŠ¡ç«¯åœ¨è¯»å–æ—¶ä¼šæŠ›å‡ºIOExceptionï¼Œå¯ä»¥é€šè¿‡æŠ“å–è¿™ä¸ªé”™è¯¯æ¥åˆ¤æ–­ç®¡é“æ˜¯å¦å·²ç»æ–­å¼€ã€‚\nå½“å®¢æˆ·ç«¯æ–­å¼€ä¹‹åï¼Œä¸­æ–­è¯»å–å¾ªç¯ï¼ŒæœåŠ¡ç«¯ä¹Ÿæ–­å¼€è¿æ¥ï¼Œå¹¶å†æ¬¡ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ã€‚\nå®¢æˆ·ç«¯ï¼ˆClientï¼‰ åˆ›å»ºå®¢æˆ·ç«¯\ncsharp \u0026#9660; 1 2 3 4 5 NamedPipeClientStream client = new NamedPipeClientStream( \u0026#34;.\u0026#34;, // The name of the remote computer, \u0026#34;.\u0026#34; æŒ‡æœ¬æœº \u0026#34;SimpleServer\u0026#34;, // pipe name PipeDirection.InOut, // æ•°æ®ä¼ è¾“æ–¹å‘ PipeOptions.Asynchronous | PipeOptions.WriteThrough); è¿æ¥åˆ°æœåŠ¡ç«¯\ncsharp \u0026#9660; 1 client.Connect(); // é˜»å¡æ–¹å¼ csharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 Task.Run(() =\u0026gt; { int bytesToRead; byte[] buffer; client.Connect(); // è¿æ¥ç®¡é“ while (true) { try { // è¯»å–æ¶ˆæ¯é•¿åº¦ bytesToRead = 256 * client.ReadByte(); bytesToRead += client.ReadByte(); buffer = new byte[bytesToRead]; client.Read(buffer, 0, bytesToRead); // è¯»å–æ¶ˆæ¯ } catch (System.IO.IOException) { break; } catch (Exception) { break; } // å¤„ç†æ¶ˆæ¯ string content = Encoding.UTF8.GetString(buffer); Console.WriteLine(content); } client.Close(); }); è¿™é‡Œä½¿ç”¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹å»è¿æ¥ç®¡é“æœåŠ¡ç«¯ï¼Œè¿æ¥æˆåŠŸåå¾ªç¯è¯»å–æ¥è‡ªæœåŠ¡ç«¯çš„æ¶ˆæ¯ã€‚\nå®¢æˆ·ç«¯å‘é€\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 string text = \u0026#34;Hello\u0026#34;; byte[] bytes = System.Text.Encoding.UTF8.GetBytes(text); client.WriteByte((byte)(bytes.Length / 256)); // å‘é€æ¶ˆæ¯å¤´ client.WriteByte((byte)(bytes.Length % 256)); client.Write(bytes, 0, bytes.Length); // å‘é€æ¶ˆæ¯ text = \u0026#34;World\u0026#34;; bytes = System.Text.Encoding.UTF8.GetBytes(text); client.WriteByte((byte)(bytes.Length / 256)); // å‘é€æ¶ˆæ¯å¤´ client.WriteByte((byte)(bytes.Length % 256)); client.Write(bytes, 0, bytes.Length); // å‘é€æ¶ˆæ¯ æ€»ç»“ æ€»çš„æ¥è¯´ï¼ŒNamed Pipeä½¿ç”¨è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œç»“åˆåºåˆ—åŒ–å°±å¯ä»¥ç›´æ¥åœ¨ä¸¤ä¸ªè¿›ç¨‹ä¸­ä¼ é€’æ¶ˆæ¯å¯¹è±¡äº†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ä¸€ä¸ªæœåŠ¡ç«¯åªèƒ½æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼Œè€Œä¸”åœ¨å®¢æˆ·ç«¯æ–­å¼€è¿æ¥ä¹‹åï¼ŒæœåŠ¡ç«¯ä¹Ÿéœ€è¦æ–­å¼€è¿æ¥ï¼Œå¹¶é‡æ–°ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼Œä¸ç„¶å†æœ‰å®¢æˆ·ç«¯å°è¯•è¿æ¥ç®¡é“ä¹Ÿæ— æ³•å»ºç«‹ã€‚\nå‚è€ƒ\nHow to: Use Named Pipes for Network Interprocess Communication\n","permalink":"https://kira-96.github.io/posts/%E4%BD%BF%E7%94%A8-named-pipe-%E8%BF%9B%E8%A1%8C%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E8%AE%AF/","summary":"\u003cp\u003eè¿™æ®µæ—¶é—´å…¬å¸çš„ä¸€ä¸ªé¡¹ç›®æ‰“ç®—ä½¿ç”¨\u003ccode\u003eNamed Pipe\u003c/code\u003eè¿›è¡Œè¿›ç¨‹é—´çš„é€šè®¯ï¼Œåˆšå¥½èŠ±äº†ç‚¹æ—¶é—´äº†è§£äº†ä¸€ä¸‹ï¼Œè¿™é‡Œåšä¸€ä¸‹ç¬”è®°ã€‚\u003c/p\u003e\n\u003cp\u003eNamed Pipeï¼ˆå‘½åç®¡é“ï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯é€šè¿‡åœ¨ä¸¤ä¸ªè¿›ç¨‹é—´æ­å»ºä¸€ä¸ªç®¡é“æ¥è¿›è¡Œé€šè®¯ï¼Œè¿™ç§æ–¹å¼çš„å¥½å¤„åœ¨äºä¸¤è€…å¯ä»¥è¿›è¡Œ\u003cstrong\u003eå…¨åŒå·¥\u003c/strong\u003eçš„é€šè®¯ï¼ŒæœåŠ¡ç«¯ä¹Ÿå¯ä»¥é€šè¿‡ç®¡é“å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯ï¼Œå¯¹äºä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´çš„é€šè®¯æ¥è¯´å†åˆé€‚ä¸è¿‡äº†ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿç›¸å¯¹æ¯”è¾ƒçµæ´»ã€‚\u003c/p\u003e","title":"ä½¿ç”¨ Named Pipe è¿›è¡Œè¿›ç¨‹é—´é€šè®¯"},{"content":"ç®€ä»‹ Hproseï¼ˆHigh Performance Remote Object Service Engineï¼‰æ˜¯ä¸€æ¬¾å…ˆè¿›çš„è½»é‡çº§ã€è·¨è¯­è¨€ã€è·¨å¹³å°ã€æ— ä¾µå…¥å¼ã€é«˜æ€§èƒ½åŠ¨æ€è¿œç¨‹å¯¹è±¡è°ƒç”¨å¼•æ“åº“ã€‚å®ƒä¸ä»…ç®€å•æ˜“ç”¨ï¼Œè€Œä¸”åŠŸèƒ½å¼ºå¤§ã€‚\nä¹Ÿæ˜¯ä¸€ä¸ªè·¨è¯­è¨€çš„RPCæ¡†æ¶ï¼Œä½†ç”±äºåº“çš„è´¨é‡å‚å·®ä¸é½ï¼Œä¸€äº›è¯­è¨€çš„åº“å¹¶ä¸å®Œå–„ã€‚è¿™é‡Œä»¥C#ä¸ºä¾‹æ¥å®ç°ä¸€ä¸ªç®€å•çš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ç¨‹åºã€‚\nåˆ›å»ºé¡¹ç›® æ–°å»ºè§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«ä¸¤ä¸ªé¡¹ç›®\nserver\næ§åˆ¶å°ç¨‹åºï¼ŒæœåŠ¡ç«¯\nclient\næ§åˆ¶å°ç¨‹åºï¼Œå®¢æˆ·ç«¯\nç„¶åï¼Œé€šè¿‡Nugetåˆ†åˆ«ä¸ºä¸¤ä¸ªé¡¹ç›®å®‰è£…Hprose.RPCåº“ã€‚\nè¿™é‡Œå¹¶ä¸éœ€è¦å†åˆ›å»ºé¢å¤–çš„æœåŠ¡æ¥å£é¡¹ç›®ï¼Œåªéœ€è¦æ‰‹åŠ¨å®šä¹‰ä¸€ä¸ªæ¥å£å³å¯ã€‚\nåˆ›å»ºæœåŠ¡æ¥å£ åœ¨serverå’Œclienté¡¹ç›®ä¸‹éƒ½æ–°å»ºä¸€ä¸ªæ¥å£ï¼Œä½œä¸ºæœåŠ¡æ¥å£\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 // IHello.cs public class ServiceVersion { public string Name { get; set; } public string Version { get; set; } public ServiceVersion() { } public ServiceVersion(string name, string ver) { Name = name; Version = ver; } } // æœåŠ¡æ¥å£ public interface IHello { ServiceVersion GetVersion(); List\u0026lt;string\u0026gt; SayHello(string name); } IHelloé‡Œé¢çš„ä¸¤ä¸ªæ¥å£å‡½æ•°å°±æ˜¯æœåŠ¡æ¥å£äº†ã€‚\næœåŠ¡ç«¯ç¨‹åº ä¾æ—§æ˜¯æœåŠ¡ç«¯å®ç°æ¥å£ï¼Œå®¢æˆ·ç«¯æ¥è°ƒç”¨ï¼Œåœ¨serveré¡¹ç›®ä¸‹æ–°å»ºç±»Hello.cs\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 // Hello.cs namespace server { using System.Collections.Generic; public class Hello : IHello { public ServiceVersion GetVersion() { return new ServiceVersion(\u0026#34;Hello Service\u0026#34;, \u0026#34;0.0.1.21\u0026#34;); } public List\u0026lt;string\u0026gt; SayHello(string name) { return new List\u0026lt;string\u0026gt;() { $\u0026#34;ä½ å¥½ {name}\u0026#34;, $\u0026#34;Hello {name}\u0026#34;, $\u0026#34;Hola {name}\u0026#34;, $\u0026#34;Bonjour {name}\u0026#34;, $\u0026#34;ã“ã‚“ã«ã¡ã¯ {name}\u0026#34;, $\u0026#34;hallo {name}\u0026#34; }; } } } ç¼–å†™æœåŠ¡å¯åŠ¨ç¨‹åº\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 namespace server { using Hprose.RPC; using System.Net; class Program { static void Main() { HttpListener server = new HttpListener(); server.Prefixes.Add(\u0026#34;http://localhost:10240/\u0026#34;); server.Start(); Service service = new Service().Bind(server).AddInstanceMethods(new Hello()); System.Console.WriteLine(\u0026#34;Server listening at http://localhost:10240/ \\n Press any key exit ...\u0026#34;); System.Console.ReadKey(); server.Stop(); } } } å®¢æˆ·ç«¯ç¨‹åº ç”±äºclienté¡¹ç›®åˆšåˆšä¹Ÿå®šä¹‰äº†IHelloæ¥å£ï¼Œè¿™é‡Œå°±å¯ä»¥ç›´æ¥è°ƒç”¨æ¥å£å‡½æ•°äº†ã€‚\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 namespace client { using Hprose.RPC; class Program { static void Main() { Client cli = new Client(\u0026#34;http://localhost:10240/\u0026#34;); IHello hello = cli.UseService\u0026lt;IHello\u0026gt;(); ServiceVersion ver = hello.GetVersion(); System.Console.WriteLine(\u0026#34;Remote Service Version: {0} - v{1}\u0026#34;, ver.Name, ver.Version); var hellos = hello.SayHello(\u0026#34;Hprose\u0026#34;); foreach (string item in hellos) { System.Console.WriteLine(item); } System.Console.ReadKey(); } } } è¿è¡Œæµ‹è¯• å…ˆå¯åŠ¨æœåŠ¡ç«¯ç¨‹åºï¼Œå†å¯åŠ¨å®¢æˆ·ç«¯ç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°å®¢æˆ·ç«¯è¾“å‡º\n\u0026#9660; Remote Service Version: Hello Service - v0.0.1.21 ä½ å¥½ Hprose Hello Hprose Hola Hprose Bonjour Hprose ã“ã‚“ã«ã¡ã¯ Hprose hallo Hprose ä¸Thriftå’ŒgRPCç›¸æ¯”ï¼ŒHproseå®ç°èµ·æ¥è¦ç®€å•å¾ˆå¤šï¼Œæš‚æ—¶è¿˜æ²¡æœ‰å°è¯•è·¨è¯­è¨€è°ƒç”¨ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯åŒæ ·ç®€å•ã€‚\n","permalink":"https://kira-96.github.io/posts/hprose-c_-%E5%88%9D%E6%8E%A2/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://hprose.com/\"\u003eHprose\u003c/a\u003eï¼ˆHigh Performance Remote Object Service Engineï¼‰æ˜¯ä¸€æ¬¾å…ˆè¿›çš„è½»é‡çº§ã€è·¨è¯­è¨€ã€è·¨å¹³å°ã€æ— ä¾µå…¥å¼ã€é«˜æ€§èƒ½åŠ¨æ€è¿œç¨‹å¯¹è±¡è°ƒç”¨å¼•æ“åº“ã€‚å®ƒä¸ä»…ç®€å•æ˜“ç”¨ï¼Œè€Œä¸”åŠŸèƒ½å¼ºå¤§ã€‚\u003c/p\u003e\n\u003cp\u003eä¹Ÿæ˜¯ä¸€ä¸ªè·¨è¯­è¨€çš„RPCæ¡†æ¶ï¼Œä½†ç”±äºåº“çš„è´¨é‡å‚å·®ä¸é½ï¼Œä¸€äº›è¯­è¨€çš„åº“å¹¶ä¸å®Œå–„ã€‚è¿™é‡Œä»¥C#ä¸ºä¾‹æ¥å®ç°ä¸€ä¸ªç®€å•çš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ç¨‹åºã€‚\u003c/p\u003e","title":"Hprose C# åˆæ¢"},{"content":"ç®€ä»‹ Thriftæ˜¯ç”±Facebookä¸ºâ€œå¤§è§„æ¨¡è·¨è¯­è¨€æœåŠ¡å¼€å‘â€è€Œå¼€å‘çš„ä¸€ç§æ¥å£æè¿°è¯­è¨€å’ŒäºŒè¿›åˆ¶é€šè®¯åè®®ï¼Œå®ƒè¢«ç”¨æ¥å®šä¹‰å’Œåˆ›å»ºè·¨è¯­è¨€çš„æœåŠ¡ã€‚ç›®å‰è¢«ä½œä¸ºä¸€ä¸ªRPCæ¡†æ¶ä½¿ç”¨ã€‚\nä¸‹è½½ ä½¿ç”¨ä¹‹å‰éœ€è¦å…ˆä¸‹è½½Thriftçš„æºä»£ç å’ŒThriftç¼–è¯‘å™¨ã€‚\nä¸‹è½½æºä»£ç åè§£å‹ï¼Œè¿›å…¥åˆ°thrift-0.12.0\\lib\\csharp\\srcç›®å½•ä¸‹ï¼Œæ‰“å¼€Thrift.slnï¼Œæ ¹æ®éœ€è¦ç¼–è¯‘ç›¸åº”çš„åº“ï¼Œè¿™é‡Œé€‰æ‹©Thrift.45ï¼Œå³.NET 4.5å¯ä»¥ä½¿ç”¨çš„åº“ï¼Œç¼–è¯‘ç”ŸæˆThrift45.dllã€‚\nåˆ›å»ºé¡¹ç›® æ–°å»ºè§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«3ä¸ªé¡¹ç›®\nThriftSample\nç±»åº“ï¼ŒThriftç”Ÿæˆçš„æœåŠ¡æ¥å£\nserver\næ§åˆ¶å°ç¨‹åºï¼ŒæœåŠ¡ç«¯\nclient\næ§åˆ¶å°ç¨‹åºï¼Œå®¢æˆ·ç«¯\nè¿™3ä¸ªé¡¹ç›®éƒ½éœ€è¦å¼•ç”¨åˆšåˆšç¼–è¯‘çš„Thrift45.dllï¼Œä¸ºä»€ä¹ˆä¸ç”¨Nugetæ¥å®‰è£…Thriftå‘¢ï¼Ÿå› ä¸ºæˆ‘æ³¨æ„åˆ°Nugetä¸Šçš„Thriftå·²ç»å¥½å‡ å¹´æ²¡æ›´æ–°äº†ï¼Œè¿˜æ˜¯æ‰‹åŠ¨ç¼–è¯‘æœ€æ–°çš„è¦å¥½ã€‚\nç„¶åï¼Œserverå’ŒclientåŒæ—¶å¼•ç”¨é¡¹ç›®ThriftSampleã€‚\nå®šä¹‰æœåŠ¡æ¥å£ åœ¨è§£å†³æ–¹æ¡ˆç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶Sample.thriftæ¥å®šä¹‰æœåŠ¡æ¥å£ï¼ŒThriftè¯­æ³•å¯ä»¥åœ¨ç½‘ä¸Šæ‰¾åˆ°\nprotobuf \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 namespace csharp kira.Interface service SampleService { ServiceVersion GetVersion() list\u0026lt;string\u0026gt; SayHello(1: string name) } struct ServiceVersion { 1: required string name; 2: required string version; } è¿™é‡ŒæŒ‡å®šäº†ç”Ÿæˆç±»çš„å‘½åç©ºé—´ï¼Œä»¥åŠå®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“ä½œä¸ºè¿”å›å€¼\nç”ŸæˆæœåŠ¡æ¥å£ è¿™é‡Œå°±éœ€è¦ç”¨åˆ°ä¹‹å‰ä¸‹è½½çš„Thriftç¼–è¯‘å™¨ï¼Œå¯ä»¥ç›´æ¥åœ¨Thriftå®˜ç½‘æ‰¾åˆ°ã€‚å°†ä¸‹è½½çš„thrift-0.12.0.exeä¹Ÿæ‹·è´åˆ°è§£å†³æ–¹æ¡ˆç›®å½•ä¸‹ï¼ˆå’ŒSample.thriftç›¸åŒç›®å½•ï¼‰ï¼Œæ‰“å¼€å‘½ä»¤çª—å£ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤\nbash \u0026#9660; 1 $ thrift-0.12.0.exe -gen csharp Sample.thrift ä¸å¾—ä¸è¯´ï¼ŒThriftçš„å‘½ä»¤è¡Œè¯­æ³•çœŸçš„æ¯”gRPCç®€æ´å¤šäº†ã€‚\næ‰§è¡Œå®Œæ²¡æœ‰é”™è¯¯çš„è¯ï¼Œå°±å¯ä»¥çœ‹åˆ°ç›®å½•ä¸‹åˆå¤šå‡ºäº†ä¸€ä¸ªgen-csharpçš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰å¯¹åº”å‘½åç©ºé—´çš„æ–‡ä»¶å¤¹ï¼Œæœ€åæ‰¾åˆ°ç”Ÿæˆçš„.csæ–‡ä»¶ã€‚å°†æ–‡ä»¶å…¨éƒ¨æ‹·è´åˆ°ThriftSampleé¡¹ç›®ç›®å½•ä¸‹ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°é¡¹ç›®ï¼Œç¼–è¯‘ç”Ÿæˆåº“ã€‚\næœåŠ¡ç«¯ç¨‹åº åœ¨serveré¡¹ç›®ä¸‹æ–°å»ºç±»MySampleServiceå¹¶å®ç°æ¥å£SampleService.Ifaceï¼Œé‡å†™å…¶ä¸­çš„ä¸¤ä¸ªæœåŠ¡æ¥å£å‡½æ•°\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 namespace server { using System.Collections.Generic; using kira.Interface; public class MySampleService : SampleService.Iface { public ServiceVersion GetVersion() { return new ServiceVersion() { Name = \u0026#34;My Sample Service\u0026#34;, Version = \u0026#34;0.0.1.20\u0026#34; }; } public List\u0026lt;string\u0026gt; SayHello(string name) { return new List\u0026lt;string\u0026gt;() { $\u0026#34;ä½ å¥½ {name}\u0026#34;, $\u0026#34;Hello {name}\u0026#34;, $\u0026#34;Hola {name}\u0026#34;, $\u0026#34;Bonjour {name}\u0026#34;, $\u0026#34;ã“ã‚“ã«ã¡ã¯ {name}\u0026#34;, $\u0026#34;hallo {name}\u0026#34; }; } } } ç¼–å†™æœåŠ¡å¯åŠ¨ç¨‹åº\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 namespace server { using Thrift.Server; using Thrift.Transport; using kira.Interface; class Program { static void Main(string[] args) { MySampleService service = new MySampleService(); SampleService.Processor processor = new SampleService.Processor(service); TServerTransport serverTransport = new TServerSocket(10240); TServer server = new TThreadPoolServer(processor, serverTransport); System.Console.WriteLine(\u0026#34;server listening at tcp://localhost:10240/\u0026#34;); server.Serve(); } } } å®¢æˆ·ç«¯ç¨‹åº csharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 namespace client { using Thrift.Protocol; using Thrift.Transport; using kira.Interface; class Program { static void Main(string[] args) { TTransport transport = new TSocket(\u0026#34;localhost\u0026#34;, 10240); transport.Open(); TProtocol protocol = new TBinaryProtocol(transport); SampleService.Client cli = new SampleService.Client(protocol); ServiceVersion ver = cli.GetVersion(); System.Console.WriteLine(\u0026#34;Remote Service Version: {0} - v{1}\u0026#34;, ver.Name, ver.Version); var hellos = cli.SayHello(\u0026#34;Thrift\u0026#34;); foreach (string item in hellos) { System.Console.WriteLine(item); } System.Console.ReadKey(); transport.Close(); } } } è¿è¡Œæµ‹è¯• è€æ ·å­ï¼Œå…ˆå¯åŠ¨æœåŠ¡ç«¯ç¨‹åºï¼Œç„¶åè¿è¡Œå®¢æˆ·ç«¯ç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°å®¢æˆ·ç«¯è¾“å‡º\n\u0026#9660; Remote Service Version: My Sample Service - v0.0.1.20 ä½ å¥½ Thrift Hello Thrift Hola Thrift Bonjour Thrift ã“ã‚“ã«ã¡ã¯ Thrift hallo Thrift æ€»ç»“ å¯¹æ¯”Thriftå’ŒgRPCä¸¤ä¸ªä¸»æµçš„RPCæ¡†æ¶ï¼Œä¸ªäººæ„Ÿè§‰Thriftä½¿ç”¨èµ·æ¥è¦æ›´åŠ çµæ´»ä¸€äº›ï¼Œå½“ç„¶è¿™åªæ˜¯åˆæ­¥æ¥è§¦ï¼Œè¾ƒæ·±å±‚æ¬¡çš„å†…å®¹è¿˜æ²¡æœ‰å»ç ”ç©¶ï¼Œå®é™…é¡¹ç›®çš„åº”ç”¨æ„Ÿè§‰ä¸¤ä¸ªéƒ½å¯ä»¥ï¼Œæœ‰å¯¹æ¯”è¯´Thriftæ¡†æ¶çš„æ€§èƒ½è¦ä¼˜äºgRPCï¼Œä½†å¯¹äºå°çš„é¡¹ç›®æ¥è¯´å·²ç»å®Œå…¨å¤Ÿç”¨äº†ã€‚\n","permalink":"https://kira-96.github.io/posts/thrift-c_-%E5%88%9D%E6%8E%A2/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"http://thrift.apache.org/\"\u003eThrift\u003c/a\u003eæ˜¯ç”±Facebookä¸ºâ€œå¤§è§„æ¨¡è·¨è¯­è¨€æœåŠ¡å¼€å‘â€è€Œå¼€å‘çš„ä¸€ç§æ¥å£æè¿°è¯­è¨€å’ŒäºŒè¿›åˆ¶é€šè®¯åè®®ï¼Œå®ƒè¢«ç”¨æ¥å®šä¹‰å’Œåˆ›å»ºè·¨è¯­è¨€çš„æœåŠ¡ã€‚ç›®å‰è¢«ä½œä¸ºä¸€ä¸ª\u003cstrong\u003eRPC\u003c/strong\u003eæ¡†æ¶ä½¿ç”¨ã€‚\u003c/p\u003e\n\u003ch2 id=\"ä¸‹è½½\"\u003eä¸‹è½½\u003c/h2\u003e\n\u003cp\u003eä½¿ç”¨ä¹‹å‰éœ€è¦å…ˆ\u003ca href=\"http://thrift.apache.org/download\"\u003eä¸‹è½½\u003c/a\u003eThriftçš„æºä»£ç å’ŒThriftç¼–è¯‘å™¨ã€‚\u003c/p\u003e\n\u003cp\u003eä¸‹è½½æºä»£ç åè§£å‹ï¼Œè¿›å…¥åˆ°\u003ccode\u003ethrift-0.12.0\\lib\\csharp\\src\u003c/code\u003eç›®å½•ä¸‹ï¼Œæ‰“å¼€\u003ccode\u003eThrift.sln\u003c/code\u003eï¼Œæ ¹æ®éœ€è¦ç¼–è¯‘ç›¸åº”çš„åº“ï¼Œè¿™é‡Œé€‰æ‹©\u003ccode\u003eThrift.45\u003c/code\u003eï¼Œå³.NET 4.5å¯ä»¥ä½¿ç”¨çš„åº“ï¼Œç¼–è¯‘ç”Ÿæˆ\u003ccode\u003eThrift45.dll\u003c/code\u003eã€‚\u003c/p\u003e","title":"Thrift C# åˆæ¢"},{"content":"ç®€ä»‹ gRPCæ˜¯Googleå¼€æºçš„ä¸€ä¸ªç°ä»£åŒ–ã€é«˜æ€§èƒ½çš„RPCæ¡†æ¶ï¼ŒåŸºäºHTTP/2æ ‡å‡†è®¾è®¡ï¼ŒåŒæ—¶æä¾›å¤šä¸ªè¯­è¨€ç‰ˆæœ¬ï¼Œå¹¶æ”¯æŒè·¨è¯­è¨€è°ƒç”¨ï¼Œå¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒä¸­è¿è¡Œã€‚\nåˆ›å»ºé¡¹ç›® æ–°å»ºè§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«3ä¸ªé¡¹ç›®\ngRpcSample\nç±»åº“ï¼ŒgRPCç”Ÿæˆçš„æ¥å£ï¼ŒServeræ¥å£ã€Clientæ¥å£ç­‰\nserver\næ§åˆ¶å°ç¨‹åºï¼ŒæœåŠ¡ç«¯\nclient\næ§åˆ¶å°ç¨‹åºï¼Œå®¢æˆ·ç«¯\nåˆ†åˆ«ç»™3ä¸ªé¡¹ç›®å®‰è£…Nugetç¨‹åºåŒ…Grpcå¹¶å®‰è£…æ‰€éœ€ä¾èµ–ï¼Œç„¶åä¸ºgRpcSampleé¡¹ç›®å®‰è£…Grpc.Toolså’ŒGoogle.ProtoBufç¨‹åºåŒ…ã€‚\nåŒæ—¶ï¼Œä½¿é¡¹ç›®serverå’Œclientå¼•ç”¨é¡¹ç›®gRpcSampleã€‚\nå®šä¹‰æœåŠ¡æ¥å£ åœ¨gRpcSampleé¡¹ç›®çš„æ–‡ä»¶å¤¹ä¸‹æ–°å»ºSample.protoæ–‡ä»¶ï¼Œä»¥æ–‡æœ¬æ–¹å¼æ‰“å¼€ï¼Œä¿®æ”¹å…¶ä¸­æ¥å£å®šä¹‰\nprotobuf \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 syntax = \u0026#34;proto3\u0026#34;; option csharp_namespace = \u0026#34;kira.Interface\u0026#34;; package sampleservice; service SampleService { rpc ServerVersion(VersionRequest) returns (VersionResponse) {} rpc SayHello(HelloRequest) returns (stream HelloResponse) {} } message VersionRequest {} message VersionResponse { string name = 1; string version = 2; } message HelloRequest { string name = 1; } message HelloResponse { string message = 1; } è¿™é‡ŒæŒ‡å®šäº†ç”Ÿæˆçš„ç±»çš„å‘½åç©ºé—´ï¼ŒåŒæ—¶å®šä¹‰äº†ä¸¤ä¸ªæœåŠ¡å‡½æ•°ï¼Œä¼¼ä¹æ¯ä¸ªå‡½æ•°éƒ½å¿…é¡»æœ‰å‚æ•°ï¼ˆè¯·æ±‚ï¼‰å’Œè¿”å›ï¼ˆå“åº”ï¼‰ï¼Œè¿™ä¸€ç‚¹ä¸å¤ªæ¸…æ¥šã€‚å…·ä½“çš„è¯­æ³•æœ‰æ¡ä»¶çš„å¯ä»¥å‚è€ƒproto3 language guideã€‚\nç”ŸæˆæœåŠ¡æ¥å£ åœ¨è¿›è¡Œä¸‹é¢æ“ä½œå‰ï¼Œå»ºè®®å…ˆå°†Grpc.Toolsæ‹·è´åˆ°è§£å†³æ–¹æ¡ˆç›®å½•ä¸‹ï¼Œä¸ç„¶çš„è¯ä¸‹é¢çš„å‘½ä»¤ä¼šå¾ˆé•¿å¾ˆé•¿\u0026hellip;\nå…·ä½“æ“ä½œæ˜¯å°†è§£å†³æ–¹æ¡ˆä¸‹packages\\Grpc.Tools.2.23.0-pre1\\tools\\windows_x64\\é‡Œé¢çš„protoc.exeå’Œgrpc_csharp_plugin.exeæ‹·è´åˆ°è§£å†³æ–¹æ¡ˆç›®å½•ä¸‹ï¼Œå®Œæˆåå°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥ã€‚\nåœ¨è§£å†³æ–¹æ¡ˆç›®å½•ä¸‹æ‰“å¼€å‘½ä»¤çª—å£ï¼Œå¹¶æ‰§è¡Œä¸‹é¢å‘½ä»¤\nTip: ç›´æ¥è¿›å…¥åˆ°ç›¸åº”æ–‡ä»¶å¤¹ä¸‹ï¼ŒæŒ‰ä½Shifté”®ï¼Œåœ¨ç©ºç™½å‡ºå•å‡»é¼ æ ‡å³é”®ï¼Œå°±å¯ä»¥çœ‹åˆ°èœå•ä¸­å¤šå‡ºäº†ä¸€é¡¹åœ¨æ­¤å¤„æ‰“å¼€å‘½ä»¤çª—å£(W)\nbash \u0026#9660; 1 $ protoc -IgRpcSample --csharp_out gRpcSample gRpcSample\\Sample.proto --grpc_out gRpcSample --plugin=protoc-gen-grpc=grpc_csharp_plugin.exe æ‰§è¡Œå®Œæ²¡æœ‰é”™è¯¯çš„è¯ï¼Œå°±å¯ä»¥çœ‹åˆ°gRpcSampleé¡¹ç›®ä¸‹å¤šå‡ºäº†ä¸¤ä¸ªæ–‡ä»¶Sample.cså’ŒSampleGrpc.csï¼Œå°†è¿™ä¸¤ä¸ªæ–‡ä»¶æ·»åŠ åˆ°é¡¹ç›®gRpcSampleã€‚\nç¼–è¯‘gRpcSampleé€šè¿‡ã€‚\nè¿›è¡Œåˆ°è¿™é‡Œï¼ŒåŸºæœ¬çš„å·¥ä½œå°±éƒ½å®Œæˆäº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯ç¼–å†™æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ç¨‹åºäº†ã€‚\næœåŠ¡ç«¯ç¨‹åº serviceé¡¹ç›®æ–°å»ºç±»MySampleServiceï¼Œå¹¶ç»§æ‰¿SampleService.SampleServiceBaseï¼Œé‡å†™åˆšåˆšå®šä¹‰çš„ä¸¤ä¸ªæœåŠ¡æ¥å£å‡½æ•°\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 namespace server { using System.Threading.Tasks; using Grpc.Core; using kira.Interface; public class MySampleService : SampleService.SampleServiceBase { public override Task\u0026lt;VersionResponse\u0026gt; ServerVersion(VersionRequest request, ServerCallContext context) { return Task.FromResult\u0026lt;VersionResponse\u0026gt;( new VersionResponse() { Name = \u0026#34;My Sample Service\u0026#34;, Version = \u0026#34;0.0.1.19\u0026#34; }); } public override async Task SayHello(HelloRequest request, IServerStreamWriter\u0026lt;HelloResponse\u0026gt; responseStream, ServerCallContext context) { string[] hellos = { \u0026#34;ä½ å¥½\u0026#34;, \u0026#34;Hello\u0026#34;, \u0026#34;Hola\u0026#34;, \u0026#34;Bonjour\u0026#34;, \u0026#34;ã“ã‚“ã«ã¡ã¯\u0026#34;, \u0026#34;hallo\u0026#34; }; foreach (string item in hellos) { await responseStream.WriteAsync(new HelloResponse() { Message = $\u0026#34;{item} {request.Name}\u0026#34; }); } } } } ç¼–å†™æœåŠ¡å¯åŠ¨ç¨‹åº\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 namespace server { using Grpc.Core; using kira.Interface; class Program { static void Main(string[] args) { Server myServer = new Server() { Services = { SampleService.BindService(new MySampleService()) }, Ports = { new ServerPort(\u0026#34;localhost\u0026#34;, 10240, ServerCredentials.Insecure) } }; myServer.Start(); System.Console.WriteLine(\u0026#34;Sample Server listening on localhost:10240 \\nPress any key exit...\u0026#34;); System.Console.ReadKey(); myServer.ShutdownAsync().Wait(); } } } å®¢æˆ·ç«¯ç¨‹åº csharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 namespace client { using System.Threading.Tasks; using Grpc.Core; using kira.Interface; class Program { static void Main(string[] args) { Program program = new Program(); program.TestService(); System.Console.ReadKey(); } async void TestService() { Channel channel = new Channel(\u0026#34;localhost:10240\u0026#34;, ChannelCredentials.Insecure); SampleService.SampleServiceClient cli = new SampleService.SampleServiceClient(channel); VersionResponse ver = cli.ServerVersion(new VersionRequest()); System.Console.WriteLine(\u0026#34;Remote Service Version: {0} - v{1}\u0026#34;, ver.Name, ver.Version); AsyncServerStreamingCall\u0026lt;HelloResponse\u0026gt; greetings = cli.SayHello(new HelloRequest() { Name = \u0026#34;gRPC\u0026#34; }); IAsyncStreamReader\u0026lt;HelloResponse\u0026gt; stream = greetings.ResponseStream; while (await stream.MoveNext()) { System.Console.WriteLine(stream.Current.Message); } } } } è¿è¡Œæµ‹è¯• é¦–å…ˆå¯åŠ¨æœåŠ¡ç«¯ç¨‹åºï¼Œç„¶åè¿è¡Œå®¢æˆ·ç«¯ç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°å®¢æˆ·ç«¯è¾“å‡º\n\u0026#9660; Remote Service Version: My Sample Service - v0.0.1.19 ä½ å¥½ gRPC Hello gRPC Hola gRPC Bonjour gRPC ã“ã‚“ã«ã¡ã¯ gRPC hallo gRPC OKï¼Œå¤§åŠŸå‘Šæˆï¼\n","permalink":"https://kira-96.github.io/posts/grpc-c_-%E5%88%9D%E6%8E%A2/","summary":"\u003ch2 id=\"ç®€ä»‹\"\u003eç®€ä»‹\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.grpc.io/\"\u003egRPC\u003c/a\u003eæ˜¯Googleå¼€æºçš„ä¸€ä¸ªç°ä»£åŒ–ã€é«˜æ€§èƒ½çš„\u003ca href=\"https://baike.baidu.com/item/%E8%BF%9C%E7%A8%8B%E8%BF%87%E7%A8%8B%E8%B0%83%E7%94%A8%E5%8D%8F%E8%AE%AE\"\u003eRPC\u003c/a\u003eæ¡†æ¶ï¼ŒåŸºäº\u003ccode\u003eHTTP/2\u003c/code\u003eæ ‡å‡†è®¾è®¡ï¼ŒåŒæ—¶æä¾›å¤šä¸ªè¯­è¨€ç‰ˆæœ¬ï¼Œå¹¶æ”¯æŒè·¨è¯­è¨€è°ƒç”¨ï¼Œå¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒä¸­è¿è¡Œã€‚\u003c/p\u003e\n\u003ch2 id=\"åˆ›å»ºé¡¹ç›®\"\u003eåˆ›å»ºé¡¹ç›®\u003c/h2\u003e\n\u003cp\u003eæ–°å»ºè§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«3ä¸ªé¡¹ç›®\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003egRpcSample\u003c/p\u003e\n\u003cp\u003eç±»åº“ï¼ŒgRPCç”Ÿæˆçš„æ¥å£ï¼ŒServeræ¥å£ã€Clientæ¥å£ç­‰\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eserver\u003c/p\u003e\n\u003cp\u003eæ§åˆ¶å°ç¨‹åºï¼ŒæœåŠ¡ç«¯\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eclient\u003c/p\u003e\n\u003cp\u003eæ§åˆ¶å°ç¨‹åºï¼Œå®¢æˆ·ç«¯\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eåˆ†åˆ«ç»™3ä¸ªé¡¹ç›®å®‰è£…Nugetç¨‹åºåŒ…\u003ccode\u003eGrpc\u003c/code\u003eå¹¶å®‰è£…æ‰€éœ€ä¾èµ–ï¼Œç„¶åä¸º\u003ccode\u003egRpcSample\u003c/code\u003eé¡¹ç›®å®‰è£…\u003ccode\u003eGrpc.Tools\u003c/code\u003eå’Œ\u003ccode\u003eGoogle.ProtoBuf\u003c/code\u003eç¨‹åºåŒ…ã€‚\u003c/p\u003e","title":"gRPC C# åˆæ¢"},{"content":"è¿›ç¨‹é—´ä¼ é€’æ•°æ®çš„æ–¹æ³• åœ¨è¿›ç¨‹é—´ä¼ é€’æ•°æ®ä¹Ÿå°±æ„å‘³ç€ä¸¤ä¸ªä¸åŒçš„åº”ç”¨ç¨‹åºä¹‹é—´çš„é€šè®¯ï¼Œå¤§å®¶å¯èƒ½ä¼šæƒ³åˆ°ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—(Message Queue)æ¥ä½œä¸ºè§£å†³æ–¹æ¡ˆï¼Œå½“ç„¶è¿™å¯èƒ½æ˜¯æœ€ä¼˜è§£ï¼Œç„¶è€Œè¿™é‡Œæˆ‘è¦è®²çš„æ˜¯å¦å¤–ä¸€ç§æ–¹æ³•ï¼Œé€šè¿‡Windowsçš„æ¶ˆæ¯æœºåˆ¶æ¥ä¼ é€’æ•°æ®ï¼Œå†…å®¹æ¯”è¾ƒç¡¬æ ¸ã€‚\nä¾æ—§ç”¨åˆ°äº†ä¸¤ä¸ªWindowsçš„APIï¼ŒFindWindowå’ŒSendMessageï¼Œä»¥åŠWPFå¦‚ä½•å’ŒMFCçª—å£é€šè®¯ï¼Œå¯ä»¥å‚è€ƒä¸Šä¸€ç¯‡æ–‡ç« ã€‚\nä¼ é€’æ•°æ®çš„æ–¹å¼ è¿™é‡Œéœ€è¦å…ˆçŸ¥é“ä¸€ä¸ªWindowæ¶ˆæ¯WM_COPYDATA å®ƒåœ¨WinUser.hä¸­çš„å®šä¹‰å¦‚ä¸‹\ncpp \u0026#9660; 1 #define WM_COPYDATA 0x004A è¿™ä¸ªæ¶ˆæ¯å°±æ˜¯è¿™æ¬¡è¦è®²çš„å†…å®¹ï¼Œé€šè¿‡è¿™ä¸ªæ¶ˆæ¯å°±å¯ä»¥åœ¨ä¸åŒçš„çª—å£é—´ä¼ é€’æ•°æ®äº†ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼ŒWPARAMæ˜¯å‘é€æ¶ˆæ¯çª—å£çš„å¥æŸ„ï¼ŒLPARAMæ˜¯ä¸€ä¸ªç»“æ„ä½“çš„æŒ‡é’ˆï¼Œè¿™ä¸ªç»“æ„ä½“åœ¨WinUser.hé‡Œå®šä¹‰å¦‚ä¸‹ï¼š\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 /* * lParam of WM_COPYDATA message points to... */ typedef struct tagCOPYDATASTRUCT { ULONG_PTR dwData; DWORD cbData; _Field_size_bytes_(cbData) PVOID lpData; } COPYDATASTRUCT, *PCOPYDATASTRUCT; å—¯\u0026hellip;çœ‹èµ·æ¥ä¹Ÿä¸æ˜¯å¾ˆå¤æ‚ï¼Œä¸ºäº†èƒ½å¤Ÿæ­£ç¡®å¤„ç†è¿™ä¸ªæŒ‡é’ˆï¼Œéœ€è¦åœ¨C#ä¸­ä¹Ÿå®šä¹‰ä¸€ä¸ªç›¸åŒçš„ç»“æ„ä½“\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 /// \u0026lt;summary\u0026gt; /// COPYDATASTRUCT /// å¯¹åº” C++ é‡Œçš„ COPYDATASTRUCT /// ä¸èƒ½æ›´æ”¹ /// \u0026lt;/summary\u0026gt; [StructLayout(LayoutKind.Sequential)] public struct COPYDATASTRUCT { public IntPtr dwData; //å¯ä»¥æ˜¯ä»»æ„å€¼ public int cbData; //æŒ‡å®šlpDataå†…å­˜åŒºåŸŸçš„å­—èŠ‚æ•° public IntPtr lpData; //å‘é€ç»™ç›®å½•çª—å£æ‰€åœ¨è¿›ç¨‹çš„æ•°æ® } è¿™æ ·å°±å¯ä»¥äº†ï¼Œå…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯lpDataï¼Œå®ƒå¯ä»¥æ˜¯ä»»æ„å¯¹è±¡çš„æŒ‡é’ˆï¼Œåªè¦C++å’ŒC#ä¸¤è¾¹å®šä¹‰äº†ä¸€ä¸ªç›¸åŒçš„ç»“æ„ä½“ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨å®ƒæ¥ç›´æ¥ä¼ é€’ç»“æ„ä½“å¯¹è±¡\u0026#x1f62e;ï¼Œè¿™ç§æ–¹å¼æ¯”é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ä¼ é€’æ•°æ®è¦å¿«å¾—å¤šã€‚\né‚£ä¹ˆå…ˆæ¥å®šä¹‰ä¸€ä¸ªç®€å•çš„ç»“æ„ä½“å§ï¼š\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 // C++ struct StructUser { char UserName[32]; char Password[32]; StructUser() { ZeroMemory(UserName, 32); ZeroMemory(Password, 32); } }; csharp \u0026#9660; 1 2 3 4 5 6 7 8 9 // C# [StructLayout(LayoutKind.Sequential)] public struct StructUser { [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)] public string UserName; [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 32)] public string Password; } è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªUserçš„ç»“æ„ä½“ï¼ŒUserNameå’ŒPasswordéƒ½æ˜¯é•¿åº¦ä¸º32çš„å­—ç¬¦ä¸²ï¼Œæ³¨æ„C#ä¸­ç»“æ„ä½“çš„å®šä¹‰æ–¹å¼ï¼Œè¿™é‡ŒæŒ‡å®šäº†å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå°±æ˜¯ä¸ºäº†å’ŒC++çš„ç»“æ„ä½“ä¿æŒä¸€è‡´ã€‚\nå…ˆæ¥çœ‹çœ‹C++ä¸­å¦‚ä½•å‘é€å’Œå¤„ç†WM_COPYDATAæ¶ˆæ¯çš„ï¼š\ncpp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 // å‘é€ StructUser user; char userName[32]; char password[32]; // GetDlgItem(IDC_EDIT_USERNAME)-\u0026gt;GetWindowTextA(userName, 32); // GetDlgItem(IDC_EDIT_PASSWORD)-\u0026gt;GetWindowTextA(password, 32); memcpy(user.UserName, userName, 32); memcpy(user.Password, password, 32); COPYDATASTRUCT copyData; copyData.dwData = 0; copyData.lpData = \u0026amp;user; copyData.cbData = sizeof(StructUser); HWND hWnd = nullptr; if (m_pTargerWnd == nullptr) { hWnd = ::FindWindow(nullptr, \u0026#34;WpfWindow\u0026#34;); } else { hWnd = m_pTargerWnd-\u0026gt;GetSafeHwnd(); } ::SendMessage(hWnd, WM_COPYDATA, (WPARAM)GetSafeHwnd(), (LPARAM)\u0026amp; copyData); // æ¥æ”¶ /* C++ ä¸­ç›¸å…³ä»£ç  * å¤„ç† WM_COPYDATA æ¶ˆæ¯ * Header File(.h) --------------------------------------------------------------------- ... afx_msg BOOL OnCopyData(CWnd *pWnd, COPYDATASTRUCT *pCopyDataStruct); ... DECLARE_MESSAGE_MAP() --------------------------------------------------------------------- * Source File(.cpp) BEGIN_MESSAGE_MAP(CxxxDlg, CDialogEx) ... ON_WM_COPYDATA() ... END_MESSAGE_MAP() ... */ BOOL CxxDlg::OnCopyData(CWnd* pWnd, COPYDATASTRUCT* pCopyDataStruct) { if (pWnd != nullptr) { m_pTargerWnd = pWnd; } if (pCopyDataStruct != nullptr) { StructUser* pUser = (StructUser*)(pCopyDataStruct-\u0026gt;lpData); // DWORD dwLen = pCopyDataStruct-\u0026gt;cbData; // GetDlgItem(IDC_EDIT_USERNAME)-\u0026gt;SetWindowTextA(pUser-\u0026gt;UserName); // GetDlgItem(IDC_EDIT_PASSWORD)-\u0026gt;SetWindowTextA(pUser-\u0026gt;Password); } return CDialogEx::OnCopyData(pWnd, pCopyDataStruct); } C#ä¼šæ¯”è¾ƒå¤æ‚ä¸€äº›\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 // æ¶ˆæ¯å¤„ç†å‡½æ•° private IntPtr WndProcFunc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled) { switch (msg) { case WM_COPYDATA: // public const int WM_COPYDATA = 0x004A; IntPrt hWnd_Target = wParam; COPYDATASTRUCT param = Marshal.PtrToStructure\u0026lt;COPYDATASTRUCT\u0026gt;(lParam); StructUser user = Marshal.PtrToStructure\u0026lt;StructUser\u0026gt;(param.lpData); // UserName.Text = user.UserName; // Password.Text = user.Password; break; default: break; } return IntPtr.Zero; } // å‘é€æ¶ˆæ¯ StructUser sctUser = new StructUser() { UserName = UserName.Text, Password = Password.Text }; IntPtr userPtr = Marshal.AllocHGlobal(Marshal.SizeOf\u0026lt;StructUser\u0026gt;()); Marshal.StructureToPtr\u0026lt;StructUser\u0026gt;(sctUser, userPtr, true); COPYDATASTRUCT copyData = new COPYDATASTRUCT() { dwData = IntPtr.Zero, cbData = Marshal.SizeOf\u0026lt;StructUser\u0026gt;(), lpData = userPtr, }; IntPtr copyDataPtr = Marshal.AllocHGlobal(Marshal.SizeOf\u0026lt;COPYDATASTRUCT\u0026gt;()); Marshal.StructureToPtr\u0026lt;COPYDATASTRUCT\u0026gt;(copyData, copyDataPtr, true); if (hWnd_Target == IntPtr.Zero) hWnd_Target = Win32Api.FindWindow(null, \u0026#34;MfcWindow\u0026#34;); hWnd_MainWnd = new WindowInteropHelper(this).Handle; if (hWnd_Target != IntPtr.Zero) Win32Api.SendMessage(hWnd_Target, WM_COPYDATA, hWnd_MainWnd, copyDataPtr); Marshal.FreeHGlobal(userPtr); // Marshal.FreeHGlobal(copyDataPtr); // æœ€åä¸€å®šè¦é‡Šæ”¾æ‰éæ‰˜ç®¡å†…å­˜ å¤„ç†æ¶ˆæ¯çš„åœ°æ–¹å’Œä¸Šä¸€ç¯‡ä¸€æ ·ï¼Œå‘é€çš„åœ°æ–¹æ¯”è¾ƒå¤æ‚ï¼Œæ€»ä½“æ¥è®²å°±æ˜¯ç”¨Marshalå¼€è¾Ÿäº†ä¸¤å—éæ‰˜ç®¡çš„å†…å­˜æ¥å­˜æ”¾ä¸¤ä¸ªç»“æ„ä½“çš„æ•°æ®ï¼Œç­‰åˆ°æ¶ˆæ¯è¢«å¤„ç†ä¹‹åå†å°†éæ‰˜ç®¡å†…å­˜é‡Šæ”¾æ‰ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚\né‚£ä¹ˆï¼Œè¿™æ¬¡çš„å†…å®¹å°±åˆ°è¿™é‡Œäº†ï¼Œä¸»è¦å†…å®¹éƒ½æ˜¯ä»£ç ï¼Œä½†å…¶å®ä¹Ÿä¸å¤æ‚ï¼Œåªæ˜¯éœ€è¦æ…¢æ…¢æ¶ˆåŒ–ã€‚\n","permalink":"https://kira-96.github.io/posts/wpf%E5%92%8Cmfc%E8%BF%9B%E7%A8%8B%E9%97%B4%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE/","summary":"\u003ch2 id=\"è¿›ç¨‹é—´ä¼ é€’æ•°æ®çš„æ–¹æ³•\"\u003eè¿›ç¨‹é—´ä¼ é€’æ•°æ®çš„æ–¹æ³•\u003c/h2\u003e\n\u003cp\u003eåœ¨è¿›ç¨‹é—´ä¼ é€’æ•°æ®ä¹Ÿå°±æ„å‘³ç€ä¸¤ä¸ªä¸åŒçš„åº”ç”¨ç¨‹åºä¹‹é—´çš„é€šè®¯ï¼Œå¤§å®¶å¯èƒ½ä¼šæƒ³åˆ°ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—(Message Queue)æ¥ä½œä¸ºè§£å†³æ–¹æ¡ˆï¼Œå½“ç„¶è¿™å¯èƒ½æ˜¯æœ€ä¼˜è§£ï¼Œç„¶è€Œè¿™é‡Œæˆ‘è¦è®²çš„æ˜¯å¦å¤–ä¸€ç§æ–¹æ³•ï¼Œé€šè¿‡Windowsçš„æ¶ˆæ¯æœºåˆ¶æ¥ä¼ é€’æ•°æ®ï¼Œå†…å®¹æ¯”è¾ƒç¡¬æ ¸ã€‚\u003c/p\u003e","title":"WPFå’ŒMFCè¿›ç¨‹é—´ä¼ é€’æ•°æ®"},{"content":"å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šçª—å£ å‘é€æ¶ˆæ¯ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå…ˆè®²ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°ä¸¤ä¸ªWindowsçš„API\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 // æŸ¥æ‰¾æŒ‡å®šçª—å£ [DllImport(\u0026#34;User32.dll\u0026#34;, EntryPoint = \u0026#34;FindWindow\u0026#34;, CharSet = CharSet.Auto)] public static extern IntPtr FindWindow(string lpClassName, string lpWindowName); //æ¶ˆæ¯å‘é€API [DllImport(\u0026#34;User32.dll\u0026#34;, EntryPoint = \u0026#34;SendMessage\u0026#34;, CharSet = CharSet.Auto)] public static extern int SendMessage( IntPtr hWnd, // ä¿¡æ¯å‘å¾€çš„çª—å£çš„å¥æŸ„ int Msg, // æ¶ˆæ¯ID IntPtr wParam, // å‚æ•°1 IntPtr lParam // å‚æ•°2 ); FindWindowå°±æ˜¯æ ¹æ®çª—å£çš„åå­—å»æ‰¾åˆ°ç›¸åº”çš„çª—å£å¥æŸ„ï¼ŒSendMessageå°±æ˜¯å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šçª—å£äº†ï¼Œå†™è¿‡MFCçš„åº”è¯¥ä¸é™Œç”Ÿ\ncsharp \u0026#9660; 1 2 3 4 IntPtr hWnd = FindWindow(null, windowName); if (hWnd == IntPtr.Zero) return; SendMessage(hWnd, WM_USER + 2, IntPtr.Zero, \u0026#34;msg\u0026#34;); å‘é€æ¶ˆæ¯å°±è®²è¿™ä¹ˆå¤šï¼Œå‰©ä¸‹çš„éœ€è¦è‡ªè¡Œæ‘¸ç´¢ï¼Œä¸‹é¢æ˜¯ç”¨WPFçª—å£æ¥æ”¶æ¶ˆæ¯\nè·å–WPFçª—å£å¥æŸ„ Windowsæ¶ˆæ¯æ˜¯é€šè¿‡çª—å£å¥æŸ„æ¥ä¼ é€’ç»™æŒ‡å®šçª—å£çš„ï¼Œæ‰€ä»¥æƒ³è¦å¤„ç†WPFçª—å£çš„æ”¶åˆ°æ¶ˆæ¯ï¼Œé¦–å…ˆå°±éœ€è¦è·å–è‡ªèº«çš„çª—å£å¥æŸ„ã€‚\ncsharp \u0026#9660; 1 HwndSource hWnd = PresentationSource.FromVisual(this) as HwndSource; æˆ–è€…\ncsharp \u0026#9660; 1 2 IntPtr hwnd = new WindowInteropHelper(this).Handle; HwndSource source = HwndSource.FromHwnd(hwnd); è¿™é‡Œçš„thiså°±æ˜¯WPFçš„çª—å£ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è·å–çª—å£ä»»æ„æ§ä»¶çš„å¥æŸ„\næ·»åŠ é’©å­(AddHook) å¾—åˆ°çª—å£çš„å¥æŸ„ä¹‹åå°±å¯ä»¥ä¸ºè¯¥çª—å£æ·»åŠ é’©å­æ¥å¤„ç†çª—å£æ”¶åˆ°çš„æ¶ˆæ¯äº†\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 protected override void OnSourceInitialized(EventArgs e) { base.OnSourceInitialized(e); // Add Hook // HwndSource source = PresentationSource.FromVisual(this) as HwndSource; // source.AddHook(WndProcFunc); // æˆ–è€… HwndSource.FromHwnd(new WindowInteropHelper(this).Handle).AddHook(new HwndSourceHook(WndProcFunc)); } æˆ–è€…\ncsharp \u0026#9660; 1 2 3 4 5 6 7 public MainWindow() { InitializeComponent(); this.SourceInitialized += (s, e) =\u0026gt; { HwndSource.FromHwnd(new WindowInteropHelper(this).Handle).AddHook(new HwndSourceHook(WndProcFunc)); }; } è¿™ä¸ªWndProcFuncå°±æ˜¯æˆ‘ä»¬çš„æ¶ˆæ¯å¤„ç†å‡½æ•°äº†ï¼Œçª—å£åœ¨æ”¶åˆ°æ¶ˆæ¯ä¹‹åå°±ä¼šèµ°åˆ°è¿™ä¸ªå‡½æ•°é‡Œé¢ï¼Œå®ƒçœ‹èµ·æ¥åƒæ˜¯è¿™æ ·\ncsharp \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 public IntPtr WndProc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled) { // Handle Msg Here switch (msg) { case WM_USER + 1: // ä½ çš„æ¶ˆæ¯å€¼ { // å¤„ç† wParam, lParam break; } // ... å…¶å®ƒæ¶ˆæ¯ default: break; } return IntPtr.Zero; } è¿™æ ·å°±å®Œäº†å—ï¼Ÿæ˜¯çš„ï¼Œä½†æ˜¯ï¼ç›®å‰è¿˜ä¸èƒ½å¤„ç†ä¼ é€’çš„å‚æ•°ï¼Œå¦‚æœWPFç¨‹åºå’ŒC++ç¨‹åºå¤„äºä¸€ä¸ªè¿›ç¨‹è¿˜å¥½è¯´ï¼Œå¦‚æœæ˜¯ä¸¤ä¸ªè¿›ç¨‹ï¼Œé‚£ä¹ˆä»–ä»¬ä¹‹é—´çš„å†…å­˜æ˜¯ä¸å…±ç”¨çš„ï¼Œæ‰€ä»¥å³ä½¿WPFçª—å£æ‹¿åˆ°äº†æŒ‡é’ˆä¹Ÿè¯»ä¸å‡ºæŒ‡é’ˆé‡Œçš„å†…å®¹ã€‚\né‚£ä¹ˆè¦æ€æ ·æ‰èƒ½åœ¨WPFç¨‹åºå’ŒC++ç¨‹åºä¹‹é—´ä¼ é€’å€¼å‘¢ï¼Œæœ‰ç©ºåœ¨è®²\u0026hellip;\n","permalink":"https://kira-96.github.io/posts/wpf%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86windows%E6%B6%88%E6%81%AF/","summary":"\u003ch2 id=\"å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šçª—å£\"\u003eå‘é€æ¶ˆæ¯åˆ°æŒ‡å®šçª—å£\u003c/h2\u003e\n\u003cp\u003eå‘é€æ¶ˆæ¯ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå…ˆè®²ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°ä¸¤ä¸ªWindowsçš„API\u003c/p\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"csharp\"\u003ecsharp\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e 1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 6\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 7\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 8\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e 9\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e10\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e11\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e12\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-csharp\" data-lang=\"csharp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// æŸ¥æ‰¾æŒ‡å®šçª—å£\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"na\"\u003e[DllImport(\u0026#34;User32.dll\u0026#34;, EntryPoint = \u0026#34;FindWindow\u0026#34;, CharSet = CharSet.Auto)]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"kd\"\u003eextern\u003c/span\u003e \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003eFindWindow\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003elpClassName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003elpWindowName\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//æ¶ˆæ¯å‘é€API\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"na\"\u003e[DllImport(\u0026#34;User32.dll\u0026#34;, EntryPoint = \u0026#34;SendMessage\u0026#34;, CharSet = CharSet.Auto)]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003epublic\u003c/span\u003e \u003cspan class=\"kd\"\u003estatic\u003c/span\u003e \u003cspan class=\"kd\"\u003eextern\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eSendMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003ehWnd\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e        \u003cspan class=\"c1\"\u003e// ä¿¡æ¯å‘å¾€çš„çª—å£çš„å¥æŸ„\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003eMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e            \u003cspan class=\"c1\"\u003e// æ¶ˆæ¯ID\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003ewParam\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e      \u003cspan class=\"c1\"\u003e// å‚æ•°1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eIntPtr\u003c/span\u003e \u003cspan class=\"n\"\u003elParam\u003c/span\u003e       \u003cspan class=\"c1\"\u003e// å‚æ•°2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003e\u003ccode\u003eFindWindow\u003c/code\u003eå°±æ˜¯æ ¹æ®çª—å£çš„åå­—å»æ‰¾åˆ°ç›¸åº”çš„çª—å£å¥æŸ„ï¼Œ\u003ccode\u003eSendMessage\u003c/code\u003eå°±æ˜¯å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šçª—å£äº†ï¼Œå†™è¿‡MFCçš„åº”è¯¥ä¸é™Œç”Ÿ\u003c/p\u003e","title":"WPFå¦‚ä½•å¤„ç†Windowsæ¶ˆæ¯"},{"content":"æ ‡é¢˜ markdown \u0026#9660; 1 2 3 4 5 6 # ä¸€çº§æ ‡é¢˜ ## äºŒçº§æ ‡é¢˜ ### ä¸‰çº§æ ‡é¢˜ #### å››çº§æ ‡é¢˜ ##### äº”çº§æ ‡é¢˜ ###### å…­çº§æ ‡é¢˜ ä¹Ÿå¯ä»¥ä½¿ç”¨é—­åˆæ–¹å¼çš„æ ‡é¢˜ï¼Œç»“å°¾çš„#å¯ä»¥ä¸å¿…å’Œå¼€å¤´ä¸€è‡´\nmarkdown \u0026#9660; 1 2 3 # ä¸€çº§æ ‡é¢˜ # ## äºŒçº§æ ‡é¢˜ ## ... å¦ä¸€ç§æ–¹å¼\nmarkdown \u0026#9660; 1 2 3 4 5 ä¸€çº§æ ‡é¢˜ ======= äºŒçº§æ ‡é¢˜ ------- å½“ç„¶ä¹Ÿå¯ä»¥ç”¨HTMLçš„æ–¹å¼\nhtml \u0026#9660; 1 2 3 4 5 6 \u0026lt;h1\u0026gt;ä¸€çº§æ ‡é¢˜\u0026lt;/h1\u0026gt; \u0026lt;h2\u0026gt;äºŒçº§æ ‡é¢˜\u0026lt;/h2\u0026gt; \u0026lt;h3\u0026gt;ä¸‰çº§æ ‡é¢˜\u0026lt;/h3\u0026gt; \u0026lt;h4\u0026gt;å››çº§æ ‡é¢˜\u0026lt;/h4\u0026gt; \u0026lt;h5\u0026gt;äº”çº§æ ‡é¢˜\u0026lt;/h5\u0026gt; \u0026lt;h6\u0026gt;å…­çº§æ ‡é¢˜\u0026lt;/h6\u0026gt; HTMLçš„å¥½å¤„åœ¨äºå¯ä»¥æ–¹ä¾¿çš„ä½¿æ ‡é¢˜å±…ä¸­\nhtml \u0026#9660; 1 \u0026lt;h1 align=\u0026#34;center\u0026#34;\u0026gt;å±…ä¸­æ ‡é¢˜\u0026lt;/h1\u0026gt; ç›®å½• å¯ä»¥ä½¿ç”¨[TOC]æ ‡è®°æ¥è‡ªåŠ¨ç”Ÿæˆç›®å½•ï¼Œä½†å…¼å®¹æ€§è²Œä¼¼ä¸æ€ä¹ˆå¥½\nmarkdown \u0026#9660; 1 [TOC] åˆ†éš”çº¿ å¯ä»¥ä½¿ç”¨3ä¸ªä»¥ä¸Šçš„*ã€-ä½œä¸ºåˆ†éš”çº¿ï¼Œä¸­é—´ä¹Ÿå¯ä»¥æ’å…¥ç©ºæ ¼\nmarkdown \u0026#9660; 1 2 3 4 *** * * * --- - - - å­—ä½“ ç²—ä½“\nåœ¨éœ€è¦ä»¥ç²—ä½“æ˜¾ç¤ºçš„æ–‡å­—å‰åå„åŠ ä¸¤ä¸ª*æˆ–_å¯ä»¥ä½¿æ–‡å­—åŠ ç²—æ˜¾ç¤º\nmarkdown \u0026#9660; 1 2 **ç²—ä½“** __ç²—ä½“__ æ–œä½“\nåœ¨éœ€è¦ä»¥æ–œä½“æ˜¾ç¤ºçš„æ–‡å­—å‰åå„åŠ ä¸€ä¸ª*æˆ–_å¯ä»¥ä½¿æ–‡å­—å·²æ–œä½“æ˜¾ç¤º\nmarkdown \u0026#9660; 1 2 *æ–œä½“* _æ–œä½“_ åˆ é™¤çº¿\nåœ¨æ–‡å­—å‰åå„åŠ ä¸¤ä¸ª~å¯ä»¥åœ¨æ–‡å­—ä¸Šæ·»åŠ åˆ é™¤çº¿\nmarkdown \u0026#9660; 1 ~~åˆ é™¤çº¿~~ å½“ç„¶ä¹Ÿå¯ä»¥è¿›è¡Œç»„åˆä½¿ç”¨\nmarkdown \u0026#9660; 1 2 ***æ–œä½“åŠ ç²—*** __~~ç²—ä½“åˆ é™¤çº¿~~__ é¢œè‰² åœ¨å†™ä½œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°ä¸å°‘æƒ…å†µéœ€è¦å°†æ–‡å­—ç”¨ä¸åŒé¢œè‰²æ ‡æ³¨ï¼Œå¯ä»¥ä½¿ç”¨HTMLçš„æ–¹å¼æ¥å®ç°ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥è®¾ç½®å­—ä½“å’Œå¤§å°\nhtml \u0026#9660; 1 \u0026lt;font face=\u0026#34;å¾®è½¯é›…é»‘\u0026#34; color=red size=12\u0026gt;è½éœä¸å­¤é¹œé½é£ï¼Œç§‹æ°´å…±é•¿å¤©ä¸€è‰²ã€‚\u0026lt;/font\u0026gt; æ®µè½ Markdownçš„æ¢è¡Œæœ‰äº›å¥‡ç‰¹ï¼Œç›´æ¥Enteræ¢è¡Œå®ƒå¥½åƒä¸è®¤ï¼Œéœ€è¦åœ¨æ®µè½ç»“å°¾åŠ ä¸¤ä¸ªç©ºæ ¼+æ¢è¡Œæ‰å¯ä»¥ï¼Œæˆ–è€…åœ¨ä¸Šä¸€æ®µè½å’Œä¸‹ä¸€æ®µè½ä¹‹é—´å†åŠ ä¸€è¡Œç©ºè¡Œï¼Œå³ä¸¤æ¬¡æ¢è¡Œä¹Ÿå¯ä»¥ã€‚\nè½éœä¸å­¤é¹œé½é£ï¼Œç§‹æ°´å…±é•¿å¤©ä¸€è‰²ã€‚ æ¸”èˆŸå”±æ™šï¼Œå“ç©·å½­è ¡ä¹‹æ»¨ï¼›\né›é˜µæƒŠå¯’ï¼Œå£°æ–­è¡¡é˜³ä¹‹æµ¦ã€‚\nmarkdown \u0026#9660; 1 2 3 4 è½éœä¸å­¤é¹œé½é£ï¼Œç§‹æ°´å…±é•¿å¤©ä¸€è‰²ã€‚ æ¸”èˆŸå”±æ™šï¼Œå“ç©·å½­è ¡ä¹‹æ»¨ï¼› é›é˜µæƒŠå¯’ï¼Œå£°æ–­è¡¡é˜³ä¹‹æµ¦ã€‚ å¼•ç”¨ å†™åœ¨\u0026gt;åçš„æ–‡å­—å³å¯æ˜¾ç¤ºä¸ºå¼•ç”¨ï¼Œå¼•ç”¨å¯ä»¥åµŒå¥—ä½¿ç”¨\nmarkdown \u0026#9660; 1 2 3 \u0026gt; å¼•ç”¨çš„æ–‡å­— \u0026gt;\u0026gt; åµŒå¥—å¼•ç”¨çš„æ–‡å­— \u0026gt;\u0026gt;\u0026gt; æ›´å¤šåµŒå¥— è¡¨æ ¼ è¡¨å¤´ è¡¨å¤´ è¡¨å¤´ è¡¨å¤´ å†…å®¹ å±…å·¦ å±…ä¸­ å±…å³ markdown \u0026#9660; 1 2 3 |è¡¨å¤´|è¡¨å¤´|è¡¨å¤´|è¡¨å¤´| |---|:--|:--:|---:| |å†…å®¹|å±…å·¦|å±…ä¸­|å±…å³| ç¬¬ä¸€è¡Œæ˜¯è¡¨å¤´ï¼Œç¬¬äºŒè¡Œä»£è¡¨å¯¹é½æ–¹å¼ï¼Œé»˜è®¤æ˜¯å±…å·¦ï¼Œåœ¨-å·¦è¾¹åŠ :å³å¯å±…å·¦å¯¹é½ï¼Œåœ¨-å³è¾¹åŠ :å¯å±…å³å¯¹é½ï¼Œä¸¤è¾¹éƒ½åŠ :è¡¨ç¤ºå±…ä¸­å¯¹é½\nåˆ—è¡¨ æœ‰åºåˆ—è¡¨\nmarkdown \u0026#9660; 1 2 3 1. åˆ—è¡¨1 2. åˆ—è¡¨2 3. åˆ—è¡¨3 æ— åºåˆ—è¡¨\nå¯ä»¥ä½¿ç”¨*ã€+æˆ–è€…-ä½œä¸ºæ ‡è®°\nmarkdown \u0026#9660; 1 2 3 * åˆ—è¡¨1 + åˆ—è¡¨2 - åˆ—è¡¨3 ä»»åŠ¡åˆ—è¡¨\n@mentions, #refs, links, formatting, and tags supported list syntax required (any unordered or ordered list supported) this is a complete item this is an incomplete item markdown \u0026#9660; 1 2 - [x] å·²å®Œæˆçš„ä»»åŠ¡ - [ ] æœªå®Œæˆçš„ä»»åŠ¡ é“¾æ¥ å¯ä»¥ç›´æ¥è¾“å…¥ç½‘å€ï¼Œå¦‚ï¼šhttps://github.com/\næˆ–è€…ä½¿ç”¨æ ¼å¼ï¼š[Text](url)\nç‚¹å‡»è¿™é‡Œè¿”å›ä¸»é¡µ\nmarkdown \u0026#9660; 1 ç‚¹å‡»[è¿™é‡Œ](https://kira-96.github.io/)è¿”å›ä¸»é¡µ ä¹Ÿå¯ä»¥ä½¿ç”¨HTMLçš„æ–¹å¼\nhtml \u0026#9660; 1 ç‚¹å‡»\u0026lt;a href=\u0026#34;https://kira-96.github.io/\u0026#34; target=\u0026#34;_blank\u0026#34;\u0026gt;è¿™é‡Œ\u0026lt;/a\u0026gt;è¿”å›ä¸»é¡µ è¿˜æœ‰ä¸€ç§å°±æ˜¯ä½¿ç”¨ç´¢å¼•çš„æ–¹å¼ ä¾‹ï¼šè°·æ­Œã€ç™¾åº¦\nmarkdown \u0026#9660; 1 2 3 4 ä¾‹ï¼š[è°·æ­Œ][1]ã€[ç™¾åº¦][2] [1]: https://www.google.com.hk/ \u0026#34;google\u0026#34; [2]: https://www.baidu.com/ \u0026#34;ç™¾åº¦\u0026#34; é”š ä¸»è¦ç”¨äºåœ¨é¡µé¢å†…è·³è½¬\nç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹é“¾æ¥çš„ç”¨æ³•\nmarkdown \u0026#9660; 1 ç‚¹å‡»[è¿™é‡Œ](#é“¾æ¥)æŸ¥çœ‹é“¾æ¥çš„ç”¨æ³• å›¾ç‰‡ å›¾ç‰‡å’Œé“¾æ¥çš„æ ¼å¼å¾ˆåƒï¼Œurlå¯ä»¥ä½¿ç”¨ç›¸å¯¹ä½ç½®å’Œç»å¯¹ä½ç½®ï¼Œå½“ç„¶ç½‘ç»œä½ç½®ä¹Ÿå¯ä»¥\n![Alt Text](url)\nmarkdown \u0026#9660; 1 ![å›¾ç‰‡](https://image-url.jpg) ä¹Ÿå¯ä»¥ä½¿ç”¨HTMLçš„æ–¹å¼\nhtml \u0026#9660; 1 \u0026lt;img src=\u0026#34;https://image-url.jpg\u0026#34; width=\u0026#34;50%\u0026#34; height=\u0026#34;50%\u0026#34;\u0026gt; è®¾ç½®å¯¹é½æ–¹å¼\nhtml \u0026#9660; 1 2 3 \u0026lt;div align=center\u0026gt; \u0026lt;img src=\u0026#34;https://image-url.jpg\u0026#34; width=\u0026#34;50%\u0026#34; height=\u0026#34;50%\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; æ ‡æ³¨ è¿™ä¸ªç”¨çš„å¹¶ä¸å¤šï¼Œçœ‹èµ·æ¥åƒæ˜¯è¯¾æœ¬ä¸Šæ–‡è¨€æ–‡é‡Œé¢é‚£ç§æ³¨é‡Šçš„æ„Ÿè§‰\nä¾‹ï¼š\næ»•ç‹é˜åºçš„ä½œè€…æ˜¯ç‹å‹ƒ1ã€‚\nmarkdown \u0026#9660; 1 2 3 æ»•ç‹é˜åºçš„ä½œè€…æ˜¯ç‹å‹ƒ[^1]ã€‚ [^1]: ç‹å‹ƒï¼ˆçº¦650â€”â€”676å¹´ï¼‰ï¼Œå”ä»£è¯—äººã€‚æ±‰æ—ï¼Œå­—å­å®‰ã€‚ç»›å·é¾™é—¨(ä»Šå±±è¥¿æ²³æ´¥)äººã€‚ç‹å‹ƒä¸æ¨ç‚¯ã€å¢ç…§é‚»ã€éª†å®¾ç‹é½åï¼Œä¸–ç§°â€œåˆå”å››æ°â€ï¼Œå…¶ä¸­ç‹å‹ƒæ˜¯â€œåˆå”å››æ°â€ä¹‹é¦–ã€‚ è¡Œå†…ä»£ç  å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸¤ä¸ª`ï¼ˆåå¼•å·ï¼‰åŒ…è£¹è¡Œå†…ä»£ç \nä¾‹ï¼šæˆ‘ä»¬å­¦ä¹ çš„ç¬¬ä¸€è¡Œä»£ç é€šå¸¸éƒ½æ˜¯printf(\u0026quot;Hello World!\u0026quot;)ã€‚\nmarkdown \u0026#9660; 1 æˆ‘ä»¬å­¦ä¹ çš„ç¬¬ä¸€è¡Œä»£ç é€šå¸¸éƒ½æ˜¯`printf(\u0026#34;Hello World!\u0026#34;)`ã€‚ è¯­æ³•é«˜äº® cpp \u0026#9660; 1 2 3 4 5 int main(void) { printf(\u0026#34;Hello World!\\n\u0026#34;); return 0; } markdown \u0026#9660; 1 2 3 4 5 6 7 â€‹``` cpp int main(void) { printf(\u0026#34;Hello World!\\n\u0026#34;); return 0; } â€‹``` å…¬å¼ å…¬å¼å¯¹äºå†™è®ºæ–‡çš„åŒå­¦æ¥è¯´æ˜¯éå¸¸æœ‰ç”¨çš„ï¼ŒMarkdownçš„å…¬å¼ä¹Ÿæ¯”wordçš„å…¬å¼ç¼–è¾‘æ–¹ä¾¿å¤šäº†ã€‚\nè¡Œå†…å…¬å¼ï¼Œä½¿ç”¨$ $åŒ…æ‹¬åœ¨å†…ã€‚\nå¦‚ï¼š$e=mc^2$\nmarkdown \u0026#9660; 1 $e=mc^2$ å•è¡Œå…¬å¼ï¼Œå…¬å¼ä¼šå•ç‹¬å ç”¨ä¸€è¡Œï¼Œä½¿ç”¨$$ $$åŒ…æ‹¬åœ¨å†…ã€‚\n$$Fe+CuSO_4=FeSO_4+Cu$$\nmarkdown \u0026#9660; 1 $$Fe+CuSO_4=FeSO_4+Cu$$ å…¶ä¸­å…·ä½“çš„ç¬¦å·å’Œå­—æ¯ä¹‹ç±»çš„éœ€è¦çš„æ—¶å€™å¯ä»¥åˆ°ç½‘ä¸Šå»æ‰¾ï¼Œå¦‚Markdown æ•°å­¦å…¬å¼ã€‚\nè½¬ä¹‰å­—ç¬¦ markdown \u0026#9660; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \\\\ åæ–œæ  \\` åå¼•å· \\* æ˜Ÿå· \\_ ä¸‹åˆ’çº¿ \\{\\} å¤§æ‹¬å· \\[\\] ä¸­æ‹¬å· \\(\\) å°æ‹¬å· \\# äº•å· \\+ åŠ å· \\- å‡å· \\. è‹±æ–‡å¥å· \\! æ„Ÿå¹å· æ³¨é‡Š å¯ä»¥ä½¿ç”¨HTMLçš„æ³¨é‡Šæ–¹å¼ï¼Œä¼šåœ¨ç”Ÿæˆçš„HTMLä¸­ä»¥æ³¨é‡Šçš„å½¢å¼å­˜åœ¨ï¼Œä¸æ˜¾ç¤ºå‡ºæ¥ã€‚\nhtml \u0026#9660; 1 \u0026lt;!-- æˆ‘æ˜¯æ³¨é‡Šå†…å®¹ --\u0026gt; æˆ–è€…ä½¿ç”¨\næˆ‘æ˜¯æ³¨é‡Šå†…å®¹ html \u0026#9660; 1 2 3 \u0026lt;div style=\u0026#39;display: none\u0026#39;\u0026gt; æˆ‘æ˜¯æ³¨é‡Šå†…å®¹ \u0026lt;/div\u0026gt; \u0026#x1f603; Emojiâ€‹ \u0026#x1f389; Markdownç”šè‡³æ”¯æŒEmoji\n\u0026#x1f60d;\u0026#x1f61c;\u0026#x1f620;\u0026#x1f4a2;\u0026#x1f637;\u0026#x1f47f;\u0026#x1f608;\u0026#x1f495;\nEmoji Cheat Sheet\nå†™åœ¨æœ€å è‡ªä»æ¥è§¦äº†Markdownä¹‹åï¼Œæˆ‘å°±å¾ˆå°‘ä½¿ç”¨Wordè¿™ç±»å·¥å…·äº†ã€‚æ—¥å¸¸å·¥ä½œå’Œç”Ÿæ´»ä¸­ç”¨å®ƒæ¥å†™æ–‡æ¡£å’Œç¬”è®°çœŸçš„æ˜¯ç›¸å½“èˆ’æœï¼Œè¯­æ³•ç®€å•å¥½è®°ï¼Œå®Œå…¨å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œä½¿ç”¨èµ·æ¥æ–¹ä¾¿å¿«æ·ï¼Œè¿˜å¯ä»¥å€ŸåŠ©HTMLæ¥å®ç°ä¸€äº›æ¯”è¾ƒå¤æ‚çš„åŠŸèƒ½ã€‚\nä¸è¿‡æˆ‘ä»¬å…¬å¸å†…éƒ¨ä¼¼ä¹æ²¡ä»€ä¹ˆäººä½¿ç”¨ï¼Œå¯èƒ½æ˜¯ç”±äºæˆ‘ä»¬å…¬å¸å¹¶ä¸æ˜¯äº’è”ç½‘ä¼ä¸šï¼Œæ‰€ä»¥æ²¡æœ‰é‚£ä¹ˆæ½®æµï¼Œæ„Ÿè§‰å¯ä»¥å€Ÿæœºä¼šå®‰åˆ©ä¸€æ³¢ï¼Œå¯¹äºæé«˜æ•´ä½“çš„å·¥ä½œæ•ˆç‡ä¹Ÿæœ‰ä¸å°çš„å¸®åŠ©ã€‚\nç‹å‹ƒï¼ˆçº¦650â€”â€”676å¹´ï¼‰ï¼Œå”ä»£è¯—äººã€‚æ±‰æ—ï¼Œå­—å­å®‰ã€‚ç»›å·é¾™é—¨(ä»Šå±±è¥¿æ²³æ´¥)äººã€‚ç‹å‹ƒä¸æ¨ç‚¯ã€å¢ç…§é‚»ã€éª†å®¾ç‹é½åï¼Œä¸–ç§°â€œåˆå”å››æ°â€ï¼Œå…¶ä¸­ç‹å‹ƒæ˜¯â€œåˆå”å››æ°â€ä¹‹é¦–ã€‚\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"https://kira-96.github.io/posts/markdown-%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95%E5%A4%87%E5%BF%98/","summary":"\u003ch2 id=\"æ ‡é¢˜\"\u003eæ ‡é¢˜\u003c/h2\u003e\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"markdown\"\u003emarkdown\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e4\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e5\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e6\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gh\"\u003e# ä¸€çº§æ ‡é¢˜\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e## äºŒçº§æ ‡é¢˜\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e### ä¸‰çº§æ ‡é¢˜\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e#### å››çº§æ ‡é¢˜\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e##### äº”çº§æ ‡é¢˜\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e###### å…­çº§æ ‡é¢˜\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003cblockquote\u003e\n    \u003cp\u003eä¹Ÿå¯ä»¥ä½¿ç”¨é—­åˆæ–¹å¼çš„æ ‡é¢˜ï¼Œç»“å°¾çš„\u003ccode\u003e#\u003c/code\u003eå¯ä»¥ä¸å¿…å’Œå¼€å¤´ä¸€è‡´\u003c/p\u003e\n\n\u003c/blockquote\u003e\n\n\u003cdiv class=\"mac-codeblock\"\u003e\n  \n  \u003cdiv class=\"mac-titlebar\"\u003e\n    \n    \u003cdiv class=\"mac-left-group\"\u003e\n      \u003cspan class=\"mac-close\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-minimize\"\u003e\u003c/span\u003e\n      \u003cspan class=\"mac-expand\"\u003e\u003c/span\u003e\n    \u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-title\" title=\"markdown\"\u003emarkdown\u003c/div\u003e\n    \n    \n    \u003cdiv class=\"mac-right-group\"\u003e\n      \u003cbutton class=\"fold-button\"\u003e\u0026#9660;\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \n  \n  \u003cdiv class=\"mac-content\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cdiv class=\"chroma\"\u003e\n\u003ctable class=\"lntable\"\u003e\u003ctr\u003e\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode\u003e\u003cspan class=\"lnt\"\u003e1\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e2\n\u003c/span\u003e\u003cspan class=\"lnt\"\u003e3\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\n\u003ctd class=\"lntd\"\u003e\n\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-markdown\" data-lang=\"markdown\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gh\"\u003e# ä¸€çº§æ ‡é¢˜ #\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e## äºŒçº§æ ‡é¢˜ ##\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e...\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cp\u003eå¦ä¸€ç§æ–¹å¼\u003c/p\u003e","title":"Markdown å¸¸ç”¨è¯­æ³•å¤‡å¿˜"},{"content":"æ¡Œé¢ç«¯ Typora æ”¶è´¹ï¼Œæ”¯æŒ Mac, Windows, Linux\nMarkText æ”¯æŒ Mac, Windows, Linux\niA Writer æ”¶è´¹, æ”¯æŒ Mac, Windows\nç§»åŠ¨ç«¯ iA Writer iOS - æ”¶è´¹ Android - å…è´¹\nç†ŠæŒè®° æ”¯æŒ Mac, iOS, å¯å…è´¹ä½¿ç”¨ï¼Œéƒ¨åˆ†åŠŸèƒ½éœ€è¦è®¢è´­\nç¬”è®°è½¯ä»¶ Joplin æ”¯æŒ Windows, Mac, Linux, Android, iOS çœŸæ­£çš„å…¨å¹³å°ï¼Œæ”¯æŒMarkdownè¯­æ³•ï¼Œå¯ä»¥é…åˆOneDriveæˆ–è€…WebDavåŒæ­¥ç¬”è®° è¿™é‡Œæ¨èä½¿ç”¨åšæœäº‘åšåŒæ­¥ç›˜ã€‚\n","permalink":"https://kira-96.github.io/posts/%E5%A5%BD%E7%94%A8%E7%9A%84-markdown-%E7%BC%96%E8%BE%91%E5%99%A8/","summary":"\u003ch2 id=\"æ¡Œé¢ç«¯\"\u003eæ¡Œé¢ç«¯\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.typora.io/\"\u003eTypora\u003c/a\u003e\næ”¶è´¹ï¼Œæ”¯æŒ Mac, Windows, Linux\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://marktext.app/\"\u003eMarkText\u003c/a\u003e\næ”¯æŒ Mac, Windows, Linux\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://ia.net/writer\"\u003eiA Writer\u003c/a\u003e\næ”¶è´¹, æ”¯æŒ Mac, Windows\u003c/p\u003e\n\u003ch2 id=\"ç§»åŠ¨ç«¯\"\u003eç§»åŠ¨ç«¯\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://ia.net/writer\"\u003eiA Writer\u003c/a\u003e\niOS - æ”¶è´¹\nAndroid - å…è´¹\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://bear.app/cn/\"\u003eç†ŠæŒè®°\u003c/a\u003e\næ”¯æŒ Mac, iOS, å¯å…è´¹ä½¿ç”¨ï¼Œéƒ¨åˆ†åŠŸèƒ½éœ€è¦è®¢è´­\u003c/p\u003e\n\u003ch2 id=\"ç¬”è®°è½¯ä»¶\"\u003eç¬”è®°è½¯ä»¶\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://joplinapp.org\"\u003eJoplin\u003c/a\u003e\næ”¯æŒ Windows, Mac, Linux, Android, iOS\nçœŸæ­£çš„å…¨å¹³å°ï¼Œæ”¯æŒMarkdownè¯­æ³•ï¼Œå¯ä»¥é…åˆOneDriveæˆ–è€…WebDavåŒæ­¥ç¬”è®°\nè¿™é‡Œæ¨èä½¿ç”¨\u003ca href=\"https://www.jianguoyun.com/\"\u003eåšæœäº‘\u003c/a\u003eåšåŒæ­¥ç›˜ã€‚\u003c/p\u003e","title":"å¥½ç”¨çš„ Markdown ç¼–è¾‘å™¨ - å…¨å¹³å°"}]